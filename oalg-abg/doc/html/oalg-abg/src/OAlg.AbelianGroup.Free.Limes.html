<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE NoImplicitPrelude #-}</span><span>
</span><span id="line-3"></span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-7"></span><span>
</span><span id="line-8"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- Module      : OAlg.AbelianGroup.Free.Limes</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- Description : limits for matrices over integers.</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- Copyright   : (c) Erich Gut</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- License     : BSD3</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- Maintainer  : zerich.gut@gmail.com</span><span>
</span><span id="line-14"></span><span class="hs-comment">--</span><span>
</span><span id="line-15"></span><span class="hs-comment">-- limits for 'Z'-matrices.</span><span>
</span><span id="line-16"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">OAlg.AbelianGroup.Free.Limes</span><span>
</span><span id="line-17"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- * Projective</span></span><span>
</span><span id="line-18"></span><span>    </span><span class="annot"><a href="OAlg.AbelianGroup.Free.Limes.html#zmxKernels"><span class="hs-identifier">zmxKernels</span></a></span><span>
</span><span id="line-19"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Free.Limes.html#zmxPullbacks"><span class="hs-identifier">zmxPullbacks</span></a></span><span>
</span><span id="line-20"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">filter</span></span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">OAlg.Prelude</span></span><span>
</span><span id="line-25"></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">OAlg.Structure.Oriented</span></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">OAlg.Structure.Multiplicative</span></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">OAlg.Structure.Exponential</span></span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">OAlg.Entity.Natural</span></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">OAlg.Entity.Diagram</span></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">OAlg.Entity.FinList</span></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">OAlg.Entity.Matrix</span></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">OAlg.Entity.Sequence</span></span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">OAlg.Limes.Definition</span></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">OAlg.Limes.Cone</span></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">OAlg.Limes.Limits</span></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">OAlg.Limes.KernelsAndCokernels</span></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">OAlg.Limes.PullbacksAndPushouts</span></span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Free.SmithNormalForm.html"><span class="hs-identifier">OAlg.AbelianGroup.Free.SmithNormalForm</span></a></span><span>
</span><span id="line-43"></span><span>
</span><span id="line-44"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-45"></span><span class="hs-comment">-- zmxKernel -</span><span>
</span><span id="line-46"></span><span>
</span><span id="line-47"></span><span class="annot"><a href="OAlg.AbelianGroup.Free.Limes.html#zmxKernel"><span class="hs-identifier hs-type">zmxKernel</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KernelDiagram</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">N1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Matrix</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Z</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Kernel</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">N1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Matrix</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Z</span></span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span id="zmxKernel"><span class="annot"><span class="annottext">zmxKernel :: KernelDiagram N1 (Matrix Z) -&gt; Kernel N1 (Matrix Z)
</span><a href="OAlg.AbelianGroup.Free.Limes.html#zmxKernel"><span class="hs-identifier hs-var hs-var">zmxKernel</span></a></span></span><span> </span><span id="local-6989586621679084211"><span class="annot"><span class="annottext">kDgm :: KernelDiagram N1 (Matrix Z)
</span><a href="#local-6989586621679084211"><span class="hs-identifier hs-var">kDgm</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">DiagramParallelLR</span></span><span> </span><span class="annot"><span class="annottext">Point (Matrix Z)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Point (Matrix Z)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679084216"><span class="annot"><span class="annottext">Matrix Z
</span><a href="#local-6989586621679084216"><span class="hs-identifier hs-var">h</span></a></span></span><span class="annot"><span class="hs-operator hs-type">:|</span></span><span class="annot"><span class="annottext">FinList n1 (Matrix Z)
</span><span class="hs-identifier hs-var">Nil</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Cone Dst 'Projective ('Parallel 'LeftToRight) N2 N1 (Matrix Z)
-&gt; (Cone Dst 'Projective ('Parallel 'LeftToRight) N2 N1 (Matrix Z)
    -&gt; Matrix Z)
-&gt; Kernel N1 (Matrix Z)
forall s (t :: DiagramType) (n :: N') (m :: N') a.
Cone s 'Projective t n m a
-&gt; (Cone s 'Projective t n m a -&gt; a) -&gt; Limes s 'Projective t n m a
</span><span class="hs-identifier hs-var">LimesProjective</span></span><span> </span><span class="annot"><span class="annottext">Cone Dst 'Projective ('Parallel 'LeftToRight) N2 N1 (Matrix Z)
</span><a href="#local-6989586621679084268"><span class="hs-identifier hs-var">lim</span></a></span><span> </span><span class="annot"><span class="annottext">Cone Dst 'Projective ('Parallel 'LeftToRight) N2 N1 (Matrix Z)
-&gt; Matrix Z
</span><a href="#local-6989586621679084269"><span class="hs-identifier hs-var">univ</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-49"></span><span>  </span><span>
</span><span id="line-50"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">DiagonalForm</span></span><span> </span><span id="local-6989586621679084271"><span class="annot"><span class="annottext">[Z]
</span><a href="#local-6989586621679084271"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="annot"><span class="annottext">RowTrafo Z
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ColTrafo</span></span><span> </span><span id="local-6989586621679084273"><span class="annot"><span class="annottext">GLT Z
</span><a href="#local-6989586621679084273"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix Z -&gt; DiagonalForm Z
</span><a href="OAlg.AbelianGroup.Free.SmithNormalForm.html#zmxDiagonalForm"><span class="hs-identifier hs-var">zmxDiagonalForm</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix Z
</span><a href="#local-6989586621679084216"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-51"></span><span>  </span><span class="hs-comment">-- d = (rt*&gt;h)&lt;*ct</span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Inv</span></span><span> </span><span id="local-6989586621679084276"><span class="annot"><span class="annottext">Matrix Z
</span><a href="#local-6989586621679084276"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679084277"><span class="annot"><span class="annottext">Matrix Z
</span><a href="#local-6989586621679084277"><span class="hs-identifier hs-var">bInv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GLApp (GLT Z) (Inv (Matrix Z)) -&gt; GLT Z -&gt; Inv (Matrix Z)
forall a b. GLApp a b -&gt; a -&gt; b
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><span class="hs-identifier hs-var">amap</span></span><span> </span><span class="annot"><span class="annottext">GLApp (GLT Z) (Inv (Matrix Z))
forall x1. Distributive x1 =&gt; GLApp (GLT x1) (Inv (Matrix x1))
</span><span class="hs-identifier hs-var">GLTGL</span></span><span> </span><span class="annot"><span class="annottext">GLT Z
</span><a href="#local-6989586621679084273"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-54"></span><span>  </span><span>
</span><span id="line-55"></span><span>  </span><span id="local-6989586621679084280"><span class="annot"><span class="annottext">m :: N
</span><a href="#local-6989586621679084280"><span class="hs-identifier hs-var hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dim Z () -&gt; N
forall x. LengthN x =&gt; x -&gt; N
</span><span class="hs-identifier hs-var">lengthN</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix Z -&gt; Point (Matrix Z)
forall q. Oriented q =&gt; q -&gt; Point q
</span><span class="hs-identifier hs-var">start</span></span><span> </span><span class="annot"><span class="annottext">Matrix Z
</span><a href="#local-6989586621679084216"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span>  </span><span id="local-6989586621679084283"><span class="annot"><span class="annottext">s :: N
</span><a href="#local-6989586621679084283"><span class="hs-identifier hs-var hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Z] -&gt; N
forall x. LengthN x =&gt; x -&gt; N
</span><span class="hs-identifier hs-var">lengthN</span></span><span> </span><span class="annot"><span class="annottext">[Z]
</span><a href="#local-6989586621679084271"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-57"></span><span>  </span><span id="local-6989586621679084284"><span class="annot"><span class="annottext">r :: N
</span><a href="#local-6989586621679084284"><span class="hs-identifier hs-var hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679084280"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; N
</span><span class="hs-operator hs-var">&gt;-</span></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679084283"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span>  </span><span id="local-6989586621679084286"><span class="annot"><span class="annottext">k :: Matrix Z
</span><a href="#local-6989586621679084286"><span class="hs-identifier hs-var hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix (Matrix Z) -&gt; Matrix Z
forall x. Oriented x =&gt; Matrix (Matrix x) -&gt; Matrix x
</span><span class="hs-identifier hs-var">mtxJoin</span></span><span> </span><span class="annot"><span class="annottext">(Matrix (Matrix Z) -&gt; Matrix Z) -&gt; Matrix (Matrix Z) -&gt; Matrix Z
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Dim' Z] -&gt; [Dim' Z] -&gt; [(Matrix Z, N, N)] -&gt; Matrix (Matrix Z)
forall x.
(Additive x, FibredOriented x) =&gt;
[Dim' x] -&gt; [Dim' x] -&gt; [(Matrix x, N, N)] -&gt; Matrix (Matrix x)
</span><span class="hs-identifier hs-var">matrixBlc</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Dim Z ()
Dim' Z
</span><a href="#local-6989586621679084290"><span class="hs-identifier hs-var">ds</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Dim Z ()
Dim' Z
</span><a href="#local-6989586621679084291"><span class="hs-identifier hs-var">dr</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Dim Z ()
Dim' Z
</span><a href="#local-6989586621679084291"><span class="hs-identifier hs-var">dr</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point (Matrix Z) -&gt; Matrix Z
forall c. Multiplicative c =&gt; Point c -&gt; c
</span><span class="hs-identifier hs-var">one</span></span><span> </span><span class="annot"><span class="annottext">Point (Matrix Z)
Dim Z ()
</span><a href="#local-6989586621679084291"><span class="hs-identifier hs-var">dr</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">N
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-60"></span><span>    </span><span id="local-6989586621679084290"><span class="annot"><span class="annottext">ds :: Dim Z ()
</span><a href="#local-6989586621679084290"><span class="hs-identifier hs-var hs-var">ds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; Dim Z ()
forall p x. (Entity p, p ~ Point x) =&gt; p -&gt; Dim x p
</span><span class="hs-identifier hs-var">dim</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Dim Z () -&gt; Exponent (Dim Z ()) -&gt; Dim Z ()
forall f. Exponential f =&gt; f -&gt; Exponent f -&gt; f
</span><span class="hs-operator hs-var">^</span></span><span> </span><span class="annot"><span class="annottext">N
Exponent (Dim Z ())
</span><a href="#local-6989586621679084283"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-61"></span><span>    </span><span id="local-6989586621679084291"><span class="annot"><span class="annottext">dr :: Dim Z ()
</span><a href="#local-6989586621679084291"><span class="hs-identifier hs-var hs-var">dr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; Dim Z ()
forall p x. (Entity p, p ~ Point x) =&gt; p -&gt; Dim x p
</span><span class="hs-identifier hs-var">dim</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Dim Z () -&gt; Exponent (Dim Z ()) -&gt; Dim Z ()
forall f. Exponential f =&gt; f -&gt; Exponent f -&gt; f
</span><span class="hs-operator hs-var">^</span></span><span> </span><span class="annot"><span class="annottext">N
Exponent (Dim Z ())
</span><a href="#local-6989586621679084284"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span>  </span><span id="local-6989586621679084295"><span class="annot"><span class="annottext">kPrj :: Matrix Z -&gt; Matrix Z
</span><a href="#local-6989586621679084295"><span class="hs-identifier hs-var hs-var">kPrj</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Matrix</span></span><span> </span><span class="annot"><span class="annottext">Dim' Z
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679084297"><span class="annot"><span class="annottext">Dim' Z
</span><a href="#local-6989586621679084297"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679084298"><span class="annot"><span class="annottext">Entries N N Z
</span><a href="#local-6989586621679084298"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dim' Z -&gt; Dim' Z -&gt; Entries N N Z -&gt; Matrix Z
forall x. Dim' x -&gt; Dim' x -&gt; Entries N N x -&gt; Matrix x
</span><span class="hs-identifier hs-var">Matrix</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix Z -&gt; Point (Matrix Z)
forall q. Oriented q =&gt; q -&gt; Point q
</span><span class="hs-identifier hs-var">start</span></span><span> </span><span class="annot"><span class="annottext">Matrix Z
</span><a href="#local-6989586621679084286"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Dim' Z
</span><a href="#local-6989586621679084297"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Entries N N Z
</span><a href="#local-6989586621679084299"><span class="hs-identifier hs-var">xs'</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-64"></span><span>    </span><span id="local-6989586621679084299"><span class="annot"><span class="annottext">xs' :: Entries N N Z
</span><a href="#local-6989586621679084299"><span class="hs-identifier hs-var hs-var">xs'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PSequence (N, N) Z -&gt; Entries N N Z
forall i j x. PSequence (i, j) x -&gt; Entries i j x
</span><span class="hs-identifier hs-var">Entries</span></span><span> </span><span class="annot"><span class="annottext">(PSequence (N, N) Z -&gt; Entries N N Z)
-&gt; PSequence (N, N) Z -&gt; Entries N N Z
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(Z, (N, N))] -&gt; PSequence (N, N) Z
forall i x. [(x, i)] -&gt; PSequence i x
</span><span class="hs-identifier hs-var">PSequence</span></span><span>
</span><span id="line-65"></span><span>        </span><span class="annot"><span class="annottext">([(Z, (N, N))] -&gt; PSequence (N, N) Z)
-&gt; [(Z, (N, N))] -&gt; PSequence (N, N) Z
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((Z, N, N) -&gt; (Z, (N, N))) -&gt; [(Z, N, N)] -&gt; [(Z, (N, N))]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
forall (h :: * -&gt; * -&gt; *) (f :: * -&gt; *) a b.
Applicative1 h f =&gt;
h a b -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">amap1</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679084303"><span class="annot"><span class="annottext">Z
</span><a href="#local-6989586621679084303"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679084304"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679084304"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679084305"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679084305"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Z
</span><a href="#local-6989586621679084303"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679084304"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">N -&gt; N -&gt; N
</span><span class="hs-operator hs-var">&gt;-</span></span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679084283"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679084305"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span>        </span><span class="annot"><span class="annottext">([(Z, N, N)] -&gt; [(Z, (N, N))]) -&gt; [(Z, N, N)] -&gt; [(Z, (N, N))]
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((Z, N, N) -&gt; Bool) -&gt; [(Z, N, N)] -&gt; [(Z, N, N)]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Z
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679084306"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679084306"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">N
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679084283"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679084306"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span>        </span><span class="annot"><span class="annottext">([(Z, N, N)] -&gt; [(Z, N, N)]) -&gt; [(Z, N, N)] -&gt; [(Z, N, N)]
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Entries N N Z -&gt; [(Z, N, N)]
forall i j x. Entries i j x -&gt; [(x, i, j)]
</span><span class="hs-identifier hs-var">etsxs</span></span><span> </span><span class="annot"><span class="annottext">Entries N N Z
</span><a href="#local-6989586621679084298"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span>  </span><span id="local-6989586621679084268"><span class="annot"><span class="annottext">lim :: Cone Dst 'Projective ('Parallel 'LeftToRight) N2 N1 (Matrix Z)
</span><a href="#local-6989586621679084268"><span class="hs-identifier hs-var hs-var">lim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KernelDiagram N1 (Matrix Z)
-&gt; Matrix Z
-&gt; Cone Dst 'Projective ('Parallel 'LeftToRight) N2 N1 (Matrix Z)
forall a (m :: N').
Distributive a =&gt;
Diagram ('Parallel 'LeftToRight) N2 m a
-&gt; a -&gt; Cone Dst 'Projective ('Parallel 'LeftToRight) N2 m a
</span><span class="hs-identifier hs-var">ConeKernel</span></span><span> </span><span class="annot"><span class="annottext">KernelDiagram N1 (Matrix Z)
</span><a href="#local-6989586621679084211"><span class="hs-identifier hs-var">kDgm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix Z
</span><a href="#local-6989586621679084276"><span class="hs-identifier hs-var">b</span></a></span><span class="annot"><span class="annottext">Matrix Z -&gt; Matrix Z -&gt; Matrix Z
forall c. Multiplicative c =&gt; c -&gt; c -&gt; c
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Matrix Z
</span><a href="#local-6989586621679084286"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span>  </span><span>
</span><span id="line-71"></span><span>  </span><span id="local-6989586621679084269"><span class="annot"><span class="annottext">univ :: Cone Dst 'Projective ('Parallel 'LeftToRight) N2 N1 (Matrix Z)
-&gt; Matrix Z
</span><a href="#local-6989586621679084269"><span class="hs-identifier hs-var hs-var">univ</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ConeKernel</span></span><span> </span><span class="annot"><span class="annottext">KernelDiagram N1 (Matrix Z)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679084319"><span class="annot"><span class="annottext">Matrix Z
</span><a href="#local-6989586621679084319"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix Z -&gt; Matrix Z
</span><a href="#local-6989586621679084295"><span class="hs-identifier hs-var">kPrj</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix Z
</span><a href="#local-6989586621679084277"><span class="hs-identifier hs-var">bInv</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix Z -&gt; Matrix Z -&gt; Matrix Z
forall c. Multiplicative c =&gt; c -&gt; c -&gt; c
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Matrix Z
</span><a href="#local-6989586621679084319"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-74"></span><span class="hs-comment">-- zmxKernels1 -</span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span class="annot"><span class="hs-comment">-- | 'N1'-kernels for 'Z'-matrices.</span></span><span>
</span><span id="line-77"></span><span class="annot"><a href="OAlg.AbelianGroup.Free.Limes.html#zmxKernels1"><span class="hs-identifier hs-type">zmxKernels1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Kernels</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">N1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Matrix</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Z</span></span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span id="zmxKernels1"><span class="annot"><span class="annottext">zmxKernels1 :: Kernels N1 (Matrix Z)
</span><a href="OAlg.AbelianGroup.Free.Limes.html#zmxKernels1"><span class="hs-identifier hs-var hs-var">zmxKernels1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(KernelDiagram N1 (Matrix Z) -&gt; Kernel N1 (Matrix Z))
-&gt; Kernels N1 (Matrix Z)
forall s (p :: Perspective) (t :: DiagramType) (n :: N') (m :: N')
       a.
(Diagram t n m a -&gt; Limes s p t n m a) -&gt; Limits s p t n m a
</span><span class="hs-identifier hs-var">Limits</span></span><span> </span><span class="annot"><span class="annottext">KernelDiagram N1 (Matrix Z) -&gt; Kernel N1 (Matrix Z)
</span><a href="OAlg.AbelianGroup.Free.Limes.html#zmxKernel"><span class="hs-identifier hs-var">zmxKernel</span></a></span><span>
</span><span id="line-79"></span><span>
</span><span id="line-80"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-81"></span><span class="hs-comment">-- zmxKernels -</span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span class="annot"><span class="hs-comment">-- | kernels for 'Z'-matrices.</span></span><span>
</span><span id="line-84"></span><span id="local-6989586621679084176"><span class="annot"><a href="OAlg.AbelianGroup.Free.Limes.html#zmxKernels"><span class="hs-identifier hs-type">zmxKernels</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Kernels</span></span><span> </span><span class="annot"><a href="#local-6989586621679084176"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Matrix</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Z</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-85"></span><span id="zmxKernels"><span class="annot"><span class="annottext">zmxKernels :: forall (n :: N'). Kernels n (Matrix Z)
</span><a href="OAlg.AbelianGroup.Free.Limes.html#zmxKernels"><span class="hs-identifier hs-var hs-var">zmxKernels</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Kernels N1 (Matrix Z) -&gt; Kernels n (Matrix Z)
forall a (n :: N'). Distributive a =&gt; Kernels N1 a -&gt; Kernels n a
</span><span class="hs-identifier hs-var">kernels</span></span><span> </span><span class="annot"><span class="annottext">Kernels N1 (Matrix Z)
</span><a href="OAlg.AbelianGroup.Free.Limes.html#zmxKernels1"><span class="hs-identifier hs-var">zmxKernels1</span></a></span><span>
</span><span id="line-86"></span><span>
</span><span id="line-87"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-88"></span><span class="hs-comment">-- zmxPullbacks2 -</span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span class="annot"><span class="hs-comment">-- | 'N2'-pullbacks for 'Z'-matrices.</span></span><span>
</span><span id="line-91"></span><span class="annot"><a href="OAlg.AbelianGroup.Free.Limes.html#zmxPullbacks2"><span class="hs-identifier hs-type">zmxPullbacks2</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pullbacks</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">N2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Matrix</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Z</span></span><span class="hs-special">)</span><span>
</span><span id="line-92"></span><span id="zmxPullbacks2"><span class="annot"><span class="annottext">zmxPullbacks2 :: Pullbacks N2 (Matrix Z)
</span><a href="OAlg.AbelianGroup.Free.Limes.html#zmxPullbacks2"><span class="hs-identifier hs-var hs-var">zmxPullbacks2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Products N2 (Matrix Z)
-&gt; Equalizers N2 (Matrix Z) -&gt; Pullbacks N2 (Matrix Z)
forall a.
Multiplicative a =&gt;
Products N2 a -&gt; Equalizers N2 a -&gt; Pullbacks N2 a
</span><span class="hs-identifier hs-var">plbPrdEql2</span></span><span> </span><span class="annot"><span class="annottext">Products N2 (Matrix Z)
forall x (n :: N'). Distributive x =&gt; Products n (Matrix x)
</span><span class="hs-identifier hs-var">mtxProducts</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Kernels N1 (Matrix Z) -&gt; Equalizers (N1 + 1) (Matrix Z)
forall a (n :: N').
(Distributive a, Abelian a) =&gt;
Kernels n a -&gt; Equalizers (n + 1) a
</span><span class="hs-identifier hs-var">krnEqls</span></span><span> </span><span class="annot"><span class="annottext">Kernels N1 (Matrix Z)
</span><a href="OAlg.AbelianGroup.Free.Limes.html#zmxKernels1"><span class="hs-identifier hs-var">zmxKernels1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span>
</span><span id="line-94"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-95"></span><span class="hs-comment">-- zmxPullbacks -</span><span>
</span><span id="line-96"></span><span>
</span><span id="line-97"></span><span class="annot"><span class="hs-comment">-- | pullbacks for 'Z'-matrices.</span></span><span>
</span><span id="line-98"></span><span id="local-6989586621679084188"><span class="annot"><a href="OAlg.AbelianGroup.Free.Limes.html#zmxPullbacks"><span class="hs-identifier hs-type">zmxPullbacks</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pullbacks</span></span><span> </span><span class="annot"><a href="#local-6989586621679084188"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Matrix</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Z</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-99"></span><span id="zmxPullbacks"><span class="annot"><span class="annottext">zmxPullbacks :: forall (n :: N'). Pullbacks n (Matrix Z)
</span><a href="OAlg.AbelianGroup.Free.Limes.html#zmxPullbacks"><span class="hs-identifier hs-var hs-var">zmxPullbacks</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pullbacks N2 (Matrix Z)
-&gt; Limits Mlt 'Projective ('Star 'To) (n + 1) n (Matrix Z)
forall a (n :: N').
Multiplicative a =&gt;
Pullbacks N2 a -&gt; Pullbacks n a
</span><span class="hs-identifier hs-var">pullbacks</span></span><span> </span><span class="annot"><span class="annottext">Pullbacks N2 (Matrix Z)
</span><a href="OAlg.AbelianGroup.Free.Limes.html#zmxPullbacks2"><span class="hs-identifier hs-var">zmxPullbacks2</span></a></span><span>
</span><span id="line-100"></span></pre></body></html>