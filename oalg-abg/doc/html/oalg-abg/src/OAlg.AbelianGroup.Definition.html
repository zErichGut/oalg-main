<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE NoImplicitPrelude #-}</span><span>
</span><span id="line-3"></span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies, TypeOperators #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances, FlexibleContexts #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE GADTs #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE StandaloneDeriving, GeneralizedNewtypeDeriving #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE DataKinds, RankNTypes #-}</span><span>
</span><span id="line-10"></span><span>
</span><span id="line-11"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- Module      : OAlg.AbelianGroup.Definition</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- Description : homomorphisms between finitely generated abelian groups</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- Copyright   : (c) Erich Gut</span><span>
</span><span id="line-15"></span><span class="hs-comment">-- License     : BSD3</span><span>
</span><span id="line-16"></span><span class="hs-comment">-- Maintainer  : zerich.gut@gmail.com</span><span>
</span><span id="line-17"></span><span class="hs-comment">--</span><span>
</span><span id="line-18"></span><span class="hs-comment">-- homomorphisms between finitely generated abelian groups.</span><span>
</span><span id="line-19"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">OAlg.AbelianGroup.Definition</span><span>
</span><span id="line-20"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- * Abelian Group</span></span><span>
</span><span id="line-21"></span><span>    </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbGroup"><span class="hs-identifier">AbGroup</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#abg"><span class="hs-identifier">abg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#isSmithNormal"><span class="hs-identifier">isSmithNormal</span></a></span><span>
</span><span id="line-22"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#abgDim"><span class="hs-identifier">abgDim</span></a></span><span>
</span><span id="line-23"></span><span>
</span><span id="line-24"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Homomorphism</span></span><span>
</span><span id="line-25"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier">AbHom</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#abh"><span class="hs-identifier">abh</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#abh%27"><span class="hs-identifier">abh'</span></a></span><span>
</span><span id="line-27"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#abhz"><span class="hs-identifier">abhz</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#zabh"><span class="hs-identifier">zabh</span></a></span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Adjunction</span></span><span>
</span><span id="line-30"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#abhFreeAdjunction"><span class="hs-identifier">abhFreeAdjunction</span></a></span><span>
</span><span id="line-31"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHomFree"><span class="hs-identifier">AbHomFree</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Limes</span></span><span>
</span><span id="line-34"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#abhProducts"><span class="hs-identifier">abhProducts</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#abhSums"><span class="hs-identifier">abhSums</span></a></span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Generator</span></span><span>
</span><span id="line-37"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#abgGeneratorTo"><span class="hs-identifier">abgGeneratorTo</span></a></span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span>    </span><span class="annot"><span class="hs-comment">-- * X</span></span><span>
</span><span id="line-40"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#xAbHom"><span class="hs-identifier">xAbHom</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#xAbHomTo"><span class="hs-identifier">xAbHomTo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#xAbHomFrom"><span class="hs-identifier">xAbHomFrom</span></a></span><span>
</span><span id="line-41"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#stdMaxDim"><span class="hs-identifier">stdMaxDim</span></a></span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Proposition</span></span><span>
</span><span id="line-44"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#prpAbHom"><span class="hs-identifier">prpAbHom</span></a></span><span>
</span><span id="line-45"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-46"></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Applicative</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(&lt;|&gt;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">foldl</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-operator">(++)</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">filter</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">takeWhile</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">zip</span></span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Typeable</span></span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">OAlg.Prelude</span></span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">OAlg.Data.Canonical</span></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">OAlg.Data.Reducible</span></span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">OAlg.Data.Constructable</span></span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">OAlg.Category.Path</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">C</span></span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">OAlg.Structure.Oriented</span></span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">OAlg.Structure.Multiplicative</span></span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">OAlg.Structure.Fibred</span></span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">OAlg.Structure.Additive</span></span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">OAlg.Structure.Vectorial</span></span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">OAlg.Structure.Distributive</span></span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">OAlg.Structure.Algebraic</span></span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">OAlg.Structure.Exponential</span></span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">OAlg.Structure.Number</span></span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">OAlg.Structure.Operational</span></span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">OAlg.Hom.Oriented</span></span><span>
</span><span id="line-73"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">OAlg.Hom.Multiplicative</span></span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">OAlg.Hom.Fibred</span></span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">OAlg.Hom.Additive</span></span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">OAlg.Hom.Distributive</span></span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">OAlg.Limes.Limits</span></span><span>
</span><span id="line-79"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">OAlg.Limes.Definition</span></span><span>
</span><span id="line-80"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">OAlg.Limes.Cone</span></span><span>
</span><span id="line-81"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">OAlg.Limes.ProductsAndSums</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">L</span></span><span>
</span><span id="line-82"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">OAlg.Limes.KernelsAndCokernels</span></span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">OAlg.Adjunction</span></span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">OAlg.Entity.Natural</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(++)</span></span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">OAlg.Entity.FinList</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(++)</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">zip</span></span><span class="hs-special">)</span><span>
</span><span id="line-88"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">OAlg.Entity.Diagram</span></span><span>
</span><span id="line-89"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">OAlg.Entity.Sequence</span></span><span>
</span><span id="line-90"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">OAlg.Entity.Matrix</span></span><span>
</span><span id="line-91"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">OAlg.Entity.Product</span></span><span>
</span><span id="line-92"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">OAlg.Entity.Slice</span></span><span>
</span><span id="line-93"></span><span>
</span><span id="line-94"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">OAlg.Data.Generator</span></span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.ZMod.html"><span class="hs-identifier">OAlg.AbelianGroup.ZMod</span></a></span><span>
</span><span id="line-97"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Euclid.html"><span class="hs-identifier">OAlg.AbelianGroup.Euclid</span></a></span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-100"></span><span class="hs-comment">-- AbGroup -</span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span class="hs-comment">-- | finitely generate abelian group, i.e. the cartesian product of cyclic groups @'Z'\/n@</span><span>
</span><span id="line-103"></span><span class="hs-comment">--   and are represented as a formal product with symbols in t'ZMod'.</span><span>
</span><span id="line-104"></span><span class="hs-comment">--</span><span>
</span><span id="line-105"></span><span class="hs-comment">-- __Definition__ Let @g@ be in t'AbGroup'. We call @g@ __/smith normal/__ if and only if</span><span>
</span><span id="line-106"></span><span class="hs-comment">-- there exists a sequence @n 0, n 1 .. n (k-1)@ in 'N' with length @k@ and a exponent</span><span>
</span><span id="line-107"></span><span class="hs-comment">-- @r@ in 'N' such that:</span><span>
</span><span id="line-108"></span><span class="hs-comment">--</span><span>
</span><span id="line-109"></span><span class="hs-comment">-- (1) @2 '&lt;=' n i@ for all @0 '&lt;=' i &lt; k@.</span><span>
</span><span id="line-110"></span><span class="hs-comment">--</span><span>
</span><span id="line-111"></span><span class="hs-comment">-- (2) @n (i v'+' 1) `mod` n i '==' 0@ for all @i@ in @0 '&lt;=' i &lt; k-1@.</span><span>
</span><span id="line-112"></span><span class="hs-comment">--</span><span>
</span><span id="line-113"></span><span class="hs-comment">-- (3) @g '==' 'abg' (n 0) v'*' 'abg' (n 1) v'*' .. v'*' 'abg' (n (k-1)) v'*' 'abg' 0 '^' r@.</span><span>
</span><span id="line-114"></span><span class="hs-comment">--</span><span>
</span><span id="line-115"></span><span class="hs-comment">-- __Theorem__ Every finitely generated abelian group is isomorphic to a group in</span><span>
</span><span id="line-116"></span><span class="hs-comment">-- smith normal form. This isomorphism is given by</span><span>
</span><span id="line-117"></span><span class="hs-comment">-- 'OAlg.AbelianGroup.KernelsAndCokernels.isoSmithNormal'.</span><span>
</span><span id="line-118"></span><span class="hs-comment">--</span><span>
</span><span id="line-119"></span><span class="hs-comment">--  __Examples__ Finitely generated abelian groups constructed via 'abg' and its</span><span>
</span><span id="line-120"></span><span class="hs-comment">--  multiplicative structure:</span><span>
</span><span id="line-121"></span><span class="hs-comment">--</span><span>
</span><span id="line-122"></span><span class="hs-comment">-- &gt;&gt;&gt; abg 12</span><span>
</span><span id="line-123"></span><span class="hs-comment">-- AbGroup[Z/12]</span><span>
</span><span id="line-124"></span><span class="hs-comment">--</span><span>
</span><span id="line-125"></span><span class="hs-comment">-- represents the cyclic group @'Z'/12@.</span><span>
</span><span id="line-126"></span><span class="hs-comment">--</span><span>
</span><span id="line-127"></span><span class="hs-comment">-- &gt;&gt;&gt; abg 2 * abg 3</span><span>
</span><span id="line-128"></span><span class="hs-comment">-- AbGroup[Z/2*Z/3]</span><span>
</span><span id="line-129"></span><span class="hs-comment">--</span><span>
</span><span id="line-130"></span><span class="hs-comment">-- represents the cartesian product of the groups @'Z'\/2@ and @'Z'\/3@.</span><span>
</span><span id="line-131"></span><span class="hs-comment">--</span><span>
</span><span id="line-132"></span><span class="hs-comment">-- &gt;&gt;&gt; abg 6 * abg 4 * abg 4</span><span>
</span><span id="line-133"></span><span class="hs-comment">-- AbGroup[Z/6*Z/4^2]</span><span>
</span><span id="line-134"></span><span class="hs-comment">--</span><span>
</span><span id="line-135"></span><span class="hs-comment">-- represents the cartesian product of the groups @'Z'\/6@, @'Z'\/4@  and @'Z'\/4@.</span><span>
</span><span id="line-136"></span><span class="hs-comment">--</span><span>
</span><span id="line-137"></span><span class="hs-comment">-- &gt;&gt;&gt; abg 0 ^ 6</span><span>
</span><span id="line-138"></span><span class="hs-comment">-- AbGroup[Z^6]</span><span>
</span><span id="line-139"></span><span class="hs-comment">-- </span><span>
</span><span id="line-140"></span><span class="hs-comment">-- represents the free abelian group  @'Z' '^' 6@ of /dimension/ 6.</span><span>
</span><span id="line-141"></span><span class="hs-comment">--</span><span>
</span><span id="line-142"></span><span class="hs-comment">-- &gt;&gt;&gt; one () :: AbGroup</span><span>
</span><span id="line-143"></span><span class="hs-comment">-- AbGroup[]</span><span>
</span><span id="line-144"></span><span class="hs-comment">--</span><span>
</span><span id="line-145"></span><span class="hs-comment">-- represents the cartesian product of zero cyclic groups and</span><span>
</span><span id="line-146"></span><span class="hs-comment">--</span><span>
</span><span id="line-147"></span><span class="hs-comment">-- &gt;&gt;&gt; one () * abg 4 * abg 6 == abg 4 * abg 6</span><span>
</span><span id="line-148"></span><span class="hs-comment">-- True</span><span>
</span><span id="line-149"></span><span class="hs-comment">--</span><span>
</span><span id="line-150"></span><span class="hs-comment">--</span><span>
</span><span id="line-151"></span><span class="hs-comment">-- __Examples__ Checking for smith normal via 'isSmithNormal':</span><span>
</span><span id="line-152"></span><span class="hs-comment">--</span><span>
</span><span id="line-153"></span><span class="hs-comment">-- &gt;&gt;&gt; isSmithNormal (abg 4)</span><span>
</span><span id="line-154"></span><span class="hs-comment">-- True</span><span>
</span><span id="line-155"></span><span class="hs-comment">--</span><span>
</span><span id="line-156"></span><span class="hs-comment">-- &gt;&gt;&gt; isSmithNormal (abg 2 * abg 2)</span><span>
</span><span id="line-157"></span><span class="hs-comment">-- True</span><span>
</span><span id="line-158"></span><span class="hs-comment">--</span><span>
</span><span id="line-159"></span><span class="hs-comment">-- &gt;&gt;&gt; isSmithNormal (abg 17 * abg 51)</span><span>
</span><span id="line-160"></span><span class="hs-comment">-- True</span><span>
</span><span id="line-161"></span><span class="hs-comment">--</span><span>
</span><span id="line-162"></span><span class="hs-comment">-- &gt;&gt;&gt; isSmithNormal (abg 2 * abg 4 * abg 0 ^ 3)</span><span>
</span><span id="line-163"></span><span class="hs-comment">-- True</span><span>
</span><span id="line-164"></span><span class="hs-comment">--</span><span>
</span><span id="line-165"></span><span class="hs-comment">-- &gt;&gt;&gt; isSmithNormal (abg 5 * abg 3)</span><span>
</span><span id="line-166"></span><span class="hs-comment">-- False</span><span>
</span><span id="line-167"></span><span class="hs-comment">--</span><span>
</span><span id="line-168"></span><span class="hs-comment">-- &gt;&gt;&gt; isSmithNormal (abg 0 * abg 3 * abg 6)</span><span>
</span><span id="line-169"></span><span class="hs-comment">-- False</span><span>
</span><span id="line-170"></span><span class="hs-comment">--</span><span>
</span><span id="line-171"></span><span class="hs-comment">-- &gt;&gt;&gt; isSmithNormal (abg 1 * abg 4)</span><span>
</span><span id="line-172"></span><span class="hs-comment">-- False</span><span>
</span><span id="line-173"></span><span class="hs-comment">--</span><span>
</span><span id="line-174"></span><span class="hs-comment">-- &gt;&gt;&gt; isSmithNormal (one ())</span><span>
</span><span id="line-175"></span><span class="hs-comment">-- True</span><span>
</span><span id="line-176"></span><span class="hs-comment">--</span><span>
</span><span id="line-177"></span><span class="hs-comment">-- __Examples__ The associated isomorphism in 'AbHom' of a finitely generated abelian group</span><span>
</span><span id="line-178"></span><span class="hs-comment">-- given by 'OAlg.AbelianGroup.KernelsAndCokernels.isoSmithNormal'.</span><span>
</span><span id="line-179"></span><span class="hs-comment">--</span><span>
</span><span id="line-180"></span><span class="hs-comment">-- &gt;&gt;&gt; end (isoSmithNormal (abg 3 * abg 5))</span><span>
</span><span id="line-181"></span><span class="hs-comment">-- AbGroup[Z/15]</span><span>
</span><span id="line-182"></span><span class="hs-comment">--</span><span>
</span><span id="line-183"></span><span class="hs-comment">-- &gt;&gt;&gt; end (isoSmithNormal (abg 2 * abg 4 * abg 2))</span><span>
</span><span id="line-184"></span><span class="hs-comment">-- AbGroup[Z/2^2*Z/4]</span><span>
</span><span id="line-185"></span><span class="hs-comment">--</span><span>
</span><span id="line-186"></span><span class="hs-comment">-- &gt;&gt;&gt; end (isoSmithNormal (abg 4 * abg 6))</span><span>
</span><span id="line-187"></span><span class="hs-comment">-- AbGroup[Z/2*Z/12]</span><span>
</span><span id="line-188"></span><span class="hs-comment">--</span><span>
</span><span id="line-189"></span><span class="hs-comment">-- &gt;&gt;&gt; end (isoSmithNormal (abg 1))</span><span>
</span><span id="line-190"></span><span class="hs-comment">-- AbGroup[]</span><span>
</span><span id="line-191"></span><span class="hs-keyword">newtype</span><span> </span><span id="AbGroup"><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbGroup"><span class="hs-identifier hs-var">AbGroup</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="AbGroup"><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbGroup"><span class="hs-identifier hs-var">AbGroup</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ProductSymbol</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.ZMod.html#ZMod"><span class="hs-identifier hs-type">ZMod</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-192"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679086507"><span id="local-6989586621679086512"><span class="annot"><span class="annottext">AbGroup -&gt; AbGroup -&gt; Bool
(AbGroup -&gt; AbGroup -&gt; Bool)
-&gt; (AbGroup -&gt; AbGroup -&gt; Bool) -&gt; Eq AbGroup
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: AbGroup -&gt; AbGroup -&gt; Bool
== :: AbGroup -&gt; AbGroup -&gt; Bool
$c/= :: AbGroup -&gt; AbGroup -&gt; Bool
/= :: AbGroup -&gt; AbGroup -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679086520"><span id="local-6989586621679086525"><span id="local-6989586621679086529"><span id="local-6989586621679086533"><span id="local-6989586621679086537"><span id="local-6989586621679086541"><span id="local-6989586621679086545"><span class="annot"><span class="annottext">Eq AbGroup
Eq AbGroup
-&gt; (AbGroup -&gt; AbGroup -&gt; Ordering)
-&gt; (AbGroup -&gt; AbGroup -&gt; Bool)
-&gt; (AbGroup -&gt; AbGroup -&gt; Bool)
-&gt; (AbGroup -&gt; AbGroup -&gt; Bool)
-&gt; (AbGroup -&gt; AbGroup -&gt; Bool)
-&gt; (AbGroup -&gt; AbGroup -&gt; AbGroup)
-&gt; (AbGroup -&gt; AbGroup -&gt; AbGroup)
-&gt; Ord AbGroup
AbGroup -&gt; AbGroup -&gt; Bool
AbGroup -&gt; AbGroup -&gt; Ordering
AbGroup -&gt; AbGroup -&gt; AbGroup
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
$ccompare :: AbGroup -&gt; AbGroup -&gt; Ordering
compare :: AbGroup -&gt; AbGroup -&gt; Ordering
$c&lt; :: AbGroup -&gt; AbGroup -&gt; Bool
&lt; :: AbGroup -&gt; AbGroup -&gt; Bool
$c&lt;= :: AbGroup -&gt; AbGroup -&gt; Bool
&lt;= :: AbGroup -&gt; AbGroup -&gt; Bool
$c&gt; :: AbGroup -&gt; AbGroup -&gt; Bool
&gt; :: AbGroup -&gt; AbGroup -&gt; Bool
$c&gt;= :: AbGroup -&gt; AbGroup -&gt; Bool
&gt;= :: AbGroup -&gt; AbGroup -&gt; Bool
$cmax :: AbGroup -&gt; AbGroup -&gt; AbGroup
max :: AbGroup -&gt; AbGroup -&gt; AbGroup
$cmin :: AbGroup -&gt; AbGroup -&gt; AbGroup
min :: AbGroup -&gt; AbGroup -&gt; AbGroup
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679086551"><span class="annot"><span class="annottext">AbGroup -&gt; N
(AbGroup -&gt; N) -&gt; LengthN AbGroup
forall x. (x -&gt; N) -&gt; LengthN x
$clengthN :: AbGroup -&gt; N
lengthN :: AbGroup -&gt; N
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">LengthN</span></span></span><span class="hs-special">,</span><span id="local-6989586621679086557"><span class="annot"><span class="annottext">AbGroup -&gt; Statement
(AbGroup -&gt; Statement) -&gt; Validable AbGroup
forall a. (a -&gt; Statement) -&gt; Validable a
$cvalid :: AbGroup -&gt; Statement
valid :: AbGroup -&gt; Statement
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Validable</span></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Eq AbGroup
Show AbGroup
Typeable AbGroup
Validable AbGroup
Show AbGroup
-&gt; Eq AbGroup
-&gt; Validable AbGroup
-&gt; Typeable AbGroup
-&gt; Entity AbGroup
forall a. Show a -&gt; Eq a -&gt; Validable a -&gt; Typeable a -&gt; Entity a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Entity</span></span><span class="hs-special">,</span><span id="local-6989586621679086578"><span id="local-6989586621679086584"><span id="local-6989586621679086588"><span class="annot"><span class="annottext">Oriented AbGroup
Oriented AbGroup
-&gt; (Point AbGroup -&gt; AbGroup)
-&gt; (AbGroup -&gt; AbGroup -&gt; AbGroup)
-&gt; (AbGroup -&gt; N -&gt; AbGroup)
-&gt; Multiplicative AbGroup
Point AbGroup -&gt; AbGroup
AbGroup -&gt; N -&gt; AbGroup
AbGroup -&gt; AbGroup -&gt; AbGroup
forall c.
Oriented c
-&gt; (Point c -&gt; c)
-&gt; (c -&gt; c -&gt; c)
-&gt; (c -&gt; N -&gt; c)
-&gt; Multiplicative c
$cone :: Point AbGroup -&gt; AbGroup
one :: Point AbGroup -&gt; AbGroup
$c* :: AbGroup -&gt; AbGroup -&gt; AbGroup
* :: AbGroup -&gt; AbGroup -&gt; AbGroup
$cnpower :: AbGroup -&gt; N -&gt; AbGroup
npower :: AbGroup -&gt; N -&gt; AbGroup
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Multiplicative</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-193"></span><span>
</span><span id="line-194"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679086594"><span id="local-6989586621679086598"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbGroup"><span class="hs-identifier hs-type">AbGroup</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-195"></span><span>  </span><span id="local-6989586621679086602"><span class="annot"><span class="annottext">show :: AbGroup -&gt; String
</span><a href="#local-6989586621679086602"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbGroup"><span class="hs-identifier hs-type">AbGroup</span></a></span><span> </span><span id="local-6989586621679086604"><span class="annot"><span class="annottext">ProductSymbol ZMod
</span><a href="#local-6989586621679086604"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;AbGroup[&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ProductSymbol ZMod -&gt; String
forall x. Entity x =&gt; ProductSymbol x -&gt; String
</span><span class="hs-identifier hs-var">psyShow</span></span><span> </span><span class="annot"><span class="annottext">ProductSymbol ZMod
</span><a href="#local-6989586621679086604"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;]&quot;</span></span><span>
</span><span id="line-196"></span><span>    </span><span>
</span><span id="line-197"></span><span>
</span><span id="line-198"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679086613"><span id="local-6989586621679086616"><span class="annot"><span class="hs-identifier hs-type">Oriented</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbGroup"><span class="hs-identifier hs-type">AbGroup</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-199"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Point"><span class="annot"><span class="hs-identifier hs-var">Point</span></span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbGroup"><span class="hs-identifier hs-type">AbGroup</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-200"></span><span>  </span><span id="local-6989586621679086622"><span class="annot"><span class="annottext">orientation :: AbGroup -&gt; Orientation (Point AbGroup)
</span><a href="#local-6989586621679086622"><span class="hs-identifier hs-var hs-var hs-var hs-var">orientation</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbGroup"><span class="hs-identifier hs-type">AbGroup</span></a></span><span> </span><span id="local-6989586621679086624"><span class="annot"><span class="annottext">ProductSymbol ZMod
</span><a href="#local-6989586621679086624"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProductSymbol ZMod -&gt; Orientation (Point (ProductSymbol ZMod))
forall q. Oriented q =&gt; q -&gt; Orientation (Point q)
</span><span class="hs-identifier hs-var">orientation</span></span><span> </span><span class="annot"><span class="annottext">ProductSymbol ZMod
</span><a href="#local-6989586621679086624"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-201"></span><span>
</span><span id="line-202"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exponential</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbGroup"><span class="hs-identifier hs-type">AbGroup</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-203"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Exponent"><span class="annot"><span class="hs-identifier hs-var">Exponent</span></span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbGroup"><span class="hs-identifier hs-type">AbGroup</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">N</span></span><span>
</span><span id="line-204"></span><span>  </span><span id="local-6989586621679086634"><span class="annot"><span class="annottext">^ :: AbGroup -&gt; Exponent AbGroup -&gt; AbGroup
</span><span class="hs-operator hs-var hs-var hs-var hs-var">(^)</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AbGroup -&gt; N -&gt; AbGroup
AbGroup -&gt; Exponent AbGroup -&gt; AbGroup
forall c. Multiplicative c =&gt; c -&gt; N -&gt; c
</span><span class="hs-identifier hs-var">npower</span></span><span>
</span><span id="line-205"></span><span>
</span><span id="line-206"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-207"></span><span class="hs-comment">-- abg -</span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span><span class="annot"><span class="hs-comment">-- | the cyclic group of the given order as a finitely generated abelian group.</span></span><span>
</span><span id="line-210"></span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#abg"><span class="hs-identifier hs-type">abg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">N</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbGroup"><span class="hs-identifier hs-type">AbGroup</span></a></span><span>
</span><span id="line-211"></span><span id="abg"><span class="annot"><span class="annottext">abg :: N -&gt; AbGroup
</span><a href="OAlg.AbelianGroup.Definition.html#abg"><span class="hs-identifier hs-var hs-var">abg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProductSymbol ZMod -&gt; AbGroup
</span><a href="OAlg.AbelianGroup.Definition.html#AbGroup"><span class="hs-identifier hs-var">AbGroup</span></a></span><span> </span><span class="annot"><span class="annottext">(ProductSymbol ZMod -&gt; AbGroup)
-&gt; (N -&gt; ProductSymbol ZMod) -&gt; N -&gt; AbGroup
forall y z x. (y -&gt; z) -&gt; (x -&gt; y) -&gt; x -&gt; z
forall (c :: * -&gt; * -&gt; *) y z x.
Category c =&gt;
c y z -&gt; c x y -&gt; c x z
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ZMod -&gt; ProductSymbol ZMod
forall x. Entity x =&gt; x -&gt; ProductSymbol x
</span><span class="hs-identifier hs-var">sy</span></span><span> </span><span class="annot"><span class="annottext">(ZMod -&gt; ProductSymbol ZMod)
-&gt; (N -&gt; ZMod) -&gt; N -&gt; ProductSymbol ZMod
forall y z x. (y -&gt; z) -&gt; (x -&gt; y) -&gt; x -&gt; z
forall (c :: * -&gt; * -&gt; *) y z x.
Category c =&gt;
c y z -&gt; c x y -&gt; c x z
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">N -&gt; ZMod
</span><a href="OAlg.AbelianGroup.ZMod.html#ZMod"><span class="hs-identifier hs-var">ZMod</span></a></span><span>
</span><span id="line-212"></span><span>
</span><span id="line-213"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-214"></span><span class="hs-comment">-- abgxs -</span><span>
</span><span id="line-215"></span><span>
</span><span id="line-216"></span><span class="annot"><span class="hs-comment">-- | the indexed listing of the 'ZMod's.</span></span><span>
</span><span id="line-217"></span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#abgxs"><span class="hs-identifier hs-type">abgxs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbGroup"><span class="hs-identifier hs-type">AbGroup</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="OAlg.AbelianGroup.ZMod.html#ZMod"><span class="hs-identifier hs-type">ZMod</span></a></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">N</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-218"></span><span id="abgxs"><span class="annot"><span class="annottext">abgxs :: AbGroup -&gt; [(ZMod, N)]
</span><a href="OAlg.AbelianGroup.Definition.html#abgxs"><span class="hs-identifier hs-var hs-var">abgxs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbGroup"><span class="hs-identifier hs-type">AbGroup</span></a></span><span> </span><span id="local-6989586621679086639"><span class="annot"><span class="annottext">ProductSymbol ZMod
</span><a href="#local-6989586621679086639"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProductSymbol ZMod -&gt; [(ZMod, N)]
forall x. ProductSymbol x -&gt; [(x, N)]
</span><span class="hs-identifier hs-var">psyxs</span></span><span> </span><span class="annot"><span class="annottext">ProductSymbol ZMod
</span><a href="#local-6989586621679086639"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-219"></span><span>
</span><span id="line-220"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-221"></span><span class="hs-comment">-- isSmithNormal -</span><span>
</span><span id="line-222"></span><span>
</span><span id="line-223"></span><span class="annot"><span class="hs-comment">-- | checks if the given group is smith normal (see definition 'AbGroup').</span></span><span>
</span><span id="line-224"></span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#isSmithNormal"><span class="hs-identifier hs-type">isSmithNormal</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbGroup"><span class="hs-identifier hs-type">AbGroup</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-225"></span><span id="isSmithNormal"><span class="annot"><span class="annottext">isSmithNormal :: AbGroup -&gt; Bool
</span><a href="OAlg.AbelianGroup.Definition.html#isSmithNormal"><span class="hs-identifier hs-var hs-var">isSmithNormal</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbGroup"><span class="hs-identifier hs-type">AbGroup</span></a></span><span> </span><span id="local-6989586621679086641"><span class="annot"><span class="annottext">ProductSymbol ZMod
</span><a href="#local-6989586621679086641"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ZMod] -&gt; Bool
</span><a href="#local-6989586621679086642"><span class="hs-identifier hs-var">sn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((ZMod, N) -&gt; ZMod) -&gt; [(ZMod, N)] -&gt; [ZMod]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
forall (h :: * -&gt; * -&gt; *) (f :: * -&gt; *) a b.
Applicative1 h f =&gt;
h a b -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">amap1</span></span><span> </span><span class="annot"><span class="annottext">(ZMod, N) -&gt; ZMod
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">[(ZMod, N)]
</span><a href="#local-6989586621679086645"><span class="hs-identifier hs-var">ws</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-226"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Word</span></span><span> </span><span id="local-6989586621679086645"><span class="annot"><span class="annottext">[(ZMod, N)]
</span><a href="#local-6989586621679086645"><span class="hs-identifier hs-var">ws</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProductSymbol ZMod -&gt; Word N ZMod
forall x. Entity x =&gt; ProductSymbol x -&gt; Word N x
</span><span class="hs-identifier hs-var">psywrd</span></span><span> </span><span class="annot"><span class="annottext">ProductSymbol ZMod
</span><a href="#local-6989586621679086641"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-227"></span><span>
</span><span id="line-228"></span><span>  </span><span id="local-6989586621679086642"><span class="annot"><span class="annottext">sn :: [ZMod] -&gt; Bool
</span><a href="#local-6989586621679086642"><span class="hs-identifier hs-var hs-var">sn</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="OAlg.AbelianGroup.ZMod.html#ZMod"><span class="hs-identifier hs-type">ZMod</span></a></span><span> </span><span id="local-6989586621679086668"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679086668"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span class="annot"><a href="OAlg.AbelianGroup.ZMod.html#ZMod"><span class="hs-identifier hs-type">ZMod</span></a></span><span> </span><span id="local-6989586621679086669"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679086669"><span class="hs-identifier hs-var">n'</span></a></span></span><span class="hs-special">]</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; Bool
forall b. Boolean b =&gt; [b] -&gt; b
</span><span class="hs-identifier hs-var">and</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">N
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679086668"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679086669"><span class="hs-identifier hs-var">n'</span></a></span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
forall b. Boolean b =&gt; b -&gt; b -&gt; b
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679086669"><span class="hs-identifier hs-var">n'</span></a></span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; N
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mod`</span></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679086668"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-229"></span><span>  </span><span class="annot"><a href="#local-6989586621679086642"><span class="hs-identifier hs-var">sn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.AbelianGroup.ZMod.html#ZMod"><span class="hs-identifier hs-type">ZMod</span></a></span><span> </span><span id="local-6989586621679086672"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679086672"><span class="hs-identifier hs-var">n</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><a href="OAlg.AbelianGroup.ZMod.html#ZMod"><span class="hs-identifier hs-type">ZMod</span></a></span><span> </span><span id="local-6989586621679086673"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679086673"><span class="hs-identifier hs-var">n'</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679086674"><span class="annot"><span class="annottext">[ZMod]
</span><a href="#local-6989586621679086674"><span class="hs-identifier hs-var">ws</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; Bool
forall b. Boolean b =&gt; [b] -&gt; b
</span><span class="hs-identifier hs-var">and</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">N
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679086672"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679086673"><span class="hs-identifier hs-var">n'</span></a></span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; N
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mod`</span></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679086672"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[ZMod] -&gt; Bool
</span><a href="#local-6989586621679086642"><span class="hs-identifier hs-var">sn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">N -&gt; ZMod
</span><a href="OAlg.AbelianGroup.ZMod.html#ZMod"><span class="hs-identifier hs-var">ZMod</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679086673"><span class="hs-identifier hs-var">n'</span></a></span><span class="annot"><span class="annottext">ZMod -&gt; [ZMod] -&gt; [ZMod]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[ZMod]
</span><a href="#local-6989586621679086674"><span class="hs-identifier hs-var">ws</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-230"></span><span>  </span><span class="annot"><a href="#local-6989586621679086642"><span class="hs-identifier hs-var">sn</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="OAlg.AbelianGroup.ZMod.html#ZMod"><span class="hs-identifier hs-type">ZMod</span></a></span><span> </span><span id="local-6989586621679086675"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679086675"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">]</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">N
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679086675"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
forall b. Boolean b =&gt; b -&gt; b -&gt; b
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679086675"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-231"></span><span>  </span><span class="annot"><a href="#local-6989586621679086642"><span class="hs-identifier hs-var">sn</span></a></span><span> </span><span class="annot"><span class="annottext">[ZMod]
</span><span class="hs-identifier">_</span></span><span>                   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-232"></span><span>
</span><span id="line-233"></span><span>
</span><span id="line-234"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-235"></span><span class="hs-comment">-- AbHom -</span><span>
</span><span id="line-236"></span><span>
</span><span id="line-237"></span><span class="hs-comment">-- | additive homomorphism between finitely generated abelian groups which are</span><span>
</span><span id="line-238"></span><span class="hs-comment">-- represented by matrices over 'ZModHom'.</span><span>
</span><span id="line-239"></span><span class="hs-keyword">newtype</span><span> </span><span id="AbHom"><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-var">AbHom</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="AbHom"><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-var">AbHom</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Matrix</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.ZMod.html#ZModHom"><span class="hs-identifier hs-type">ZModHom</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-240"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679086677"><span id="local-6989586621679086683"><span id="local-6989586621679086687"><span class="annot"><span class="annottext">Int -&gt; AbHom -&gt; ShowS
[AbHom] -&gt; ShowS
AbHom -&gt; String
(Int -&gt; AbHom -&gt; ShowS)
-&gt; (AbHom -&gt; String) -&gt; ([AbHom] -&gt; ShowS) -&gt; Show AbHom
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; AbHom -&gt; ShowS
showsPrec :: Int -&gt; AbHom -&gt; ShowS
$cshow :: AbHom -&gt; String
show :: AbHom -&gt; String
$cshowList :: [AbHom] -&gt; ShowS
showList :: [AbHom] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679086690"><span id="local-6989586621679086695"><span class="annot"><span class="annottext">AbHom -&gt; AbHom -&gt; Bool
(AbHom -&gt; AbHom -&gt; Bool) -&gt; (AbHom -&gt; AbHom -&gt; Bool) -&gt; Eq AbHom
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: AbHom -&gt; AbHom -&gt; Bool
== :: AbHom -&gt; AbHom -&gt; Bool
$c/= :: AbHom -&gt; AbHom -&gt; Bool
/= :: AbHom -&gt; AbHom -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679086700"><span class="annot"><span class="annottext">AbHom -&gt; Statement
(AbHom -&gt; Statement) -&gt; Validable AbHom
forall a. (a -&gt; Statement) -&gt; Validable a
$cvalid :: AbHom -&gt; Statement
valid :: AbHom -&gt; Statement
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Validable</span></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Eq AbHom
Show AbHom
Typeable AbHom
Validable AbHom
Show AbHom
-&gt; Eq AbHom -&gt; Validable AbHom -&gt; Typeable AbHom -&gt; Entity AbHom
forall a. Show a -&gt; Eq a -&gt; Validable a -&gt; Typeable a -&gt; Entity a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Entity</span></span><span class="hs-special">)</span><span>
</span><span id="line-241"></span><span>
</span><span id="line-242"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-243"></span><span class="hs-comment">-- abgDim -</span><span>
</span><span id="line-244"></span><span>
</span><span id="line-245"></span><span class="annot"><span class="hs-comment">-- | the associated dimension for matrices of 'ZModHom'.</span></span><span>
</span><span id="line-246"></span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#abgDim"><span class="hs-identifier hs-type">abgDim</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbGroup"><span class="hs-identifier hs-type">AbGroup</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dim'</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.ZMod.html#ZModHom"><span class="hs-identifier hs-type">ZModHom</span></a></span><span>
</span><span id="line-247"></span><span id="abgDim"><span class="annot"><span class="annottext">abgDim :: AbGroup -&gt; Dim' ZModHom
</span><a href="OAlg.AbelianGroup.Definition.html#abgDim"><span class="hs-identifier hs-var hs-var">abgDim</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbGroup"><span class="hs-identifier hs-type">AbGroup</span></a></span><span> </span><span id="local-6989586621679086714"><span class="annot"><span class="annottext">ProductSymbol ZMod
</span><a href="#local-6989586621679086714"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CSequence (Point ZModHom) -&gt; Dim' ZModHom
forall x. CSequence (Point x) -&gt; Dim x (Point x)
</span><span class="hs-identifier hs-var">Dim</span></span><span> </span><span class="annot"><span class="annottext">CSequence (Point ZModHom)
ProductSymbol ZMod
</span><a href="#local-6989586621679086714"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-248"></span><span>
</span><span id="line-249"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-250"></span><span class="hs-comment">-- abhz -</span><span>
</span><span id="line-251"></span><span>
</span><span id="line-252"></span><span class="annot"><span class="hs-comment">-- | the underlying 'Z'-matrix.</span></span><span>
</span><span id="line-253"></span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#abhz"><span class="hs-identifier hs-type">abhz</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Matrix</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Z</span></span><span>
</span><span id="line-254"></span><span id="abhz"><span class="annot"><span class="annottext">abhz :: AbHom -&gt; Matrix Z
</span><a href="OAlg.AbelianGroup.Definition.html#abhz"><span class="hs-identifier hs-var hs-var">abhz</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Matrix</span></span><span> </span><span id="local-6989586621679086717"><span class="annot"><span class="annottext">Dim' ZModHom
</span><a href="#local-6989586621679086717"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679086718"><span class="annot"><span class="annottext">Dim' ZModHom
</span><a href="#local-6989586621679086718"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679086719"><span class="annot"><span class="annottext">Entries N N ZModHom
</span><a href="#local-6989586621679086719"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dim' Z -&gt; Dim' Z -&gt; Entries N N Z -&gt; Matrix Z
forall x. Dim' x -&gt; Dim' x -&gt; Entries N N x -&gt; Matrix x
</span><span class="hs-identifier hs-var">Matrix</span></span><span> </span><span class="annot"><span class="annottext">Dim Z ()
Dim' Z
</span><a href="#local-6989586621679086720"><span class="hs-identifier hs-var">r'</span></a></span><span> </span><span class="annot"><span class="annottext">Dim Z ()
Dim' Z
</span><a href="#local-6989586621679086721"><span class="hs-identifier hs-var">c'</span></a></span><span> </span><span class="annot"><span class="annottext">Entries N N Z
</span><a href="#local-6989586621679086722"><span class="hs-identifier hs-var">xs'</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-255"></span><span>  </span><span id="local-6989586621679086725"><span class="annot"><span class="annottext">u :: Dim Z ()
</span><a href="#local-6989586621679086725"><span class="hs-identifier hs-var hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; Dim Z ()
forall p x. (Entity p, p ~ Point x) =&gt; p -&gt; Dim x p
</span><span class="hs-identifier hs-var">dim</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-256"></span><span>  </span><span id="local-6989586621679086720"><span class="annot"><span class="annottext">r' :: Dim Z ()
</span><a href="#local-6989586621679086720"><span class="hs-identifier hs-var hs-var">r'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dim Z ()
</span><a href="#local-6989586621679086725"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">Dim Z () -&gt; Exponent (Dim Z ()) -&gt; Dim Z ()
forall f. Exponential f =&gt; f -&gt; Exponent f -&gt; f
</span><span class="hs-operator hs-var">^</span></span><span> </span><span class="annot"><span class="annottext">Dim ZModHom ZMod -&gt; N
forall x. LengthN x =&gt; x -&gt; N
</span><span class="hs-identifier hs-var">lengthN</span></span><span> </span><span class="annot"><span class="annottext">Dim' ZModHom
Dim ZModHom ZMod
</span><a href="#local-6989586621679086717"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-257"></span><span>  </span><span id="local-6989586621679086721"><span class="annot"><span class="annottext">c' :: Dim Z ()
</span><a href="#local-6989586621679086721"><span class="hs-identifier hs-var hs-var">c'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dim Z ()
</span><a href="#local-6989586621679086725"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">Dim Z () -&gt; Exponent (Dim Z ()) -&gt; Dim Z ()
forall f. Exponential f =&gt; f -&gt; Exponent f -&gt; f
</span><span class="hs-operator hs-var">^</span></span><span> </span><span class="annot"><span class="annottext">Dim ZModHom ZMod -&gt; N
forall x. LengthN x =&gt; x -&gt; N
</span><span class="hs-identifier hs-var">lengthN</span></span><span> </span><span class="annot"><span class="annottext">Dim' ZModHom
Dim ZModHom ZMod
</span><a href="#local-6989586621679086718"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-258"></span><span>
</span><span id="line-259"></span><span>  </span><span id="local-6989586621679086722"><span class="annot"><span class="annottext">xs' :: Entries N N Z
</span><a href="#local-6989586621679086722"><span class="hs-identifier hs-var hs-var">xs'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ZModHom -&gt; Z) -&gt; Entries N N ZModHom -&gt; Entries N N Z
forall a b. (a -&gt; b) -&gt; Entries N N a -&gt; Entries N N b
forall (h :: * -&gt; * -&gt; *) (f :: * -&gt; *) a b.
Applicative1 h f =&gt;
h a b -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">amap1</span></span><span> </span><span class="annot"><span class="annottext">ZModHom -&gt; Z
</span><a href="OAlg.AbelianGroup.ZMod.html#toZ"><span class="hs-identifier hs-var">toZ</span></a></span><span> </span><span class="annot"><span class="annottext">Entries N N ZModHom
</span><a href="#local-6989586621679086719"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-260"></span><span>
</span><span id="line-261"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-262"></span><span class="hs-comment">-- zabh -</span><span>
</span><span id="line-263"></span><span>
</span><span id="line-264"></span><span class="hs-comment">-- | the associated homomorphism between products of @'abg' 0@ given by the column</span><span>
</span><span id="line-265"></span><span class="hs-comment">-- - respectively row - length.</span><span>
</span><span id="line-266"></span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#zabh"><span class="hs-identifier hs-type">zabh</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Matrix</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Z</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span><span>
</span><span id="line-267"></span><span id="zabh"><span class="annot"><span class="annottext">zabh :: Matrix Z -&gt; AbHom
</span><a href="OAlg.AbelianGroup.Definition.html#zabh"><span class="hs-identifier hs-var hs-var">zabh</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Matrix</span></span><span> </span><span id="local-6989586621679086729"><span class="annot"><span class="annottext">Dim' Z
</span><a href="#local-6989586621679086729"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679086730"><span class="annot"><span class="annottext">Dim' Z
</span><a href="#local-6989586621679086730"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679086731"><span class="annot"><span class="annottext">Entries N N Z
</span><a href="#local-6989586621679086731"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix ZModHom -&gt; AbHom
</span><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-var">AbHom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dim' ZModHom
-&gt; Dim' ZModHom -&gt; Entries N N ZModHom -&gt; Matrix ZModHom
forall x. Dim' x -&gt; Dim' x -&gt; Entries N N x -&gt; Matrix x
</span><span class="hs-identifier hs-var">Matrix</span></span><span> </span><span class="annot"><span class="annottext">Dim' ZModHom
Dim ZModHom ZMod
</span><a href="#local-6989586621679086732"><span class="hs-identifier hs-var">r'</span></a></span><span> </span><span class="annot"><span class="annottext">Dim' ZModHom
Dim ZModHom ZMod
</span><a href="#local-6989586621679086733"><span class="hs-identifier hs-var">c'</span></a></span><span> </span><span class="annot"><span class="annottext">Entries N N ZModHom
</span><a href="#local-6989586621679086734"><span class="hs-identifier hs-var">xs'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-268"></span><span>  </span><span id="local-6989586621679086738"><span class="annot"><span class="annottext">u :: Dim ZModHom ZMod
</span><a href="#local-6989586621679086738"><span class="hs-identifier hs-var hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ZMod -&gt; Dim ZModHom ZMod
forall p x. (Entity p, p ~ Point x) =&gt; p -&gt; Dim x p
</span><span class="hs-identifier hs-var">dim</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">N -&gt; ZMod
</span><a href="OAlg.AbelianGroup.ZMod.html#ZMod"><span class="hs-identifier hs-var">ZMod</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-269"></span><span>  </span><span id="local-6989586621679086732"><span class="annot"><span class="annottext">r' :: Dim ZModHom ZMod
</span><a href="#local-6989586621679086732"><span class="hs-identifier hs-var hs-var">r'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dim ZModHom ZMod
</span><a href="#local-6989586621679086738"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">Dim ZModHom ZMod -&gt; Exponent (Dim ZModHom ZMod) -&gt; Dim ZModHom ZMod
forall f. Exponential f =&gt; f -&gt; Exponent f -&gt; f
</span><span class="hs-operator hs-var">^</span></span><span> </span><span class="annot"><span class="annottext">Dim Z () -&gt; N
forall x. LengthN x =&gt; x -&gt; N
</span><span class="hs-identifier hs-var">lengthN</span></span><span> </span><span class="annot"><span class="annottext">Dim Z ()
Dim' Z
</span><a href="#local-6989586621679086729"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-270"></span><span>  </span><span id="local-6989586621679086733"><span class="annot"><span class="annottext">c' :: Dim ZModHom ZMod
</span><a href="#local-6989586621679086733"><span class="hs-identifier hs-var hs-var">c'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dim ZModHom ZMod
</span><a href="#local-6989586621679086738"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">Dim ZModHom ZMod -&gt; Exponent (Dim ZModHom ZMod) -&gt; Dim ZModHom ZMod
forall f. Exponential f =&gt; f -&gt; Exponent f -&gt; f
</span><span class="hs-operator hs-var">^</span></span><span> </span><span class="annot"><span class="annottext">Dim Z () -&gt; N
forall x. LengthN x =&gt; x -&gt; N
</span><span class="hs-identifier hs-var">lengthN</span></span><span> </span><span class="annot"><span class="annottext">Dim Z ()
Dim' Z
</span><a href="#local-6989586621679086730"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-271"></span><span>
</span><span id="line-272"></span><span>  </span><span id="local-6989586621679086734"><span class="annot"><span class="annottext">xs' :: Entries N N ZModHom
</span><a href="#local-6989586621679086734"><span class="hs-identifier hs-var hs-var">xs'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Z -&gt; ZModHom) -&gt; Entries N N Z -&gt; Entries N N ZModHom
forall a b. (a -&gt; b) -&gt; Entries N N a -&gt; Entries N N b
forall (h :: * -&gt; * -&gt; *) (f :: * -&gt; *) a b.
Applicative1 h f =&gt;
h a b -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">amap1</span></span><span> </span><span class="annot"><span class="annottext">Z -&gt; ZModHom
</span><a href="OAlg.AbelianGroup.ZMod.html#fromZ"><span class="hs-identifier hs-var">fromZ</span></a></span><span> </span><span class="annot"><span class="annottext">Entries N N Z
</span><a href="#local-6989586621679086731"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-273"></span><span>
</span><span id="line-274"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-275"></span><span class="hs-comment">-- AbHom - Algebraic -</span><span>
</span><span id="line-276"></span><span>
</span><span id="line-277"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679086747"><span id="local-6989586621679086750"><span class="annot"><span class="hs-identifier hs-type">Oriented</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-278"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Point"><span class="annot"><span class="hs-identifier hs-var">Point</span></span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbGroup"><span class="hs-identifier hs-type">AbGroup</span></a></span><span>
</span><span id="line-279"></span><span>  </span><span id="local-6989586621679086753"><span class="annot"><span class="annottext">orientation :: AbHom -&gt; Orientation (Point AbHom)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">orientation</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span><span> </span><span id="local-6989586621679086754"><span class="annot"><span class="annottext">Matrix ZModHom
</span><a href="#local-6989586621679086754"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProductSymbol ZMod -&gt; AbGroup
</span><a href="OAlg.AbelianGroup.Definition.html#AbGroup"><span class="hs-identifier hs-var">AbGroup</span></a></span><span> </span><span class="annot"><span class="annottext">ProductSymbol ZMod
</span><a href="#local-6989586621679086755"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">AbGroup -&gt; AbGroup -&gt; Orientation AbGroup
forall p. p -&gt; p -&gt; Orientation p
</span><span class="hs-operator hs-var">:&gt;</span></span><span> </span><span class="annot"><span class="annottext">ProductSymbol ZMod -&gt; AbGroup
</span><a href="OAlg.AbelianGroup.Definition.html#AbGroup"><span class="hs-identifier hs-var">AbGroup</span></a></span><span> </span><span class="annot"><span class="annottext">ProductSymbol ZMod
</span><a href="#local-6989586621679086757"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-280"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Dim</span></span><span> </span><span id="local-6989586621679086755"><span class="annot"><span class="annottext">CSequence (Point ZModHom)
ProductSymbol ZMod
</span><a href="#local-6989586621679086755"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dim</span></span><span> </span><span id="local-6989586621679086757"><span class="annot"><span class="annottext">CSequence (Point ZModHom)
ProductSymbol ZMod
</span><a href="#local-6989586621679086757"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix ZModHom -&gt; Orientation (Point (Matrix ZModHom))
forall q. Oriented q =&gt; q -&gt; Orientation (Point q)
</span><span class="hs-identifier hs-var">orientation</span></span><span> </span><span class="annot"><span class="annottext">Matrix ZModHom
</span><a href="#local-6989586621679086754"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-281"></span><span>
</span><span id="line-282"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Multiplicative</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-283"></span><span>  </span><span id="local-6989586621679086768"><span class="annot"><span class="annottext">one :: Point AbHom -&gt; AbHom
</span><a href="#local-6989586621679086768"><span class="hs-identifier hs-var hs-var hs-var hs-var">one</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix ZModHom -&gt; AbHom
</span><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-var">AbHom</span></a></span><span> </span><span class="annot"><span class="annottext">(Matrix ZModHom -&gt; AbHom)
-&gt; (AbGroup -&gt; Matrix ZModHom) -&gt; AbGroup -&gt; AbHom
forall y z x. (y -&gt; z) -&gt; (x -&gt; y) -&gt; x -&gt; z
forall (c :: * -&gt; * -&gt; *) y z x.
Category c =&gt;
c y z -&gt; c x y -&gt; c x z
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Point (Matrix ZModHom) -&gt; Matrix ZModHom
Dim ZModHom ZMod -&gt; Matrix ZModHom
forall c. Multiplicative c =&gt; Point c -&gt; c
</span><span class="hs-identifier hs-var">one</span></span><span> </span><span class="annot"><span class="annottext">(Dim ZModHom ZMod -&gt; Matrix ZModHom)
-&gt; (AbGroup -&gt; Dim ZModHom ZMod) -&gt; AbGroup -&gt; Matrix ZModHom
forall y z x. (y -&gt; z) -&gt; (x -&gt; y) -&gt; x -&gt; z
forall (c :: * -&gt; * -&gt; *) y z x.
Category c =&gt;
c y z -&gt; c x y -&gt; c x z
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">AbGroup -&gt; Dim' ZModHom
AbGroup -&gt; Dim ZModHom ZMod
</span><a href="OAlg.AbelianGroup.Definition.html#abgDim"><span class="hs-identifier hs-var">abgDim</span></a></span><span>
</span><span id="line-284"></span><span>  </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span><span> </span><span id="local-6989586621679086771"><span class="annot"><span class="annottext">Matrix ZModHom
</span><a href="#local-6989586621679086771"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679086772"><span class="annot"><span class="annottext">* :: AbHom -&gt; AbHom -&gt; AbHom
</span><span class="hs-operator hs-var hs-var hs-var hs-var">*</span></span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span><span> </span><span id="local-6989586621679086773"><span class="annot"><span class="annottext">Matrix ZModHom
</span><a href="#local-6989586621679086773"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix ZModHom -&gt; AbHom
</span><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-var">AbHom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix ZModHom
</span><a href="#local-6989586621679086771"><span class="hs-identifier hs-var">f</span></a></span><span class="annot"><span class="annottext">Matrix ZModHom -&gt; Matrix ZModHom -&gt; Matrix ZModHom
forall c. Multiplicative c =&gt; c -&gt; c -&gt; c
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Matrix ZModHom
</span><a href="#local-6989586621679086773"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-285"></span><span>  </span><span id="local-6989586621679086775"><span class="annot"><span class="annottext">npower :: AbHom -&gt; N -&gt; AbHom
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">npower</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span><span> </span><span id="local-6989586621679086776"><span class="annot"><span class="annottext">Matrix ZModHom
</span><a href="#local-6989586621679086776"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679086777"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679086777"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix ZModHom -&gt; AbHom
</span><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-var">AbHom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix ZModHom -&gt; N -&gt; Matrix ZModHom
forall c. Multiplicative c =&gt; c -&gt; N -&gt; c
</span><span class="hs-identifier hs-var">npower</span></span><span> </span><span class="annot"><span class="annottext">Matrix ZModHom
</span><a href="#local-6989586621679086776"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679086777"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-286"></span><span>
</span><span id="line-287"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679086784"><span class="annot"><span class="hs-identifier hs-type">Fibred</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-288"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Root"><span class="annot"><span class="hs-identifier hs-var">Root</span></span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Orientation</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbGroup"><span class="hs-identifier hs-type">AbGroup</span></a></span><span>
</span><span id="line-289"></span><span>
</span><span id="line-290"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Additive</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-291"></span><span>  </span><span id="local-6989586621679086799"><span class="annot"><span class="annottext">zero :: Root AbHom -&gt; AbHom
</span><a href="#local-6989586621679086799"><span class="hs-identifier hs-var hs-var hs-var hs-var">zero</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679086801"><span class="annot"><span class="annottext">AbGroup
</span><a href="#local-6989586621679086801"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&gt;</span></span><span> </span><span id="local-6989586621679086802"><span class="annot"><span class="annottext">AbGroup
</span><a href="#local-6989586621679086802"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix ZModHom -&gt; AbHom
</span><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-var">AbHom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Root (Matrix ZModHom) -&gt; Matrix ZModHom
forall a. Additive a =&gt; Root a -&gt; a
</span><span class="hs-identifier hs-var">zero</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AbGroup -&gt; Dim' ZModHom
</span><a href="OAlg.AbelianGroup.Definition.html#abgDim"><span class="hs-identifier hs-var">abgDim</span></a></span><span> </span><span class="annot"><span class="annottext">AbGroup
</span><a href="#local-6989586621679086801"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Dim ZModHom ZMod
-&gt; Dim ZModHom ZMod -&gt; Orientation (Dim ZModHom ZMod)
forall p. p -&gt; p -&gt; Orientation p
</span><span class="hs-operator hs-var">:&gt;</span></span><span> </span><span class="annot"><span class="annottext">AbGroup -&gt; Dim' ZModHom
</span><a href="OAlg.AbelianGroup.Definition.html#abgDim"><span class="hs-identifier hs-var">abgDim</span></a></span><span> </span><span class="annot"><span class="annottext">AbGroup
</span><a href="#local-6989586621679086802"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-292"></span><span>  </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span><span> </span><span id="local-6989586621679086804"><span class="annot"><span class="annottext">Matrix ZModHom
</span><a href="#local-6989586621679086804"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679086805"><span class="annot"><span class="annottext">+ :: AbHom -&gt; AbHom -&gt; AbHom
</span><span class="hs-operator hs-var hs-var hs-var hs-var">+</span></span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span><span> </span><span id="local-6989586621679086806"><span class="annot"><span class="annottext">Matrix ZModHom
</span><a href="#local-6989586621679086806"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix ZModHom -&gt; AbHom
</span><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-var">AbHom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix ZModHom
</span><a href="#local-6989586621679086804"><span class="hs-identifier hs-var">a</span></a></span><span class="annot"><span class="annottext">Matrix ZModHom -&gt; Matrix ZModHom -&gt; Matrix ZModHom
forall a. Additive a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Matrix ZModHom
</span><a href="#local-6989586621679086806"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-293"></span><span>  </span><span id="local-6989586621679086808"><span class="annot"><span class="annottext">ntimes :: N -&gt; AbHom -&gt; AbHom
</span><a href="#local-6989586621679086808"><span class="hs-identifier hs-var hs-var hs-var hs-var">ntimes</span></a></span></span><span> </span><span id="local-6989586621679086810"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679086810"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span><span> </span><span id="local-6989586621679086811"><span class="annot"><span class="annottext">Matrix ZModHom
</span><a href="#local-6989586621679086811"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix ZModHom -&gt; AbHom
</span><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-var">AbHom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">N -&gt; Matrix ZModHom -&gt; Matrix ZModHom
forall a. Additive a =&gt; N -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">ntimes</span></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679086810"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix ZModHom
</span><a href="#local-6989586621679086811"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-294"></span><span>
</span><span id="line-295"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Abelian</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-296"></span><span>  </span><span id="local-6989586621679086822"><span class="annot"><span class="annottext">negate :: AbHom -&gt; AbHom
</span><a href="#local-6989586621679086822"><span class="hs-identifier hs-var hs-var hs-var hs-var">negate</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span><span> </span><span id="local-6989586621679086824"><span class="annot"><span class="annottext">Matrix ZModHom
</span><a href="#local-6989586621679086824"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix ZModHom -&gt; AbHom
</span><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-var">AbHom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix ZModHom -&gt; Matrix ZModHom
forall a. Abelian a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">negate</span></span><span> </span><span class="annot"><span class="annottext">Matrix ZModHom
</span><a href="#local-6989586621679086824"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-297"></span><span>  </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span><span> </span><span id="local-6989586621679086827"><span class="annot"><span class="annottext">Matrix ZModHom
</span><a href="#local-6989586621679086827"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679086828"><span class="annot"><span class="annottext">- :: AbHom -&gt; AbHom -&gt; AbHom
</span><a href="#local-6989586621679086828"><span class="hs-glyph hs-var hs-var hs-var hs-var">-</span></a></span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span><span> </span><span id="local-6989586621679086830"><span class="annot"><span class="annottext">Matrix ZModHom
</span><a href="#local-6989586621679086830"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix ZModHom -&gt; AbHom
</span><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-var">AbHom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix ZModHom
</span><a href="#local-6989586621679086827"><span class="hs-identifier hs-var">a</span></a></span><span class="annot"><span class="annottext">Matrix ZModHom -&gt; Matrix ZModHom -&gt; Matrix ZModHom
forall a. Abelian a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Matrix ZModHom
</span><a href="#local-6989586621679086830"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-298"></span><span>  </span><span id="local-6989586621679086833"><span class="annot"><span class="annottext">ztimes :: Z -&gt; AbHom -&gt; AbHom
</span><a href="#local-6989586621679086833"><span class="hs-identifier hs-var hs-var hs-var hs-var">ztimes</span></a></span></span><span> </span><span id="local-6989586621679086835"><span class="annot"><span class="annottext">Z
</span><a href="#local-6989586621679086835"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span><span> </span><span id="local-6989586621679086836"><span class="annot"><span class="annottext">Matrix ZModHom
</span><a href="#local-6989586621679086836"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix ZModHom -&gt; AbHom
</span><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-var">AbHom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Z -&gt; Matrix ZModHom -&gt; Matrix ZModHom
forall a. Abelian a =&gt; Z -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">ztimes</span></span><span> </span><span class="annot"><span class="annottext">Z
</span><a href="#local-6989586621679086835"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix ZModHom
</span><a href="#local-6989586621679086836"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-299"></span><span>  </span><span>
</span><span id="line-300"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Vectorial</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-301"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Scalar"><span class="annot"><span class="hs-identifier hs-var">Scalar</span></span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Z</span></span><span>
</span><span id="line-302"></span><span>  </span><span id="local-6989586621679086852"><span class="annot"><span class="annottext">! :: Scalar AbHom -&gt; AbHom -&gt; AbHom
</span><a href="#local-6989586621679086852"><span class="hs-operator hs-var hs-var hs-var hs-var">(!)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Z -&gt; AbHom -&gt; AbHom
Scalar AbHom -&gt; AbHom -&gt; AbHom
forall a. Abelian a =&gt; Z -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">ztimes</span></span><span>
</span><span id="line-303"></span><span>
</span><span id="line-304"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FibredOriented</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span><span>
</span><span id="line-305"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Distributive</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span><span>
</span><span id="line-306"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Algebraic</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span><span>
</span><span id="line-307"></span><span>
</span><span id="line-308"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-309"></span><span class="hs-comment">-- abh -</span><span>
</span><span id="line-310"></span><span>
</span><span id="line-311"></span><span class="annot"><span class="hs-comment">-- | the additive homomorphism with the given orientation and 'ZModHom'-entries.</span></span><span>
</span><span id="line-312"></span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#abh"><span class="hs-identifier hs-type">abh</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Orientation</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbGroup"><span class="hs-identifier hs-type">AbGroup</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="OAlg.AbelianGroup.ZMod.html#ZModHom"><span class="hs-identifier hs-type">ZModHom</span></a></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">N</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">N</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span><span>
</span><span id="line-313"></span><span id="abh"><span class="annot"><span class="annottext">abh :: Orientation AbGroup -&gt; [(ZModHom, N, N)] -&gt; AbHom
</span><a href="OAlg.AbelianGroup.Definition.html#abh"><span class="hs-identifier hs-var hs-var">abh</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679086875"><span class="annot"><span class="annottext">AbGroup
</span><a href="#local-6989586621679086875"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&gt;</span></span><span> </span><span id="local-6989586621679086876"><span class="annot"><span class="annottext">AbGroup
</span><a href="#local-6989586621679086876"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679086877"><span class="annot"><span class="annottext">[(ZModHom, N, N)]
</span><a href="#local-6989586621679086877"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix ZModHom -&gt; AbHom
</span><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-var">AbHom</span></a></span><span> </span><span class="annot"><span class="annottext">(Matrix ZModHom -&gt; AbHom) -&gt; Matrix ZModHom -&gt; AbHom
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Dim ZModHom ZMod
-&gt; Dim ZModHom ZMod -&gt; [(ZModHom, N, N)] -&gt; Matrix ZModHom
forall x p.
(Additive x, p ~ Point x) =&gt;
Dim x p -&gt; Dim x p -&gt; [(x, N, N)] -&gt; Matrix x
</span><span class="hs-identifier hs-var">matrix</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AbGroup -&gt; Dim' ZModHom
</span><a href="OAlg.AbelianGroup.Definition.html#abgDim"><span class="hs-identifier hs-var">abgDim</span></a></span><span> </span><span class="annot"><span class="annottext">AbGroup
</span><a href="#local-6989586621679086876"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AbGroup -&gt; Dim' ZModHom
</span><a href="OAlg.AbelianGroup.Definition.html#abgDim"><span class="hs-identifier hs-var">abgDim</span></a></span><span> </span><span class="annot"><span class="annottext">AbGroup
</span><a href="#local-6989586621679086875"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(ZModHom, N, N)]
</span><a href="#local-6989586621679086877"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span>
</span><span id="line-314"></span><span>
</span><span id="line-315"></span><span class="annot"><span class="hs-comment">-- | the additive homomorphism with the given orientation and 'Z'-entries.</span></span><span>
</span><span id="line-316"></span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#abh%27"><span class="hs-identifier hs-type">abh'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Orientation</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbGroup"><span class="hs-identifier hs-type">AbGroup</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Z</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">N</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">N</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span><span>
</span><span id="line-317"></span><span id="abh%27"><span class="annot"><span class="annottext">abh' :: Orientation AbGroup -&gt; [(Z, N, N)] -&gt; AbHom
</span><a href="OAlg.AbelianGroup.Definition.html#abh%27"><span class="hs-identifier hs-var hs-var">abh'</span></a></span></span><span> </span><span id="local-6989586621679086880"><span class="annot"><span class="annottext">o :: Orientation AbGroup
</span><a href="#local-6989586621679086880"><span class="hs-identifier hs-var">o</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679086881"><span class="annot"><span class="annottext">AbGroup
</span><a href="#local-6989586621679086881"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&gt;</span></span><span> </span><span id="local-6989586621679086882"><span class="annot"><span class="annottext">AbGroup
</span><a href="#local-6989586621679086882"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679086883"><span class="annot"><span class="annottext">[(Z, N, N)]
</span><a href="#local-6989586621679086883"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Orientation AbGroup -&gt; [(ZModHom, N, N)] -&gt; AbHom
</span><a href="OAlg.AbelianGroup.Definition.html#abh"><span class="hs-identifier hs-var">abh</span></a></span><span> </span><span class="annot"><span class="annottext">Orientation AbGroup
</span><a href="#local-6989586621679086880"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">[(ZModHom, N, N)]
</span><a href="#local-6989586621679086884"><span class="hs-identifier hs-var">xs'</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-318"></span><span>  </span><span id="local-6989586621679086884"><span class="annot"><span class="annottext">xs' :: [(ZModHom, N, N)]
</span><a href="#local-6989586621679086884"><span class="hs-identifier hs-var hs-var">xs'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Z, N, N) -&gt; (ZModHom, N, N)) -&gt; [(Z, N, N)] -&gt; [(ZModHom, N, N)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
forall (h :: * -&gt; * -&gt; *) (f :: * -&gt; *) a b.
Applicative1 h f =&gt;
h a b -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">amap1</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679086885"><span class="annot"><span class="annottext">Z
</span><a href="#local-6989586621679086885"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679086886"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679086886"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679086887"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679086887"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Orientation ZMod -&gt; Z -&gt; ZModHom
</span><a href="OAlg.AbelianGroup.ZMod.html#zmh"><span class="hs-identifier hs-var">zmh</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">N -&gt; ZMod
</span><a href="#local-6989586621679086889"><span class="hs-identifier hs-var">s'</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679086887"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">ZMod -&gt; ZMod -&gt; Orientation ZMod
forall p. p -&gt; p -&gt; Orientation p
</span><span class="hs-operator hs-var">:&gt;</span></span><span> </span><span class="annot"><span class="annottext">N -&gt; ZMod
</span><a href="#local-6989586621679086890"><span class="hs-identifier hs-var">e'</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679086886"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Z
</span><a href="#local-6989586621679086885"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679086886"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679086887"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Z, N, N)]
</span><a href="#local-6989586621679086883"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-319"></span><span>  </span><span id="local-6989586621679086889"><span class="annot"><span class="annottext">s' :: N -&gt; ZMod
</span><a href="#local-6989586621679086889"><span class="hs-identifier hs-var hs-var">s'</span></a></span></span><span> </span><span id="local-6989586621679086891"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679086891"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ZMod -&gt; ZMod
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromJust</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProductSymbol ZMod
</span><a href="#local-6989586621679086893"><span class="hs-identifier hs-var">sp</span></a></span><span> </span><span class="annot"><span class="annottext">ProductSymbol ZMod -&gt; N -&gt; Maybe ZMod
forall (s :: * -&gt; *) i x. Sequence s i x =&gt; s x -&gt; i -&gt; Maybe x
</span><span class="hs-operator hs-var">??</span></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679086891"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-320"></span><span>  </span><span id="local-6989586621679086890"><span class="annot"><span class="annottext">e' :: N -&gt; ZMod
</span><a href="#local-6989586621679086890"><span class="hs-identifier hs-var hs-var">e'</span></a></span></span><span> </span><span id="local-6989586621679086895"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679086895"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ZMod -&gt; ZMod
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromJust</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProductSymbol ZMod
</span><a href="#local-6989586621679086896"><span class="hs-identifier hs-var">ep</span></a></span><span> </span><span class="annot"><span class="annottext">ProductSymbol ZMod -&gt; N -&gt; Maybe ZMod
forall (s :: * -&gt; *) i x. Sequence s i x =&gt; s x -&gt; i -&gt; Maybe x
</span><span class="hs-operator hs-var">??</span></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679086895"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-321"></span><span>  </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbGroup"><span class="hs-identifier hs-type">AbGroup</span></a></span><span> </span><span id="local-6989586621679086893"><span class="annot"><span class="annottext">ProductSymbol ZMod
</span><a href="#local-6989586621679086893"><span class="hs-identifier hs-var">sp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AbGroup
</span><a href="#local-6989586621679086881"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-322"></span><span>  </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbGroup"><span class="hs-identifier hs-type">AbGroup</span></a></span><span> </span><span id="local-6989586621679086896"><span class="annot"><span class="annottext">ProductSymbol ZMod
</span><a href="#local-6989586621679086896"><span class="hs-identifier hs-var">ep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AbGroup
</span><a href="#local-6989586621679086882"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-323"></span><span>
</span><span id="line-324"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-325"></span><span class="hs-comment">-- AbHomMap -</span><span>
</span><span id="line-326"></span><span>
</span><span id="line-327"></span><span class="hs-comment">-- | morphisms between 'AbHom' and the underlying @'Matrix' 'ZModHom'@ which constitute</span><span>
</span><span id="line-328"></span><span class="hs-comment">-- isomorphisms (see 'IsoAbHomMap').</span><span>
</span><span id="line-329"></span><span class="hs-keyword">data</span><span> </span><span id="AbHomMap"><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHomMap"><span class="hs-identifier hs-var">AbHomMap</span></a></span></span><span> </span><span id="local-6989586621679086898"><span class="annot"><a href="#local-6989586621679086898"><span class="hs-identifier hs-type">x</span></a></span></span><span> </span><span id="local-6989586621679086899"><span class="annot"><a href="#local-6989586621679086899"><span class="hs-identifier hs-type">y</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-330"></span><span>  </span><span id="AbHomMatrix"><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHomMatrix"><span class="hs-identifier hs-var">AbHomMatrix</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHomMap"><span class="hs-identifier hs-type">AbHomMap</span></a></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Matrix</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.ZMod.html#ZModHom"><span class="hs-identifier hs-type">ZModHom</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-331"></span><span>  </span><span id="MatrixAbHom"><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#MatrixAbHom"><span class="hs-identifier hs-var">MatrixAbHom</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHomMap"><span class="hs-identifier hs-type">AbHomMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Matrix</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.ZMod.html#ZModHom"><span class="hs-identifier hs-type">ZModHom</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span><span>
</span><span id="line-332"></span><span>
</span><span id="line-333"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-334"></span><span class="hs-comment">-- AbHomMap - Entity -</span><span>
</span><span id="line-335"></span><span>
</span><span id="line-336"></span><span id="local-6989586621679085454"><span id="local-6989586621679085455"><span id="local-6989586621679086903"><span id="local-6989586621679086905"><span id="local-6989586621679086909"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHomMap"><span class="hs-identifier hs-type">AbHomMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679085454"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679085455"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-337"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679086912"><span class="annot"><span class="hs-identifier hs-type">Show2</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHomMap"><span class="hs-identifier hs-type">AbHomMap</span></a></span></span><span>
</span><span id="line-338"></span><span id="local-6989586621679085464"><span id="local-6989586621679085465"><span id="local-6989586621679086918"><span id="local-6989586621679086920"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHomMap"><span class="hs-identifier hs-type">AbHomMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679085464"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679085465"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-339"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679086924"><span class="annot"><span class="hs-identifier hs-type">Eq2</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHomMap"><span class="hs-identifier hs-type">AbHomMap</span></a></span></span><span>
</span><span id="line-340"></span><span>
</span><span id="line-341"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679085474"><span id="local-6989586621679085475"><span class="annot"><span class="hs-identifier hs-type">Validable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHomMap"><span class="hs-identifier hs-type">AbHomMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679085474"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679085475"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-342"></span><span>  </span><span id="local-6989586621679086931"><span class="annot"><span class="annottext">valid :: AbHomMap x y -&gt; Statement
</span><a href="#local-6989586621679086931"><span class="hs-identifier hs-var hs-var hs-var hs-var">valid</span></a></span></span><span> </span><span class="annot"><span class="annottext">AbHomMap x y
</span><a href="OAlg.AbelianGroup.Definition.html#AbHomMatrix"><span class="hs-identifier hs-var">AbHomMatrix</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Statement
</span><span class="hs-identifier hs-var">SValid</span></span><span>
</span><span id="line-343"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">valid</span></span><span> </span><span class="annot"><span class="annottext">AbHomMap x y
</span><a href="OAlg.AbelianGroup.Definition.html#MatrixAbHom"><span class="hs-identifier hs-var">MatrixAbHom</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Statement
</span><span class="hs-identifier hs-var">SValid</span></span><span>
</span><span id="line-344"></span><span>
</span><span id="line-345"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679086939"><span class="annot"><span class="hs-identifier hs-type">Validable2</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHomMap"><span class="hs-identifier hs-type">AbHomMap</span></a></span></span><span>
</span><span id="line-346"></span><span>
</span><span id="line-347"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679085484"><span id="local-6989586621679085485"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="annot"><a href="#local-6989586621679085484"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="annot"><a href="#local-6989586621679085485"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Entity</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHomMap"><span class="hs-identifier hs-type">AbHomMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679085484"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679085485"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-348"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Entity2</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHomMap"><span class="hs-identifier hs-type">AbHomMap</span></a></span><span>
</span><span id="line-349"></span><span>
</span><span id="line-350"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-351"></span><span class="hs-comment">-- invAbHomMap -</span><span>
</span><span id="line-352"></span><span>
</span><span id="line-353"></span><span class="annot"><span class="hs-comment">-- | the inverse.</span></span><span>
</span><span id="line-354"></span><span id="local-6989586621679085488"><span id="local-6989586621679085489"><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#invAbHomMap"><span class="hs-identifier hs-type">invAbHomMap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHomMap"><span class="hs-identifier hs-type">AbHomMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679085488"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679085489"><span class="hs-identifier hs-type">y</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHomMap"><span class="hs-identifier hs-type">AbHomMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679085489"><span class="hs-identifier hs-type">y</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679085488"><span class="hs-identifier hs-type">x</span></a></span></span></span><span>
</span><span id="line-355"></span><span id="invAbHomMap"><span class="annot"><span class="annottext">invAbHomMap :: forall x y. AbHomMap x y -&gt; AbHomMap y x
</span><a href="OAlg.AbelianGroup.Definition.html#invAbHomMap"><span class="hs-identifier hs-var hs-var">invAbHomMap</span></a></span></span><span> </span><span class="annot"><span class="annottext">AbHomMap x y
</span><a href="OAlg.AbelianGroup.Definition.html#AbHomMatrix"><span class="hs-identifier hs-var">AbHomMatrix</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AbHomMap y x
AbHomMap (Matrix ZModHom) AbHom
</span><a href="OAlg.AbelianGroup.Definition.html#MatrixAbHom"><span class="hs-identifier hs-var">MatrixAbHom</span></a></span><span>
</span><span id="line-356"></span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#invAbHomMap"><span class="hs-identifier hs-var">invAbHomMap</span></a></span><span> </span><span class="annot"><span class="annottext">AbHomMap x y
</span><a href="OAlg.AbelianGroup.Definition.html#MatrixAbHom"><span class="hs-identifier hs-var">MatrixAbHom</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AbHomMap y x
AbHomMap AbHom (Matrix ZModHom)
</span><a href="OAlg.AbelianGroup.Definition.html#AbHomMatrix"><span class="hs-identifier hs-var">AbHomMatrix</span></a></span><span>
</span><span id="line-357"></span><span>
</span><span id="line-358"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-359"></span><span class="hs-comment">-- AbHomMap - HomAlgebraic -</span><span>
</span><span id="line-360"></span><span>
</span><span id="line-361"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679086974"><span id="local-6989586621679086978"><span class="annot"><span class="hs-identifier hs-type">Morphism</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHomMap"><span class="hs-identifier hs-type">AbHomMap</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-362"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="ObjectClass"><span class="annot"><span class="hs-identifier hs-var">ObjectClass</span></span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHomMap"><span class="hs-identifier hs-type">AbHomMap</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Alg</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Z</span></span><span>
</span><span id="line-363"></span><span>  </span><span id="local-6989586621679086981"><span class="annot"><span class="annottext">homomorphous :: forall x y. AbHomMap x y -&gt; Homomorphous (ObjectClass AbHomMap) x y
</span><a href="#local-6989586621679086981"><span class="hs-identifier hs-var hs-var hs-var hs-var">homomorphous</span></a></span></span><span> </span><span class="annot"><span class="annottext">AbHomMap x y
</span><a href="OAlg.AbelianGroup.Definition.html#AbHomMatrix"><span class="hs-identifier hs-var">AbHomMatrix</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Struct (Alg Z) x
forall s x. Structure s x =&gt; Struct s x
</span><span class="hs-identifier hs-var">Struct</span></span><span> </span><span class="annot"><span class="annottext">Struct (Alg Z) x -&gt; Struct (Alg Z) y -&gt; Homomorphous (Alg Z) x y
forall s x y. Struct s x -&gt; Struct s y -&gt; Homomorphous s x y
</span><span class="hs-operator hs-var">:&gt;:</span></span><span> </span><span class="annot"><span class="annottext">Struct (Alg Z) y
forall s x. Structure s x =&gt; Struct s x
</span><span class="hs-identifier hs-var">Struct</span></span><span>
</span><span id="line-364"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">homomorphous</span></span><span> </span><span class="annot"><span class="annottext">AbHomMap x y
</span><a href="OAlg.AbelianGroup.Definition.html#MatrixAbHom"><span class="hs-identifier hs-var">MatrixAbHom</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Struct (Alg Z) x
forall s x. Structure s x =&gt; Struct s x
</span><span class="hs-identifier hs-var">Struct</span></span><span> </span><span class="annot"><span class="annottext">Struct (Alg Z) x -&gt; Struct (Alg Z) y -&gt; Homomorphous (Alg Z) x y
forall s x y. Struct s x -&gt; Struct s y -&gt; Homomorphous s x y
</span><span class="hs-operator hs-var">:&gt;:</span></span><span> </span><span class="annot"><span class="annottext">Struct (Alg Z) y
forall s x. Structure s x =&gt; Struct s x
</span><span class="hs-identifier hs-var">Struct</span></span><span>
</span><span id="line-365"></span><span>
</span><span id="line-366"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EmbeddableMorphism</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHomMap"><span class="hs-identifier hs-type">AbHomMap</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ort</span></span><span>
</span><span id="line-367"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EmbeddableMorphism</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHomMap"><span class="hs-identifier hs-type">AbHomMap</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typ</span></span><span>
</span><span id="line-368"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EmbeddableMorphismTyp</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHomMap"><span class="hs-identifier hs-type">AbHomMap</span></a></span><span>
</span><span id="line-369"></span><span>
</span><span id="line-370"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHomMap"><span class="hs-identifier hs-type">AbHomMap</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-371"></span><span>  </span><span id="local-6989586621679087015"><span class="annot"><span class="annottext">amap :: forall a b. AbHomMap a b -&gt; a -&gt; b
</span><a href="#local-6989586621679087015"><span class="hs-identifier hs-var hs-var hs-var hs-var">amap</span></a></span></span><span> </span><span class="annot"><span class="annottext">AbHomMap a b
</span><a href="OAlg.AbelianGroup.Definition.html#AbHomMatrix"><span class="hs-identifier hs-var">AbHomMatrix</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span><span> </span><span id="local-6989586621679087019"><span class="annot"><span class="annottext">Matrix ZModHom
</span><a href="#local-6989586621679087019"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b
Matrix ZModHom
</span><a href="#local-6989586621679087019"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-372"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">amap</span></span><span> </span><span class="annot"><span class="annottext">AbHomMap a b
</span><a href="OAlg.AbelianGroup.Definition.html#MatrixAbHom"><span class="hs-identifier hs-var">MatrixAbHom</span></a></span><span> </span><span id="local-6989586621679087022"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679087022"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix ZModHom -&gt; AbHom
</span><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-var">AbHom</span></a></span><span> </span><span class="annot"><span class="annottext">a
Matrix ZModHom
</span><a href="#local-6989586621679087022"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-373"></span><span>
</span><span id="line-374"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HomOriented</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHomMap"><span class="hs-identifier hs-type">AbHomMap</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-375"></span><span>  </span><span id="local-6989586621679087038"><span class="annot"><span class="annottext">pmap :: forall a b. AbHomMap a b -&gt; Point a -&gt; Point b
</span><a href="#local-6989586621679087038"><span class="hs-identifier hs-var hs-var hs-var hs-var">pmap</span></a></span></span><span> </span><span class="annot"><span class="annottext">AbHomMap a b
</span><a href="OAlg.AbelianGroup.Definition.html#AbHomMatrix"><span class="hs-identifier hs-var">AbHomMatrix</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbGroup"><span class="hs-identifier hs-type">AbGroup</span></a></span><span> </span><span id="local-6989586621679087042"><span class="annot"><span class="annottext">ProductSymbol ZMod
</span><a href="#local-6989586621679087042"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CSequence (Point ZModHom) -&gt; Dim' ZModHom
forall x. CSequence (Point x) -&gt; Dim x (Point x)
</span><span class="hs-identifier hs-var">Dim</span></span><span> </span><span class="annot"><span class="annottext">CSequence (Point ZModHom)
ProductSymbol ZMod
</span><a href="#local-6989586621679087042"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-376"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pmap</span></span><span> </span><span class="annot"><span class="annottext">AbHomMap a b
</span><a href="OAlg.AbelianGroup.Definition.html#MatrixAbHom"><span class="hs-identifier hs-var">MatrixAbHom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Dim</span></span><span> </span><span id="local-6989586621679087046"><span class="annot"><span class="annottext">CSequence (Point ZModHom)
</span><a href="#local-6989586621679087046"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProductSymbol ZMod -&gt; AbGroup
</span><a href="OAlg.AbelianGroup.Definition.html#AbGroup"><span class="hs-identifier hs-var">AbGroup</span></a></span><span> </span><span class="annot"><span class="annottext">CSequence (Point ZModHom)
ProductSymbol ZMod
</span><a href="#local-6989586621679087046"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-377"></span><span>
</span><span id="line-378"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EmbeddableMorphism</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHomMap"><span class="hs-identifier hs-type">AbHomMap</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Mlt</span></span><span>
</span><span id="line-379"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HomMultiplicative</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHomMap"><span class="hs-identifier hs-type">AbHomMap</span></a></span><span>
</span><span id="line-380"></span><span>
</span><span id="line-381"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-382"></span><span class="hs-comment">-- PathAbHomMap -</span><span>
</span><span id="line-383"></span><span>
</span><span id="line-384"></span><span class="annot"><span class="hs-comment">-- | paths of 'AbHomMap'.</span></span><span>
</span><span id="line-385"></span><span class="hs-keyword">type</span><span> </span><span id="PathAbHomMap"><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#PathAbHomMap"><span class="hs-identifier hs-var">PathAbHomMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">C.Path</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHomMap"><span class="hs-identifier hs-type">AbHomMap</span></a></span><span>
</span><span id="line-386"></span><span>
</span><span id="line-387"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-388"></span><span class="hs-comment">-- IsoAbHomMap -</span><span>
</span><span id="line-389"></span><span>
</span><span id="line-390"></span><span class="annot"><span class="hs-comment">-- | isomorphisms between 'AbHom' and @'Matrix' 'ZModHom'@.</span></span><span>
</span><span id="line-391"></span><span class="hs-keyword">newtype</span><span> </span><span id="IsoAbHomMap"><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#IsoAbHomMap"><span class="hs-identifier hs-var">IsoAbHomMap</span></a></span></span><span> </span><span id="local-6989586621679085616"><span class="annot"><a href="#local-6989586621679085616"><span class="hs-identifier hs-type">x</span></a></span></span><span> </span><span id="local-6989586621679085617"><span class="annot"><a href="#local-6989586621679085617"><span class="hs-identifier hs-type">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="IsoAbHomMap"><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#IsoAbHomMap"><span class="hs-identifier hs-var">IsoAbHomMap</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#PathAbHomMap"><span class="hs-identifier hs-type">PathAbHomMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679085616"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679085617"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-392"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679087061"><span id="local-6989586621679087067"><span id="local-6989586621679087071"><span class="annot"><span class="annottext">Int -&gt; IsoAbHomMap x y -&gt; ShowS
[IsoAbHomMap x y] -&gt; ShowS
IsoAbHomMap x y -&gt; String
(Int -&gt; IsoAbHomMap x y -&gt; ShowS)
-&gt; (IsoAbHomMap x y -&gt; String)
-&gt; ([IsoAbHomMap x y] -&gt; ShowS)
-&gt; Show (IsoAbHomMap x y)
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall x y. Int -&gt; IsoAbHomMap x y -&gt; ShowS
forall x y. [IsoAbHomMap x y] -&gt; ShowS
forall x y. IsoAbHomMap x y -&gt; String
$cshowsPrec :: forall x y. Int -&gt; IsoAbHomMap x y -&gt; ShowS
showsPrec :: Int -&gt; IsoAbHomMap x y -&gt; ShowS
$cshow :: forall x y. IsoAbHomMap x y -&gt; String
show :: IsoAbHomMap x y -&gt; String
$cshowList :: forall x y. [IsoAbHomMap x y] -&gt; ShowS
showList :: [IsoAbHomMap x y] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679087076"><span class="annot"><span class="annottext">(forall x y. IsoAbHomMap x y -&gt; String) -&gt; Show2 IsoAbHomMap
forall x y. IsoAbHomMap x y -&gt; String
forall (h :: * -&gt; * -&gt; *). (forall a b. h a b -&gt; String) -&gt; Show2 h
$cshow2 :: forall x y. IsoAbHomMap x y -&gt; String
show2 :: forall x y. IsoAbHomMap x y -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Show2</span></span></span><span class="hs-special">,</span><span id="local-6989586621679087082"><span class="annot"><span class="annottext">IsoAbHomMap x y -&gt; Statement
(IsoAbHomMap x y -&gt; Statement) -&gt; Validable (IsoAbHomMap x y)
forall a. (a -&gt; Statement) -&gt; Validable a
forall x y. IsoAbHomMap x y -&gt; Statement
$cvalid :: forall x y. IsoAbHomMap x y -&gt; Statement
valid :: IsoAbHomMap x y -&gt; Statement
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Validable</span></span></span><span class="hs-special">,</span><span id="local-6989586621679087092"><span class="annot"><span class="annottext">(forall x y. IsoAbHomMap x y -&gt; Statement)
-&gt; Validable2 IsoAbHomMap
forall x y. IsoAbHomMap x y -&gt; Statement
forall (h :: * -&gt; * -&gt; *).
(forall x y. h x y -&gt; Statement) -&gt; Validable2 h
$cvalid2 :: forall x y. IsoAbHomMap x y -&gt; Statement
valid2 :: forall x y. IsoAbHomMap x y -&gt; Statement
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Validable2</span></span></span><span class="hs-special">,</span><span id="local-6989586621679087099"><span id="local-6989586621679087105"><span class="annot"><span class="annottext">IsoAbHomMap x y -&gt; IsoAbHomMap x y -&gt; Bool
(IsoAbHomMap x y -&gt; IsoAbHomMap x y -&gt; Bool)
-&gt; (IsoAbHomMap x y -&gt; IsoAbHomMap x y -&gt; Bool)
-&gt; Eq (IsoAbHomMap x y)
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall x y. IsoAbHomMap x y -&gt; IsoAbHomMap x y -&gt; Bool
$c== :: forall x y. IsoAbHomMap x y -&gt; IsoAbHomMap x y -&gt; Bool
== :: IsoAbHomMap x y -&gt; IsoAbHomMap x y -&gt; Bool
$c/= :: forall x y. IsoAbHomMap x y -&gt; IsoAbHomMap x y -&gt; Bool
/= :: IsoAbHomMap x y -&gt; IsoAbHomMap x y -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679087116"><span class="annot"><span class="annottext">(forall x y. IsoAbHomMap x y -&gt; IsoAbHomMap x y -&gt; Bool)
-&gt; Eq2 IsoAbHomMap
forall x y. IsoAbHomMap x y -&gt; IsoAbHomMap x y -&gt; Bool
forall (h :: * -&gt; * -&gt; *).
(forall x y. h x y -&gt; h x y -&gt; Bool) -&gt; Eq2 h
$ceq2 :: forall x y. IsoAbHomMap x y -&gt; IsoAbHomMap x y -&gt; Bool
eq2 :: forall x y. IsoAbHomMap x y -&gt; IsoAbHomMap x y -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Eq2</span></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Eq (IsoAbHomMap x y)
Show (IsoAbHomMap x y)
Typeable (IsoAbHomMap x y)
Validable (IsoAbHomMap x y)
Show (IsoAbHomMap x y)
-&gt; Eq (IsoAbHomMap x y)
-&gt; Validable (IsoAbHomMap x y)
-&gt; Typeable (IsoAbHomMap x y)
-&gt; Entity (IsoAbHomMap x y)
forall a. Show a -&gt; Eq a -&gt; Validable a -&gt; Typeable a -&gt; Entity a
forall {x} {y}. (Typeable x, Typeable y) =&gt; Eq (IsoAbHomMap x y)
forall {x} {y}. (Typeable x, Typeable y) =&gt; Show (IsoAbHomMap x y)
forall {x} {y}.
(Typeable x, Typeable y) =&gt;
Typeable (IsoAbHomMap x y)
forall {x} {y}.
(Typeable x, Typeable y) =&gt;
Validable (IsoAbHomMap x y)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Entity</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Typeable IsoAbHomMap
Eq2 IsoAbHomMap
Show2 IsoAbHomMap
Validable2 IsoAbHomMap
Show2 IsoAbHomMap
-&gt; Eq2 IsoAbHomMap
-&gt; Validable2 IsoAbHomMap
-&gt; Typeable IsoAbHomMap
-&gt; Entity2 IsoAbHomMap
forall (h :: * -&gt; * -&gt; *).
Show2 h -&gt; Eq2 h -&gt; Validable2 h -&gt; Typeable h -&gt; Entity2 h
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Entity2</span></span><span class="hs-special">)</span><span>
</span><span id="line-393"></span><span>
</span><span id="line-394"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-395"></span><span class="hs-comment">-- IsoAbHomMap - Constructable -</span><span>
</span><span id="line-396"></span><span>
</span><span id="line-397"></span><span class="annot"><span class="hs-comment">-- | reducing paths of 'AbHomMap'.</span></span><span>
</span><span id="line-398"></span><span id="local-6989586621679085574"><span id="local-6989586621679085575"><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#rdcPathAbHomMap"><span class="hs-identifier hs-type">rdcPathAbHomMap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#PathAbHomMap"><span class="hs-identifier hs-type">PathAbHomMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679085574"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679085575"><span class="hs-identifier hs-type">y</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rdc</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#PathAbHomMap"><span class="hs-identifier hs-type">PathAbHomMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679085574"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679085575"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-399"></span><span id="rdcPathAbHomMap"><span class="annot"><span class="annottext">rdcPathAbHomMap :: forall x y. PathAbHomMap x y -&gt; Rdc (PathAbHomMap x y)
</span><a href="OAlg.AbelianGroup.Definition.html#rdcPathAbHomMap"><span class="hs-identifier hs-var hs-var">rdcPathAbHomMap</span></a></span></span><span> </span><span id="local-6989586621679087147"><span class="annot"><span class="annottext">PathAbHomMap x y
</span><a href="#local-6989586621679087147"><span class="hs-identifier hs-var">pth</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">PathAbHomMap x y
</span><a href="#local-6989586621679087147"><span class="hs-identifier hs-var">pth</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-400"></span><span>  </span><span class="annot"><span class="annottext">AbHomMap y1 y
</span><a href="OAlg.AbelianGroup.Definition.html#AbHomMatrix"><span class="hs-identifier hs-var">AbHomMatrix</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:.</span></span><span> </span><span class="annot"><span class="annottext">AbHomMap y1 y1
</span><a href="OAlg.AbelianGroup.Definition.html#MatrixAbHom"><span class="hs-identifier hs-var">MatrixAbHom</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:.</span></span><span> </span><span id="local-6989586621679087154"><span class="annot"><span class="annottext">Path AbHomMap x y1
</span><a href="#local-6989586621679087154"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Path AbHomMap x y1 -&gt; Rdc (Path AbHomMap x y1)
forall x. x -&gt; Rdc x
</span><span class="hs-identifier hs-var">reducesTo</span></span><span> </span><span class="annot"><span class="annottext">Path AbHomMap x y1
</span><a href="#local-6989586621679087154"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Rdc (Path AbHomMap x y1)
-&gt; (Path AbHomMap x y1 -&gt; Rdc (PathAbHomMap x y))
-&gt; Rdc (PathAbHomMap x y)
forall a b.
Action RdcState a -&gt; (a -&gt; Action RdcState b) -&gt; Action RdcState b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Path AbHomMap x y1 -&gt; Rdc (PathAbHomMap x y)
Path AbHomMap x y1 -&gt; Rdc (Path AbHomMap x y1)
forall x y. PathAbHomMap x y -&gt; Rdc (PathAbHomMap x y)
</span><a href="OAlg.AbelianGroup.Definition.html#rdcPathAbHomMap"><span class="hs-identifier hs-var">rdcPathAbHomMap</span></a></span><span>
</span><span id="line-401"></span><span>  </span><span class="annot"><span class="annottext">AbHomMap y1 y
</span><a href="OAlg.AbelianGroup.Definition.html#MatrixAbHom"><span class="hs-identifier hs-var">MatrixAbHom</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:.</span></span><span> </span><span class="annot"><span class="annottext">AbHomMap y1 y1
</span><a href="OAlg.AbelianGroup.Definition.html#AbHomMatrix"><span class="hs-identifier hs-var">AbHomMatrix</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:.</span></span><span> </span><span id="local-6989586621679087161"><span class="annot"><span class="annottext">Path AbHomMap x y1
</span><a href="#local-6989586621679087161"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Path AbHomMap x y1 -&gt; Rdc (Path AbHomMap x y1)
forall x. x -&gt; Rdc x
</span><span class="hs-identifier hs-var">reducesTo</span></span><span> </span><span class="annot"><span class="annottext">Path AbHomMap x y1
</span><a href="#local-6989586621679087161"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Rdc (Path AbHomMap x y1)
-&gt; (Path AbHomMap x y1 -&gt; Rdc (PathAbHomMap x y))
-&gt; Rdc (PathAbHomMap x y)
forall a b.
Action RdcState a -&gt; (a -&gt; Action RdcState b) -&gt; Action RdcState b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Path AbHomMap x y1 -&gt; Rdc (PathAbHomMap x y)
Path AbHomMap x y1 -&gt; Rdc (Path AbHomMap x y1)
forall x y. PathAbHomMap x y -&gt; Rdc (PathAbHomMap x y)
</span><a href="OAlg.AbelianGroup.Definition.html#rdcPathAbHomMap"><span class="hs-identifier hs-var">rdcPathAbHomMap</span></a></span><span>
</span><span id="line-402"></span><span>  </span><span id="local-6989586621679087165"><span class="annot"><span class="annottext">AbHomMap y1 y
</span><a href="#local-6989586621679087165"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:.</span></span><span> </span><span id="local-6989586621679087166"><span class="annot"><span class="annottext">Path AbHomMap x y1
</span><a href="#local-6989586621679087166"><span class="hs-identifier hs-var">p</span></a></span></span><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Path AbHomMap x y1 -&gt; Rdc (Path AbHomMap x y1)
forall x y. PathAbHomMap x y -&gt; Rdc (PathAbHomMap x y)
</span><a href="OAlg.AbelianGroup.Definition.html#rdcPathAbHomMap"><span class="hs-identifier hs-var">rdcPathAbHomMap</span></a></span><span> </span><span class="annot"><span class="annottext">Path AbHomMap x y1
</span><a href="#local-6989586621679087166"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Rdc (Path AbHomMap x y1)
-&gt; (Path AbHomMap x y1 -&gt; Rdc (PathAbHomMap x y))
-&gt; Rdc (PathAbHomMap x y)
forall a b.
Action RdcState a -&gt; (a -&gt; Action RdcState b) -&gt; Action RdcState b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">PathAbHomMap x y -&gt; Rdc (PathAbHomMap x y)
forall x. x -&gt; Rdc x
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(PathAbHomMap x y -&gt; Rdc (PathAbHomMap x y))
-&gt; (Path AbHomMap x y1 -&gt; PathAbHomMap x y)
-&gt; Path AbHomMap x y1
-&gt; Rdc (PathAbHomMap x y)
forall y z x. (y -&gt; z) -&gt; (x -&gt; y) -&gt; x -&gt; z
forall (c :: * -&gt; * -&gt; *) y z x.
Category c =&gt;
c y z -&gt; c x y -&gt; c x z
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AbHomMap y1 y
</span><a href="#local-6989586621679087165"><span class="hs-identifier hs-var">h</span></a></span><span class="annot"><span class="annottext">AbHomMap y1 y -&gt; Path AbHomMap x y1 -&gt; PathAbHomMap x y
forall (m :: * -&gt; * -&gt; *) y1 y x.
m y1 y -&gt; Path m x y1 -&gt; Path m x y
</span><span class="hs-operator hs-var">:.</span></span><span class="hs-special">)</span><span>
</span><span id="line-403"></span><span>  </span><span id="local-6989586621679087167"><span class="annot"><span class="annottext">PathAbHomMap x y
</span><a href="#local-6989586621679087167"><span class="hs-identifier hs-var">p</span></a></span></span><span>                               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PathAbHomMap x y -&gt; Rdc (PathAbHomMap x y)
forall x. x -&gt; Rdc x
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">PathAbHomMap x y
</span><a href="#local-6989586621679087167"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-404"></span><span>
</span><span id="line-405"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679085600"><span id="local-6989586621679085601"><span class="annot"><span class="hs-identifier hs-type">Reducible</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#PathAbHomMap"><span class="hs-identifier hs-type">PathAbHomMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679085600"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679085601"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-406"></span><span>  </span><span id="local-6989586621679087171"><span class="annot"><span class="annottext">reduce :: PathAbHomMap x y -&gt; PathAbHomMap x y
</span><a href="#local-6989586621679087171"><span class="hs-identifier hs-var hs-var hs-var hs-var">reduce</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PathAbHomMap x y -&gt; Rdc (PathAbHomMap x y))
-&gt; PathAbHomMap x y -&gt; PathAbHomMap x y
forall x. (x -&gt; Rdc x) -&gt; x -&gt; x
</span><span class="hs-identifier hs-var">reduceWith</span></span><span> </span><span class="annot"><span class="annottext">PathAbHomMap x y -&gt; Rdc (PathAbHomMap x y)
forall x y. PathAbHomMap x y -&gt; Rdc (PathAbHomMap x y)
</span><a href="OAlg.AbelianGroup.Definition.html#rdcPathAbHomMap"><span class="hs-identifier hs-var">rdcPathAbHomMap</span></a></span><span>
</span><span id="line-407"></span><span>
</span><span id="line-408"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679085608"><span id="local-6989586621679085609"><span class="annot"><span class="hs-identifier hs-type">Exposable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#IsoAbHomMap"><span class="hs-identifier hs-type">IsoAbHomMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679085608"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679085609"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-409"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Form"><span class="annot"><span class="hs-identifier hs-var">Form</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#IsoAbHomMap"><span class="hs-identifier hs-type">IsoAbHomMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679085608"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679085609"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#PathAbHomMap"><span class="hs-identifier hs-type">PathAbHomMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679085608"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679085609"><span class="hs-identifier hs-type">y</span></a></span><span>
</span><span id="line-410"></span><span>  </span><span id="local-6989586621679087177"><span class="annot"><span class="annottext">form :: IsoAbHomMap x y -&gt; Form (IsoAbHomMap x y)
</span><a href="#local-6989586621679087177"><span class="hs-identifier hs-var hs-var hs-var hs-var">form</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#IsoAbHomMap"><span class="hs-identifier hs-type">IsoAbHomMap</span></a></span><span> </span><span id="local-6989586621679087179"><span class="annot"><span class="annottext">PathAbHomMap x y
</span><a href="#local-6989586621679087179"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Form (IsoAbHomMap x y)
PathAbHomMap x y
</span><a href="#local-6989586621679087179"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-411"></span><span>
</span><span id="line-412"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679085614"><span id="local-6989586621679085615"><span class="annot"><span class="hs-identifier hs-type">Constructable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#IsoAbHomMap"><span class="hs-identifier hs-type">IsoAbHomMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679085614"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679085615"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-413"></span><span>  </span><span id="local-6989586621679087186"><span class="annot"><span class="annottext">make :: Form (IsoAbHomMap x y) -&gt; IsoAbHomMap x y
</span><a href="#local-6989586621679087186"><span class="hs-identifier hs-var hs-var hs-var hs-var">make</span></a></span></span><span> </span><span id="local-6989586621679087188"><span class="annot"><span class="annottext">Form (IsoAbHomMap x y)
</span><a href="#local-6989586621679087188"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PathAbHomMap x y -&gt; IsoAbHomMap x y
forall x y. PathAbHomMap x y -&gt; IsoAbHomMap x y
</span><a href="OAlg.AbelianGroup.Definition.html#IsoAbHomMap"><span class="hs-identifier hs-var">IsoAbHomMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PathAbHomMap x y -&gt; PathAbHomMap x y
forall e. Reducible e =&gt; e -&gt; e
</span><span class="hs-identifier hs-var">reduce</span></span><span> </span><span class="annot"><span class="annottext">Form (IsoAbHomMap x y)
PathAbHomMap x y
</span><a href="#local-6989586621679087188"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-414"></span><span>
</span><span id="line-415"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-416"></span><span class="hs-comment">-- abHomMatrix -</span><span>
</span><span id="line-417"></span><span>
</span><span id="line-418"></span><span class="annot"><span class="hs-comment">-- | the induced isomorphism from 'AbHom' to @'Matrix' 'ZModHom'@ with inverse 'matrixAbHom'.</span></span><span>
</span><span id="line-419"></span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#abHomMatrix"><span class="hs-identifier hs-type">abHomMatrix</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#IsoAbHomMap"><span class="hs-identifier hs-type">IsoAbHomMap</span></a></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Matrix</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.ZMod.html#ZModHom"><span class="hs-identifier hs-type">ZModHom</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-420"></span><span id="abHomMatrix"><span class="annot"><span class="annottext">abHomMatrix :: IsoAbHomMap AbHom (Matrix ZModHom)
</span><a href="OAlg.AbelianGroup.Definition.html#abHomMatrix"><span class="hs-identifier hs-var hs-var">abHomMatrix</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PathAbHomMap AbHom (Matrix ZModHom)
-&gt; IsoAbHomMap AbHom (Matrix ZModHom)
forall x y. PathAbHomMap x y -&gt; IsoAbHomMap x y
</span><a href="OAlg.AbelianGroup.Definition.html#IsoAbHomMap"><span class="hs-identifier hs-var">IsoAbHomMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AbHomMap AbHom (Matrix ZModHom)
</span><a href="OAlg.AbelianGroup.Definition.html#AbHomMatrix"><span class="hs-identifier hs-var">AbHomMatrix</span></a></span><span> </span><span class="annot"><span class="annottext">AbHomMap AbHom (Matrix ZModHom)
-&gt; Path AbHomMap AbHom AbHom -&gt; PathAbHomMap AbHom (Matrix ZModHom)
forall (m :: * -&gt; * -&gt; *) y1 y x.
m y1 y -&gt; Path m x y1 -&gt; Path m x y
</span><span class="hs-operator hs-var">:.</span></span><span> </span><span class="annot"><span class="annottext">Struct (ObjectClass AbHomMap) AbHom -&gt; Path AbHomMap AbHom AbHom
forall (m :: * -&gt; * -&gt; *) x. Struct (ObjectClass m) x -&gt; Path m x x
</span><span class="hs-identifier hs-var">IdPath</span></span><span> </span><span class="annot"><span class="annottext">Struct (ObjectClass AbHomMap) AbHom
Struct (Alg Z) AbHom
forall s x. Structure s x =&gt; Struct s x
</span><span class="hs-identifier hs-var">Struct</span></span><span class="hs-special">)</span><span>
</span><span id="line-421"></span><span>
</span><span id="line-422"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-423"></span><span class="hs-comment">-- matrixAbHom -</span><span>
</span><span id="line-424"></span><span>
</span><span id="line-425"></span><span class="annot"><span class="hs-comment">-- | the induced isomorphism from @'Matrix' 'ZModHom'@ to 'AbHom' with inverse 'abHomMatrix'.</span></span><span>
</span><span id="line-426"></span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#matrixAbHom"><span class="hs-identifier hs-type">matrixAbHom</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#IsoAbHomMap"><span class="hs-identifier hs-type">IsoAbHomMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Matrix</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.ZMod.html#ZModHom"><span class="hs-identifier hs-type">ZModHom</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span><span>
</span><span id="line-427"></span><span id="matrixAbHom"><span class="annot"><span class="annottext">matrixAbHom :: IsoAbHomMap (Matrix ZModHom) AbHom
</span><a href="OAlg.AbelianGroup.Definition.html#matrixAbHom"><span class="hs-identifier hs-var hs-var">matrixAbHom</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PathAbHomMap (Matrix ZModHom) AbHom
-&gt; IsoAbHomMap (Matrix ZModHom) AbHom
forall x y. PathAbHomMap x y -&gt; IsoAbHomMap x y
</span><a href="OAlg.AbelianGroup.Definition.html#IsoAbHomMap"><span class="hs-identifier hs-var">IsoAbHomMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AbHomMap (Matrix ZModHom) AbHom
</span><a href="OAlg.AbelianGroup.Definition.html#MatrixAbHom"><span class="hs-identifier hs-var">MatrixAbHom</span></a></span><span> </span><span class="annot"><span class="annottext">AbHomMap (Matrix ZModHom) AbHom
-&gt; Path AbHomMap (Matrix ZModHom) (Matrix ZModHom)
-&gt; PathAbHomMap (Matrix ZModHom) AbHom
forall (m :: * -&gt; * -&gt; *) y1 y x.
m y1 y -&gt; Path m x y1 -&gt; Path m x y
</span><span class="hs-operator hs-var">:.</span></span><span> </span><span class="annot"><span class="annottext">Struct (ObjectClass AbHomMap) (Matrix ZModHom)
-&gt; Path AbHomMap (Matrix ZModHom) (Matrix ZModHom)
forall (m :: * -&gt; * -&gt; *) x. Struct (ObjectClass m) x -&gt; Path m x x
</span><span class="hs-identifier hs-var">IdPath</span></span><span> </span><span class="annot"><span class="annottext">Struct (ObjectClass AbHomMap) (Matrix ZModHom)
Struct (Alg Z) (Matrix ZModHom)
forall s x. Structure s x =&gt; Struct s x
</span><span class="hs-identifier hs-var">Struct</span></span><span class="hs-special">)</span><span>
</span><span id="line-428"></span><span>
</span><span id="line-429"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-430"></span><span class="hs-comment">-- IsoAbHomMap - Cayleyan2 -</span><span>
</span><span id="line-431"></span><span>
</span><span id="line-432"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679087194"><span id="local-6989586621679087198"><span class="annot"><span class="hs-identifier hs-type">Morphism</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#IsoAbHomMap"><span class="hs-identifier hs-type">IsoAbHomMap</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-433"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="ObjectClass"><span class="annot"><span class="hs-identifier hs-var">ObjectClass</span></span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#IsoAbHomMap"><span class="hs-identifier hs-type">IsoAbHomMap</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Alg</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Z</span></span><span>
</span><span id="line-434"></span><span>  </span><span id="local-6989586621679087204"><span class="annot"><span class="annottext">homomorphous :: forall x y.
IsoAbHomMap x y -&gt; Homomorphous (ObjectClass IsoAbHomMap) x y
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">homomorphous</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Form (IsoAbHomMap x y) -&gt; Homomorphous (Alg Z) x y)
-&gt; IsoAbHomMap x y -&gt; Homomorphous (Alg Z) x y
forall x y. Exposable x =&gt; (Form x -&gt; y) -&gt; x -&gt; y
</span><span class="hs-identifier hs-var">restrict</span></span><span> </span><span class="annot"><span class="annottext">Form (IsoAbHomMap x y) -&gt; Homomorphous (Alg Z) x y
Path AbHomMap x y -&gt; Homomorphous (ObjectClass (Path AbHomMap)) x y
forall x y.
Path AbHomMap x y -&gt; Homomorphous (ObjectClass (Path AbHomMap)) x y
forall (m :: * -&gt; * -&gt; *) x y.
Morphism m =&gt;
m x y -&gt; Homomorphous (ObjectClass m) x y
</span><span class="hs-identifier hs-var">homomorphous</span></span><span>
</span><span id="line-435"></span><span>
</span><span id="line-436"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Category</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#IsoAbHomMap"><span class="hs-identifier hs-type">IsoAbHomMap</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-437"></span><span>  </span><span id="local-6989586621679087212"><span class="annot"><span class="annottext">cOne :: forall x. Struct (ObjectClass IsoAbHomMap) x -&gt; IsoAbHomMap x x
</span><a href="#local-6989586621679087212"><span class="hs-identifier hs-var hs-var hs-var hs-var">cOne</span></a></span></span><span> </span><span id="local-6989586621679087214"><span class="annot"><span class="annottext">Struct (ObjectClass IsoAbHomMap) x
</span><a href="#local-6989586621679087214"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PathAbHomMap x x -&gt; IsoAbHomMap x x
forall x y. PathAbHomMap x y -&gt; IsoAbHomMap x y
</span><a href="OAlg.AbelianGroup.Definition.html#IsoAbHomMap"><span class="hs-identifier hs-var">IsoAbHomMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Struct (ObjectClass AbHomMap) x -&gt; PathAbHomMap x x
forall (m :: * -&gt; * -&gt; *) x. Struct (ObjectClass m) x -&gt; Path m x x
</span><span class="hs-identifier hs-var">IdPath</span></span><span> </span><span class="annot"><span class="annottext">Struct (ObjectClass IsoAbHomMap) x
Struct (ObjectClass AbHomMap) x
</span><a href="#local-6989586621679087214"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-438"></span><span>  </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#IsoAbHomMap"><span class="hs-identifier hs-type">IsoAbHomMap</span></a></span><span> </span><span id="local-6989586621679087219"><span class="annot"><span class="annottext">PathAbHomMap y z
</span><a href="#local-6989586621679087219"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679087220"><span class="annot"><span class="annottext">. :: forall y z x. IsoAbHomMap y z -&gt; IsoAbHomMap x y -&gt; IsoAbHomMap x z
</span><span class="hs-operator hs-var hs-var hs-var hs-var">.</span></span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#IsoAbHomMap"><span class="hs-identifier hs-type">IsoAbHomMap</span></a></span><span> </span><span id="local-6989586621679087221"><span class="annot"><span class="annottext">PathAbHomMap x y
</span><a href="#local-6989586621679087221"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Form (IsoAbHomMap x z) -&gt; IsoAbHomMap x z
forall x. Constructable x =&gt; Form x -&gt; x
</span><span class="hs-identifier hs-var">make</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PathAbHomMap y z
</span><a href="#local-6989586621679087219"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">PathAbHomMap y z -&gt; PathAbHomMap x y -&gt; Path AbHomMap x z
forall y z x.
Path AbHomMap y z -&gt; Path AbHomMap x y -&gt; Path AbHomMap x z
forall (c :: * -&gt; * -&gt; *) y z x.
Category c =&gt;
c y z -&gt; c x y -&gt; c x z
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PathAbHomMap x y
</span><a href="#local-6989586621679087221"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-439"></span><span>
</span><span id="line-440"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Cayleyan2</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#IsoAbHomMap"><span class="hs-identifier hs-type">IsoAbHomMap</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-441"></span><span>  </span><span id="local-6989586621679087231"><span class="annot"><span class="annottext">invert2 :: forall x y. IsoAbHomMap x y -&gt; IsoAbHomMap y x
</span><a href="#local-6989586621679087231"><span class="hs-identifier hs-var hs-var hs-var hs-var">invert2</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#IsoAbHomMap"><span class="hs-identifier hs-type">IsoAbHomMap</span></a></span><span> </span><span id="local-6989586621679087233"><span class="annot"><span class="annottext">PathAbHomMap x y
</span><a href="#local-6989586621679087233"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PathAbHomMap y x -&gt; IsoAbHomMap y x
forall x y. PathAbHomMap x y -&gt; IsoAbHomMap x y
</span><a href="OAlg.AbelianGroup.Definition.html#IsoAbHomMap"><span class="hs-identifier hs-var">IsoAbHomMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall u.
 Struct (ObjectClass AbHomMap) u -&gt; Struct (ObjectClass AbHomMap) u)
-&gt; (forall x y. AbHomMap x y -&gt; AbHomMap y x)
-&gt; PathAbHomMap x y
-&gt; PathAbHomMap y x
forall (m :: * -&gt; * -&gt; *) (f :: * -&gt; * -&gt; *) x y.
(Morphism m, Morphism f) =&gt;
(forall u. Struct (ObjectClass m) u -&gt; Struct (ObjectClass f) u)
-&gt; (forall u v. m u v -&gt; f v u) -&gt; Path m x y -&gt; Path f y x
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">Struct (ObjectClass AbHomMap) u -&gt; Struct (ObjectClass AbHomMap) u
Struct (Alg Z) u -&gt; Struct (Alg Z) u
forall x. x -&gt; x
forall u.
Struct (ObjectClass AbHomMap) u -&gt; Struct (ObjectClass AbHomMap) u
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="annot"><span class="annottext">AbHomMap u v -&gt; AbHomMap v u
forall x y. AbHomMap x y -&gt; AbHomMap y x
</span><a href="OAlg.AbelianGroup.Definition.html#invAbHomMap"><span class="hs-identifier hs-var">invAbHomMap</span></a></span><span> </span><span class="annot"><span class="annottext">PathAbHomMap x y
</span><a href="#local-6989586621679087233"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-442"></span><span>
</span><span id="line-443"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-444"></span><span class="hs-comment">-- IsoAbHomMap - Hom -</span><span>
</span><span id="line-445"></span><span>
</span><span id="line-446"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#IsoAbHomMap"><span class="hs-identifier hs-type">IsoAbHomMap</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-447"></span><span>  </span><span id="local-6989586621679087242"><span class="annot"><span class="annottext">amap :: forall a b. IsoAbHomMap a b -&gt; a -&gt; b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">amap</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Form (IsoAbHomMap a b) -&gt; a -&gt; b) -&gt; IsoAbHomMap a b -&gt; a -&gt; b
forall x y. Exposable x =&gt; (Form x -&gt; y) -&gt; x -&gt; y
</span><span class="hs-identifier hs-var">restrict</span></span><span> </span><span class="annot"><span class="annottext">Form (IsoAbHomMap a b) -&gt; a -&gt; b
Path AbHomMap a b -&gt; a -&gt; b
forall a b. Path AbHomMap a b -&gt; a -&gt; b
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><span class="hs-identifier hs-var">amap</span></span><span>
</span><span id="line-448"></span><span>
</span><span id="line-449"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EmbeddableMorphism</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#IsoAbHomMap"><span class="hs-identifier hs-type">IsoAbHomMap</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ort</span></span><span>
</span><span id="line-450"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EmbeddableMorphism</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#IsoAbHomMap"><span class="hs-identifier hs-type">IsoAbHomMap</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typ</span></span><span>
</span><span id="line-451"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EmbeddableMorphismTyp</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#IsoAbHomMap"><span class="hs-identifier hs-type">IsoAbHomMap</span></a></span><span>
</span><span id="line-452"></span><span>
</span><span id="line-453"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HomOriented</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#IsoAbHomMap"><span class="hs-identifier hs-type">IsoAbHomMap</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-454"></span><span>  </span><span id="local-6989586621679087275"><span class="annot"><span class="annottext">pmap :: forall a b. IsoAbHomMap a b -&gt; Point a -&gt; Point b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">pmap</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Form (IsoAbHomMap a b) -&gt; Point a -&gt; Point b)
-&gt; IsoAbHomMap a b -&gt; Point a -&gt; Point b
forall x y. Exposable x =&gt; (Form x -&gt; y) -&gt; x -&gt; y
</span><span class="hs-identifier hs-var">restrict</span></span><span> </span><span class="annot"><span class="annottext">Form (IsoAbHomMap a b) -&gt; Point a -&gt; Point b
Path AbHomMap a b -&gt; Point a -&gt; Point b
forall a b. Path AbHomMap a b -&gt; Point a -&gt; Point b
forall (h :: * -&gt; * -&gt; *) a b.
HomOriented h =&gt;
h a b -&gt; Point a -&gt; Point b
</span><span class="hs-identifier hs-var">pmap</span></span><span>
</span><span id="line-455"></span><span>
</span><span id="line-456"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EmbeddableMorphism</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#IsoAbHomMap"><span class="hs-identifier hs-type">IsoAbHomMap</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Mlt</span></span><span>
</span><span id="line-457"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HomMultiplicative</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#IsoAbHomMap"><span class="hs-identifier hs-type">IsoAbHomMap</span></a></span><span>
</span><span id="line-458"></span><span>
</span><span id="line-459"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-460"></span><span class="hs-comment">-- IsoAbHomMap - Functorial -</span><span>
</span><span id="line-461"></span><span>
</span><span id="line-462"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Functorial</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#IsoAbHomMap"><span class="hs-identifier hs-type">IsoAbHomMap</span></a></span><span>
</span><span id="line-463"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FunctorialHomOriented</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#IsoAbHomMap"><span class="hs-identifier hs-type">IsoAbHomMap</span></a></span><span>
</span><span id="line-464"></span><span>
</span><span id="line-465"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-466"></span><span class="hs-comment">-- abhProducts -</span><span>
</span><span id="line-467"></span><span>
</span><span id="line-468"></span><span class="annot"><span class="hs-comment">-- | products for 'AbHom'.</span></span><span>
</span><span id="line-469"></span><span id="local-6989586621679085657"><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#abhProducts"><span class="hs-identifier hs-type">abhProducts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Products</span></span><span> </span><span class="annot"><a href="#local-6989586621679085657"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span></span><span>
</span><span id="line-470"></span><span id="abhProducts"><span class="annot"><span class="annottext">abhProducts :: forall (n :: N'). Products n AbHom
</span><a href="OAlg.AbelianGroup.Definition.html#abhProducts"><span class="hs-identifier hs-var hs-var">abhProducts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IsoAbHomMap (Matrix ZModHom) AbHom
-&gt; Limits Mlt 'Projective 'Discrete n N0 (Matrix ZModHom)
-&gt; Limits Mlt 'Projective 'Discrete n N0 AbHom
forall s (h :: * -&gt; * -&gt; *) a b (p :: Perspective)
       (t :: DiagramType) (n :: N') (m :: N').
IsoOrt s h =&gt;
h a b -&gt; Limits s p t n m a -&gt; Limits s p t n m b
</span><span class="hs-identifier hs-var">lmsMap</span></span><span> </span><span class="annot"><span class="annottext">IsoAbHomMap (Matrix ZModHom) AbHom
</span><a href="OAlg.AbelianGroup.Definition.html#matrixAbHom"><span class="hs-identifier hs-var">matrixAbHom</span></a></span><span> </span><span class="annot"><span class="annottext">Limits Mlt 'Projective 'Discrete n N0 (Matrix ZModHom)
forall x (n :: N'). Distributive x =&gt; Products n (Matrix x)
</span><span class="hs-identifier hs-var">mtxProducts</span></span><span>
</span><span id="line-471"></span><span>
</span><span id="line-472"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-473"></span><span class="hs-comment">-- abhSums -</span><span>
</span><span id="line-474"></span><span>
</span><span id="line-475"></span><span class="annot"><span class="hs-comment">-- | sums for 'AbHom'.</span></span><span>
</span><span id="line-476"></span><span id="local-6989586621679085677"><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#abhSums"><span class="hs-identifier hs-type">abhSums</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Sums</span></span><span> </span><span class="annot"><a href="#local-6989586621679085677"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span></span><span>
</span><span id="line-477"></span><span id="abhSums"><span class="annot"><span class="annottext">abhSums :: forall (n :: N'). Sums n AbHom
</span><a href="OAlg.AbelianGroup.Definition.html#abhSums"><span class="hs-identifier hs-var hs-var">abhSums</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IsoAbHomMap (Matrix ZModHom) AbHom
-&gt; Limits Mlt 'Injective 'Discrete n N0 (Matrix ZModHom)
-&gt; Limits Mlt 'Injective 'Discrete n N0 AbHom
forall s (h :: * -&gt; * -&gt; *) a b (p :: Perspective)
       (t :: DiagramType) (n :: N') (m :: N').
IsoOrt s h =&gt;
h a b -&gt; Limits s p t n m a -&gt; Limits s p t n m b
</span><span class="hs-identifier hs-var">lmsMap</span></span><span> </span><span class="annot"><span class="annottext">IsoAbHomMap (Matrix ZModHom) AbHom
</span><a href="OAlg.AbelianGroup.Definition.html#matrixAbHom"><span class="hs-identifier hs-var">matrixAbHom</span></a></span><span> </span><span class="annot"><span class="annottext">Limits Mlt 'Injective 'Discrete n N0 (Matrix ZModHom)
forall x (n :: N'). Distributive x =&gt; Sums n (Matrix x)
</span><span class="hs-identifier hs-var">mtxSums</span></span><span>
</span><span id="line-478"></span><span>
</span><span id="line-479"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-480"></span><span class="hs-comment">-- abgFree -</span><span>
</span><span id="line-481"></span><span>
</span><span id="line-482"></span><span class="hs-comment">-- | the free abelian group of the given dimension.</span><span>
</span><span id="line-483"></span><span class="hs-comment">--</span><span>
</span><span id="line-484"></span><span class="hs-comment">-- &gt;&gt;&gt; abgFree (Free attest :: Free N6 AbGroup)</span><span>
</span><span id="line-485"></span><span class="hs-comment">-- AbGroup ProductSymbol[Z^6]</span><span>
</span><span id="line-486"></span><span id="local-6989586621679085683"><span id="local-6989586621679085684"><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#abgFree"><span class="hs-identifier hs-type">abgFree</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Free</span></span><span> </span><span class="annot"><a href="#local-6989586621679085683"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679085684"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbGroup"><span class="hs-identifier hs-type">AbGroup</span></a></span></span></span><span>
</span><span id="line-487"></span><span id="abgFree"><span class="annot"><span class="annottext">abgFree :: forall (k :: N') x. Free k x -&gt; AbGroup
</span><a href="OAlg.AbelianGroup.Definition.html#abgFree"><span class="hs-identifier hs-var hs-var">abgFree</span></a></span></span><span> </span><span id="local-6989586621679087319"><span class="annot"><span class="annottext">Free k x
</span><a href="#local-6989586621679087319"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">N -&gt; AbGroup
</span><a href="OAlg.AbelianGroup.Definition.html#abg"><span class="hs-identifier hs-var">abg</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">AbGroup -&gt; Exponent AbGroup -&gt; AbGroup
forall f. Exponential f =&gt; f -&gt; Exponent f -&gt; f
</span><span class="hs-operator hs-var">^</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Free k x -&gt; N
forall (k :: N') c. Free k c -&gt; N
</span><span class="hs-identifier hs-var">freeN</span></span><span> </span><span class="annot"><span class="annottext">Free k x
</span><a href="#local-6989586621679087319"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-488"></span><span>
</span><span id="line-489"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-490"></span><span class="hs-comment">-- Sliced (Free k) -</span><span>
</span><span id="line-491"></span><span>
</span><span id="line-492"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679085699"><span class="annot"><span class="hs-identifier hs-type">Attestable</span></span><span> </span><span class="annot"><a href="#local-6989586621679085699"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Sliced</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Free</span></span><span> </span><span class="annot"><a href="#local-6989586621679085699"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-493"></span><span>  </span><span id="local-6989586621679087333"><span class="annot"><span class="annottext">slicePoint :: Free k AbHom -&gt; Point AbHom
</span><a href="#local-6989586621679087333"><span class="hs-identifier hs-var hs-var hs-var hs-var">slicePoint</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Free k AbHom -&gt; Point AbHom
Free k AbHom -&gt; AbGroup
forall (k :: N') x. Free k x -&gt; AbGroup
</span><a href="OAlg.AbelianGroup.Definition.html#abgFree"><span class="hs-identifier hs-var">abgFree</span></a></span><span>
</span><span id="line-494"></span><span>
</span><span id="line-495"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-496"></span><span class="hs-comment">-- abgMaybeFree -</span><span>
</span><span id="line-497"></span><span>
</span><span id="line-498"></span><span class="hs-comment">-- | check of being free of some length.</span><span>
</span><span id="line-499"></span><span class="hs-comment">--</span><span>
</span><span id="line-500"></span><span class="hs-comment">-- &gt;&gt;&gt; abgMaybeFree (abg 0 ^ 5)</span><span>
</span><span id="line-501"></span><span class="hs-comment">-- Just (SomeFree (Free 5))</span><span>
</span><span id="line-502"></span><span class="hs-comment">--</span><span>
</span><span id="line-503"></span><span class="hs-comment">-- &gt;&gt;&gt; abgMaybeFree (abg 0 ^ 5 * abg 3)</span><span>
</span><span id="line-504"></span><span class="hs-comment">-- Nothing</span><span>
</span><span id="line-505"></span><span class="hs-comment">--</span><span>
</span><span id="line-506"></span><span class="hs-comment">-- &gt;&gt;&gt; abgMaybeFree (abg 0 ^ 5 * abg 3 ^ 0)</span><span>
</span><span id="line-507"></span><span class="hs-comment">-- Just (SomeFree (Free 5))</span><span>
</span><span id="line-508"></span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#abgMaybeFree"><span class="hs-identifier hs-type">abgMaybeFree</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbGroup"><span class="hs-identifier hs-type">AbGroup</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SomeFree</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-509"></span><span id="abgMaybeFree"><span class="annot"><span class="annottext">abgMaybeFree :: AbGroup -&gt; Maybe (SomeFree AbHom)
</span><a href="OAlg.AbelianGroup.Definition.html#abgMaybeFree"><span class="hs-identifier hs-var hs-var">abgMaybeFree</span></a></span></span><span> </span><span id="local-6989586621679087336"><span class="annot"><span class="annottext">AbGroup
</span><a href="#local-6989586621679087336"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">N -&gt; SomeNatural
</span><span class="hs-identifier hs-var">someNatural</span></span><span> </span><span class="annot"><span class="annottext">(N -&gt; SomeNatural) -&gt; N -&gt; SomeNatural
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">AbGroup -&gt; N
forall x. LengthN x =&gt; x -&gt; N
</span><span class="hs-identifier hs-var">lengthN</span></span><span> </span><span class="annot"><span class="annottext">AbGroup
</span><a href="#local-6989586621679087336"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-510"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">SomeNatural</span></span><span> </span><span id="local-6989586621679087343"><span class="annot"><span class="annottext">W n
</span><a href="#local-6989586621679087343"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">AbGroup
</span><a href="#local-6989586621679087336"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">AbGroup -&gt; AbGroup -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Free n AbHom -&gt; AbGroup
forall (k :: N') x. Free k x -&gt; AbGroup
</span><a href="OAlg.AbelianGroup.Definition.html#abgFree"><span class="hs-identifier hs-var">abgFree</span></a></span><span> </span><span class="annot"><span class="annottext">Free n AbHom
</span><a href="#local-6989586621679087344"><span class="hs-identifier hs-var">k'</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">SomeFree AbHom -&gt; Maybe (SomeFree AbHom)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Free n AbHom -&gt; SomeFree AbHom
forall (k :: N') c.
(Attestable k, Sliced (Free k) c) =&gt;
Free k c -&gt; SomeFree c
</span><span class="hs-identifier hs-var">SomeFree</span></span><span> </span><span class="annot"><span class="annottext">Free n AbHom
</span><a href="#local-6989586621679087344"><span class="hs-identifier hs-var">k'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe (SomeFree AbHom)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679087344"><span class="annot"><span class="annottext">k' :: Free n AbHom
</span><a href="#local-6989586621679087344"><span class="hs-identifier hs-var hs-var">k'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">W n -&gt; Free n AbHom
forall (k :: N') c. Any k -&gt; Free k c
</span><span class="hs-identifier hs-var">Free</span></span><span> </span><span class="annot"><span class="annottext">W n
</span><a href="#local-6989586621679087343"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-511"></span><span>
</span><span id="line-512"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-513"></span><span class="hs-comment">-- abgFrees -</span><span>
</span><span id="line-514"></span><span>
</span><span id="line-515"></span><span class="annot"><span class="hs-comment">-- | number of free components.</span></span><span>
</span><span id="line-516"></span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#abgFrees"><span class="hs-identifier hs-type">abgFrees</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbGroup"><span class="hs-identifier hs-type">AbGroup</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">N</span></span><span>
</span><span id="line-517"></span><span id="abgFrees"><span class="annot"><span class="annottext">abgFrees :: AbGroup -&gt; N
</span><a href="OAlg.AbelianGroup.Definition.html#abgFrees"><span class="hs-identifier hs-var hs-var">abgFrees</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(ZMod, N)] -&gt; N
forall x. LengthN x =&gt; x -&gt; N
</span><span class="hs-identifier hs-var">lengthN</span></span><span> </span><span class="annot"><span class="annottext">([(ZMod, N)] -&gt; N) -&gt; (AbGroup -&gt; [(ZMod, N)]) -&gt; AbGroup -&gt; N
forall y z x. (y -&gt; z) -&gt; (x -&gt; y) -&gt; x -&gt; z
forall (c :: * -&gt; * -&gt; *) y z x.
Category c =&gt;
c y z -&gt; c x y -&gt; c x z
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((ZMod, N) -&gt; Bool) -&gt; [(ZMod, N)] -&gt; [(ZMod, N)]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">ZMod -&gt; ZMod -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">N -&gt; ZMod
</span><a href="OAlg.AbelianGroup.ZMod.html#ZMod"><span class="hs-identifier hs-var">ZMod</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ZMod -&gt; Bool) -&gt; ((ZMod, N) -&gt; ZMod) -&gt; (ZMod, N) -&gt; Bool
forall y z x. (y -&gt; z) -&gt; (x -&gt; y) -&gt; x -&gt; z
forall (c :: * -&gt; * -&gt; *) y z x.
Category c =&gt;
c y z -&gt; c x y -&gt; c x z
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(ZMod, N) -&gt; ZMod
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(ZMod, N)] -&gt; [(ZMod, N)])
-&gt; (AbGroup -&gt; [(ZMod, N)]) -&gt; AbGroup -&gt; [(ZMod, N)]
forall y z x. (y -&gt; z) -&gt; (x -&gt; y) -&gt; x -&gt; z
forall (c :: * -&gt; * -&gt; *) y z x.
Category c =&gt;
c y z -&gt; c x y -&gt; c x z
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">AbGroup -&gt; [(ZMod, N)]
</span><a href="OAlg.AbelianGroup.Definition.html#abgxs"><span class="hs-identifier hs-var">abgxs</span></a></span><span>
</span><span id="line-518"></span><span>  </span><span>
</span><span id="line-519"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-520"></span><span class="hs-comment">-- AbHomFree -</span><span>
</span><span id="line-521"></span><span>
</span><span id="line-522"></span><span class="annot"><span class="hs-comment">-- | projection homomorphisms to @'Matrix' 'Z'@.</span></span><span>
</span><span id="line-523"></span><span class="hs-keyword">data</span><span> </span><span id="AbHomFree"><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHomFree"><span class="hs-identifier hs-var">AbHomFree</span></a></span></span><span> </span><span id="local-6989586621679087348"><span class="annot"><a href="#local-6989586621679087348"><span class="hs-identifier hs-type">x</span></a></span></span><span> </span><span id="local-6989586621679087349"><span class="annot"><a href="#local-6989586621679087349"><span class="hs-identifier hs-type">y</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-524"></span><span>  </span><span id="AbHomFree"><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHomFree"><span class="hs-identifier hs-var">AbHomFree</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHomFree"><span class="hs-identifier hs-type">AbHomFree</span></a></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Matrix</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Z</span></span><span class="hs-special">)</span><span>
</span><span id="line-525"></span><span>  </span><span id="FreeAbHom"><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#FreeAbHom"><span class="hs-identifier hs-var">FreeAbHom</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHomFree"><span class="hs-identifier hs-type">AbHomFree</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Matrix</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Z</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span><span>
</span><span id="line-526"></span><span>
</span><span id="line-527"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-528"></span><span class="hs-comment">-- AbHomFree - Entity -</span><span>
</span><span id="line-529"></span><span>
</span><span id="line-530"></span><span id="local-6989586621679085710"><span id="local-6989586621679085711"><span id="local-6989586621679087353"><span id="local-6989586621679087355"><span id="local-6989586621679087359"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHomFree"><span class="hs-identifier hs-type">AbHomFree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679085710"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679085711"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-531"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679087362"><span class="annot"><span class="hs-identifier hs-type">Show2</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHomFree"><span class="hs-identifier hs-type">AbHomFree</span></a></span></span><span>
</span><span id="line-532"></span><span id="local-6989586621679085716"><span id="local-6989586621679085717"><span id="local-6989586621679087367"><span id="local-6989586621679087369"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHomFree"><span class="hs-identifier hs-type">AbHomFree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679085716"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679085717"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-533"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679087373"><span class="annot"><span class="hs-identifier hs-type">Eq2</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHomFree"><span class="hs-identifier hs-type">AbHomFree</span></a></span></span><span>
</span><span id="line-534"></span><span>
</span><span id="line-535"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679085722"><span id="local-6989586621679085723"><span class="annot"><span class="hs-identifier hs-type">Validable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHomFree"><span class="hs-identifier hs-type">AbHomFree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679085722"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679085723"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-536"></span><span>  </span><span id="local-6989586621679087379"><span class="annot"><span class="annottext">valid :: AbHomFree x y -&gt; Statement
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">valid</span></span></span><span> </span><span class="annot"><span class="annottext">AbHomFree x y
</span><a href="OAlg.AbelianGroup.Definition.html#AbHomFree"><span class="hs-identifier hs-var">AbHomFree</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Statement
</span><span class="hs-identifier hs-var">SValid</span></span><span>
</span><span id="line-537"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">valid</span></span><span> </span><span class="annot"><span class="annottext">AbHomFree x y
</span><span class="hs-identifier">_</span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Statement
</span><span class="hs-identifier hs-var">SValid</span></span><span>
</span><span id="line-538"></span><span>
</span><span id="line-539"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679087383"><span class="annot"><span class="hs-identifier hs-type">Validable2</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHomFree"><span class="hs-identifier hs-type">AbHomFree</span></a></span></span><span>
</span><span id="line-540"></span><span>
</span><span id="line-541"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679085728"><span id="local-6989586621679085729"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="annot"><a href="#local-6989586621679085728"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="annot"><a href="#local-6989586621679085729"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Entity</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHomFree"><span class="hs-identifier hs-type">AbHomFree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679085728"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679085729"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-542"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Entity2</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHomFree"><span class="hs-identifier hs-type">AbHomFree</span></a></span><span>
</span><span id="line-543"></span><span>
</span><span id="line-544"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-545"></span><span class="hs-comment">-- AbHomFree - HomAlgebraic -</span><span>
</span><span id="line-546"></span><span>
</span><span id="line-547"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679087411"><span id="local-6989586621679087415"><span class="annot"><span class="hs-identifier hs-type">Morphism</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHomFree"><span class="hs-identifier hs-type">AbHomFree</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-548"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="ObjectClass"><span class="annot"><span class="hs-identifier hs-var">ObjectClass</span></span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHomFree"><span class="hs-identifier hs-type">AbHomFree</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Alg</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Z</span></span><span>
</span><span id="line-549"></span><span>  </span><span id="local-6989586621679087417"><span class="annot"><span class="annottext">homomorphous :: forall x y.
AbHomFree x y -&gt; Homomorphous (ObjectClass AbHomFree) x y
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">homomorphous</span></span></span><span> </span><span class="annot"><span class="annottext">AbHomFree x y
</span><a href="OAlg.AbelianGroup.Definition.html#AbHomFree"><span class="hs-identifier hs-var">AbHomFree</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Struct (Alg Z) x
forall s x. Structure s x =&gt; Struct s x
</span><span class="hs-identifier hs-var">Struct</span></span><span> </span><span class="annot"><span class="annottext">Struct (Alg Z) x -&gt; Struct (Alg Z) y -&gt; Homomorphous (Alg Z) x y
forall s x y. Struct s x -&gt; Struct s y -&gt; Homomorphous s x y
</span><span class="hs-operator hs-var">:&gt;:</span></span><span> </span><span class="annot"><span class="annottext">Struct (Alg Z) y
forall s x. Structure s x =&gt; Struct s x
</span><span class="hs-identifier hs-var">Struct</span></span><span>
</span><span id="line-550"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">homomorphous</span></span><span> </span><span class="annot"><span class="annottext">AbHomFree x y
</span><a href="OAlg.AbelianGroup.Definition.html#FreeAbHom"><span class="hs-identifier hs-var">FreeAbHom</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Struct (Alg Z) x
forall s x. Structure s x =&gt; Struct s x
</span><span class="hs-identifier hs-var">Struct</span></span><span> </span><span class="annot"><span class="annottext">Struct (Alg Z) x -&gt; Struct (Alg Z) y -&gt; Homomorphous (Alg Z) x y
forall s x y. Struct s x -&gt; Struct s y -&gt; Homomorphous s x y
</span><span class="hs-operator hs-var">:&gt;:</span></span><span> </span><span class="annot"><span class="annottext">Struct (Alg Z) y
forall s x. Structure s x =&gt; Struct s x
</span><span class="hs-identifier hs-var">Struct</span></span><span>
</span><span id="line-551"></span><span>
</span><span id="line-552"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EmbeddableMorphism</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHomFree"><span class="hs-identifier hs-type">AbHomFree</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ort</span></span><span>
</span><span id="line-553"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EmbeddableMorphism</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHomFree"><span class="hs-identifier hs-type">AbHomFree</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typ</span></span><span>
</span><span id="line-554"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EmbeddableMorphismTyp</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHomFree"><span class="hs-identifier hs-type">AbHomFree</span></a></span><span>
</span><span id="line-555"></span><span>
</span><span id="line-556"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHomFree"><span class="hs-identifier hs-type">AbHomFree</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-557"></span><span>  </span><span id="local-6989586621679087452"><span class="annot"><span class="annottext">amap :: forall a b. AbHomFree a b -&gt; a -&gt; b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">amap</span></span></span><span> </span><span class="annot"><span class="annottext">AbHomFree a b
</span><a href="OAlg.AbelianGroup.Definition.html#AbHomFree"><span class="hs-identifier hs-var">AbHomFree</span></a></span><span> </span><span id="local-6989586621679087467"><span class="annot"><span class="annottext">h :: a
</span><a href="#local-6989586621679087467"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Matrix</span></span><span> </span><span class="annot"><span class="annottext">Dim' ZModHom
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Dim' ZModHom
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679087468"><span class="annot"><span class="annottext">Entries N N ZModHom
</span><a href="#local-6989586621679087468"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dim' Z -&gt; Dim' Z -&gt; Entries N N Z -&gt; Matrix Z
forall x. Dim' x -&gt; Dim' x -&gt; Entries N N x -&gt; Matrix x
</span><span class="hs-identifier hs-var">Matrix</span></span><span> </span><span class="annot"><span class="annottext">Dim Z ()
Dim' Z
</span><a href="#local-6989586621679087469"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Dim Z ()
Dim' Z
</span><a href="#local-6989586621679087470"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Entries N N Z
</span><a href="#local-6989586621679087471"><span class="hs-identifier hs-var">xs'</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-558"></span><span>    </span><span id="local-6989586621679087472"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679087472"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&gt;</span></span><span> </span><span id="local-6989586621679087473"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679087473"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Orientation (Point a)
forall q. Oriented q =&gt; q -&gt; Orientation (Point q)
</span><span class="hs-identifier hs-var">orientation</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679087467"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-559"></span><span>    </span><span id="local-6989586621679087476"><span class="annot"><span class="annottext">u :: Dim Z ()
</span><a href="#local-6989586621679087476"><span class="hs-identifier hs-var hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; Dim Z ()
forall p x. (Entity p, p ~ Point x) =&gt; p -&gt; Dim x p
</span><span class="hs-identifier hs-var">dim</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-560"></span><span>    </span><span id="local-6989586621679087469"><span class="annot"><span class="annottext">n :: Dim Z ()
</span><a href="#local-6989586621679087469"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dim Z ()
</span><a href="#local-6989586621679087476"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">Dim Z () -&gt; Exponent (Dim Z ()) -&gt; Dim Z ()
forall f. Exponential f =&gt; f -&gt; Exponent f -&gt; f
</span><span class="hs-operator hs-var">^</span></span><span> </span><span class="annot"><span class="annottext">AbGroup -&gt; N
</span><a href="OAlg.AbelianGroup.Definition.html#abgFrees"><span class="hs-identifier hs-var">abgFrees</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
AbGroup
</span><a href="#local-6989586621679087473"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-561"></span><span>    </span><span id="local-6989586621679087470"><span class="annot"><span class="annottext">m :: Dim Z ()
</span><a href="#local-6989586621679087470"><span class="hs-identifier hs-var hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dim Z ()
</span><a href="#local-6989586621679087476"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">Dim Z () -&gt; Exponent (Dim Z ()) -&gt; Dim Z ()
forall f. Exponential f =&gt; f -&gt; Exponent f -&gt; f
</span><span class="hs-operator hs-var">^</span></span><span> </span><span class="annot"><span class="annottext">AbGroup -&gt; N
</span><a href="OAlg.AbelianGroup.Definition.html#abgFrees"><span class="hs-identifier hs-var">abgFrees</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
AbGroup
</span><a href="#local-6989586621679087472"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-562"></span><span>    </span><span>
</span><span id="line-563"></span><span>    </span><span id="local-6989586621679087471"><span class="annot"><span class="annottext">xs' :: Entries N N Z
</span><a href="#local-6989586621679087471"><span class="hs-identifier hs-var hs-var">xs'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Col N (Row N Z) -&gt; Entries N N Z
forall i j x. Col i (Row j x) -&gt; Entries i j x
</span><span class="hs-identifier hs-var">crets</span></span><span> </span><span class="annot"><span class="annottext">(Col N (Row N Z) -&gt; Entries N N Z)
-&gt; Col N (Row N Z) -&gt; Entries N N Z
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PSequence N (Row N Z) -&gt; Col N (Row N Z)
forall i x. PSequence i x -&gt; Col i x
</span><span class="hs-identifier hs-var">Col</span></span><span> </span><span class="annot"><span class="annottext">(PSequence N (Row N Z) -&gt; Col N (Row N Z))
-&gt; PSequence N (Row N Z) -&gt; Col N (Row N Z)
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(Row N Z, N)] -&gt; PSequence N (Row N Z)
forall i x. [(x, i)] -&gt; PSequence i x
</span><span class="hs-identifier hs-var">PSequence</span></span><span> </span><span class="annot"><span class="annottext">([(Row N Z, N)] -&gt; PSequence N (Row N Z))
-&gt; [(Row N Z, N)] -&gt; PSequence N (Row N Z)
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">N
-&gt; [(ZMod, N)]
-&gt; [(ZMod, N)]
-&gt; [(Row N ZModHom, N)]
-&gt; [(Row N Z, N)]
forall i j.
(i ~ N, j ~ N) =&gt;
i
-&gt; [(ZMod, i)]
-&gt; [(ZMod, j)]
-&gt; [(Row j ZModHom, i)]
-&gt; [(Row j Z, i)]
</span><a href="#local-6989586621679087480"><span class="hs-identifier hs-var">frees</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AbGroup -&gt; [(ZMod, N)]
</span><a href="OAlg.AbelianGroup.Definition.html#abgxs"><span class="hs-identifier hs-var">abgxs</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
AbGroup
</span><a href="#local-6989586621679087473"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AbGroup -&gt; [(ZMod, N)]
</span><a href="OAlg.AbelianGroup.Definition.html#abgxs"><span class="hs-identifier hs-var">abgxs</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
AbGroup
</span><a href="#local-6989586621679087472"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(Row N ZModHom, N)] -&gt; [(Row N Z, N)])
-&gt; [(Row N ZModHom, N)] -&gt; [(Row N Z, N)]
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Col N (Row N ZModHom) -&gt; [(Row N ZModHom, N)]
forall i x. Col i x -&gt; [(x, i)]
</span><span class="hs-identifier hs-var">colxs</span></span><span> </span><span class="annot"><span class="annottext">(Col N (Row N ZModHom) -&gt; [(Row N ZModHom, N)])
-&gt; Col N (Row N ZModHom) -&gt; [(Row N ZModHom, N)]
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Entries N N ZModHom -&gt; Col N (Row N ZModHom)
forall i j x. Eq i =&gt; Entries i j x -&gt; Col i (Row j x)
</span><span class="hs-identifier hs-var">etscr</span></span><span> </span><span class="annot"><span class="annottext">Entries N N ZModHom
</span><a href="#local-6989586621679087468"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-564"></span><span>
</span><span id="line-565"></span><span>    </span><span id="local-6989586621679085744"><span id="local-6989586621679085745"><span class="annot"><a href="#local-6989586621679087480"><span class="hs-identifier hs-type">frees</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679085744"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">N</span></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679085745"><span class="hs-identifier hs-type">j</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">N</span></span><span class="hs-special">)</span><span>
</span><span id="line-566"></span><span>      </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679085744"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="OAlg.AbelianGroup.ZMod.html#ZMod"><span class="hs-identifier hs-type">ZMod</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679085744"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="OAlg.AbelianGroup.ZMod.html#ZMod"><span class="hs-identifier hs-type">ZMod</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679085745"><span class="hs-identifier hs-type">j</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Row</span></span><span> </span><span class="annot"><a href="#local-6989586621679085745"><span class="hs-identifier hs-type">j</span></a></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.ZMod.html#ZModHom"><span class="hs-identifier hs-type">ZModHom</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679085744"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Row</span></span><span> </span><span class="annot"><a href="#local-6989586621679085745"><span class="hs-identifier hs-type">j</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Z</span></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679085744"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span></span><span>
</span><span id="line-567"></span><span>    </span><span id="local-6989586621679087480"><span class="annot"><span class="annottext">frees :: forall i j.
(i ~ N, j ~ N) =&gt;
i
-&gt; [(ZMod, i)]
-&gt; [(ZMod, j)]
-&gt; [(Row j ZModHom, i)]
-&gt; [(Row j Z, i)]
</span><a href="#local-6989586621679087480"><span class="hs-identifier hs-var hs-var">frees</span></a></span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[(ZMod, j)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[(Row j ZModHom, i)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-568"></span><span>    </span><span class="annot"><a href="#local-6989586621679087480"><span class="hs-identifier hs-var">frees</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[(ZMod, i)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[(ZMod, j)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-569"></span><span>    </span><span class="annot"><a href="#local-6989586621679087480"><span class="hs-identifier hs-var">frees</span></a></span><span> </span><span id="local-6989586621679087506"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679087506"><span class="hs-identifier hs-var">i''</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="OAlg.AbelianGroup.ZMod.html#ZMod"><span class="hs-identifier hs-type">ZMod</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span id="local-6989586621679087507"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679087507"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679087508"><span class="annot"><span class="annottext">[(ZMod, i)]
</span><a href="#local-6989586621679087508"><span class="hs-identifier hs-var">is'</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679087509"><span class="annot"><span class="annottext">[(ZMod, j)]
</span><a href="#local-6989586621679087509"><span class="hs-identifier hs-var">js</span></a></span></span><span> </span><span id="local-6989586621679087510"><span class="annot"><span class="annottext">rws :: [(Row j ZModHom, i)]
</span><a href="#local-6989586621679087510"><span class="hs-identifier hs-var">rws</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679087511"><span class="annot"><span class="annottext">Row j ZModHom
</span><a href="#local-6989586621679087511"><span class="hs-identifier hs-var">rw</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679087512"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679087512"><span class="hs-identifier hs-var">i'</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679087513"><span class="annot"><span class="annottext">[(Row j ZModHom, i)]
</span><a href="#local-6989586621679087513"><span class="hs-identifier hs-var">rws'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679087507"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">i -&gt; i -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679087512"><span class="hs-identifier hs-var">i'</span></a></span><span>
</span><span id="line-570"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">i
-&gt; [(ZMod, i)]
-&gt; [(ZMod, j)]
-&gt; [(Row j ZModHom, i)]
-&gt; [(Row j Z, i)]
forall i j.
(i ~ N, j ~ N) =&gt;
i
-&gt; [(ZMod, i)]
-&gt; [(ZMod, j)]
-&gt; [(Row j ZModHom, i)]
-&gt; [(Row j Z, i)]
</span><a href="#local-6989586621679087480"><span class="hs-identifier hs-var">frees</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i -&gt; i
forall a. Enum a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">succ</span></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679087506"><span class="hs-identifier hs-var">i''</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(ZMod, i)]
</span><a href="#local-6989586621679087508"><span class="hs-identifier hs-var">is'</span></a></span><span> </span><span class="annot"><span class="annottext">[(ZMod, j)]
</span><a href="#local-6989586621679087509"><span class="hs-identifier hs-var">js</span></a></span><span> </span><span class="annot"><span class="annottext">[(Row j ZModHom, i)]
</span><a href="#local-6989586621679087510"><span class="hs-identifier hs-var">rws</span></a></span><span>
</span><span id="line-571"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">PSequence N Z -&gt; Row j Z
PSequence N Z -&gt; Row N Z
forall j x. PSequence j x -&gt; Row j x
</span><span class="hs-identifier hs-var">Row</span></span><span> </span><span class="annot"><span class="annottext">(PSequence N Z -&gt; Row j Z) -&gt; PSequence N Z -&gt; Row j Z
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(Z, j)] -&gt; PSequence N Z
[(Z, N)] -&gt; PSequence N Z
forall i x. [(x, i)] -&gt; PSequence i x
</span><span class="hs-identifier hs-var">PSequence</span></span><span> </span><span class="annot"><span class="annottext">([(Z, j)] -&gt; PSequence N Z) -&gt; [(Z, j)] -&gt; PSequence N Z
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">j -&gt; [(ZMod, j)] -&gt; [(ZModHom, j)] -&gt; [(Z, j)]
forall j. (j ~ N) =&gt; j -&gt; [(ZMod, j)] -&gt; [(ZModHom, j)] -&gt; [(Z, j)]
</span><a href="#local-6989586621679087517"><span class="hs-identifier hs-var">rwFrees</span></a></span><span> </span><span class="annot"><span class="annottext">j
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">[(ZMod, j)]
</span><a href="#local-6989586621679087509"><span class="hs-identifier hs-var">js</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Row j ZModHom -&gt; [(ZModHom, j)]
forall j x. Row j x -&gt; [(x, j)]
</span><span class="hs-identifier hs-var">rowxs</span></span><span> </span><span class="annot"><span class="annottext">Row j ZModHom
</span><a href="#local-6989586621679087511"><span class="hs-identifier hs-var">rw</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679087506"><span class="hs-identifier hs-var">i''</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">(Row j Z, i) -&gt; [(Row j Z, i)] -&gt; [(Row j Z, i)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">i
-&gt; [(ZMod, i)]
-&gt; [(ZMod, j)]
-&gt; [(Row j ZModHom, i)]
-&gt; [(Row j Z, i)]
forall i j.
(i ~ N, j ~ N) =&gt;
i
-&gt; [(ZMod, i)]
-&gt; [(ZMod, j)]
-&gt; [(Row j ZModHom, i)]
-&gt; [(Row j Z, i)]
</span><a href="#local-6989586621679087480"><span class="hs-identifier hs-var">frees</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i -&gt; i
forall a. Enum a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">succ</span></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679087506"><span class="hs-identifier hs-var">i''</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(ZMod, i)]
</span><a href="#local-6989586621679087508"><span class="hs-identifier hs-var">is'</span></a></span><span> </span><span class="annot"><span class="annottext">[(ZMod, j)]
</span><a href="#local-6989586621679087509"><span class="hs-identifier hs-var">js</span></a></span><span> </span><span class="annot"><span class="annottext">[(Row j ZModHom, i)]
</span><a href="#local-6989586621679087513"><span class="hs-identifier hs-var">rws'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-572"></span><span>    </span><span class="annot"><a href="#local-6989586621679087480"><span class="hs-identifier hs-var">frees</span></a></span><span> </span><span id="local-6989586621679087519"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679087519"><span class="hs-identifier hs-var">i''</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="OAlg.AbelianGroup.ZMod.html#ZMod"><span class="hs-identifier hs-type">ZMod</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679087520"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679087520"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679087521"><span class="annot"><span class="annottext">[(ZMod, i)]
</span><a href="#local-6989586621679087521"><span class="hs-identifier hs-var">is'</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679087522"><span class="annot"><span class="annottext">[(ZMod, j)]
</span><a href="#local-6989586621679087522"><span class="hs-identifier hs-var">js</span></a></span></span><span> </span><span id="local-6989586621679087523"><span class="annot"><span class="annottext">rws :: [(Row j ZModHom, i)]
</span><a href="#local-6989586621679087523"><span class="hs-identifier hs-var">rws</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Row j ZModHom
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679087524"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679087524"><span class="hs-identifier hs-var">i'</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679087525"><span class="annot"><span class="annottext">[(Row j ZModHom, i)]
</span><a href="#local-6989586621679087525"><span class="hs-identifier hs-var">rws'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679087520"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">i -&gt; i -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679087524"><span class="hs-identifier hs-var">i'</span></a></span><span>
</span><span id="line-573"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">i
-&gt; [(ZMod, i)]
-&gt; [(ZMod, j)]
-&gt; [(Row j ZModHom, i)]
-&gt; [(Row j Z, i)]
forall i j.
(i ~ N, j ~ N) =&gt;
i
-&gt; [(ZMod, i)]
-&gt; [(ZMod, j)]
-&gt; [(Row j ZModHom, i)]
-&gt; [(Row j Z, i)]
</span><a href="#local-6989586621679087480"><span class="hs-identifier hs-var">frees</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679087519"><span class="hs-identifier hs-var">i''</span></a></span><span> </span><span class="annot"><span class="annottext">[(ZMod, i)]
</span><a href="#local-6989586621679087521"><span class="hs-identifier hs-var">is'</span></a></span><span> </span><span class="annot"><span class="annottext">[(ZMod, j)]
</span><a href="#local-6989586621679087522"><span class="hs-identifier hs-var">js</span></a></span><span> </span><span class="annot"><span class="annottext">[(Row j ZModHom, i)]
</span><a href="#local-6989586621679087523"><span class="hs-identifier hs-var">rws</span></a></span><span>
</span><span id="line-574"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">i
-&gt; [(ZMod, i)]
-&gt; [(ZMod, j)]
-&gt; [(Row j ZModHom, i)]
-&gt; [(Row j Z, i)]
forall i j.
(i ~ N, j ~ N) =&gt;
i
-&gt; [(ZMod, i)]
-&gt; [(ZMod, j)]
-&gt; [(Row j ZModHom, i)]
-&gt; [(Row j Z, i)]
</span><a href="#local-6989586621679087480"><span class="hs-identifier hs-var">frees</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679087519"><span class="hs-identifier hs-var">i''</span></a></span><span> </span><span class="annot"><span class="annottext">[(ZMod, i)]
</span><a href="#local-6989586621679087521"><span class="hs-identifier hs-var">is'</span></a></span><span> </span><span class="annot"><span class="annottext">[(ZMod, j)]
</span><a href="#local-6989586621679087522"><span class="hs-identifier hs-var">js</span></a></span><span> </span><span class="annot"><span class="annottext">[(Row j ZModHom, i)]
</span><a href="#local-6989586621679087525"><span class="hs-identifier hs-var">rws'</span></a></span><span>
</span><span id="line-575"></span><span>
</span><span id="line-576"></span><span>    </span><span id="local-6989586621679085756"><span class="annot"><a href="#local-6989586621679087517"><span class="hs-identifier hs-type">rwFrees</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679085756"><span class="hs-identifier hs-type">j</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">N</span></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679085756"><span class="hs-identifier hs-type">j</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="OAlg.AbelianGroup.ZMod.html#ZMod"><span class="hs-identifier hs-type">ZMod</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679085756"><span class="hs-identifier hs-type">j</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="OAlg.AbelianGroup.ZMod.html#ZModHom"><span class="hs-identifier hs-type">ZModHom</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679085756"><span class="hs-identifier hs-type">j</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Z</span></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679085756"><span class="hs-identifier hs-type">j</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-577"></span><span>    </span><span id="local-6989586621679087517"><span class="annot"><span class="annottext">rwFrees :: forall j. (j ~ N) =&gt; j -&gt; [(ZMod, j)] -&gt; [(ZModHom, j)] -&gt; [(Z, j)]
</span><a href="#local-6989586621679087517"><span class="hs-identifier hs-var hs-var">rwFrees</span></a></span></span><span> </span><span class="annot"><span class="annottext">j
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[(ZModHom, j)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-578"></span><span>    </span><span class="annot"><a href="#local-6989586621679087517"><span class="hs-identifier hs-var">rwFrees</span></a></span><span> </span><span class="annot"><span class="annottext">j
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[(ZMod, j)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-579"></span><span>    </span><span class="annot"><a href="#local-6989586621679087517"><span class="hs-identifier hs-var">rwFrees</span></a></span><span> </span><span id="local-6989586621679087539"><span class="annot"><span class="annottext">j
</span><a href="#local-6989586621679087539"><span class="hs-identifier hs-var">j''</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="OAlg.AbelianGroup.ZMod.html#ZMod"><span class="hs-identifier hs-type">ZMod</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span id="local-6989586621679087540"><span class="annot"><span class="annottext">j
</span><a href="#local-6989586621679087540"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679087541"><span class="annot"><span class="annottext">[(ZMod, j)]
</span><a href="#local-6989586621679087541"><span class="hs-identifier hs-var">js'</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679087542"><span class="annot"><span class="annottext">hs :: [(ZModHom, j)]
</span><a href="#local-6989586621679087542"><span class="hs-identifier hs-var">hs</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679087543"><span class="annot"><span class="annottext">ZModHom
</span><a href="#local-6989586621679087543"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679087544"><span class="annot"><span class="annottext">j
</span><a href="#local-6989586621679087544"><span class="hs-identifier hs-var">j'</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679087545"><span class="annot"><span class="annottext">[(ZModHom, j)]
</span><a href="#local-6989586621679087545"><span class="hs-identifier hs-var">hs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">j
</span><a href="#local-6989586621679087540"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">j -&gt; j -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">j
</span><a href="#local-6989586621679087544"><span class="hs-identifier hs-var">j'</span></a></span><span>
</span><span id="line-580"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">j -&gt; [(ZMod, j)] -&gt; [(ZModHom, j)] -&gt; [(Z, j)]
forall j. (j ~ N) =&gt; j -&gt; [(ZMod, j)] -&gt; [(ZModHom, j)] -&gt; [(Z, j)]
</span><a href="#local-6989586621679087517"><span class="hs-identifier hs-var">rwFrees</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">j -&gt; j
forall a. Enum a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">succ</span></span><span> </span><span class="annot"><span class="annottext">j
</span><a href="#local-6989586621679087539"><span class="hs-identifier hs-var">j''</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(ZMod, j)]
</span><a href="#local-6989586621679087541"><span class="hs-identifier hs-var">js'</span></a></span><span> </span><span class="annot"><span class="annottext">[(ZModHom, j)]
</span><a href="#local-6989586621679087542"><span class="hs-identifier hs-var">hs</span></a></span><span>
</span><span id="line-581"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">ZModHom -&gt; Z
</span><a href="OAlg.AbelianGroup.ZMod.html#toZ"><span class="hs-identifier hs-var">toZ</span></a></span><span> </span><span class="annot"><span class="annottext">ZModHom
</span><a href="#local-6989586621679087543"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">j
</span><a href="#local-6989586621679087539"><span class="hs-identifier hs-var">j''</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">(Z, j) -&gt; [(Z, j)] -&gt; [(Z, j)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">j -&gt; [(ZMod, j)] -&gt; [(ZModHom, j)] -&gt; [(Z, j)]
forall j. (j ~ N) =&gt; j -&gt; [(ZMod, j)] -&gt; [(ZModHom, j)] -&gt; [(Z, j)]
</span><a href="#local-6989586621679087517"><span class="hs-identifier hs-var">rwFrees</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">j -&gt; j
forall a. Enum a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">succ</span></span><span> </span><span class="annot"><span class="annottext">j
</span><a href="#local-6989586621679087539"><span class="hs-identifier hs-var">j''</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(ZMod, j)]
</span><a href="#local-6989586621679087541"><span class="hs-identifier hs-var">js'</span></a></span><span> </span><span class="annot"><span class="annottext">[(ZModHom, j)]
</span><a href="#local-6989586621679087545"><span class="hs-identifier hs-var">hs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-582"></span><span>    </span><span class="annot"><a href="#local-6989586621679087517"><span class="hs-identifier hs-var">rwFrees</span></a></span><span> </span><span id="local-6989586621679087546"><span class="annot"><span class="annottext">j
</span><a href="#local-6989586621679087546"><span class="hs-identifier hs-var">j''</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="OAlg.AbelianGroup.ZMod.html#ZMod"><span class="hs-identifier hs-type">ZMod</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679087547"><span class="annot"><span class="annottext">j
</span><a href="#local-6989586621679087547"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679087548"><span class="annot"><span class="annottext">[(ZMod, j)]
</span><a href="#local-6989586621679087548"><span class="hs-identifier hs-var">js'</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679087549"><span class="annot"><span class="annottext">hs :: [(ZModHom, j)]
</span><a href="#local-6989586621679087549"><span class="hs-identifier hs-var">hs</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">ZModHom
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679087550"><span class="annot"><span class="annottext">j
</span><a href="#local-6989586621679087550"><span class="hs-identifier hs-var">j'</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679087551"><span class="annot"><span class="annottext">[(ZModHom, j)]
</span><a href="#local-6989586621679087551"><span class="hs-identifier hs-var">hs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">j
</span><a href="#local-6989586621679087547"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">j -&gt; j -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">j
</span><a href="#local-6989586621679087550"><span class="hs-identifier hs-var">j'</span></a></span><span>
</span><span id="line-583"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">j -&gt; [(ZMod, j)] -&gt; [(ZModHom, j)] -&gt; [(Z, j)]
forall j. (j ~ N) =&gt; j -&gt; [(ZMod, j)] -&gt; [(ZModHom, j)] -&gt; [(Z, j)]
</span><a href="#local-6989586621679087517"><span class="hs-identifier hs-var">rwFrees</span></a></span><span> </span><span class="annot"><span class="annottext">j
</span><a href="#local-6989586621679087546"><span class="hs-identifier hs-var">j''</span></a></span><span> </span><span class="annot"><span class="annottext">[(ZMod, j)]
</span><a href="#local-6989586621679087548"><span class="hs-identifier hs-var">js'</span></a></span><span> </span><span class="annot"><span class="annottext">[(ZModHom, j)]
</span><a href="#local-6989586621679087549"><span class="hs-identifier hs-var">hs</span></a></span><span>
</span><span id="line-584"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">j -&gt; [(ZMod, j)] -&gt; [(ZModHom, j)] -&gt; [(Z, j)]
forall j. (j ~ N) =&gt; j -&gt; [(ZMod, j)] -&gt; [(ZModHom, j)] -&gt; [(Z, j)]
</span><a href="#local-6989586621679087517"><span class="hs-identifier hs-var">rwFrees</span></a></span><span> </span><span class="annot"><span class="annottext">j
</span><a href="#local-6989586621679087546"><span class="hs-identifier hs-var">j''</span></a></span><span> </span><span class="annot"><span class="annottext">[(ZMod, j)]
</span><a href="#local-6989586621679087548"><span class="hs-identifier hs-var">js'</span></a></span><span> </span><span class="annot"><span class="annottext">[(ZModHom, j)]
</span><a href="#local-6989586621679087551"><span class="hs-identifier hs-var">hs'</span></a></span><span>
</span><span id="line-585"></span><span>    </span><span>
</span><span id="line-586"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">amap</span></span><span> </span><span class="annot"><span class="annottext">AbHomFree a b
</span><a href="OAlg.AbelianGroup.Definition.html#FreeAbHom"><span class="hs-identifier hs-var">FreeAbHom</span></a></span><span> </span><span id="local-6989586621679087554"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679087554"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix Z -&gt; AbHom
</span><a href="OAlg.AbelianGroup.Definition.html#zabh"><span class="hs-identifier hs-var">zabh</span></a></span><span> </span><span class="annot"><span class="annottext">a
Matrix Z
</span><a href="#local-6989586621679087554"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-587"></span><span>
</span><span id="line-588"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HomOriented</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHomFree"><span class="hs-identifier hs-type">AbHomFree</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-589"></span><span>  </span><span id="local-6989586621679087567"><span class="annot"><span class="annottext">pmap :: forall a b. AbHomFree a b -&gt; Point a -&gt; Point b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">pmap</span></span></span><span> </span><span class="annot"><span class="annottext">AbHomFree a b
</span><a href="OAlg.AbelianGroup.Definition.html#AbHomFree"><span class="hs-identifier hs-var">AbHomFree</span></a></span><span> </span><span id="local-6989586621679087574"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679087574"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; Dim Z ()
forall p x. (Entity p, p ~ Point x) =&gt; p -&gt; Dim x p
</span><span class="hs-identifier hs-var">dim</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Dim Z () -&gt; Exponent (Dim Z ()) -&gt; Dim Z ()
forall f. Exponential f =&gt; f -&gt; Exponent f -&gt; f
</span><span class="hs-operator hs-var">^</span></span><span> </span><span class="annot"><span class="annottext">AbGroup -&gt; N
</span><a href="OAlg.AbelianGroup.Definition.html#abgFrees"><span class="hs-identifier hs-var">abgFrees</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
AbGroup
</span><a href="#local-6989586621679087574"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-590"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pmap</span></span><span> </span><span class="annot"><span class="annottext">AbHomFree a b
</span><a href="OAlg.AbelianGroup.Definition.html#FreeAbHom"><span class="hs-identifier hs-var">FreeAbHom</span></a></span><span> </span><span id="local-6989586621679087580"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679087580"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">N -&gt; AbGroup
</span><a href="OAlg.AbelianGroup.Definition.html#abg"><span class="hs-identifier hs-var">abg</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">AbGroup -&gt; Exponent AbGroup -&gt; AbGroup
forall f. Exponential f =&gt; f -&gt; Exponent f -&gt; f
</span><span class="hs-operator hs-var">^</span></span><span> </span><span class="annot"><span class="annottext">Dim Z () -&gt; N
forall x. LengthN x =&gt; x -&gt; N
</span><span class="hs-identifier hs-var">lengthN</span></span><span> </span><span class="annot"><span class="annottext">Point a
Dim Z ()
</span><a href="#local-6989586621679087580"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-591"></span><span>
</span><span id="line-592"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EmbeddableMorphism</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHomFree"><span class="hs-identifier hs-type">AbHomFree</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Mlt</span></span><span>
</span><span id="line-593"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HomMultiplicative</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHomFree"><span class="hs-identifier hs-type">AbHomFree</span></a></span><span>
</span><span id="line-594"></span><span>
</span><span id="line-595"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EmbeddableMorphism</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHomFree"><span class="hs-identifier hs-type">AbHomFree</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fbr</span></span><span>
</span><span id="line-596"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EmbeddableMorphism</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHomFree"><span class="hs-identifier hs-type">AbHomFree</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">FbrOrt</span></span><span>
</span><span id="line-597"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679087615"><span class="annot"><span class="hs-identifier hs-type">HomFibred</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHomFree"><span class="hs-identifier hs-type">AbHomFree</span></a></span></span><span>
</span><span id="line-598"></span><span>
</span><span id="line-599"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HomFibredOriented</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHomFree"><span class="hs-identifier hs-type">AbHomFree</span></a></span><span>
</span><span id="line-600"></span><span>
</span><span id="line-601"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EmbeddableMorphism</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHomFree"><span class="hs-identifier hs-type">AbHomFree</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Add</span></span><span>
</span><span id="line-602"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HomAdditive</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHomFree"><span class="hs-identifier hs-type">AbHomFree</span></a></span><span>
</span><span id="line-603"></span><span>
</span><span id="line-604"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EmbeddableMorphism</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHomFree"><span class="hs-identifier hs-type">AbHomFree</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dst</span></span><span>
</span><span id="line-605"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HomDistributive</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHomFree"><span class="hs-identifier hs-type">AbHomFree</span></a></span><span>
</span><span id="line-606"></span><span>
</span><span id="line-607"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-608"></span><span class="hs-comment">-- abhFreeAdjucntion -</span><span>
</span><span id="line-609"></span><span>
</span><span id="line-610"></span><span class="annot"><span class="hs-comment">-- | the projection 'AbHomFree' as left adjoint.</span></span><span>
</span><span id="line-611"></span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#abhFreeAdjunction"><span class="hs-identifier hs-type">abhFreeAdjunction</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Adjunction</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHomFree"><span class="hs-identifier hs-type">AbHomFree</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Matrix</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Z</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span><span>
</span><span id="line-612"></span><span id="abhFreeAdjunction"><span class="annot"><span class="annottext">abhFreeAdjunction :: Adjunction AbHomFree (Matrix Z) AbHom
</span><a href="OAlg.AbelianGroup.Definition.html#abhFreeAdjunction"><span class="hs-identifier hs-var hs-var">abhFreeAdjunction</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AbHomFree AbHom (Matrix Z)
-&gt; AbHomFree (Matrix Z) AbHom
-&gt; (Point AbHom -&gt; AbHom)
-&gt; (Point (Matrix Z) -&gt; Matrix Z)
-&gt; Adjunction AbHomFree (Matrix Z) AbHom
forall (h :: * -&gt; * -&gt; *) c d.
h c d
-&gt; h d c -&gt; (Point c -&gt; c) -&gt; (Point d -&gt; d) -&gt; Adjunction h d c
</span><span class="hs-identifier hs-var">Adjunction</span></span><span> </span><span class="annot"><span class="annottext">AbHomFree AbHom (Matrix Z)
</span><a href="OAlg.AbelianGroup.Definition.html#AbHomFree"><span class="hs-identifier hs-var">AbHomFree</span></a></span><span> </span><span class="annot"><span class="annottext">AbHomFree (Matrix Z) AbHom
</span><a href="OAlg.AbelianGroup.Definition.html#FreeAbHom"><span class="hs-identifier hs-var">FreeAbHom</span></a></span><span> </span><span class="annot"><span class="annottext">Point AbHom -&gt; AbHom
AbGroup -&gt; AbHom
</span><a href="#local-6989586621679087660"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">Point (Matrix Z) -&gt; Matrix Z
forall c. Multiplicative c =&gt; Point c -&gt; c
</span><span class="hs-identifier hs-var">one</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-613"></span><span>  </span><span class="annot"><a href="#local-6989586621679087660"><span class="hs-identifier hs-type">u</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbGroup"><span class="hs-identifier hs-type">AbGroup</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span><span>
</span><span id="line-614"></span><span>  </span><span id="local-6989586621679087660"><span class="annot"><span class="annottext">u :: AbGroup -&gt; AbHom
</span><a href="#local-6989586621679087660"><span class="hs-identifier hs-var hs-var">u</span></a></span></span><span> </span><span id="local-6989586621679087661"><span class="annot"><span class="annottext">AbGroup
</span><a href="#local-6989586621679087661"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix ZModHom -&gt; AbHom
</span><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-var">AbHom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dim' ZModHom
-&gt; Dim' ZModHom -&gt; Entries N N ZModHom -&gt; Matrix ZModHom
forall x. Dim' x -&gt; Dim' x -&gt; Entries N N x -&gt; Matrix x
</span><span class="hs-identifier hs-var">Matrix</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AbGroup -&gt; Dim' ZModHom
</span><a href="OAlg.AbelianGroup.Definition.html#abgDim"><span class="hs-identifier hs-var">abgDim</span></a></span><span> </span><span class="annot"><span class="annottext">Point AbHom
AbGroup
</span><a href="#local-6989586621679087662"><span class="hs-identifier hs-var">g'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AbGroup -&gt; Dim' ZModHom
</span><a href="OAlg.AbelianGroup.Definition.html#abgDim"><span class="hs-identifier hs-var">abgDim</span></a></span><span> </span><span class="annot"><span class="annottext">AbGroup
</span><a href="#local-6989586621679087661"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PSequence (N, N) ZModHom -&gt; Entries N N ZModHom
forall i j x. PSequence (i, j) x -&gt; Entries i j x
</span><span class="hs-identifier hs-var">Entries</span></span><span> </span><span class="annot"><span class="annottext">(PSequence (N, N) ZModHom -&gt; Entries N N ZModHom)
-&gt; PSequence (N, N) ZModHom -&gt; Entries N N ZModHom
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(ZModHom, (N, N))] -&gt; PSequence (N, N) ZModHom
forall i x. [(x, i)] -&gt; PSequence i x
</span><span class="hs-identifier hs-var">PSequence</span></span><span> </span><span class="annot"><span class="annottext">([(ZModHom, (N, N))] -&gt; PSequence (N, N) ZModHom)
-&gt; [(ZModHom, (N, N))] -&gt; PSequence (N, N) ZModHom
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">N -&gt; [(ZMod, N)] -&gt; [(ZModHom, (N, N))]
forall i j. Enum i =&gt; i -&gt; [(ZMod, j)] -&gt; [(ZModHom, (i, j))]
</span><a href="#local-6989586621679087664"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AbGroup -&gt; [(ZMod, N)]
</span><a href="OAlg.AbelianGroup.Definition.html#abgxs"><span class="hs-identifier hs-var">abgxs</span></a></span><span> </span><span class="annot"><span class="annottext">AbGroup
</span><a href="#local-6989586621679087661"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-615"></span><span>    </span><span id="local-6989586621679087662"><span class="annot"><span class="annottext">g' :: Point AbHom
</span><a href="#local-6989586621679087662"><span class="hs-identifier hs-var hs-var">g'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AbHomFree (Matrix Z) AbHom -&gt; Point (Matrix Z) -&gt; Point AbHom
forall a b. AbHomFree a b -&gt; Point a -&gt; Point b
forall (h :: * -&gt; * -&gt; *) a b.
HomOriented h =&gt;
h a b -&gt; Point a -&gt; Point b
</span><span class="hs-identifier hs-var">pmap</span></span><span> </span><span class="annot"><span class="annottext">AbHomFree (Matrix Z) AbHom
</span><a href="OAlg.AbelianGroup.Definition.html#FreeAbHom"><span class="hs-identifier hs-var">FreeAbHom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AbHomFree AbHom (Matrix Z) -&gt; Point AbHom -&gt; Point (Matrix Z)
forall a b. AbHomFree a b -&gt; Point a -&gt; Point b
forall (h :: * -&gt; * -&gt; *) a b.
HomOriented h =&gt;
h a b -&gt; Point a -&gt; Point b
</span><span class="hs-identifier hs-var">pmap</span></span><span> </span><span class="annot"><span class="annottext">AbHomFree AbHom (Matrix Z)
</span><a href="OAlg.AbelianGroup.Definition.html#AbHomFree"><span class="hs-identifier hs-var">AbHomFree</span></a></span><span> </span><span class="annot"><span class="annottext">Point AbHom
AbGroup
</span><a href="#local-6989586621679087661"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-616"></span><span>    </span><span id="local-6989586621679087668"><span class="annot"><span class="annottext">o :: ZModHom
</span><a href="#local-6989586621679087668"><span class="hs-identifier hs-var hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point ZModHom -&gt; ZModHom
forall c. Multiplicative c =&gt; Point c -&gt; c
</span><span class="hs-identifier hs-var">one</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">N -&gt; ZMod
</span><a href="OAlg.AbelianGroup.ZMod.html#ZMod"><span class="hs-identifier hs-var">ZMod</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.ZMod.html#ZModHom"><span class="hs-identifier hs-type">ZModHom</span></a></span><span>
</span><span id="line-617"></span><span>    </span><span>
</span><span id="line-618"></span><span>    </span><span id="local-6989586621679085787"><span id="local-6989586621679085788"><span class="annot"><a href="#local-6989586621679087664"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Enum</span></span><span> </span><span class="annot"><a href="#local-6989586621679085787"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679085787"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="OAlg.AbelianGroup.ZMod.html#ZMod"><span class="hs-identifier hs-type">ZMod</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679085788"><span class="hs-identifier hs-type">j</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="OAlg.AbelianGroup.ZMod.html#ZModHom"><span class="hs-identifier hs-type">ZModHom</span></a></span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679085787"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679085788"><span class="hs-identifier hs-type">j</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span></span></span><span>
</span><span id="line-619"></span><span>    </span><span id="local-6989586621679087664"><span class="annot"><span class="annottext">xs :: forall i j. Enum i =&gt; i -&gt; [(ZMod, j)] -&gt; [(ZModHom, (i, j))]
</span><a href="#local-6989586621679087664"><span class="hs-identifier hs-var hs-var">xs</span></a></span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-620"></span><span>    </span><span class="annot"><a href="#local-6989586621679087664"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span id="local-6989586621679087675"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679087675"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="OAlg.AbelianGroup.ZMod.html#ZMod"><span class="hs-identifier hs-type">ZMod</span></a></span><span> </span><span id="local-6989586621679087676"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679087676"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679087677"><span class="annot"><span class="annottext">j
</span><a href="#local-6989586621679087677"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679087678"><span class="annot"><span class="annottext">[(ZMod, j)]
</span><a href="#local-6989586621679087678"><span class="hs-identifier hs-var">js</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679087676"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span>
</span><span id="line-621"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">i -&gt; [(ZMod, j)] -&gt; [(ZModHom, (i, j))]
forall i j. Enum i =&gt; i -&gt; [(ZMod, j)] -&gt; [(ZModHom, (i, j))]
</span><a href="#local-6989586621679087664"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679087675"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">[(ZMod, j)]
</span><a href="#local-6989586621679087678"><span class="hs-identifier hs-var">js</span></a></span><span>
</span><span id="line-622"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">ZModHom
</span><a href="#local-6989586621679087668"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679087675"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">j
</span><a href="#local-6989586621679087677"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="annot"><span class="annottext">(ZModHom, (i, j)) -&gt; [(ZModHom, (i, j))] -&gt; [(ZModHom, (i, j))]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">i -&gt; [(ZMod, j)] -&gt; [(ZModHom, (i, j))]
forall i j. Enum i =&gt; i -&gt; [(ZMod, j)] -&gt; [(ZModHom, (i, j))]
</span><a href="#local-6989586621679087664"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i -&gt; i
forall a. Enum a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">succ</span></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679087675"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(ZMod, j)]
</span><a href="#local-6989586621679087678"><span class="hs-identifier hs-var">js</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-623"></span><span>
</span><span id="line-624"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-625"></span><span class="hs-comment">-- abgGeneratorTo -</span><span>
</span><span id="line-626"></span><span>
</span><span id="line-627"></span><span class="hs-comment">-- | the generator for a finitely generated abelian group.</span><span>
</span><span id="line-628"></span><span class="hs-comment">--</span><span>
</span><span id="line-629"></span><span class="hs-comment">-- __Property__ Let @a@ be in 'AbGroup', then holds</span><span>
</span><span id="line-630"></span><span class="hs-comment">-- @a '==' g@ where @'Generator' ('DiagramChainTo' g _) _ _ _ _ = 'abgGeneratorTo' a@.  </span><span>
</span><span id="line-631"></span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#abgGeneratorTo"><span class="hs-identifier hs-type">abgGeneratorTo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbGroup"><span class="hs-identifier hs-type">AbGroup</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Generator</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">To</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span><span>
</span><span id="line-632"></span><span id="abgGeneratorTo"><span class="annot"><span class="annottext">abgGeneratorTo :: AbGroup -&gt; Generator 'To AbHom
</span><a href="OAlg.AbelianGroup.Definition.html#abgGeneratorTo"><span class="hs-identifier hs-var hs-var">abgGeneratorTo</span></a></span></span><span> </span><span id="local-6989586621679087681"><span class="annot"><span class="annottext">g :: AbGroup
</span><a href="#local-6989586621679087681"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbGroup"><span class="hs-identifier hs-type">AbGroup</span></a></span><span> </span><span id="local-6989586621679087682"><span class="annot"><span class="annottext">ProductSymbol ZMod
</span><a href="#local-6989586621679087682"><span class="hs-identifier hs-var">pg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">N -&gt; SomeNatural
</span><span class="hs-identifier hs-var">someNatural</span></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679087683"><span class="hs-identifier hs-var">ng'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">N -&gt; SomeNatural
</span><span class="hs-identifier hs-var">someNatural</span></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679087684"><span class="hs-identifier hs-var">ng''</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-633"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SomeNatural</span></span><span> </span><span id="local-6989586621679087686"><span class="annot"><span class="annottext">W n
</span><a href="#local-6989586621679087686"><span class="hs-identifier hs-var">k'</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">SomeNatural</span></span><span> </span><span id="local-6989586621679087692"><span class="annot"><span class="annottext">W n
</span><a href="#local-6989586621679087692"><span class="hs-identifier hs-var">k''</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Diagram ('Chain 'To) N3 N2 AbHom
-&gt; Free n AbHom
-&gt; Free n AbHom
-&gt; Cokernel N1 AbHom
-&gt; Kernel N1 AbHom
-&gt; (forall (k :: N'). Slice 'From (Free k) AbHom -&gt; AbHom)
-&gt; Generator 'To AbHom
forall (k' :: N') a (k'' :: N').
(Attestable k', Sliced (Free k') a, Attestable k'',
 Sliced (Free k'') a) =&gt;
Diagram ('Chain 'To) N3 N2 a
-&gt; Free k' a
-&gt; Free k'' a
-&gt; Cokernel N1 a
-&gt; Kernel N1 a
-&gt; (forall (k :: N'). Slice 'From (Free k) a -&gt; a)
-&gt; Generator 'To a
</span><span class="hs-identifier hs-var">GeneratorTo</span></span><span> </span><span class="annot"><span class="annottext">Diagram ('Chain 'To) (N2 + 1) N2 AbHom
Diagram ('Chain 'To) N3 N2 AbHom
</span><a href="#local-6989586621679087694"><span class="hs-identifier hs-var">chn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">W n -&gt; Free n AbHom
forall (k :: N') c. Any k -&gt; Free k c
</span><span class="hs-identifier hs-var">Free</span></span><span> </span><span class="annot"><span class="annottext">W n
</span><a href="#local-6989586621679087686"><span class="hs-identifier hs-var">k'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">W n -&gt; Free n AbHom
forall (k :: N') c. Any k -&gt; Free k c
</span><span class="hs-identifier hs-var">Free</span></span><span> </span><span class="annot"><span class="annottext">W n
</span><a href="#local-6989586621679087692"><span class="hs-identifier hs-var">k''</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Cokernel N1 AbHom
</span><a href="#local-6989586621679087695"><span class="hs-identifier hs-var">coker</span></a></span><span> </span><span class="annot"><span class="annottext">Kernel N1 AbHom
</span><a href="#local-6989586621679087696"><span class="hs-identifier hs-var">ker</span></a></span><span> </span><span class="annot"><span class="annottext">Slice 'From (Free k) AbHom -&gt; AbHom
forall (k :: N'). Slice 'From (Free k) AbHom -&gt; AbHom
</span><a href="#local-6989586621679087697"><span class="hs-identifier hs-var">lft</span></a></span><span>
</span><span id="line-634"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-635"></span><span>    </span><span id="local-6989586621679087698"><span class="annot"><span class="annottext">gs :: [(ZMod, N)]
</span><a href="#local-6989586621679087698"><span class="hs-identifier hs-var hs-var">gs</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProductSymbol ZMod -&gt; [(ZMod, N)]
forall (s :: * -&gt; *) x. Sequence s N x =&gt; s x -&gt; [(x, N)]
</span><span class="hs-identifier hs-var">listN</span></span><span> </span><span class="annot"><span class="annottext">ProductSymbol ZMod
</span><a href="#local-6989586621679087682"><span class="hs-identifier hs-var">pg</span></a></span><span>
</span><span id="line-636"></span><span>    </span><span id="local-6989586621679087700"><span class="annot"><span class="annottext">g's :: [(ZMod, N)]
</span><a href="#local-6989586621679087700"><span class="hs-identifier hs-var hs-var">g's</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((ZMod, N) -&gt; Bool) -&gt; [(ZMod, N)] -&gt; [(ZMod, N)]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">ZMod -&gt; ZMod -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span class="annot"><span class="annottext">N -&gt; ZMod
</span><a href="OAlg.AbelianGroup.ZMod.html#ZMod"><span class="hs-identifier hs-var">ZMod</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ZMod -&gt; Bool) -&gt; ((ZMod, N) -&gt; ZMod) -&gt; (ZMod, N) -&gt; Bool
forall y z x. (y -&gt; z) -&gt; (x -&gt; y) -&gt; x -&gt; z
forall (c :: * -&gt; * -&gt; *) y z x.
Category c =&gt;
c y z -&gt; c x y -&gt; c x z
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(ZMod, N) -&gt; ZMod
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(ZMod, N)]
</span><a href="#local-6989586621679087698"><span class="hs-identifier hs-var">gs</span></a></span><span>
</span><span id="line-637"></span><span>    </span><span id="local-6989586621679087701"><span class="annot"><span class="annottext">g''s :: [(ZMod, N)]
</span><a href="#local-6989586621679087701"><span class="hs-identifier hs-var hs-var">g''s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((ZMod, N) -&gt; Bool) -&gt; [(ZMod, N)] -&gt; [(ZMod, N)]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">ZMod -&gt; ZMod -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span class="annot"><span class="annottext">N -&gt; ZMod
</span><a href="OAlg.AbelianGroup.ZMod.html#ZMod"><span class="hs-identifier hs-var">ZMod</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ZMod -&gt; Bool) -&gt; ((ZMod, N) -&gt; ZMod) -&gt; (ZMod, N) -&gt; Bool
forall y z x. (y -&gt; z) -&gt; (x -&gt; y) -&gt; x -&gt; z
forall (c :: * -&gt; * -&gt; *) y z x.
Category c =&gt;
c y z -&gt; c x y -&gt; c x z
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(ZMod, N) -&gt; ZMod
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(ZMod, N)]
</span><a href="#local-6989586621679087700"><span class="hs-identifier hs-var">g's</span></a></span><span>
</span><span id="line-638"></span><span>
</span><span id="line-639"></span><span>    </span><span id="local-6989586621679087683"><span class="annot"><span class="annottext">ng' :: N
</span><a href="#local-6989586621679087683"><span class="hs-identifier hs-var hs-var">ng'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(ZMod, N)] -&gt; N
forall x. LengthN x =&gt; x -&gt; N
</span><span class="hs-identifier hs-var">lengthN</span></span><span> </span><span class="annot"><span class="annottext">[(ZMod, N)]
</span><a href="#local-6989586621679087700"><span class="hs-identifier hs-var">g's</span></a></span><span>
</span><span id="line-640"></span><span>    </span><span id="local-6989586621679087702"><span class="annot"><span class="annottext">g' :: AbGroup
</span><a href="#local-6989586621679087702"><span class="hs-identifier hs-var hs-var">g'</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">N -&gt; AbGroup
</span><a href="OAlg.AbelianGroup.Definition.html#abg"><span class="hs-identifier hs-var">abg</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">AbGroup -&gt; Exponent AbGroup -&gt; AbGroup
forall f. Exponential f =&gt; f -&gt; Exponent f -&gt; f
</span><span class="hs-operator hs-var">^</span></span><span> </span><span class="annot"><span class="annottext">N
Exponent AbGroup
</span><a href="#local-6989586621679087683"><span class="hs-identifier hs-var">ng'</span></a></span><span>
</span><span id="line-641"></span><span>
</span><span id="line-642"></span><span>    </span><span id="local-6989586621679087684"><span class="annot"><span class="annottext">ng'' :: N
</span><a href="#local-6989586621679087684"><span class="hs-identifier hs-var hs-var">ng''</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(ZMod, N)] -&gt; N
forall x. LengthN x =&gt; x -&gt; N
</span><span class="hs-identifier hs-var">lengthN</span></span><span> </span><span class="annot"><span class="annottext">[(ZMod, N)]
</span><a href="#local-6989586621679087701"><span class="hs-identifier hs-var">g''s</span></a></span><span>
</span><span id="line-643"></span><span>    </span><span id="local-6989586621679087703"><span class="annot"><span class="annottext">g'' :: AbGroup
</span><a href="#local-6989586621679087703"><span class="hs-identifier hs-var hs-var">g''</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">N -&gt; AbGroup
</span><a href="OAlg.AbelianGroup.Definition.html#abg"><span class="hs-identifier hs-var">abg</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">AbGroup -&gt; Exponent AbGroup -&gt; AbGroup
forall f. Exponential f =&gt; f -&gt; Exponent f -&gt; f
</span><span class="hs-operator hs-var">^</span></span><span> </span><span class="annot"><span class="annottext">N
Exponent AbGroup
</span><a href="#local-6989586621679087684"><span class="hs-identifier hs-var">ng''</span></a></span><span>
</span><span id="line-644"></span><span>    </span><span>
</span><span id="line-645"></span><span>    </span><span id="local-6989586621679087704"><span class="annot"><span class="annottext">p :: AbHom
</span><a href="#local-6989586621679087704"><span class="hs-identifier hs-var hs-var">p</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Orientation AbGroup -&gt; [(ZModHom, N, N)] -&gt; AbHom
</span><a href="OAlg.AbelianGroup.Definition.html#abh"><span class="hs-identifier hs-var">abh</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AbGroup
</span><a href="#local-6989586621679087702"><span class="hs-identifier hs-var">g'</span></a></span><span> </span><span class="annot"><span class="annottext">AbGroup -&gt; AbGroup -&gt; Orientation AbGroup
forall p. p -&gt; p -&gt; Orientation p
</span><span class="hs-operator hs-var">:&gt;</span></span><span> </span><span class="annot"><span class="annottext">AbGroup
</span><a href="#local-6989586621679087681"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(ZModHom, N, N)] -&gt; AbHom) -&gt; [(ZModHom, N, N)] -&gt; AbHom
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(((ZMod, N), N) -&gt; (ZModHom, N, N))
-&gt; [((ZMod, N), N)] -&gt; [(ZModHom, N, N)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
forall (h :: * -&gt; * -&gt; *) (f :: * -&gt; *) a b.
Applicative1 h f =&gt;
h a b -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">amap1</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679087705"><span class="annot"><span class="annottext">ZMod
</span><a href="#local-6989586621679087705"><span class="hs-identifier hs-var">z</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679087706"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679087706"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span id="local-6989586621679087707"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679087707"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Orientation ZMod -&gt; Z -&gt; ZModHom
</span><a href="OAlg.AbelianGroup.ZMod.html#zmh"><span class="hs-identifier hs-var">zmh</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">N -&gt; ZMod
</span><a href="OAlg.AbelianGroup.ZMod.html#ZMod"><span class="hs-identifier hs-var">ZMod</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span class="annot"><span class="annottext">ZMod -&gt; ZMod -&gt; Orientation ZMod
forall p. p -&gt; p -&gt; Orientation p
</span><span class="hs-operator hs-var">:&gt;</span></span><span class="annot"><span class="annottext">ZMod
</span><a href="#local-6989586621679087705"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Z
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679087706"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679087707"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(ZMod, N)]
</span><a href="#local-6989586621679087700"><span class="hs-identifier hs-var">g's</span></a></span><span> </span><span class="annot"><span class="annottext">[(ZMod, N)] -&gt; [N] -&gt; [((ZMod, N), N)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-operator hs-var">`zip`</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-646"></span><span>    </span><span id="local-6989586621679087708"><span class="annot"><span class="annottext">p' :: AbHom
</span><a href="#local-6989586621679087708"><span class="hs-identifier hs-var hs-var">p'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Orientation AbGroup -&gt; [(ZModHom, N, N)] -&gt; AbHom
</span><a href="OAlg.AbelianGroup.Definition.html#abh"><span class="hs-identifier hs-var">abh</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AbGroup
</span><a href="#local-6989586621679087703"><span class="hs-identifier hs-var">g''</span></a></span><span> </span><span class="annot"><span class="annottext">AbGroup -&gt; AbGroup -&gt; Orientation AbGroup
forall p. p -&gt; p -&gt; Orientation p
</span><span class="hs-operator hs-var">:&gt;</span></span><span> </span><span class="annot"><span class="annottext">AbGroup
</span><a href="#local-6989586621679087702"><span class="hs-identifier hs-var">g'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(ZModHom, N, N)] -&gt; AbHom) -&gt; [(ZModHom, N, N)] -&gt; AbHom
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">N -&gt; [(ZMod, N)] -&gt; [(ZModHom, N, N)]
forall {t} {b}. Enum t =&gt; t -&gt; [(ZMod, b)] -&gt; [(ZModHom, b, t)]
</span><a href="#local-6989586621679087709"><span class="hs-identifier hs-var">zs</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((ZMod, N) -&gt; ZMod) -&gt; [(ZMod, N)] -&gt; [ZMod]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
forall (h :: * -&gt; * -&gt; *) (f :: * -&gt; *) a b.
Applicative1 h f =&gt;
h a b -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">amap1</span></span><span> </span><span class="annot"><span class="annottext">(ZMod, N) -&gt; ZMod
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">[(ZMod, N)]
</span><a href="#local-6989586621679087700"><span class="hs-identifier hs-var">g's</span></a></span><span> </span><span class="annot"><span class="annottext">[ZMod] -&gt; [N] -&gt; [(ZMod, N)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-operator hs-var">`zip`</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-647"></span><span>      </span><span id="local-6989586621679087711"><span class="annot"><span class="annottext">z0 :: ZMod
</span><a href="#local-6989586621679087711"><span class="hs-identifier hs-var hs-var">z0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">N -&gt; ZMod
</span><a href="OAlg.AbelianGroup.ZMod.html#ZMod"><span class="hs-identifier hs-var">ZMod</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span>
</span><span id="line-648"></span><span>      </span><span id="local-6989586621679087709"><span class="annot"><span class="annottext">zs :: t -&gt; [(ZMod, b)] -&gt; [(ZModHom, b, t)]
</span><a href="#local-6989586621679087709"><span class="hs-identifier hs-var hs-var">zs</span></a></span></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-649"></span><span>      </span><span class="annot"><a href="#local-6989586621679087709"><span class="hs-identifier hs-var">zs</span></a></span><span> </span><span id="local-6989586621679087717"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679087717"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="OAlg.AbelianGroup.ZMod.html#ZMod"><span class="hs-identifier hs-type">ZMod</span></a></span><span> </span><span id="local-6989586621679087718"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679087718"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679087719"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679087719"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679087720"><span class="annot"><span class="annottext">[(ZMod, b)]
</span><a href="#local-6989586621679087720"><span class="hs-identifier hs-var">g's</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679087718"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span>
</span><span id="line-650"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Orientation ZMod -&gt; Z -&gt; ZModHom
</span><a href="OAlg.AbelianGroup.ZMod.html#zmh"><span class="hs-identifier hs-var">zmh</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ZMod
</span><a href="#local-6989586621679087711"><span class="hs-identifier hs-var">z0</span></a></span><span class="annot"><span class="annottext">ZMod -&gt; ZMod -&gt; Orientation ZMod
forall p. p -&gt; p -&gt; Orientation p
</span><span class="hs-operator hs-var">:&gt;</span></span><span class="annot"><span class="annottext">ZMod
</span><a href="#local-6989586621679087711"><span class="hs-identifier hs-var">z0</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">N -&gt; Z
forall a b. Embeddable a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">inj</span></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679087718"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679087719"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679087717"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">(ZModHom, b, t) -&gt; [(ZModHom, b, t)] -&gt; [(ZModHom, b, t)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">t -&gt; [(ZMod, b)] -&gt; [(ZModHom, b, t)]
</span><a href="#local-6989586621679087709"><span class="hs-identifier hs-var">zs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t -&gt; t
forall a. Enum a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">succ</span></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679087717"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(ZMod, b)]
</span><a href="#local-6989586621679087720"><span class="hs-identifier hs-var">g's</span></a></span><span>
</span><span id="line-651"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">t -&gt; [(ZMod, b)] -&gt; [(ZModHom, b, t)]
</span><a href="#local-6989586621679087709"><span class="hs-identifier hs-var">zs</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679087717"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">[(ZMod, b)]
</span><a href="#local-6989586621679087720"><span class="hs-identifier hs-var">g's</span></a></span><span> </span><span>
</span><span id="line-652"></span><span>
</span><span id="line-653"></span><span>    </span><span id="local-6989586621679087694"><span class="annot"><span class="annottext">chn :: Diagram ('Chain 'To) (N2 + 1) N2 AbHom
</span><a href="#local-6989586621679087694"><span class="hs-identifier hs-var hs-var">chn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point AbHom
-&gt; FinList N2 AbHom -&gt; Diagram ('Chain 'To) (N2 + 1) N2 AbHom
forall a (m :: N').
Point a -&gt; FinList m a -&gt; Diagram ('Chain 'To) (m + 1) m a
</span><span class="hs-identifier hs-var">DiagramChainTo</span></span><span> </span><span class="annot"><span class="annottext">Point AbHom
AbGroup
</span><a href="#local-6989586621679087681"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AbHom
</span><a href="#local-6989586621679087704"><span class="hs-identifier hs-var">p</span></a></span><span class="annot"><span class="annottext">AbHom -&gt; FinList N1 AbHom -&gt; FinList (N1 + 1) AbHom
forall a (n1 :: N'). a -&gt; FinList n1 a -&gt; FinList (n1 + 1) a
</span><span class="hs-operator hs-var">:|</span></span><span class="annot"><span class="annottext">AbHom
</span><a href="#local-6989586621679087708"><span class="hs-identifier hs-var">p'</span></a></span><span class="annot"><span class="annottext">AbHom -&gt; FinList N0 AbHom -&gt; FinList (N0 + 1) AbHom
forall a (n1 :: N'). a -&gt; FinList n1 a -&gt; FinList (n1 + 1) a
</span><span class="hs-operator hs-var">:|</span></span><span class="annot"><span class="annottext">FinList N0 AbHom
forall a. FinList N0 a
</span><span class="hs-identifier hs-var">Nil</span></span><span class="hs-special">)</span><span>
</span><span id="line-654"></span><span>    </span><span>
</span><span id="line-655"></span><span>    </span><span id="local-6989586621679087696"><span class="annot"><span class="annottext">ker :: Kernel N1 AbHom
</span><a href="#local-6989586621679087696"><span class="hs-identifier hs-var hs-var">ker</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Cone Dst 'Projective ('Parallel 'LeftToRight) N2 N1 AbHom
-&gt; (Cone Dst 'Projective ('Parallel 'LeftToRight) N2 N1 AbHom
    -&gt; AbHom)
-&gt; Kernel N1 AbHom
forall s (t :: DiagramType) (n :: N') (m :: N') a.
Cone s 'Projective t n m a
-&gt; (Cone s 'Projective t n m a -&gt; a) -&gt; Limes s 'Projective t n m a
</span><span class="hs-identifier hs-var">LimesProjective</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Diagram ('Parallel 'LeftToRight) N2 N1 AbHom
-&gt; AbHom
-&gt; Cone Dst 'Projective ('Parallel 'LeftToRight) N2 N1 AbHom
forall a (m :: N').
Distributive a =&gt;
Diagram ('Parallel 'LeftToRight) N2 m a
-&gt; a -&gt; Cone Dst 'Projective ('Parallel 'LeftToRight) N2 m a
</span><span class="hs-identifier hs-var">ConeKernel</span></span><span> </span><span class="annot"><span class="annottext">Diagram ('Parallel 'LeftToRight) N2 N1 AbHom
</span><a href="#local-6989586621679087726"><span class="hs-identifier hs-var">dg</span></a></span><span> </span><span class="annot"><span class="annottext">AbHom
</span><a href="#local-6989586621679087708"><span class="hs-identifier hs-var">p'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Cone Dst 'Projective ('Parallel 'LeftToRight) N2 N1 AbHom -&gt; AbHom
</span><a href="#local-6989586621679087727"><span class="hs-identifier hs-var">univ</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-656"></span><span>      </span><span id="local-6989586621679087726"><span class="annot"><span class="annottext">dg :: Diagram ('Parallel 'LeftToRight) N2 N1 AbHom
</span><a href="#local-6989586621679087726"><span class="hs-identifier hs-var hs-var">dg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point AbHom
-&gt; Point AbHom
-&gt; FinList N1 AbHom
-&gt; Diagram ('Parallel 'LeftToRight) N2 N1 AbHom
forall a (m :: N').
Point a
-&gt; Point a
-&gt; FinList m a
-&gt; Diagram ('Parallel 'LeftToRight) N2 m a
</span><span class="hs-identifier hs-var">DiagramParallelLR</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AbHom -&gt; Point AbHom
forall q. Oriented q =&gt; q -&gt; Point q
</span><span class="hs-identifier hs-var">start</span></span><span> </span><span class="annot"><span class="annottext">AbHom
</span><a href="#local-6989586621679087704"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AbHom -&gt; Point AbHom
forall q. Oriented q =&gt; q -&gt; Point q
</span><span class="hs-identifier hs-var">end</span></span><span> </span><span class="annot"><span class="annottext">AbHom
</span><a href="#local-6989586621679087704"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AbHom
</span><a href="#local-6989586621679087704"><span class="hs-identifier hs-var">p</span></a></span><span class="annot"><span class="annottext">AbHom -&gt; FinList N0 AbHom -&gt; FinList (N0 + 1) AbHom
forall a (n1 :: N'). a -&gt; FinList n1 a -&gt; FinList (n1 + 1) a
</span><span class="hs-operator hs-var">:|</span></span><span class="annot"><span class="annottext">FinList N0 AbHom
forall a. FinList N0 a
</span><span class="hs-identifier hs-var">Nil</span></span><span class="hs-special">)</span><span>
</span><span id="line-657"></span><span>      </span><span class="annot"><a href="#local-6989586621679087727"><span class="hs-identifier hs-type">univ</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KernelCone</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">N1</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span><span>
</span><span id="line-658"></span><span>      </span><span id="local-6989586621679087727"><span class="annot"><span class="annottext">univ :: Cone Dst 'Projective ('Parallel 'LeftToRight) N2 N1 AbHom -&gt; AbHom
</span><a href="#local-6989586621679087727"><span class="hs-identifier hs-var hs-var">univ</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ConeKernel</span></span><span> </span><span class="annot"><span class="annottext">Diagram ('Parallel 'LeftToRight) N2 N1 AbHom
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Matrix</span></span><span> </span><span class="annot"><span class="annottext">Dim' ZModHom
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679087753"><span class="annot"><span class="annottext">Dim' ZModHom
</span><a href="#local-6989586621679087753"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679087754"><span class="annot"><span class="annottext">Entries N N ZModHom
</span><a href="#local-6989586621679087754"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix ZModHom -&gt; AbHom
</span><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-var">AbHom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dim' ZModHom
-&gt; Dim' ZModHom -&gt; Entries N N ZModHom -&gt; Matrix ZModHom
forall x. Dim' x -&gt; Dim' x -&gt; Entries N N x -&gt; Matrix x
</span><span class="hs-identifier hs-var">Matrix</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AbGroup -&gt; Dim' ZModHom
</span><a href="OAlg.AbelianGroup.Definition.html#abgDim"><span class="hs-identifier hs-var">abgDim</span></a></span><span> </span><span class="annot"><span class="annottext">AbGroup
</span><a href="#local-6989586621679087703"><span class="hs-identifier hs-var">g''</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Dim' ZModHom
</span><a href="#local-6989586621679087753"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Entries N N ZModHom
</span><a href="#local-6989586621679087755"><span class="hs-identifier hs-var">xs'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-659"></span><span>        </span><span id="local-6989586621679087755"><span class="annot"><span class="annottext">xs' :: Entries N N ZModHom
</span><a href="#local-6989586621679087755"><span class="hs-identifier hs-var hs-var">xs'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Col N (Row N ZModHom) -&gt; Entries N N ZModHom
forall i j x. Col i (Row j x) -&gt; Entries i j x
</span><span class="hs-identifier hs-var">crets</span></span><span> </span><span class="annot"><span class="annottext">(Col N (Row N ZModHom) -&gt; Entries N N ZModHom)
-&gt; Col N (Row N ZModHom) -&gt; Entries N N ZModHom
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PSequence N (Row N ZModHom) -&gt; Col N (Row N ZModHom)
forall i x. PSequence i x -&gt; Col i x
</span><span class="hs-identifier hs-var">Col</span></span><span> </span><span class="annot"><span class="annottext">(PSequence N (Row N ZModHom) -&gt; Col N (Row N ZModHom))
-&gt; PSequence N (Row N ZModHom) -&gt; Col N (Row N ZModHom)
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(Row N ZModHom, N)] -&gt; PSequence N (Row N ZModHom)
forall i x. [(x, i)] -&gt; PSequence i x
</span><span class="hs-identifier hs-var">PSequence</span></span><span>
</span><span id="line-660"></span><span>          </span><span class="annot"><span class="annottext">([(Row N ZModHom, N)] -&gt; PSequence N (Row N ZModHom))
-&gt; [(Row N ZModHom, N)] -&gt; PSequence N (Row N ZModHom)
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">N -&gt; [(ZMod, N)] -&gt; [(Row N ZModHom, N)] -&gt; [(Row N ZModHom, N)]
forall i j.
(Enum i, Ord i) =&gt;
i -&gt; [(ZMod, i)] -&gt; [(Row j ZModHom, i)] -&gt; [(Row j ZModHom, i)]
</span><a href="#local-6989586621679087756"><span class="hs-identifier hs-var">divRows</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((ZMod, N) -&gt; ZMod) -&gt; [(ZMod, N)] -&gt; [ZMod]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
forall (h :: * -&gt; * -&gt; *) (f :: * -&gt; *) a b.
Applicative1 h f =&gt;
h a b -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">amap1</span></span><span> </span><span class="annot"><span class="annottext">(ZMod, N) -&gt; ZMod
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">[(ZMod, N)]
</span><a href="#local-6989586621679087700"><span class="hs-identifier hs-var">g's</span></a></span><span> </span><span class="annot"><span class="annottext">[ZMod] -&gt; [N] -&gt; [(ZMod, N)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-operator hs-var">`zip`</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Col N (Row N ZModHom) -&gt; [(Row N ZModHom, N)]
forall (s :: * -&gt; *) x. Sequence s N x =&gt; s x -&gt; [(x, N)]
</span><span class="hs-identifier hs-var">listN</span></span><span> </span><span class="annot"><span class="annottext">(Col N (Row N ZModHom) -&gt; [(Row N ZModHom, N)])
-&gt; Col N (Row N ZModHom) -&gt; [(Row N ZModHom, N)]
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Entries N N ZModHom -&gt; Col N (Row N ZModHom)
forall i j x. Eq i =&gt; Entries i j x -&gt; Col i (Row j x)
</span><span class="hs-identifier hs-var">etscr</span></span><span> </span><span class="annot"><span class="annottext">Entries N N ZModHom
</span><a href="#local-6989586621679087754"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-661"></span><span>        </span><span>
</span><span id="line-662"></span><span>        </span><span id="local-6989586621679085836"><span id="local-6989586621679085837"><span class="annot"><a href="#local-6989586621679087756"><span class="hs-identifier hs-type">divRows</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Enum</span></span><span> </span><span class="annot"><a href="#local-6989586621679085836"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679085836"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-663"></span><span>          </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679085836"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="OAlg.AbelianGroup.ZMod.html#ZMod"><span class="hs-identifier hs-type">ZMod</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679085836"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Row</span></span><span> </span><span class="annot"><a href="#local-6989586621679085837"><span class="hs-identifier hs-type">j</span></a></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.ZMod.html#ZModHom"><span class="hs-identifier hs-type">ZModHom</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679085836"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Row</span></span><span> </span><span class="annot"><a href="#local-6989586621679085837"><span class="hs-identifier hs-type">j</span></a></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.ZMod.html#ZModHom"><span class="hs-identifier hs-type">ZModHom</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679085836"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span></span><span>
</span><span id="line-664"></span><span>        </span><span id="local-6989586621679087756"><span class="annot"><span class="annottext">divRows :: forall i j.
(Enum i, Ord i) =&gt;
i -&gt; [(ZMod, i)] -&gt; [(Row j ZModHom, i)] -&gt; [(Row j ZModHom, i)]
</span><a href="#local-6989586621679087756"><span class="hs-identifier hs-var hs-var">divRows</span></a></span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[(Row j ZModHom, i)]
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-665"></span><span>        </span><span class="annot"><a href="#local-6989586621679087756"><span class="hs-identifier hs-var">divRows</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[(ZMod, i)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-666"></span><span>        </span><span class="annot"><a href="#local-6989586621679087756"><span class="hs-identifier hs-var">divRows</span></a></span><span> </span><span id="local-6989586621679087776"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679087776"><span class="hs-identifier hs-var">i''</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="OAlg.AbelianGroup.ZMod.html#ZMod"><span class="hs-identifier hs-type">ZMod</span></a></span><span> </span><span id="local-6989586621679087777"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679087777"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679087778"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679087778"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679087779"><span class="annot"><span class="annottext">[(ZMod, i)]
</span><a href="#local-6989586621679087779"><span class="hs-identifier hs-var">zis'</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679087780"><span class="annot"><span class="annottext">rws :: [(Row j ZModHom, i)]
</span><a href="#local-6989586621679087780"><span class="hs-identifier hs-var">rws</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679087781"><span class="annot"><span class="annottext">Row j ZModHom
</span><a href="#local-6989586621679087781"><span class="hs-identifier hs-var">rw</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679087782"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679087782"><span class="hs-identifier hs-var">i'</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679087783"><span class="annot"><span class="annottext">[(Row j ZModHom, i)]
</span><a href="#local-6989586621679087783"><span class="hs-identifier hs-var">rws'</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-667"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679087777"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">i -&gt; [(ZMod, i)] -&gt; [(Row j ZModHom, i)] -&gt; [(Row j ZModHom, i)]
forall i j.
(Enum i, Ord i) =&gt;
i -&gt; [(ZMod, i)] -&gt; [(Row j ZModHom, i)] -&gt; [(Row j ZModHom, i)]
</span><a href="#local-6989586621679087756"><span class="hs-identifier hs-var">divRows</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679087776"><span class="hs-identifier hs-var">i''</span></a></span><span> </span><span class="annot"><span class="annottext">[(ZMod, i)]
</span><a href="#local-6989586621679087779"><span class="hs-identifier hs-var">zis'</span></a></span><span> </span><span class="annot"><span class="annottext">[(Row j ZModHom, i)]
</span><a href="#local-6989586621679087780"><span class="hs-identifier hs-var">rws</span></a></span><span>
</span><span id="line-668"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679087778"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">i -&gt; i -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679087782"><span class="hs-identifier hs-var">i'</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ZModHom -&gt; ZModHom) -&gt; Row j ZModHom -&gt; Row j ZModHom
forall a b. (a -&gt; b) -&gt; Row j a -&gt; Row j b
forall (h :: * -&gt; * -&gt; *) (f :: * -&gt; *) a b.
Applicative1 h f =&gt;
h a b -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">amap1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Z -&gt; ZModHom -&gt; ZModHom
</span><a href="#local-6989586621679087784"><span class="hs-identifier hs-var">divZHom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">N -&gt; Z
forall a b. Embeddable a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">inj</span></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679087777"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Row j ZModHom
</span><a href="#local-6989586621679087781"><span class="hs-identifier hs-var">rw</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679087776"><span class="hs-identifier hs-var">i''</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">(Row j ZModHom, i) -&gt; [(Row j ZModHom, i)] -&gt; [(Row j ZModHom, i)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">i -&gt; [(ZMod, i)] -&gt; [(Row j ZModHom, i)] -&gt; [(Row j ZModHom, i)]
forall i j.
(Enum i, Ord i) =&gt;
i -&gt; [(ZMod, i)] -&gt; [(Row j ZModHom, i)] -&gt; [(Row j ZModHom, i)]
</span><a href="#local-6989586621679087756"><span class="hs-identifier hs-var">divRows</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i -&gt; i
forall a. Enum a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">succ</span></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679087776"><span class="hs-identifier hs-var">i''</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(ZMod, i)]
</span><a href="#local-6989586621679087779"><span class="hs-identifier hs-var">zis'</span></a></span><span> </span><span class="annot"><span class="annottext">[(Row j ZModHom, i)]
</span><a href="#local-6989586621679087783"><span class="hs-identifier hs-var">rws'</span></a></span><span>
</span><span id="line-669"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">i -&gt; [(ZMod, i)] -&gt; [(Row j ZModHom, i)] -&gt; [(Row j ZModHom, i)]
forall i j.
(Enum i, Ord i) =&gt;
i -&gt; [(ZMod, i)] -&gt; [(Row j ZModHom, i)] -&gt; [(Row j ZModHom, i)]
</span><a href="#local-6989586621679087756"><span class="hs-identifier hs-var">divRows</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i -&gt; i
forall a. Enum a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">succ</span></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679087776"><span class="hs-identifier hs-var">i''</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(ZMod, i)]
</span><a href="#local-6989586621679087779"><span class="hs-identifier hs-var">zis'</span></a></span><span> </span><span class="annot"><span class="annottext">[(Row j ZModHom, i)]
</span><a href="#local-6989586621679087780"><span class="hs-identifier hs-var">rws</span></a></span><span>
</span><span id="line-670"></span><span>
</span><span id="line-671"></span><span>        </span><span class="annot"><a href="#local-6989586621679087784"><span class="hs-identifier hs-type">divZHom</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Z</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.ZMod.html#ZModHom"><span class="hs-identifier hs-type">ZModHom</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.ZMod.html#ZModHom"><span class="hs-identifier hs-type">ZModHom</span></a></span><span>
</span><span id="line-672"></span><span>        </span><span id="local-6989586621679087784"><span class="annot"><span class="annottext">divZHom :: Z -&gt; ZModHom -&gt; ZModHom
</span><a href="#local-6989586621679087784"><span class="hs-identifier hs-var hs-var">divZHom</span></a></span></span><span> </span><span id="local-6989586621679087785"><span class="annot"><span class="annottext">Z
</span><a href="#local-6989586621679087785"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span id="local-6989586621679087786"><span class="annot"><span class="annottext">ZModHom
</span><a href="#local-6989586621679087786"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Orientation ZMod -&gt; Z -&gt; ZModHom
</span><a href="OAlg.AbelianGroup.ZMod.html#zmh"><span class="hs-identifier hs-var">zmh</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ZModHom -&gt; Orientation (Point ZModHom)
forall q. Oriented q =&gt; q -&gt; Orientation (Point q)
</span><span class="hs-identifier hs-var">orientation</span></span><span> </span><span class="annot"><span class="annottext">ZModHom
</span><a href="#local-6989586621679087786"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Z -&gt; Z -&gt; Z
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">div</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ZModHom -&gt; Z
</span><a href="OAlg.AbelianGroup.ZMod.html#toZ"><span class="hs-identifier hs-var">toZ</span></a></span><span> </span><span class="annot"><span class="annottext">ZModHom
</span><a href="#local-6989586621679087786"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Z
</span><a href="#local-6989586621679087785"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-673"></span><span>    </span><span>
</span><span id="line-674"></span><span>    </span><span id="local-6989586621679087695"><span class="annot"><span class="annottext">coker :: Cokernel N1 AbHom
</span><a href="#local-6989586621679087695"><span class="hs-identifier hs-var hs-var">coker</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Cone Dst 'Injective ('Parallel 'RightToLeft) N2 N1 AbHom
-&gt; (Cone Dst 'Injective ('Parallel 'RightToLeft) N2 N1 AbHom
    -&gt; AbHom)
-&gt; Cokernel N1 AbHom
forall s (t :: DiagramType) (n :: N') (m :: N') a.
Cone s 'Injective t n m a
-&gt; (Cone s 'Injective t n m a -&gt; a) -&gt; Limes s 'Injective t n m a
</span><span class="hs-identifier hs-var">LimesInjective</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Diagram ('Parallel 'RightToLeft) N2 N1 AbHom
-&gt; AbHom
-&gt; Cone Dst 'Injective ('Parallel 'RightToLeft) N2 N1 AbHom
forall a (m :: N').
Distributive a =&gt;
Diagram ('Parallel 'RightToLeft) N2 m a
-&gt; a -&gt; Cone Dst 'Injective ('Parallel 'RightToLeft) N2 m a
</span><span class="hs-identifier hs-var">ConeCokernel</span></span><span> </span><span class="annot"><span class="annottext">Diagram ('Parallel 'RightToLeft) N2 N1 AbHom
</span><a href="#local-6989586621679087790"><span class="hs-identifier hs-var">dg</span></a></span><span> </span><span class="annot"><span class="annottext">AbHom
</span><a href="#local-6989586621679087704"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Cone Dst 'Injective ('Parallel 'RightToLeft) N2 N1 AbHom -&gt; AbHom
</span><a href="#local-6989586621679087791"><span class="hs-identifier hs-var">univ</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-675"></span><span>      </span><span id="local-6989586621679087790"><span class="annot"><span class="annottext">dg :: Diagram ('Parallel 'RightToLeft) N2 N1 AbHom
</span><a href="#local-6989586621679087790"><span class="hs-identifier hs-var hs-var">dg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point AbHom
-&gt; Point AbHom
-&gt; FinList N1 AbHom
-&gt; Diagram ('Parallel 'RightToLeft) N2 N1 AbHom
forall a (m :: N').
Point a
-&gt; Point a
-&gt; FinList m a
-&gt; Diagram ('Parallel 'RightToLeft) N2 m a
</span><span class="hs-identifier hs-var">DiagramParallelRL</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AbHom -&gt; Point AbHom
forall q. Oriented q =&gt; q -&gt; Point q
</span><span class="hs-identifier hs-var">end</span></span><span> </span><span class="annot"><span class="annottext">AbHom
</span><a href="#local-6989586621679087708"><span class="hs-identifier hs-var">p'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AbHom -&gt; Point AbHom
forall q. Oriented q =&gt; q -&gt; Point q
</span><span class="hs-identifier hs-var">start</span></span><span> </span><span class="annot"><span class="annottext">AbHom
</span><a href="#local-6989586621679087708"><span class="hs-identifier hs-var">p'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AbHom
</span><a href="#local-6989586621679087708"><span class="hs-identifier hs-var">p'</span></a></span><span class="annot"><span class="annottext">AbHom -&gt; FinList N0 AbHom -&gt; FinList (N0 + 1) AbHom
forall a (n1 :: N'). a -&gt; FinList n1 a -&gt; FinList (n1 + 1) a
</span><span class="hs-operator hs-var">:|</span></span><span class="annot"><span class="annottext">FinList N0 AbHom
forall a. FinList N0 a
</span><span class="hs-identifier hs-var">Nil</span></span><span class="hs-special">)</span><span>
</span><span id="line-676"></span><span>      </span><span class="annot"><a href="#local-6989586621679087791"><span class="hs-identifier hs-type">univ</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CokernelCone</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">N1</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span><span>
</span><span id="line-677"></span><span>      </span><span id="local-6989586621679087791"><span class="annot"><span class="annottext">univ :: Cone Dst 'Injective ('Parallel 'RightToLeft) N2 N1 AbHom -&gt; AbHom
</span><a href="#local-6989586621679087791"><span class="hs-identifier hs-var hs-var">univ</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ConeCokernel</span></span><span> </span><span class="annot"><span class="annottext">Diagram ('Parallel 'RightToLeft) N2 N1 AbHom
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Matrix</span></span><span> </span><span id="local-6989586621679087813"><span class="annot"><span class="annottext">Dim' ZModHom
</span><a href="#local-6989586621679087813"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="annot"><span class="annottext">Dim' ZModHom
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679087814"><span class="annot"><span class="annottext">Entries N N ZModHom
</span><a href="#local-6989586621679087814"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix ZModHom -&gt; AbHom
</span><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-var">AbHom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dim' ZModHom
-&gt; Dim' ZModHom -&gt; Entries N N ZModHom -&gt; Matrix ZModHom
forall x. Dim' x -&gt; Dim' x -&gt; Entries N N x -&gt; Matrix x
</span><span class="hs-identifier hs-var">Matrix</span></span><span> </span><span class="annot"><span class="annottext">Dim' ZModHom
</span><a href="#local-6989586621679087813"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AbGroup -&gt; Dim' ZModHom
</span><a href="OAlg.AbelianGroup.Definition.html#abgDim"><span class="hs-identifier hs-var">abgDim</span></a></span><span> </span><span class="annot"><span class="annottext">AbGroup
</span><a href="#local-6989586621679087681"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Entries N N ZModHom
</span><a href="#local-6989586621679087815"><span class="hs-identifier hs-var">xs'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-678"></span><span>        </span><span id="local-6989586621679087815"><span class="annot"><span class="annottext">xs' :: Entries N N ZModHom
</span><a href="#local-6989586621679087815"><span class="hs-identifier hs-var hs-var">xs'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Row N (Col N ZModHom) -&gt; Entries N N ZModHom
forall i j x. (Ord i, Ord j) =&gt; Row j (Col i x) -&gt; Entries i j x
</span><span class="hs-identifier hs-var">rcets</span></span><span> </span><span class="annot"><span class="annottext">(Row N (Col N ZModHom) -&gt; Entries N N ZModHom)
-&gt; Row N (Col N ZModHom) -&gt; Entries N N ZModHom
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PSequence N (Col N ZModHom) -&gt; Row N (Col N ZModHom)
forall j x. PSequence j x -&gt; Row j x
</span><span class="hs-identifier hs-var">Row</span></span><span> </span><span class="annot"><span class="annottext">(PSequence N (Col N ZModHom) -&gt; Row N (Col N ZModHom))
-&gt; PSequence N (Col N ZModHom) -&gt; Row N (Col N ZModHom)
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(Col N ZModHom, N)] -&gt; PSequence N (Col N ZModHom)
forall i x. [(x, i)] -&gt; PSequence i x
</span><span class="hs-identifier hs-var">PSequence</span></span><span>
</span><span id="line-679"></span><span>          </span><span class="annot"><span class="annottext">([(Col N ZModHom, N)] -&gt; PSequence N (Col N ZModHom))
-&gt; [(Col N ZModHom, N)] -&gt; PSequence N (Col N ZModHom)
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">N -&gt; [(ZMod, N)] -&gt; [(Col N ZModHom, N)] -&gt; [(Col N ZModHom, N)]
forall j i.
(Ord j, Enum j) =&gt;
j -&gt; [(ZMod, j)] -&gt; [(Col i ZModHom, j)] -&gt; [(Col i ZModHom, j)]
</span><a href="#local-6989586621679087817"><span class="hs-identifier hs-var">castCols</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">[(ZMod, N)]
</span><a href="#local-6989586621679087698"><span class="hs-identifier hs-var">gs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Row N (Col N ZModHom) -&gt; [(Col N ZModHom, N)]
forall (s :: * -&gt; *) x. Sequence s N x =&gt; s x -&gt; [(x, N)]
</span><span class="hs-identifier hs-var">listN</span></span><span> </span><span class="annot"><span class="annottext">(Row N (Col N ZModHom) -&gt; [(Col N ZModHom, N)])
-&gt; Row N (Col N ZModHom) -&gt; [(Col N ZModHom, N)]
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Entries N N ZModHom -&gt; Row N (Col N ZModHom)
forall i j x. (Ord i, Ord j) =&gt; Entries i j x -&gt; Row j (Col i x)
</span><span class="hs-identifier hs-var">etsrc</span></span><span> </span><span class="annot"><span class="annottext">Entries N N ZModHom
</span><a href="#local-6989586621679087814"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-680"></span><span>
</span><span id="line-681"></span><span>        </span><span id="local-6989586621679085847"><span id="local-6989586621679085848"><span class="annot"><a href="#local-6989586621679087817"><span class="hs-identifier hs-type">castCols</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679085847"><span class="hs-identifier hs-type">j</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Enum</span></span><span> </span><span class="annot"><a href="#local-6989586621679085847"><span class="hs-identifier hs-type">j</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-682"></span><span>          </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679085847"><span class="hs-identifier hs-type">j</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="OAlg.AbelianGroup.ZMod.html#ZMod"><span class="hs-identifier hs-type">ZMod</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679085847"><span class="hs-identifier hs-type">j</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Col</span></span><span> </span><span class="annot"><a href="#local-6989586621679085848"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.ZMod.html#ZModHom"><span class="hs-identifier hs-type">ZModHom</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679085847"><span class="hs-identifier hs-type">j</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Col</span></span><span> </span><span class="annot"><a href="#local-6989586621679085848"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.ZMod.html#ZModHom"><span class="hs-identifier hs-type">ZModHom</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679085847"><span class="hs-identifier hs-type">j</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span></span><span>
</span><span id="line-683"></span><span>        </span><span id="local-6989586621679087817"><span class="annot"><span class="annottext">castCols :: forall j i.
(Ord j, Enum j) =&gt;
j -&gt; [(ZMod, j)] -&gt; [(Col i ZModHom, j)] -&gt; [(Col i ZModHom, j)]
</span><a href="#local-6989586621679087817"><span class="hs-identifier hs-var hs-var">castCols</span></a></span></span><span> </span><span class="annot"><span class="annottext">j
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[(Col i ZModHom, j)]
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-684"></span><span>        </span><span class="annot"><a href="#local-6989586621679087817"><span class="hs-identifier hs-var">castCols</span></a></span><span> </span><span class="annot"><span class="annottext">j
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[(ZMod, j)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-685"></span><span>        </span><span class="annot"><a href="#local-6989586621679087817"><span class="hs-identifier hs-var">castCols</span></a></span><span> </span><span id="local-6989586621679087836"><span class="annot"><span class="annottext">j
</span><a href="#local-6989586621679087836"><span class="hs-identifier hs-var">j''</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679087837"><span class="annot"><span class="annottext">g :: ZMod
</span><a href="#local-6989586621679087837"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="OAlg.AbelianGroup.ZMod.html#ZMod"><span class="hs-identifier hs-type">ZMod</span></a></span><span> </span><span id="local-6989586621679087838"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679087838"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span id="local-6989586621679087839"><span class="annot"><span class="annottext">j
</span><a href="#local-6989586621679087839"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679087840"><span class="annot"><span class="annottext">[(ZMod, j)]
</span><a href="#local-6989586621679087840"><span class="hs-identifier hs-var">gs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679087841"><span class="annot"><span class="annottext">cls :: [(Col i ZModHom, j)]
</span><a href="#local-6989586621679087841"><span class="hs-identifier hs-var">cls</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679087842"><span class="annot"><span class="annottext">Col i ZModHom
</span><a href="#local-6989586621679087842"><span class="hs-identifier hs-var">cl</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679087843"><span class="annot"><span class="annottext">j
</span><a href="#local-6989586621679087843"><span class="hs-identifier hs-var">j'</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679087844"><span class="annot"><span class="annottext">[(Col i ZModHom, j)]
</span><a href="#local-6989586621679087844"><span class="hs-identifier hs-var">cls'</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-686"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679087838"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">1</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">j -&gt; [(ZMod, j)] -&gt; [(Col i ZModHom, j)] -&gt; [(Col i ZModHom, j)]
forall j i.
(Ord j, Enum j) =&gt;
j -&gt; [(ZMod, j)] -&gt; [(Col i ZModHom, j)] -&gt; [(Col i ZModHom, j)]
</span><a href="#local-6989586621679087817"><span class="hs-identifier hs-var">castCols</span></a></span><span> </span><span class="annot"><span class="annottext">j
</span><a href="#local-6989586621679087836"><span class="hs-identifier hs-var">j''</span></a></span><span> </span><span class="annot"><span class="annottext">[(ZMod, j)]
</span><a href="#local-6989586621679087840"><span class="hs-identifier hs-var">gs</span></a></span><span> </span><span class="annot"><span class="annottext">[(Col i ZModHom, j)]
</span><a href="#local-6989586621679087841"><span class="hs-identifier hs-var">cls</span></a></span><span>
</span><span id="line-687"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">j
</span><a href="#local-6989586621679087836"><span class="hs-identifier hs-var">j''</span></a></span><span> </span><span class="annot"><span class="annottext">j -&gt; j -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">j
</span><a href="#local-6989586621679087843"><span class="hs-identifier hs-var">j'</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ZModHom -&gt; ZModHom) -&gt; Col i ZModHom -&gt; Col i ZModHom
forall a b. (a -&gt; b) -&gt; Col i a -&gt; Col i b
forall (h :: * -&gt; * -&gt; *) (f :: * -&gt; *) a b.
Applicative1 h f =&gt;
h a b -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">amap1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ZMod -&gt; ZModHom -&gt; ZModHom
</span><a href="#local-6989586621679087845"><span class="hs-identifier hs-var">castZHom</span></a></span><span> </span><span class="annot"><span class="annottext">ZMod
</span><a href="#local-6989586621679087837"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Col i ZModHom
</span><a href="#local-6989586621679087842"><span class="hs-identifier hs-var">cl</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">j
</span><a href="#local-6989586621679087839"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">(Col i ZModHom, j) -&gt; [(Col i ZModHom, j)] -&gt; [(Col i ZModHom, j)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">j -&gt; [(ZMod, j)] -&gt; [(Col i ZModHom, j)] -&gt; [(Col i ZModHom, j)]
forall j i.
(Ord j, Enum j) =&gt;
j -&gt; [(ZMod, j)] -&gt; [(Col i ZModHom, j)] -&gt; [(Col i ZModHom, j)]
</span><a href="#local-6989586621679087817"><span class="hs-identifier hs-var">castCols</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">j -&gt; j
forall a. Enum a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">succ</span></span><span> </span><span class="annot"><span class="annottext">j
</span><a href="#local-6989586621679087836"><span class="hs-identifier hs-var">j''</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(ZMod, j)]
</span><a href="#local-6989586621679087840"><span class="hs-identifier hs-var">gs</span></a></span><span> </span><span class="annot"><span class="annottext">[(Col i ZModHom, j)]
</span><a href="#local-6989586621679087844"><span class="hs-identifier hs-var">cls'</span></a></span><span>
</span><span id="line-688"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">j -&gt; [(ZMod, j)] -&gt; [(Col i ZModHom, j)] -&gt; [(Col i ZModHom, j)]
forall j i.
(Ord j, Enum j) =&gt;
j -&gt; [(ZMod, j)] -&gt; [(Col i ZModHom, j)] -&gt; [(Col i ZModHom, j)]
</span><a href="#local-6989586621679087817"><span class="hs-identifier hs-var">castCols</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">j -&gt; j
forall a. Enum a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">succ</span></span><span> </span><span class="annot"><span class="annottext">j
</span><a href="#local-6989586621679087836"><span class="hs-identifier hs-var">j''</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(ZMod, j)]
</span><a href="#local-6989586621679087840"><span class="hs-identifier hs-var">gs</span></a></span><span> </span><span class="annot"><span class="annottext">[(Col i ZModHom, j)]
</span><a href="#local-6989586621679087841"><span class="hs-identifier hs-var">cls</span></a></span><span>
</span><span id="line-689"></span><span>
</span><span id="line-690"></span><span>        </span><span class="annot"><a href="#local-6989586621679087845"><span class="hs-identifier hs-type">castZHom</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.ZMod.html#ZMod"><span class="hs-identifier hs-type">ZMod</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.ZMod.html#ZModHom"><span class="hs-identifier hs-type">ZModHom</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.ZMod.html#ZModHom"><span class="hs-identifier hs-type">ZModHom</span></a></span><span>
</span><span id="line-691"></span><span>        </span><span id="local-6989586621679087845"><span class="annot"><span class="annottext">castZHom :: ZMod -&gt; ZModHom -&gt; ZModHom
</span><a href="#local-6989586621679087845"><span class="hs-identifier hs-var hs-var">castZHom</span></a></span></span><span> </span><span id="local-6989586621679087846"><span class="annot"><span class="annottext">ZMod
</span><a href="#local-6989586621679087846"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679087847"><span class="annot"><span class="annottext">ZModHom
</span><a href="#local-6989586621679087847"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Orientation ZMod -&gt; Z -&gt; ZModHom
</span><a href="OAlg.AbelianGroup.ZMod.html#zmh"><span class="hs-identifier hs-var">zmh</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ZMod
</span><a href="#local-6989586621679087846"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">ZMod -&gt; ZMod -&gt; Orientation ZMod
forall p. p -&gt; p -&gt; Orientation p
</span><span class="hs-operator hs-var">:&gt;</span></span><span> </span><span class="annot"><span class="annottext">ZModHom -&gt; Point ZModHom
forall q. Oriented q =&gt; q -&gt; Point q
</span><span class="hs-identifier hs-var">end</span></span><span> </span><span class="annot"><span class="annottext">ZModHom
</span><a href="#local-6989586621679087847"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ZModHom -&gt; Z
</span><a href="OAlg.AbelianGroup.ZMod.html#toZ"><span class="hs-identifier hs-var">toZ</span></a></span><span> </span><span class="annot"><span class="annottext">ZModHom
</span><a href="#local-6989586621679087847"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-692"></span><span>
</span><span id="line-693"></span><span>    </span><span id="local-6989586621679087848"><span class="annot"><a href="#local-6989586621679087697"><span class="hs-identifier hs-type">lft</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Slice</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">From</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Free</span></span><span> </span><span class="annot"><a href="#local-6989586621679087848"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span></span><span>
</span><span id="line-694"></span><span>    </span><span id="local-6989586621679087697"><span class="annot"><span class="annottext">lft :: forall (k :: N'). Slice 'From (Free k) AbHom -&gt; AbHom
</span><a href="#local-6989586621679087697"><span class="hs-identifier hs-var hs-var">lft</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SliceFrom</span></span><span> </span><span class="annot"><span class="annottext">Free k AbHom
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Matrix</span></span><span> </span><span class="annot"><span class="annottext">Dim' ZModHom
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679087860"><span class="annot"><span class="annottext">Dim' ZModHom
</span><a href="#local-6989586621679087860"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679087861"><span class="annot"><span class="annottext">Entries N N ZModHom
</span><a href="#local-6989586621679087861"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix ZModHom -&gt; AbHom
</span><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-var">AbHom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dim' ZModHom
-&gt; Dim' ZModHom -&gt; Entries N N ZModHom -&gt; Matrix ZModHom
forall x. Dim' x -&gt; Dim' x -&gt; Entries N N x -&gt; Matrix x
</span><span class="hs-identifier hs-var">Matrix</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AbGroup -&gt; Dim' ZModHom
</span><a href="OAlg.AbelianGroup.Definition.html#abgDim"><span class="hs-identifier hs-var">abgDim</span></a></span><span> </span><span class="annot"><span class="annottext">AbGroup
</span><a href="#local-6989586621679087702"><span class="hs-identifier hs-var">g'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Dim' ZModHom
</span><a href="#local-6989586621679087860"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Entries N N ZModHom
</span><a href="#local-6989586621679087862"><span class="hs-identifier hs-var">xs'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-695"></span><span>      </span><span id="local-6989586621679087862"><span class="annot"><span class="annottext">xs' :: Entries N N ZModHom
</span><a href="#local-6989586621679087862"><span class="hs-identifier hs-var hs-var">xs'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Col N (Row N ZModHom) -&gt; Entries N N ZModHom
forall i j x. Col i (Row j x) -&gt; Entries i j x
</span><span class="hs-identifier hs-var">crets</span></span><span> </span><span class="annot"><span class="annottext">(Col N (Row N ZModHom) -&gt; Entries N N ZModHom)
-&gt; Col N (Row N ZModHom) -&gt; Entries N N ZModHom
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PSequence N (Row N ZModHom) -&gt; Col N (Row N ZModHom)
forall i x. PSequence i x -&gt; Col i x
</span><span class="hs-identifier hs-var">Col</span></span><span> </span><span class="annot"><span class="annottext">(PSequence N (Row N ZModHom) -&gt; Col N (Row N ZModHom))
-&gt; PSequence N (Row N ZModHom) -&gt; Col N (Row N ZModHom)
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(Row N ZModHom, N)] -&gt; PSequence N (Row N ZModHom)
forall i x. [(x, i)] -&gt; PSequence i x
</span><span class="hs-identifier hs-var">PSequence</span></span><span> </span><span class="annot"><span class="annottext">([(Row N ZModHom, N)] -&gt; PSequence N (Row N ZModHom))
-&gt; [(Row N ZModHom, N)] -&gt; PSequence N (Row N ZModHom)
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">N -&gt; [(ZMod, N)] -&gt; [(Row N ZModHom, N)] -&gt; [(Row N ZModHom, N)]
forall i j.
(Ord i, Enum i) =&gt;
i -&gt; [(ZMod, i)] -&gt; [(Row j ZModHom, i)] -&gt; [(Row j ZModHom, i)]
</span><a href="#local-6989586621679087863"><span class="hs-identifier hs-var">lftRows</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">[(ZMod, N)]
</span><a href="#local-6989586621679087698"><span class="hs-identifier hs-var">gs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Col N (Row N ZModHom) -&gt; [(Row N ZModHom, N)]
forall (s :: * -&gt; *) x. Sequence s N x =&gt; s x -&gt; [(x, N)]
</span><span class="hs-identifier hs-var">listN</span></span><span> </span><span class="annot"><span class="annottext">(Col N (Row N ZModHom) -&gt; [(Row N ZModHom, N)])
-&gt; Col N (Row N ZModHom) -&gt; [(Row N ZModHom, N)]
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Entries N N ZModHom -&gt; Col N (Row N ZModHom)
forall i j x. Eq i =&gt; Entries i j x -&gt; Col i (Row j x)
</span><span class="hs-identifier hs-var">etscr</span></span><span> </span><span class="annot"><span class="annottext">Entries N N ZModHom
</span><a href="#local-6989586621679087861"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-696"></span><span>
</span><span id="line-697"></span><span>      </span><span id="local-6989586621679085857"><span id="local-6989586621679085858"><span class="annot"><a href="#local-6989586621679087863"><span class="hs-identifier hs-type">lftRows</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679085857"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Enum</span></span><span> </span><span class="annot"><a href="#local-6989586621679085857"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-698"></span><span>        </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679085857"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="OAlg.AbelianGroup.ZMod.html#ZMod"><span class="hs-identifier hs-type">ZMod</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679085857"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Row</span></span><span> </span><span class="annot"><a href="#local-6989586621679085858"><span class="hs-identifier hs-type">j</span></a></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.ZMod.html#ZModHom"><span class="hs-identifier hs-type">ZModHom</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679085857"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Row</span></span><span> </span><span class="annot"><a href="#local-6989586621679085858"><span class="hs-identifier hs-type">j</span></a></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.ZMod.html#ZModHom"><span class="hs-identifier hs-type">ZModHom</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679085857"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span></span><span>
</span><span id="line-699"></span><span>      </span><span id="local-6989586621679087863"><span class="annot"><span class="annottext">lftRows :: forall i j.
(Ord i, Enum i) =&gt;
i -&gt; [(ZMod, i)] -&gt; [(Row j ZModHom, i)] -&gt; [(Row j ZModHom, i)]
</span><a href="#local-6989586621679087863"><span class="hs-identifier hs-var hs-var">lftRows</span></a></span></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[(Row j ZModHom, i)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-700"></span><span>      </span><span class="annot"><a href="#local-6989586621679087863"><span class="hs-identifier hs-var">lftRows</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[(ZMod, i)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-701"></span><span>      </span><span class="annot"><a href="#local-6989586621679087863"><span class="hs-identifier hs-var">lftRows</span></a></span><span> </span><span id="local-6989586621679087881"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679087881"><span class="hs-identifier hs-var">i''</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="OAlg.AbelianGroup.ZMod.html#ZMod"><span class="hs-identifier hs-type">ZMod</span></a></span><span> </span><span id="local-6989586621679087882"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679087882"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679087883"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679087883"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679087884"><span class="annot"><span class="annottext">[(ZMod, i)]
</span><a href="#local-6989586621679087884"><span class="hs-identifier hs-var">gs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679087885"><span class="annot"><span class="annottext">rws :: [(Row j ZModHom, i)]
</span><a href="#local-6989586621679087885"><span class="hs-identifier hs-var">rws</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679087886"><span class="annot"><span class="annottext">Row j ZModHom
</span><a href="#local-6989586621679087886"><span class="hs-identifier hs-var">rw</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679087887"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679087887"><span class="hs-identifier hs-var">i'</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679087888"><span class="annot"><span class="annottext">[(Row j ZModHom, i)]
</span><a href="#local-6989586621679087888"><span class="hs-identifier hs-var">rws'</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-702"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679087882"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">1</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">i -&gt; [(ZMod, i)] -&gt; [(Row j ZModHom, i)] -&gt; [(Row j ZModHom, i)]
forall i j.
(Ord i, Enum i) =&gt;
i -&gt; [(ZMod, i)] -&gt; [(Row j ZModHom, i)] -&gt; [(Row j ZModHom, i)]
</span><a href="#local-6989586621679087863"><span class="hs-identifier hs-var">lftRows</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679087881"><span class="hs-identifier hs-var">i''</span></a></span><span> </span><span class="annot"><span class="annottext">[(ZMod, i)]
</span><a href="#local-6989586621679087884"><span class="hs-identifier hs-var">gs</span></a></span><span> </span><span class="annot"><span class="annottext">[(Row j ZModHom, i)]
</span><a href="#local-6989586621679087885"><span class="hs-identifier hs-var">rws</span></a></span><span>
</span><span id="line-703"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679087883"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">i -&gt; i -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679087887"><span class="hs-identifier hs-var">i'</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ZModHom -&gt; ZModHom) -&gt; Row j ZModHom -&gt; Row j ZModHom
forall a b. (a -&gt; b) -&gt; Row j a -&gt; Row j b
forall (h :: * -&gt; * -&gt; *) (f :: * -&gt; *) a b.
Applicative1 h f =&gt;
h a b -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">amap1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Z -&gt; ZModHom
</span><a href="OAlg.AbelianGroup.ZMod.html#fromZ"><span class="hs-identifier hs-var">fromZ</span></a></span><span> </span><span class="annot"><span class="annottext">(Z -&gt; ZModHom) -&gt; (ZModHom -&gt; Z) -&gt; ZModHom -&gt; ZModHom
forall y z x. (y -&gt; z) -&gt; (x -&gt; y) -&gt; x -&gt; z
forall (c :: * -&gt; * -&gt; *) y z x.
Category c =&gt;
c y z -&gt; c x y -&gt; c x z
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ZModHom -&gt; Z
</span><a href="OAlg.AbelianGroup.ZMod.html#toZ"><span class="hs-identifier hs-var">toZ</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Row j ZModHom
</span><a href="#local-6989586621679087886"><span class="hs-identifier hs-var">rw</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679087881"><span class="hs-identifier hs-var">i''</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">(Row j ZModHom, i) -&gt; [(Row j ZModHom, i)] -&gt; [(Row j ZModHom, i)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">i -&gt; [(ZMod, i)] -&gt; [(Row j ZModHom, i)] -&gt; [(Row j ZModHom, i)]
forall i j.
(Ord i, Enum i) =&gt;
i -&gt; [(ZMod, i)] -&gt; [(Row j ZModHom, i)] -&gt; [(Row j ZModHom, i)]
</span><a href="#local-6989586621679087863"><span class="hs-identifier hs-var">lftRows</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i -&gt; i
forall a. Enum a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">succ</span></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679087881"><span class="hs-identifier hs-var">i''</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(ZMod, i)]
</span><a href="#local-6989586621679087884"><span class="hs-identifier hs-var">gs</span></a></span><span> </span><span class="annot"><span class="annottext">[(Row j ZModHom, i)]
</span><a href="#local-6989586621679087888"><span class="hs-identifier hs-var">rws'</span></a></span><span>
</span><span id="line-704"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">i -&gt; [(ZMod, i)] -&gt; [(Row j ZModHom, i)] -&gt; [(Row j ZModHom, i)]
forall i j.
(Ord i, Enum i) =&gt;
i -&gt; [(ZMod, i)] -&gt; [(Row j ZModHom, i)] -&gt; [(Row j ZModHom, i)]
</span><a href="#local-6989586621679087863"><span class="hs-identifier hs-var">lftRows</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i -&gt; i
forall a. Enum a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">succ</span></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679087881"><span class="hs-identifier hs-var">i''</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(ZMod, i)]
</span><a href="#local-6989586621679087884"><span class="hs-identifier hs-var">gs</span></a></span><span> </span><span class="annot"><span class="annottext">[(Row j ZModHom, i)]
</span><a href="#local-6989586621679087885"><span class="hs-identifier hs-var">rws</span></a></span><span>
</span><span id="line-705"></span><span>
</span><span id="line-706"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-707"></span><span class="hs-comment">-- XSomeFreeSliceFromLiftable -</span><span>
</span><span id="line-708"></span><span>
</span><span id="line-709"></span><span class="annot"><span class="hs-comment">-- | random variable for 'AbHom'.</span></span><span>
</span><span id="line-710"></span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#xsfsflAbHom"><span class="hs-identifier hs-type">xsfsflAbHom</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">XSomeFreeSliceFromLiftable</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span><span>
</span><span id="line-711"></span><span id="xsfsflAbHom"><span class="annot"><span class="annottext">xsfsflAbHom :: XSomeFreeSliceFromLiftable AbHom
</span><a href="OAlg.AbelianGroup.Definition.html#xsfsflAbHom"><span class="hs-identifier hs-var hs-var">xsfsflAbHom</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Point AbHom -&gt; X (SomeFreeSlice 'From AbHom))
-&gt; XSomeFreeSliceFromLiftable AbHom
forall a.
(Point a -&gt; X (SomeFreeSlice 'From a))
-&gt; XSomeFreeSliceFromLiftable a
</span><span class="hs-identifier hs-var">XSomeFreeSliceFromLiftable</span></span><span> </span><span class="annot"><span class="annottext">Point AbHom -&gt; X (SomeFreeSlice 'From AbHom)
AbGroup -&gt; X (SomeFreeSlice 'From AbHom)
</span><a href="#local-6989586621679087891"><span class="hs-identifier hs-var">xsf</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-712"></span><span>  </span><span id="local-6989586621679087895"><span class="annot"><span class="annottext">q :: Q
</span><a href="#local-6989586621679087895"><span class="hs-identifier hs-var hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Q
</span><span class="hs-number">0.1</span></span><span>
</span><span id="line-713"></span><span>  </span><span id="local-6989586621679087891"><span class="annot"><span class="annottext">xsf :: AbGroup -&gt; X (SomeFreeSlice 'From AbHom)
</span><a href="#local-6989586621679087891"><span class="hs-identifier hs-var hs-var">xsf</span></a></span></span><span> </span><span id="local-6989586621679087896"><span class="annot"><span class="annottext">AbGroup
</span><a href="#local-6989586621679087896"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-714"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">SomeNatural</span></span><span> </span><span id="local-6989586621679087913"><span class="annot"><span class="annottext">W n
</span><a href="#local-6989586621679087913"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">X N -&gt; X SomeNatural
</span><span class="hs-identifier hs-var">xSomeNatural</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">N -&gt; N -&gt; X N
</span><span class="hs-identifier hs-var">xNB</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="OAlg.AbelianGroup.Definition.html#stdMaxDim"><span class="hs-identifier hs-var">stdMaxDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-715"></span><span>    </span><span id="local-6989586621679087916"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679087916"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; X N
</span><span class="hs-identifier hs-var">xNB</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">10</span></span><span>
</span><span id="line-716"></span><span>    </span><span id="local-6989586621679087917"><span class="annot"><span class="annottext">AbHom
</span><a href="#local-6989586621679087917"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Q -&gt; N -&gt; N -&gt; N -&gt; AbGroup -&gt; X AbHom
</span><a href="OAlg.AbelianGroup.Definition.html#xAbHomTo"><span class="hs-identifier hs-var">xAbHomTo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">N -&gt; Q
forall a b. Embeddable a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">inj</span></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679087916"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Q -&gt; Q -&gt; Q
forall c. Multiplicative c =&gt; c -&gt; c -&gt; c
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Q
</span><a href="#local-6989586621679087895"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">W n -&gt; N
forall x. LengthN x =&gt; x -&gt; N
</span><span class="hs-identifier hs-var">lengthN</span></span><span> </span><span class="annot"><span class="annottext">W n
</span><a href="#local-6989586621679087913"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">AbGroup
</span><a href="#local-6989586621679087896"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-717"></span><span>    </span><span class="annot"><span class="annottext">SomeFreeSlice 'From AbHom -&gt; X (SomeFreeSlice 'From AbHom)
forall a. a -&gt; X a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(SomeFreeSlice 'From AbHom -&gt; X (SomeFreeSlice 'From AbHom))
-&gt; SomeFreeSlice 'From AbHom -&gt; X (SomeFreeSlice 'From AbHom)
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Slice 'From (Free n) AbHom -&gt; SomeFreeSlice 'From AbHom
forall (k :: N') c (s :: Site).
(Attestable k, Sliced (Free k) c) =&gt;
Slice s (Free k) c -&gt; SomeFreeSlice s c
</span><span class="hs-identifier hs-var">SomeFreeSlice</span></span><span> </span><span class="annot"><span class="annottext">(Slice 'From (Free n) AbHom -&gt; SomeFreeSlice 'From AbHom)
-&gt; Slice 'From (Free n) AbHom -&gt; SomeFreeSlice 'From AbHom
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Free n AbHom -&gt; AbHom -&gt; Slice 'From (Free n) AbHom
forall (i :: * -&gt; *) c. i c -&gt; c -&gt; Slice 'From i c
</span><span class="hs-identifier hs-var">SliceFrom</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">W n -&gt; Free n AbHom
forall (k :: N') c. Any k -&gt; Free k c
</span><span class="hs-identifier hs-var">Free</span></span><span> </span><span class="annot"><span class="annottext">W n
</span><a href="#local-6989586621679087913"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">AbHom
</span><a href="#local-6989586621679087917"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-718"></span><span>    </span><span>
</span><span id="line-719"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">XStandardSomeFreeSliceFromLiftable</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-720"></span><span>  </span><span id="local-6989586621679087922"><span class="annot"><span class="annottext">xStandardSomeFreeSliceFromLiftable :: XSomeFreeSliceFromLiftable AbHom
</span><a href="#local-6989586621679087922"><span class="hs-identifier hs-var hs-var hs-var hs-var">xStandardSomeFreeSliceFromLiftable</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XSomeFreeSliceFromLiftable AbHom
</span><a href="OAlg.AbelianGroup.Definition.html#xsfsflAbHom"><span class="hs-identifier hs-var">xsfsflAbHom</span></a></span><span>
</span><span id="line-721"></span><span>  </span><span>
</span><span id="line-722"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-723"></span><span class="hs-comment">-- AbGroup - XStandard -</span><span>
</span><span id="line-724"></span><span>
</span><span id="line-725"></span><span class="hs-comment">-- | the maximal length of abelian groups for the standard random variable of type</span><span>
</span><span id="line-726"></span><span class="hs-comment">-- @'X' 'AbGroup'@.</span><span>
</span><span id="line-727"></span><span class="hs-comment">--</span><span>
</span><span id="line-728"></span><span class="hs-comment">-- __Property__ @1 '&lt;=' 'stdMaxDim'@.</span><span>
</span><span id="line-729"></span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#stdMaxDim"><span class="hs-identifier hs-type">stdMaxDim</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">N</span></span><span>
</span><span id="line-730"></span><span id="stdMaxDim"><span class="annot"><span class="annottext">stdMaxDim :: N
</span><a href="OAlg.AbelianGroup.Definition.html#stdMaxDim"><span class="hs-identifier hs-var hs-var">stdMaxDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">10</span></span><span>
</span><span id="line-731"></span><span>
</span><span id="line-732"></span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#stdMaxPrime"><span class="hs-identifier hs-type">stdMaxPrime</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">N</span></span><span>
</span><span id="line-733"></span><span id="stdMaxPrime"><span class="annot"><span class="annottext">stdMaxPrime :: N
</span><a href="OAlg.AbelianGroup.Definition.html#stdMaxPrime"><span class="hs-identifier hs-var hs-var">stdMaxPrime</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">1000</span></span><span>
</span><span id="line-734"></span><span>
</span><span id="line-735"></span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#stdPrimes"><span class="hs-identifier hs-type">stdPrimes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">N</span></span><span class="hs-special">]</span><span>
</span><span id="line-736"></span><span id="stdPrimes"><span class="annot"><span class="annottext">stdPrimes :: [N]
</span><a href="OAlg.AbelianGroup.Definition.html#stdPrimes"><span class="hs-identifier hs-var hs-var">stdPrimes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(N -&gt; Bool) -&gt; [N] -&gt; [N]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">takeWhile</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">N -&gt; N -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span class="annot"><span class="annottext">N
</span><a href="OAlg.AbelianGroup.Definition.html#stdMaxPrime"><span class="hs-identifier hs-var">stdMaxPrime</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[N]
</span><span class="hs-identifier hs-var">primes</span></span><span>
</span><span id="line-737"></span><span>
</span><span id="line-738"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">XStandard</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbGroup"><span class="hs-identifier hs-type">AbGroup</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-739"></span><span>  </span><span id="local-6989586621679087946"><span class="annot"><span class="annottext">xStandard :: X AbGroup
</span><a href="#local-6989586621679087946"><span class="hs-identifier hs-var hs-var hs-var hs-var">xStandard</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">X (X AbGroup) -&gt; X AbGroup
forall (m :: * -&gt; *) a. Monad m =&gt; m (m a) -&gt; m a
</span><span class="hs-identifier hs-var">join</span></span><span>
</span><span id="line-740"></span><span>            </span><span class="annot"><span class="annottext">(X (X AbGroup) -&gt; X AbGroup) -&gt; X (X AbGroup) -&gt; X AbGroup
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(Q, X AbGroup)] -&gt; X (X AbGroup)
forall a. [(Q, a)] -&gt; X a
</span><span class="hs-identifier hs-var">xOneOfW</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Q
</span><span class="hs-number">99</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">([ZMod] -&gt; AbGroup) -&gt; X [ZMod] -&gt; X AbGroup
forall a b. (a -&gt; b) -&gt; X a -&gt; X b
forall (h :: * -&gt; * -&gt; *) (f :: * -&gt; *) a b.
Applicative1 h f =&gt;
h a b -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">amap1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProductSymbol ZMod -&gt; AbGroup
</span><a href="OAlg.AbelianGroup.Definition.html#AbGroup"><span class="hs-identifier hs-var">AbGroup</span></a></span><span> </span><span class="annot"><span class="annottext">(ProductSymbol ZMod -&gt; AbGroup)
-&gt; ([ZMod] -&gt; ProductSymbol ZMod) -&gt; [ZMod] -&gt; AbGroup
forall y z x. (y -&gt; z) -&gt; (x -&gt; y) -&gt; x -&gt; z
forall (c :: * -&gt; * -&gt; *) y z x.
Category c =&gt;
c y z -&gt; c x y -&gt; c x z
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[ZMod] -&gt; ProductSymbol ZMod
forall x. Entity x =&gt; [x] -&gt; ProductSymbol x
</span><span class="hs-identifier hs-var">productSymbol</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(X [ZMod] -&gt; X AbGroup) -&gt; X [ZMod] -&gt; X AbGroup
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; X ZMod -&gt; X [ZMod]
forall x. N -&gt; N -&gt; X x -&gt; X [x]
</span><span class="hs-identifier hs-var">xTakeB</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="OAlg.AbelianGroup.Definition.html#stdMaxDim"><span class="hs-identifier hs-var">stdMaxDim</span></a></span><span> </span><span class="annot"><span class="annottext">X ZMod
forall x. XStandard x =&gt; X x
</span><span class="hs-identifier hs-var">xStandard</span></span><span class="hs-special">)</span><span>
</span><span id="line-741"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Q
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">AbGroup -&gt; X AbGroup
forall a. a -&gt; X a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(AbGroup -&gt; X AbGroup) -&gt; AbGroup -&gt; X AbGroup
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Point AbGroup -&gt; AbGroup
forall c. Multiplicative c =&gt; Point c -&gt; c
</span><span class="hs-identifier hs-var">one</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-742"></span><span>                      </span><span class="hs-special">]</span><span>
</span><span id="line-743"></span><span>
</span><span id="line-744"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">XStandardPoint</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span><span>
</span><span id="line-745"></span><span>
</span><span id="line-746"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-747"></span><span class="hs-comment">-- xAbHom -</span><span>
</span><span id="line-748"></span><span>
</span><span id="line-749"></span><span class="annot"><span class="hs-comment">-- | random variable for 'AbHom' given by a density and an orientation.</span></span><span>
</span><span id="line-750"></span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#xAbHom"><span class="hs-identifier hs-type">xAbHom</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Orientation</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbGroup"><span class="hs-identifier hs-type">AbGroup</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span><span>
</span><span id="line-751"></span><span id="xAbHom"><span class="annot"><span class="annottext">xAbHom :: Q -&gt; Orientation AbGroup -&gt; X AbHom
</span><a href="OAlg.AbelianGroup.Definition.html#xAbHom"><span class="hs-identifier hs-var hs-var">xAbHom</span></a></span></span><span> </span><span id="local-6989586621679087956"><span class="annot"><span class="annottext">Q
</span><a href="#local-6989586621679087956"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Q -&gt; X Z -&gt; Orientation AbGroup -&gt; X AbHom
</span><a href="OAlg.AbelianGroup.Definition.html#xAbHom%27"><span class="hs-identifier hs-var">xAbHom'</span></a></span><span> </span><span class="annot"><span class="annottext">Q
</span><a href="#local-6989586621679087956"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Z -&gt; Z -&gt; X Z
</span><span class="hs-identifier hs-var">xZB</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Z
</span><span class="hs-number">100</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Z
</span><span class="hs-number">100</span></span><span class="hs-special">)</span><span>
</span><span id="line-752"></span><span>
</span><span id="line-753"></span><span class="annot"><span class="hs-comment">-- | random variable of homomorphism of the given 'Orientation.</span></span><span>
</span><span id="line-754"></span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#xAbHom%27"><span class="hs-identifier hs-type">xAbHom'</span></a></span><span>
</span><span id="line-755"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ density @d@.</span></span><span>
</span><span id="line-756"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Z</span></span><span>
</span><span id="line-757"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Orientation</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbGroup"><span class="hs-identifier hs-type">AbGroup</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span><span>
</span><span id="line-758"></span><span id="xAbHom%27"><span class="annot"><span class="annottext">xAbHom' :: Q -&gt; X Z -&gt; Orientation AbGroup -&gt; X AbHom
</span><a href="OAlg.AbelianGroup.Definition.html#xAbHom%27"><span class="hs-identifier hs-var hs-var">xAbHom'</span></a></span></span><span> </span><span id="local-6989586621679087959"><span class="annot"><span class="annottext">Q
</span><a href="#local-6989586621679087959"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679087960"><span class="annot"><span class="annottext">X Z
</span><a href="#local-6989586621679087960"><span class="hs-identifier hs-var">xz</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbGroup"><span class="hs-identifier hs-type">AbGroup</span></a></span><span> </span><span id="local-6989586621679087961"><span class="annot"><span class="annottext">ProductSymbol ZMod
</span><a href="#local-6989586621679087961"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&gt;</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbGroup"><span class="hs-identifier hs-type">AbGroup</span></a></span><span> </span><span id="local-6989586621679087962"><span class="annot"><span class="annottext">ProductSymbol ZMod
</span><a href="#local-6989586621679087962"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-759"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679087963"><span class="hs-identifier hs-var">dab</span></a></span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AbHom -&gt; X AbHom
forall a. a -&gt; X a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(AbHom -&gt; X AbHom) -&gt; AbHom -&gt; X AbHom
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Matrix ZModHom -&gt; AbHom
</span><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-var">AbHom</span></a></span><span> </span><span class="annot"><span class="annottext">(Matrix ZModHom -&gt; AbHom) -&gt; Matrix ZModHom -&gt; AbHom
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Root (Matrix ZModHom) -&gt; Matrix ZModHom
forall a. Additive a =&gt; Root a -&gt; a
</span><span class="hs-identifier hs-var">zero</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CSequence (Point ZModHom) -&gt; Dim' ZModHom
forall x. CSequence (Point x) -&gt; Dim x (Point x)
</span><span class="hs-identifier hs-var">Dim</span></span><span> </span><span class="annot"><span class="annottext">CSequence (Point ZModHom)
ProductSymbol ZMod
</span><a href="#local-6989586621679087961"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Dim ZModHom ZMod
-&gt; Dim ZModHom ZMod -&gt; Orientation (Dim ZModHom ZMod)
forall p. p -&gt; p -&gt; Orientation p
</span><span class="hs-operator hs-var">:&gt;</span></span><span> </span><span class="annot"><span class="annottext">CSequence (Point ZModHom) -&gt; Dim' ZModHom
forall x. CSequence (Point x) -&gt; Dim x (Point x)
</span><span class="hs-identifier hs-var">Dim</span></span><span> </span><span class="annot"><span class="annottext">CSequence (Point ZModHom)
ProductSymbol ZMod
</span><a href="#local-6989586621679087962"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-760"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">X [(ZModHom, N, N)]
</span><a href="#local-6989586621679087964"><span class="hs-identifier hs-var">xxs</span></a></span><span> </span><span class="annot"><span class="annottext">X [(ZModHom, N, N)] -&gt; ([(ZModHom, N, N)] -&gt; X AbHom) -&gt; X AbHom
forall a b. X a -&gt; (a -&gt; X b) -&gt; X b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">AbHom -&gt; X AbHom
forall a. a -&gt; X a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(AbHom -&gt; X AbHom)
-&gt; ([(ZModHom, N, N)] -&gt; AbHom) -&gt; [(ZModHom, N, N)] -&gt; X AbHom
forall y z x. (y -&gt; z) -&gt; (x -&gt; y) -&gt; x -&gt; z
forall (c :: * -&gt; * -&gt; *) y z x.
Category c =&gt;
c y z -&gt; c x y -&gt; c x z
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Matrix ZModHom -&gt; AbHom
</span><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-var">AbHom</span></a></span><span> </span><span class="annot"><span class="annottext">(Matrix ZModHom -&gt; AbHom)
-&gt; ([(ZModHom, N, N)] -&gt; Matrix ZModHom)
-&gt; [(ZModHom, N, N)]
-&gt; AbHom
forall y z x. (y -&gt; z) -&gt; (x -&gt; y) -&gt; x -&gt; z
forall (c :: * -&gt; * -&gt; *) y z x.
Category c =&gt;
c y z -&gt; c x y -&gt; c x z
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Dim' ZModHom -&gt; Dim' ZModHom -&gt; [(ZModHom, N, N)] -&gt; Matrix ZModHom
forall x p.
(Additive x, p ~ Point x) =&gt;
Dim x p -&gt; Dim x p -&gt; [(x, N, N)] -&gt; Matrix x
</span><span class="hs-identifier hs-var">matrix</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CSequence (Point ZModHom) -&gt; Dim' ZModHom
forall x. CSequence (Point x) -&gt; Dim x (Point x)
</span><span class="hs-identifier hs-var">Dim</span></span><span> </span><span class="annot"><span class="annottext">CSequence (Point ZModHom)
ProductSymbol ZMod
</span><a href="#local-6989586621679087962"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CSequence (Point ZModHom) -&gt; Dim' ZModHom
forall x. CSequence (Point x) -&gt; Dim x (Point x)
</span><span class="hs-identifier hs-var">Dim</span></span><span> </span><span class="annot"><span class="annottext">CSequence (Point ZModHom)
ProductSymbol ZMod
</span><a href="#local-6989586621679087961"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-761"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-762"></span><span>    </span><span id="local-6989586621679087965"><span class="annot"><span class="annottext">as :: [(ZMod, N)]
</span><a href="#local-6989586621679087965"><span class="hs-keyword hs-var hs-var">as</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProductSymbol ZMod -&gt; [(ZMod, N)]
forall x. ProductSymbol x -&gt; [(x, N)]
</span><span class="hs-identifier hs-var">psyxs</span></span><span> </span><span class="annot"><span class="annottext">ProductSymbol ZMod
</span><a href="#local-6989586621679087961"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-763"></span><span>    </span><span id="local-6989586621679087966"><span class="annot"><span class="annottext">bs :: [(ZMod, N)]
</span><a href="#local-6989586621679087966"><span class="hs-identifier hs-var hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProductSymbol ZMod -&gt; [(ZMod, N)]
forall x. ProductSymbol x -&gt; [(x, N)]
</span><span class="hs-identifier hs-var">psyxs</span></span><span> </span><span class="annot"><span class="annottext">ProductSymbol ZMod
</span><a href="#local-6989586621679087962"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-764"></span><span>    </span><span id="local-6989586621679087967"><span class="annot"><span class="annottext">da :: N
</span><a href="#local-6989586621679087967"><span class="hs-identifier hs-var hs-var">da</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(ZMod, N)] -&gt; N
forall x. LengthN x =&gt; x -&gt; N
</span><span class="hs-identifier hs-var">lengthN</span></span><span> </span><span class="annot"><span class="annottext">[(ZMod, N)]
</span><a href="#local-6989586621679087965"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-765"></span><span>    </span><span id="local-6989586621679087968"><span class="annot"><span class="annottext">db :: N
</span><a href="#local-6989586621679087968"><span class="hs-identifier hs-var hs-var">db</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(ZMod, N)] -&gt; N
forall x. LengthN x =&gt; x -&gt; N
</span><span class="hs-identifier hs-var">lengthN</span></span><span> </span><span class="annot"><span class="annottext">[(ZMod, N)]
</span><a href="#local-6989586621679087966"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-766"></span><span>        </span><span>
</span><span id="line-767"></span><span>    </span><span id="local-6989586621679087963"><span class="annot"><span class="annottext">dab :: N
</span><a href="#local-6989586621679087963"><span class="hs-identifier hs-var hs-var">dab</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679087967"><span class="hs-identifier hs-var">da</span></a></span><span class="annot"><span class="annottext">N -&gt; N -&gt; N
forall c. Multiplicative c =&gt; c -&gt; c -&gt; c
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679087968"><span class="hs-identifier hs-var">db</span></a></span><span>
</span><span id="line-768"></span><span>    </span><span id="local-6989586621679087969"><span class="annot"><span class="annottext">n :: N
</span><a href="#local-6989586621679087969"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Z -&gt; N
forall a b. Projectible a b =&gt; b -&gt; a
</span><span class="hs-identifier hs-var">prj</span></span><span> </span><span class="annot"><span class="annottext">(Z -&gt; N) -&gt; Z -&gt; N
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Q -&gt; Z
forall r. Number r =&gt; r -&gt; Z
</span><span class="hs-identifier hs-var">zFloor</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Q
</span><a href="#local-6989586621679087959"><span class="hs-identifier hs-var">d</span></a></span><span class="annot"><span class="annottext">Q -&gt; Q -&gt; Q
forall c. Multiplicative c =&gt; c -&gt; c -&gt; c
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">N -&gt; Q
forall a b. Embeddable a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">inj</span></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679087963"><span class="hs-identifier hs-var">dab</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">N</span></span><span>
</span><span id="line-769"></span><span>
</span><span id="line-770"></span><span>    </span><span id="local-6989586621679087972"><span class="annot"><span class="annottext">xs :: [((ZModHom, N), N, N)]
</span><a href="#local-6989586621679087972"><span class="hs-identifier hs-var hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(((ZModHom, N), N, N) -&gt; Bool)
-&gt; [((ZModHom, N), N, N)] -&gt; [((ZModHom, N), N, N)]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679087973"><span class="annot"><span class="annottext">ZModHom
</span><a href="#local-6989586621679087973"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">N
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">N
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">N
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
forall b. Boolean b =&gt; b -&gt; b
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ZModHom -&gt; Bool
forall a. Additive a =&gt; a -&gt; Bool
</span><span class="hs-identifier hs-var">isZero</span></span><span> </span><span class="annot"><span class="annottext">ZModHom
</span><a href="#local-6989586621679087973"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-771"></span><span>       </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Orientation ZMod -&gt; (ZModHom, N)
</span><a href="OAlg.AbelianGroup.ZMod.html#zmhGenOrd"><span class="hs-identifier hs-var">zmhGenOrd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ZMod
</span><a href="#local-6989586621679087977"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">ZMod -&gt; ZMod -&gt; Orientation ZMod
forall p. p -&gt; p -&gt; Orientation p
</span><span class="hs-operator hs-var">:&gt;</span></span><span> </span><span class="annot"><span class="annottext">ZMod
</span><a href="#local-6989586621679087978"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679087979"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679087980"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679087977"><span class="annot"><span class="annottext">ZMod
</span><a href="#local-6989586621679087977"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679087980"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679087980"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(ZMod, N)]
</span><a href="#local-6989586621679087965"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679087978"><span class="annot"><span class="annottext">ZMod
</span><a href="#local-6989586621679087978"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679087979"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679087979"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(ZMod, N)]
</span><a href="#local-6989586621679087966"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">]</span><span> </span><span>
</span><span id="line-772"></span><span>         </span><span>
</span><span id="line-773"></span><span>    </span><span id="local-6989586621679087964"><span class="annot"><span class="annottext">xxs :: X [(ZModHom, N, N)]
</span><a href="#local-6989586621679087964"><span class="hs-identifier hs-var hs-var">xxs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-774"></span><span>      </span><span id="local-6989586621679087981"><span class="annot"><span class="annottext">Permutation N
</span><a href="#local-6989586621679087981"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; X (Permutation N)
forall i. (Ord i, Enum i) =&gt; i -&gt; i -&gt; X (Permutation i)
</span><span class="hs-identifier hs-var">xPermutationB</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">N -&gt; N
forall a. Enum a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">pred</span></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679087963"><span class="hs-identifier hs-var">dab</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- 0 &lt; dba</span><span>
</span><span id="line-775"></span><span>      </span><span class="annot"><span class="annottext">[((ZModHom, N), N, N)] -&gt; X [(ZModHom, N, N)]
</span><a href="#local-6989586621679087984"><span class="hs-identifier hs-var">xets</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">N -&gt; [((ZModHom, N), N, N)] -&gt; [((ZModHom, N), N, N)]
forall a. N -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">takeN</span></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679087969"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[((ZModHom, N), N, N)]
</span><a href="#local-6989586621679087972"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">[((ZModHom, N), N, N)] -&gt; Permutation N -&gt; [((ZModHom, N), N, N)]
forall f x. Opr f x =&gt; x -&gt; f -&gt; x
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Permutation N
</span><a href="#local-6989586621679087981"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-776"></span><span>
</span><span id="line-777"></span><span>    </span><span id="local-6989586621679087984"><span class="annot"><span class="annottext">xets :: [((ZModHom, N), N, N)] -&gt; X [(ZModHom, N, N)]
</span><a href="#local-6989586621679087984"><span class="hs-identifier hs-var hs-var">xets</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(ZModHom, N, N)] -&gt; X [(ZModHom, N, N)]
forall a. a -&gt; X a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-778"></span><span>    </span><span class="annot"><a href="#local-6989586621679087984"><span class="hs-identifier hs-var">xets</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679087987"><span class="annot"><span class="annottext">(ZModHom, N)
</span><a href="#local-6989586621679087987"><span class="hs-identifier hs-var">ho</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679087988"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679087988"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679087989"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679087989"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679087990"><span class="annot"><span class="annottext">[((ZModHom, N), N, N)]
</span><a href="#local-6989586621679087990"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-779"></span><span>      </span><span id="local-6989586621679087991"><span class="annot"><span class="annottext">[(ZModHom, N, N)]
</span><a href="#local-6989586621679087991"><span class="hs-identifier hs-var">xs'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[((ZModHom, N), N, N)] -&gt; X [(ZModHom, N, N)]
</span><a href="#local-6989586621679087984"><span class="hs-identifier hs-var">xets</span></a></span><span> </span><span class="annot"><span class="annottext">[((ZModHom, N), N, N)]
</span><a href="#local-6989586621679087990"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-780"></span><span>      </span><span id="local-6989586621679087992"><span class="annot"><span class="annottext">ZModHom
</span><a href="#local-6989586621679087992"><span class="hs-identifier hs-var">h'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(ZModHom, N) -&gt; X ZModHom
</span><a href="#local-6989586621679087993"><span class="hs-identifier hs-var">xh</span></a></span><span> </span><span class="annot"><span class="annottext">(ZModHom, N)
</span><a href="#local-6989586621679087987"><span class="hs-identifier hs-var">ho</span></a></span><span>
</span><span id="line-781"></span><span>      </span><span class="annot"><span class="annottext">[(ZModHom, N, N)] -&gt; X [(ZModHom, N, N)]
forall a. a -&gt; X a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">ZModHom
</span><a href="#local-6989586621679087992"><span class="hs-identifier hs-var">h'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679087988"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679087989"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">(ZModHom, N, N) -&gt; [(ZModHom, N, N)] -&gt; [(ZModHom, N, N)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[(ZModHom, N, N)]
</span><a href="#local-6989586621679087991"><span class="hs-identifier hs-var">xs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-782"></span><span>
</span><span id="line-783"></span><span>    </span><span id="local-6989586621679087993"><span class="annot"><span class="annottext">xh :: (ZModHom, N) -&gt; X ZModHom
</span><a href="#local-6989586621679087993"><span class="hs-identifier hs-var hs-var">xh</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679087994"><span class="annot"><span class="annottext">ZModHom
</span><a href="#local-6989586621679087994"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">X Z
</span><a href="#local-6989586621679087960"><span class="hs-identifier hs-var">xz</span></a></span><span> </span><span class="annot"><span class="annottext">X Z -&gt; (Z -&gt; X ZModHom) -&gt; X ZModHom
forall a b. X a -&gt; (a -&gt; X b) -&gt; X b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">ZModHom -&gt; X ZModHom
forall a. a -&gt; X a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(ZModHom -&gt; X ZModHom) -&gt; (Z -&gt; ZModHom) -&gt; Z -&gt; X ZModHom
forall y z x. (y -&gt; z) -&gt; (x -&gt; y) -&gt; x -&gt; z
forall (c :: * -&gt; * -&gt; *) y z x.
Category c =&gt;
c y z -&gt; c x y -&gt; c x z
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Scalar ZModHom -&gt; ZModHom -&gt; ZModHom
forall v. Vectorial v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">!</span></span><span> </span><span class="annot"><span class="annottext">ZModHom
</span><a href="#local-6989586621679087994"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-784"></span><span>    </span><span class="annot"><a href="#local-6989586621679087993"><span class="hs-identifier hs-var">xh</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679087995"><span class="annot"><span class="annottext">ZModHom
</span><a href="#local-6989586621679087995"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">N
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ZModHom -&gt; X ZModHom
forall a. a -&gt; X a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">ZModHom
</span><a href="#local-6989586621679087995"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-785"></span><span>    </span><span class="annot"><a href="#local-6989586621679087993"><span class="hs-identifier hs-var">xh</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679087996"><span class="annot"><span class="annottext">ZModHom
</span><a href="#local-6989586621679087996"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679087997"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679087997"><span class="hs-identifier hs-var">o</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-786"></span><span>      </span><span id="local-6989586621679087998"><span class="annot"><span class="annottext">Z
</span><a href="#local-6989586621679087998"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Z -&gt; Z -&gt; X Z
</span><span class="hs-identifier hs-var">xZB</span></span><span> </span><span class="annot"><span class="annottext">Z
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Z -&gt; Z
forall a. Enum a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">pred</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">N -&gt; Z
forall a b. Embeddable a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">inj</span></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679087997"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-787"></span><span>      </span><span class="annot"><span class="annottext">ZModHom -&gt; X ZModHom
forall a. a -&gt; X a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Z
Scalar ZModHom
</span><a href="#local-6989586621679087998"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">Scalar ZModHom -&gt; ZModHom -&gt; ZModHom
forall v. Vectorial v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">!</span></span><span> </span><span class="annot"><span class="annottext">ZModHom
</span><a href="#local-6989586621679087996"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-788"></span><span>
</span><span id="line-789"></span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#dstXAbHom"><span class="hs-identifier hs-type">dstXAbHom</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Orientation</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbGroup"><span class="hs-identifier hs-type">AbGroup</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-790"></span><span id="dstXAbHom"><span class="annot"><span class="annottext">dstXAbHom :: (AbHom -&gt; String) -&gt; Int -&gt; Q -&gt; Orientation AbGroup -&gt; IO ()
</span><a href="OAlg.AbelianGroup.Definition.html#dstXAbHom"><span class="hs-identifier hs-var hs-var">dstXAbHom</span></a></span></span><span> </span><span id="local-6989586621679088000"><span class="annot"><span class="annottext">AbHom -&gt; String
</span><a href="#local-6989586621679088000"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679088001"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679088001"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679088002"><span class="annot"><span class="annottext">Q
</span><a href="#local-6989586621679088002"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span id="local-6989586621679088003"><span class="annot"><span class="annottext">Orientation AbGroup
</span><a href="#local-6989586621679088003"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO Omega
</span><span class="hs-identifier hs-var">getOmega</span></span><span> </span><span class="annot"><span class="annottext">IO Omega -&gt; (Omega -&gt; IO ()) -&gt; IO ()
forall a b. IO a -&gt; (a -&gt; IO b) -&gt; IO b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; X String -&gt; Omega -&gt; IO ()
forall x. (Show x, Ord x) =&gt; Int -&gt; X x -&gt; Omega -&gt; IO ()
</span><span class="hs-identifier hs-var">putDistribution</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679088001"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(AbHom -&gt; String) -&gt; X AbHom -&gt; X String
forall a b. (a -&gt; b) -&gt; X a -&gt; X b
forall (h :: * -&gt; * -&gt; *) (f :: * -&gt; *) a b.
Applicative1 h f =&gt;
h a b -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">amap1</span></span><span> </span><span class="annot"><span class="annottext">AbHom -&gt; String
</span><a href="#local-6989586621679088000"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">(X AbHom -&gt; X String) -&gt; X AbHom -&gt; X String
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Q -&gt; Orientation AbGroup -&gt; X AbHom
</span><a href="OAlg.AbelianGroup.Definition.html#xAbHom"><span class="hs-identifier hs-var">xAbHom</span></a></span><span> </span><span class="annot"><span class="annottext">Q
</span><a href="#local-6989586621679088002"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Orientation AbGroup
</span><a href="#local-6989586621679088003"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-791"></span><span>
</span><span id="line-792"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-793"></span><span class="hs-comment">-- xAbHomTo -</span><span>
</span><span id="line-794"></span><span>
</span><span id="line-795"></span><span class="hs-comment">-- | random variable of homomorphisms between abelian groups with 'end' equal to the given</span><span>
</span><span id="line-796"></span><span class="hs-comment">-- one.</span><span>
</span><span id="line-797"></span><span class="hs-comment">--</span><span>
</span><span id="line-798"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-799"></span><span class="hs-comment">--    r s t</span><span>
</span><span id="line-800"></span><span class="hs-comment">--   [f    ] a</span><span>
</span><span id="line-801"></span><span class="hs-comment">--   [     ] b</span><span>
</span><span id="line-802"></span><span class="hs-comment">--   [g h  ] c</span><span>
</span><span id="line-803"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-804"></span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#xAbHomTo"><span class="hs-identifier hs-type">xAbHomTo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">N</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">N</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">N</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbGroup"><span class="hs-identifier hs-type">AbGroup</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span><span>
</span><span id="line-805"></span><span id="xAbHomTo"><span class="annot"><span class="annottext">xAbHomTo :: Q -&gt; N -&gt; N -&gt; N -&gt; AbGroup -&gt; X AbHom
</span><a href="OAlg.AbelianGroup.Definition.html#xAbHomTo"><span class="hs-identifier hs-var hs-var">xAbHomTo</span></a></span></span><span> </span><span id="local-6989586621679088006"><span class="annot"><span class="annottext">Q
</span><a href="#local-6989586621679088006"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679088007"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679088007"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679088008"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679088008"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679088009"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679088009"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbGroup"><span class="hs-identifier hs-type">AbGroup</span></a></span><span> </span><span id="local-6989586621679088010"><span class="annot"><span class="annottext">ProductSymbol ZMod
</span><a href="#local-6989586621679088010"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Matrix ZModHom -&gt; AbHom) -&gt; X (Matrix ZModHom) -&gt; X AbHom
forall a b. (a -&gt; b) -&gt; X a -&gt; X b
forall (h :: * -&gt; * -&gt; *) (f :: * -&gt; *) a b.
Applicative1 h f =&gt;
h a b -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">amap1</span></span><span> </span><span class="annot"><span class="annottext">Matrix ZModHom -&gt; AbHom
</span><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-var">AbHom</span></a></span><span> </span><span class="annot"><span class="annottext">X (Matrix ZModHom)
</span><a href="#local-6989586621679088011"><span class="hs-identifier hs-var">xm</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-806"></span><span>
</span><span id="line-807"></span><span>  </span><span class="annot"><a href="#local-6989586621679088011"><span class="hs-identifier hs-type">xm</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Matrix</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.ZMod.html#ZModHom"><span class="hs-identifier hs-type">ZModHom</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-808"></span><span>  </span><span id="local-6989586621679088011"><span class="annot"><span class="annottext">xm :: X (Matrix ZModHom)
</span><a href="#local-6989586621679088011"><span class="hs-identifier hs-var hs-var">xm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-809"></span><span>    </span><span id="local-6989586621679088012"><span class="annot"><span class="annottext">ProductSymbol ZMod
</span><a href="#local-6989586621679088012"><span class="hs-identifier hs-var">dr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ProductSymbol ZMod -&gt; X (ProductSymbol ZMod)
forall a. a -&gt; X a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ZMod -&gt; ProductSymbol ZMod
forall x. Entity x =&gt; x -&gt; ProductSymbol x
</span><span class="hs-identifier hs-var">sy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">N -&gt; ZMod
</span><a href="OAlg.AbelianGroup.ZMod.html#ZMod"><span class="hs-identifier hs-var">ZMod</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ProductSymbol ZMod
-&gt; Exponent (ProductSymbol ZMod) -&gt; ProductSymbol ZMod
forall f. Exponential f =&gt; f -&gt; Exponent f -&gt; f
</span><span class="hs-operator hs-var">^</span></span><span> </span><span class="annot"><span class="annottext">N
Exponent (ProductSymbol ZMod)
</span><a href="#local-6989586621679088007"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-810"></span><span>    </span><span id="local-6989586621679088013"><span class="annot"><span class="annottext">ProductSymbol ZMod
</span><a href="#local-6989586621679088013"><span class="hs-identifier hs-var">ds</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">X (ProductSymbol ZMod)
</span><a href="#local-6989586621679088014"><span class="hs-identifier hs-var">xds</span></a></span><span>
</span><span id="line-811"></span><span>    </span><span id="local-6989586621679088015"><span class="annot"><span class="annottext">ProductSymbol ZMod
</span><a href="#local-6989586621679088015"><span class="hs-identifier hs-var">dt</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">X (ProductSymbol ZMod)
</span><a href="#local-6989586621679088016"><span class="hs-identifier hs-var">xdt</span></a></span><span>
</span><span id="line-812"></span><span>    </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span><span> </span><span id="local-6989586621679088017"><span class="annot"><span class="annottext">Matrix ZModHom
</span><a href="#local-6989586621679088017"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Q -&gt; Orientation AbGroup -&gt; X AbHom
</span><a href="OAlg.AbelianGroup.Definition.html#xAbHom"><span class="hs-identifier hs-var">xAbHom</span></a></span><span> </span><span class="annot"><span class="annottext">Q
</span><a href="#local-6989586621679088006"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProductSymbol ZMod -&gt; AbGroup
</span><a href="OAlg.AbelianGroup.Definition.html#AbGroup"><span class="hs-identifier hs-var">AbGroup</span></a></span><span> </span><span class="annot"><span class="annottext">ProductSymbol ZMod
</span><a href="#local-6989586621679088012"><span class="hs-identifier hs-var">dr</span></a></span><span> </span><span class="annot"><span class="annottext">AbGroup -&gt; AbGroup -&gt; Orientation AbGroup
forall p. p -&gt; p -&gt; Orientation p
</span><span class="hs-operator hs-var">:&gt;</span></span><span> </span><span class="annot"><span class="annottext">ProductSymbol ZMod -&gt; AbGroup
</span><a href="OAlg.AbelianGroup.Definition.html#AbGroup"><span class="hs-identifier hs-var">AbGroup</span></a></span><span> </span><span class="annot"><span class="annottext">ProductSymbol ZMod
</span><a href="#local-6989586621679088018"><span class="hs-identifier hs-var">da</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-813"></span><span>    </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span><span> </span><span id="local-6989586621679088019"><span class="annot"><span class="annottext">Matrix ZModHom
</span><a href="#local-6989586621679088019"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Q -&gt; Orientation AbGroup -&gt; X AbHom
</span><a href="OAlg.AbelianGroup.Definition.html#xAbHom"><span class="hs-identifier hs-var">xAbHom</span></a></span><span> </span><span class="annot"><span class="annottext">Q
</span><a href="#local-6989586621679088006"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProductSymbol ZMod -&gt; AbGroup
</span><a href="OAlg.AbelianGroup.Definition.html#AbGroup"><span class="hs-identifier hs-var">AbGroup</span></a></span><span> </span><span class="annot"><span class="annottext">ProductSymbol ZMod
</span><a href="#local-6989586621679088012"><span class="hs-identifier hs-var">dr</span></a></span><span> </span><span class="annot"><span class="annottext">AbGroup -&gt; AbGroup -&gt; Orientation AbGroup
forall p. p -&gt; p -&gt; Orientation p
</span><span class="hs-operator hs-var">:&gt;</span></span><span> </span><span class="annot"><span class="annottext">ProductSymbol ZMod -&gt; AbGroup
</span><a href="OAlg.AbelianGroup.Definition.html#AbGroup"><span class="hs-identifier hs-var">AbGroup</span></a></span><span> </span><span class="annot"><span class="annottext">ProductSymbol ZMod
</span><a href="#local-6989586621679088020"><span class="hs-identifier hs-var">dc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-814"></span><span>    </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span><span> </span><span id="local-6989586621679088021"><span class="annot"><span class="annottext">Matrix ZModHom
</span><a href="#local-6989586621679088021"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Q -&gt; Orientation AbGroup -&gt; X AbHom
</span><a href="OAlg.AbelianGroup.Definition.html#xAbHom"><span class="hs-identifier hs-var">xAbHom</span></a></span><span> </span><span class="annot"><span class="annottext">Q
</span><a href="#local-6989586621679088006"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProductSymbol ZMod -&gt; AbGroup
</span><a href="OAlg.AbelianGroup.Definition.html#AbGroup"><span class="hs-identifier hs-var">AbGroup</span></a></span><span> </span><span class="annot"><span class="annottext">ProductSymbol ZMod
</span><a href="#local-6989586621679088013"><span class="hs-identifier hs-var">ds</span></a></span><span> </span><span class="annot"><span class="annottext">AbGroup -&gt; AbGroup -&gt; Orientation AbGroup
forall p. p -&gt; p -&gt; Orientation p
</span><span class="hs-operator hs-var">:&gt;</span></span><span> </span><span class="annot"><span class="annottext">ProductSymbol ZMod -&gt; AbGroup
</span><a href="OAlg.AbelianGroup.Definition.html#AbGroup"><span class="hs-identifier hs-var">AbGroup</span></a></span><span> </span><span class="annot"><span class="annottext">ProductSymbol ZMod
</span><a href="#local-6989586621679088020"><span class="hs-identifier hs-var">dc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-815"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679088022"><span class="annot"><span class="annottext">cl :: [Dim' ZModHom]
</span><a href="#local-6989586621679088022"><span class="hs-identifier hs-var hs-var">cl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ProductSymbol ZMod -&gt; Dim' ZModHom)
-&gt; [ProductSymbol ZMod] -&gt; [Dim' ZModHom]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
forall (h :: * -&gt; * -&gt; *) (f :: * -&gt; *) a b.
Applicative1 h f =&gt;
h a b -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">amap1</span></span><span> </span><span class="annot"><span class="annottext">CSequence (Point ZModHom) -&gt; Dim' ZModHom
ProductSymbol ZMod -&gt; Dim' ZModHom
forall x. CSequence (Point x) -&gt; Dim x (Point x)
</span><span class="hs-identifier hs-var">Dim</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ProductSymbol ZMod
</span><a href="#local-6989586621679088012"><span class="hs-identifier hs-var">dr</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">ProductSymbol ZMod
</span><a href="#local-6989586621679088013"><span class="hs-identifier hs-var">ds</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">ProductSymbol ZMod
</span><a href="#local-6989586621679088015"><span class="hs-identifier hs-var">dt</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-816"></span><span>        </span><span id="local-6989586621679088023"><span class="annot"><span class="annottext">rw :: [Dim' ZModHom]
</span><a href="#local-6989586621679088023"><span class="hs-identifier hs-var hs-var">rw</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ProductSymbol ZMod -&gt; Dim' ZModHom)
-&gt; [ProductSymbol ZMod] -&gt; [Dim' ZModHom]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
forall (h :: * -&gt; * -&gt; *) (f :: * -&gt; *) a b.
Applicative1 h f =&gt;
h a b -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">amap1</span></span><span> </span><span class="annot"><span class="annottext">CSequence (Point ZModHom) -&gt; Dim' ZModHom
ProductSymbol ZMod -&gt; Dim' ZModHom
forall x. CSequence (Point x) -&gt; Dim x (Point x)
</span><span class="hs-identifier hs-var">Dim</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ProductSymbol ZMod
</span><a href="#local-6989586621679088018"><span class="hs-identifier hs-var">da</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">ProductSymbol ZMod
</span><a href="#local-6989586621679088024"><span class="hs-identifier hs-var">db</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">ProductSymbol ZMod
</span><a href="#local-6989586621679088020"><span class="hs-identifier hs-var">dc</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-817"></span><span>        </span><span id="local-6989586621679088025"><span class="annot"><span class="annottext">m :: Matrix ZModHom
</span><a href="#local-6989586621679088025"><span class="hs-identifier hs-var hs-var">m</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix (Matrix ZModHom) -&gt; Matrix ZModHom
forall x. Oriented x =&gt; Matrix (Matrix x) -&gt; Matrix x
</span><span class="hs-identifier hs-var">mtxJoin</span></span><span> </span><span class="annot"><span class="annottext">(Matrix (Matrix ZModHom) -&gt; Matrix ZModHom)
-&gt; Matrix (Matrix ZModHom) -&gt; Matrix ZModHom
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Dim' ZModHom]
-&gt; [Dim' ZModHom]
-&gt; [(Matrix ZModHom, N, N)]
-&gt; Matrix (Matrix ZModHom)
forall x.
(Additive x, FibredOriented x) =&gt;
[Dim' x] -&gt; [Dim' x] -&gt; [(Matrix x, N, N)] -&gt; Matrix (Matrix x)
</span><span class="hs-identifier hs-var">matrixBlc</span></span><span> </span><span class="annot"><span class="annottext">[Dim' ZModHom]
</span><a href="#local-6989586621679088023"><span class="hs-identifier hs-var">rw</span></a></span><span> </span><span class="annot"><span class="annottext">[Dim' ZModHom]
</span><a href="#local-6989586621679088022"><span class="hs-identifier hs-var">cl</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix ZModHom
</span><a href="#local-6989586621679088017"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix ZModHom
</span><a href="#local-6989586621679088019"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">N
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix ZModHom
</span><a href="#local-6989586621679088021"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">N
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">N
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-818"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-819"></span><span>      </span><span id="local-6989586621679088028"><span class="annot"><span class="annottext">ColTrafo ZModHom
</span><a href="#local-6989586621679088028"><span class="hs-identifier hs-var">pc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Dim' ZModHom -&gt; X (ColTrafo ZModHom)
forall {x}. Distributive x =&gt; Dim x (Point x) -&gt; X (ColTrafo x)
</span><a href="#local-6989586621679088029"><span class="hs-identifier hs-var">xpc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix ZModHom -&gt; Point (Matrix ZModHom)
forall q. Oriented q =&gt; q -&gt; Point q
</span><span class="hs-identifier hs-var">start</span></span><span> </span><span class="annot"><span class="annottext">Matrix ZModHom
</span><a href="#local-6989586621679088025"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-820"></span><span>      </span><span class="annot"><span class="annottext">Matrix ZModHom -&gt; X (Matrix ZModHom)
forall a. a -&gt; X a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">RowTrafo ZModHom
</span><a href="#local-6989586621679088030"><span class="hs-identifier hs-var">pr</span></a></span><span> </span><span class="annot"><span class="annottext">RowTrafo ZModHom -&gt; Matrix ZModHom -&gt; Matrix ZModHom
forall f x. Opl f x =&gt; f -&gt; x -&gt; x
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Matrix ZModHom
</span><a href="#local-6989586621679088025"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Matrix ZModHom -&gt; ColTrafo ZModHom -&gt; Matrix ZModHom
forall f x. Opr f x =&gt; x -&gt; f -&gt; x
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">ColTrafo ZModHom
</span><a href="#local-6989586621679088028"><span class="hs-identifier hs-var">pc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-821"></span><span>
</span><span id="line-822"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679088032"><span class="annot"><span class="annottext">ProductSymbol ZMod
</span><a href="#local-6989586621679088032"><span class="hs-identifier hs-var">g'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679088033"><span class="annot"><span class="annottext">Permutation N
</span><a href="#local-6989586621679088033"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ZMod -&gt; ZMod -&gt; Ordering)
-&gt; (ZMod -&gt; ZMod)
-&gt; ProductSymbol ZMod
-&gt; (ProductSymbol ZMod, Permutation N)
forall (s :: * -&gt; *) x w.
PermutableSequence s N x =&gt;
(w -&gt; w -&gt; Ordering) -&gt; (x -&gt; w) -&gt; s x -&gt; (s x, Permutation N)
</span><span class="hs-identifier hs-var">permuteByN</span></span><span> </span><span class="annot"><span class="annottext">ZMod -&gt; ZMod -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><span class="annottext">ZMod -&gt; ZMod
forall x. x -&gt; x
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="annot"><span class="annottext">ProductSymbol ZMod
</span><a href="#local-6989586621679088010"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-823"></span><span>
</span><span id="line-824"></span><span>  </span><span class="annot"><a href="#local-6989586621679088030"><span class="hs-identifier hs-type">pr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RowTrafo</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.ZMod.html#ZModHom"><span class="hs-identifier hs-type">ZModHom</span></a></span><span>
</span><span id="line-825"></span><span>  </span><span id="local-6989586621679088030"><span class="annot"><span class="annottext">pr :: RowTrafo ZModHom
</span><a href="#local-6989586621679088030"><span class="hs-identifier hs-var hs-var">pr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GLT ZModHom -&gt; RowTrafo ZModHom
forall a. GLT a -&gt; RowTrafo a
</span><span class="hs-identifier hs-var">RowTrafo</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dim' ZModHom -&gt; Dim' ZModHom -&gt; Permutation N -&gt; GLT ZModHom
forall x.
Distributive x =&gt;
Dim' x -&gt; Dim' x -&gt; Permutation N -&gt; GLT x
</span><span class="hs-identifier hs-var">permute</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CSequence (Point ZModHom) -&gt; Dim' ZModHom
forall x. CSequence (Point x) -&gt; Dim x (Point x)
</span><span class="hs-identifier hs-var">Dim</span></span><span> </span><span class="annot"><span class="annottext">CSequence (Point ZModHom)
ProductSymbol ZMod
</span><a href="#local-6989586621679088010"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CSequence (Point ZModHom) -&gt; Dim' ZModHom
forall x. CSequence (Point x) -&gt; Dim x (Point x)
</span><span class="hs-identifier hs-var">Dim</span></span><span> </span><span class="annot"><span class="annottext">CSequence (Point ZModHom)
ProductSymbol ZMod
</span><a href="#local-6989586621679088032"><span class="hs-identifier hs-var">g'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Permutation N -&gt; Permutation N
forall c. Invertible c =&gt; c -&gt; c
</span><span class="hs-identifier hs-var">invert</span></span><span> </span><span class="annot"><span class="annottext">Permutation N
</span><a href="#local-6989586621679088033"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-826"></span><span>
</span><span id="line-827"></span><span>  </span><span id="local-6989586621679088029"><span class="annot"><span class="annottext">xpc :: Dim x (Point x) -&gt; X (ColTrafo x)
</span><a href="#local-6989586621679088029"><span class="hs-identifier hs-var hs-var">xpc</span></a></span></span><span> </span><span id="local-6989586621679088140"><span class="annot"><span class="annottext">Dim x (Point x)
</span><a href="#local-6989586621679088140"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-828"></span><span>    </span><span id="local-6989586621679088141"><span class="annot"><span class="annottext">Permutation N
</span><a href="#local-6989586621679088141"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">N -&gt; X (Permutation N)
</span><span class="hs-identifier hs-var">xPermutationN</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dim x (Point x) -&gt; N
forall x. LengthN x =&gt; x -&gt; N
</span><span class="hs-identifier hs-var">lengthN</span></span><span> </span><span class="annot"><span class="annottext">Dim x (Point x)
</span><a href="#local-6989586621679088140"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-829"></span><span>    </span><span class="annot"><span class="annottext">ColTrafo x -&gt; X (ColTrafo x)
forall a. a -&gt; X a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GLT x -&gt; ColTrafo x
forall x. GLT x -&gt; ColTrafo x
</span><span class="hs-identifier hs-var">ColTrafo</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dim x (Point x) -&gt; Dim x (Point x) -&gt; Permutation N -&gt; GLT x
forall x.
Distributive x =&gt;
Dim' x -&gt; Dim' x -&gt; Permutation N -&gt; GLT x
</span><span class="hs-identifier hs-var">permute</span></span><span> </span><span class="annot"><span class="annottext">Dim x (Point x)
</span><a href="#local-6989586621679088140"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dim x (Point x)
</span><a href="#local-6989586621679088140"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Dim x (Point x) -&gt; Permutation N -&gt; Dim x (Point x)
forall f x. Opr f x =&gt; x -&gt; f -&gt; x
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Permutation N -&gt; Permutation N
forall c. Invertible c =&gt; c -&gt; c
</span><span class="hs-identifier hs-var">invert</span></span><span> </span><span class="annot"><span class="annottext">Permutation N
</span><a href="#local-6989586621679088141"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Permutation N
</span><a href="#local-6989586621679088141"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-830"></span><span>      </span><span>
</span><span id="line-831"></span><span>  </span><span id="local-6989586621679088147"><span class="annot"><span class="annottext">expAt :: N -&gt; Word r ZMod -&gt; (r, Word r ZMod)
</span><a href="#local-6989586621679088147"><span class="hs-identifier hs-var hs-var">expAt</span></a></span></span><span> </span><span id="local-6989586621679088148"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679088148"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679088149"><span class="annot"><span class="annottext">Word r ZMod
</span><a href="#local-6989586621679088149"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Word r ZMod
</span><a href="#local-6989586621679088149"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-832"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Word</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="OAlg.AbelianGroup.ZMod.html#ZMod"><span class="hs-identifier hs-type">ZMod</span></a></span><span> </span><span id="local-6989586621679088150"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679088150"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679088151"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679088151"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679088152"><span class="annot"><span class="annottext">[(ZMod, r)]
</span><a href="#local-6989586621679088152"><span class="hs-identifier hs-var">w'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679088148"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679088150"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679088151"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[(ZMod, r)] -&gt; Word r ZMod
forall r a. [(a, r)] -&gt; Word r a
</span><span class="hs-identifier hs-var">Word</span></span><span> </span><span class="annot"><span class="annottext">[(ZMod, r)]
</span><a href="#local-6989586621679088152"><span class="hs-identifier hs-var">w'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-833"></span><span>    </span><span class="annot"><span class="annottext">Word r ZMod
</span><span class="hs-identifier">_</span></span><span>                             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Word r ZMod
</span><a href="#local-6989586621679088149"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-834"></span><span>
</span><span id="line-835"></span><span>  </span><span id="local-6989586621679088153"><span class="annot"><span class="annottext">w' :: Word N ZMod
</span><a href="#local-6989586621679088153"><span class="hs-identifier hs-var hs-var">w'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProductSymbol ZMod -&gt; Word N ZMod
forall x. Entity x =&gt; ProductSymbol x -&gt; Word N x
</span><span class="hs-identifier hs-var">psywrd</span></span><span> </span><span class="annot"><span class="annottext">ProductSymbol ZMod
</span><a href="#local-6989586621679088032"><span class="hs-identifier hs-var">g'</span></a></span><span>
</span><span id="line-836"></span><span>
</span><span id="line-837"></span><span>  </span><span id="local-6989586621679088018"><span class="annot"><span class="annottext">da :: ProductSymbol ZMod
</span><a href="#local-6989586621679088018"><span class="hs-identifier hs-var hs-var">da</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ZMod -&gt; ProductSymbol ZMod
forall x. Entity x =&gt; x -&gt; ProductSymbol x
</span><span class="hs-identifier hs-var">sy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">N -&gt; ZMod
</span><a href="OAlg.AbelianGroup.ZMod.html#ZMod"><span class="hs-identifier hs-var">ZMod</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ProductSymbol ZMod
-&gt; Exponent (ProductSymbol ZMod) -&gt; ProductSymbol ZMod
forall f. Exponential f =&gt; f -&gt; Exponent f -&gt; f
</span><span class="hs-operator hs-var">^</span></span><span> </span><span class="annot"><span class="annottext">N
Exponent (ProductSymbol ZMod)
</span><a href="#local-6989586621679088154"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-838"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679088154"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679088154"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679088155"><span class="annot"><span class="annottext">Word N ZMod
</span><a href="#local-6989586621679088155"><span class="hs-identifier hs-var">w''</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">N -&gt; Word N ZMod -&gt; (N, Word N ZMod)
forall {r}. Num r =&gt; N -&gt; Word r ZMod -&gt; (r, Word r ZMod)
</span><a href="#local-6989586621679088147"><span class="hs-identifier hs-var">expAt</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Word N ZMod
</span><a href="#local-6989586621679088153"><span class="hs-identifier hs-var">w'</span></a></span><span>
</span><span id="line-839"></span><span>  </span><span>
</span><span id="line-840"></span><span>  </span><span id="local-6989586621679088024"><span class="annot"><span class="annottext">db :: ProductSymbol ZMod
</span><a href="#local-6989586621679088024"><span class="hs-identifier hs-var hs-var">db</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ZMod -&gt; ProductSymbol ZMod
forall x. Entity x =&gt; x -&gt; ProductSymbol x
</span><span class="hs-identifier hs-var">sy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">N -&gt; ZMod
</span><a href="OAlg.AbelianGroup.ZMod.html#ZMod"><span class="hs-identifier hs-var">ZMod</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ProductSymbol ZMod
-&gt; Exponent (ProductSymbol ZMod) -&gt; ProductSymbol ZMod
forall f. Exponential f =&gt; f -&gt; Exponent f -&gt; f
</span><span class="hs-operator hs-var">^</span></span><span> </span><span class="annot"><span class="annottext">N
Exponent (ProductSymbol ZMod)
</span><a href="#local-6989586621679088156"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-841"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679088156"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679088156"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679088157"><span class="annot"><span class="annottext">Word N ZMod
</span><a href="#local-6989586621679088157"><span class="hs-identifier hs-var">w'''</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">N -&gt; Word N ZMod -&gt; (N, Word N ZMod)
forall {r}. Num r =&gt; N -&gt; Word r ZMod -&gt; (r, Word r ZMod)
</span><a href="#local-6989586621679088147"><span class="hs-identifier hs-var">expAt</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Word N ZMod
</span><a href="#local-6989586621679088155"><span class="hs-identifier hs-var">w''</span></a></span><span>
</span><span id="line-842"></span><span>  </span><span class="hs-comment">-- for all ((ZMod n),_) in w''' holds: 2 &lt;= n</span><span>
</span><span id="line-843"></span><span>    </span><span>
</span><span id="line-844"></span><span>  </span><span id="local-6989586621679088020"><span class="annot"><span class="annottext">dc :: ProductSymbol ZMod
</span><a href="#local-6989586621679088020"><span class="hs-identifier hs-var hs-var">dc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word N ZMod -&gt; ProductSymbol ZMod
forall x. Entity x =&gt; Word N x -&gt; ProductSymbol x
</span><span class="hs-identifier hs-var">wrdpsy</span></span><span> </span><span class="annot"><span class="annottext">Word N ZMod
</span><a href="#local-6989586621679088157"><span class="hs-identifier hs-var">w'''</span></a></span><span>
</span><span id="line-845"></span><span>
</span><span id="line-846"></span><span>  </span><span id="local-6989586621679088159"><span class="annot"><span class="annottext">ms :: [N]
</span><a href="#local-6989586621679088159"><span class="hs-identifier hs-var hs-var">ms</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((ZMod, N) -&gt; N) -&gt; [(ZMod, N)] -&gt; [N]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
forall (h :: * -&gt; * -&gt; *) (f :: * -&gt; *) a b.
Applicative1 h f =&gt;
h a b -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">amap1</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="OAlg.AbelianGroup.ZMod.html#ZMod"><span class="hs-identifier hs-type">ZMod</span></a></span><span> </span><span id="local-6989586621679088160"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679088160"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679088160"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ZMod -&gt; N) -&gt; ((ZMod, N) -&gt; ZMod) -&gt; (ZMod, N) -&gt; N
forall y z x. (y -&gt; z) -&gt; (x -&gt; y) -&gt; x -&gt; z
forall (c :: * -&gt; * -&gt; *) y z x.
Category c =&gt;
c y z -&gt; c x y -&gt; c x z
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(ZMod, N) -&gt; ZMod
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(ZMod, N)] -&gt; [N]) -&gt; [(ZMod, N)] -&gt; [N]
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Word N ZMod -&gt; [(ZMod, N)]
forall r a. Word r a -&gt; [(a, r)]
</span><span class="hs-identifier hs-var">fromWord</span></span><span> </span><span class="annot"><span class="annottext">Word N ZMod
</span><a href="#local-6989586621679088157"><span class="hs-identifier hs-var">w'''</span></a></span><span>
</span><span id="line-847"></span><span>  </span><span id="local-6989586621679088162"><span class="annot"><span class="annottext">gms :: N
</span><a href="#local-6989586621679088162"><span class="hs-identifier hs-var hs-var">gms</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[N] -&gt; N
</span><a href="OAlg.AbelianGroup.Euclid.html#gcds"><span class="hs-identifier hs-var">gcds</span></a></span><span> </span><span class="annot"><span class="annottext">[N]
</span><a href="#local-6989586621679088159"><span class="hs-identifier hs-var">ms</span></a></span><span>  </span><span>
</span><span id="line-848"></span><span>  </span><span id="local-6989586621679088164"><span class="annot"><span class="annottext">lms :: N
</span><a href="#local-6989586621679088164"><span class="hs-identifier hs-var hs-var">lms</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[N] -&gt; N
</span><a href="OAlg.AbelianGroup.Euclid.html#lcms"><span class="hs-identifier hs-var">lcms</span></a></span><span> </span><span class="annot"><span class="annottext">[N]
</span><a href="#local-6989586621679088159"><span class="hs-identifier hs-var">ms</span></a></span><span>
</span><span id="line-849"></span><span>  </span><span class="hs-comment">-- 1 &lt;= lms, because 2 &lt;= m for all m in ms</span><span>
</span><span id="line-850"></span><span>  </span><span>
</span><span id="line-851"></span><span>  </span><span id="local-6989586621679088166"><span class="annot"><span class="annottext">xsl :: X ZMod
</span><a href="#local-6989586621679088166"><span class="hs-identifier hs-var hs-var">xsl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-852"></span><span>    </span><span id="local-6989586621679088167"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679088167"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; X N
</span><span class="hs-identifier hs-var">xNB</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">10</span></span><span>
</span><span id="line-853"></span><span>    </span><span class="annot"><span class="annottext">ZMod -&gt; X ZMod
forall a. a -&gt; X a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(ZMod -&gt; X ZMod) -&gt; ZMod -&gt; X ZMod
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">N -&gt; ZMod
</span><a href="OAlg.AbelianGroup.ZMod.html#ZMod"><span class="hs-identifier hs-var">ZMod</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679088167"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">N -&gt; N -&gt; N
forall c. Multiplicative c =&gt; c -&gt; c -&gt; c
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679088164"><span class="hs-identifier hs-var">lms</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-854"></span><span>
</span><span id="line-855"></span><span>  </span><span id="local-6989586621679088168"><span class="annot"><span class="annottext">xsg :: X ZMod
</span><a href="#local-6989586621679088168"><span class="hs-identifier hs-var hs-var">xsg</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679088162"><span class="hs-identifier hs-var">gms</span></a></span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">2</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">X ZMod
forall x. X x
</span><span class="hs-identifier hs-var">XEmpty</span></span><span>
</span><span id="line-856"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[(N, N)]
</span><a href="#local-6989586621679088170"><span class="hs-identifier hs-var">ws</span></a></span><span> </span><span class="annot"><span class="annottext">[(N, N)] -&gt; [(N, N)] -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">X ZMod
forall x. X x
</span><span class="hs-identifier hs-var">XEmpty</span></span><span>
</span><span id="line-857"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-858"></span><span>          </span><span id="local-6989586621679088171"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679088171"><span class="hs-identifier hs-var">r</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; X N
</span><span class="hs-identifier hs-var">xNB</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679088172"><span class="hs-identifier hs-var">rMax</span></a></span><span>
</span><span id="line-859"></span><span>          </span><span id="local-6989586621679088173"><span class="annot"><span class="annottext">[N]
</span><a href="#local-6989586621679088173"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">N -&gt; X N -&gt; X [N]
forall x. N -&gt; X x -&gt; X [x]
</span><span class="hs-identifier hs-var">xTakeN</span></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679088171"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[N] -&gt; X N
forall a. [a] -&gt; X a
</span><span class="hs-identifier hs-var">xOneOf</span></span><span> </span><span class="annot"><span class="annottext">[N]
</span><a href="#local-6989586621679088176"><span class="hs-identifier hs-var">fs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-860"></span><span>          </span><span id="local-6989586621679088177"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679088177"><span class="hs-identifier hs-var">n</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; X N
</span><span class="hs-identifier hs-var">xNB</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">10</span></span><span>
</span><span id="line-861"></span><span>          </span><span class="annot"><span class="annottext">ZMod -&gt; X ZMod
forall a. a -&gt; X a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(ZMod -&gt; X ZMod) -&gt; ZMod -&gt; X ZMod
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">N -&gt; ZMod
</span><a href="OAlg.AbelianGroup.ZMod.html#ZMod"><span class="hs-identifier hs-var">ZMod</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679088177"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; N
forall c. Multiplicative c =&gt; c -&gt; c -&gt; c
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">(N -&gt; N -&gt; N) -&gt; N -&gt; [N] -&gt; N
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; N
forall c. Multiplicative c =&gt; c -&gt; c -&gt; c
</span><span class="hs-operator hs-var">(*)</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">[N]
</span><a href="#local-6989586621679088173"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-862"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word</span></span><span> </span><span id="local-6989586621679088170"><span class="annot"><span class="annottext">[(N, N)]
</span><a href="#local-6989586621679088170"><span class="hs-identifier hs-var">ws</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; Word N N
</span><span class="hs-identifier hs-var">nFactorize'</span></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="OAlg.AbelianGroup.Definition.html#stdMaxPrime"><span class="hs-identifier hs-var">stdMaxPrime</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679088162"><span class="hs-identifier hs-var">gms</span></a></span><span>
</span><span id="line-863"></span><span>          </span><span id="local-6989586621679088176"><span class="annot"><span class="annottext">fs :: [N]
</span><a href="#local-6989586621679088176"><span class="hs-identifier hs-var hs-var">fs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((N, N) -&gt; N) -&gt; [(N, N)] -&gt; [N]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
forall (h :: * -&gt; * -&gt; *) (f :: * -&gt; *) a b.
Applicative1 h f =&gt;
h a b -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">amap1</span></span><span> </span><span class="annot"><span class="annottext">(N, N) -&gt; N
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">[(N, N)]
</span><a href="#local-6989586621679088170"><span class="hs-identifier hs-var">ws</span></a></span><span>
</span><span id="line-864"></span><span>          </span><span id="local-6989586621679088172"><span class="annot"><span class="annottext">rMax :: N
</span><a href="#local-6989586621679088172"><span class="hs-identifier hs-var hs-var">rMax</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(N -&gt; N -&gt; N) -&gt; N -&gt; [N] -&gt; N
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; N
forall a. Additive a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(+)</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">([N] -&gt; N) -&gt; [N] -&gt; N
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((N, N) -&gt; N) -&gt; [(N, N)] -&gt; [N]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
forall (h :: * -&gt; * -&gt; *) (f :: * -&gt; *) a b.
Applicative1 h f =&gt;
h a b -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">amap1</span></span><span> </span><span class="annot"><span class="annottext">(N, N) -&gt; N
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">[(N, N)]
</span><a href="#local-6989586621679088170"><span class="hs-identifier hs-var">ws</span></a></span><span>
</span><span id="line-865"></span><span>          </span><span class="hs-comment">-- 0 &lt; nMax, because ws is not empty</span><span>
</span><span id="line-866"></span><span>          </span><span>
</span><span id="line-867"></span><span>  </span><span id="local-6989586621679088014"><span class="annot"><span class="annottext">xds :: X (ProductSymbol ZMod)
</span><a href="#local-6989586621679088014"><span class="hs-identifier hs-var hs-var">xds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">N -&gt; X ZMod -&gt; X [ZMod]
forall x. N -&gt; X x -&gt; X [x]
</span><span class="hs-identifier hs-var">xTakeN</span></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679088008"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">X ZMod
</span><a href="#local-6989586621679088168"><span class="hs-identifier hs-var">xsg</span></a></span><span> </span><span class="annot"><span class="annottext">X ZMod -&gt; X ZMod -&gt; X ZMod
forall a. X a -&gt; X a -&gt; X a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">X ZMod
</span><a href="#local-6989586621679088166"><span class="hs-identifier hs-var">xsl</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">X [ZMod]
-&gt; ([ZMod] -&gt; X (ProductSymbol ZMod)) -&gt; X (ProductSymbol ZMod)
forall a b. X a -&gt; (a -&gt; X b) -&gt; X b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">ProductSymbol ZMod -&gt; X (ProductSymbol ZMod)
forall a. a -&gt; X a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(ProductSymbol ZMod -&gt; X (ProductSymbol ZMod))
-&gt; ([ZMod] -&gt; ProductSymbol ZMod)
-&gt; [ZMod]
-&gt; X (ProductSymbol ZMod)
forall y z x. (y -&gt; z) -&gt; (x -&gt; y) -&gt; x -&gt; z
forall (c :: * -&gt; * -&gt; *) y z x.
Category c =&gt;
c y z -&gt; c x y -&gt; c x z
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[ZMod] -&gt; ProductSymbol ZMod
forall x. Entity x =&gt; [x] -&gt; ProductSymbol x
</span><span class="hs-identifier hs-var">productSymbol</span></span><span>
</span><span id="line-868"></span><span>
</span><span id="line-869"></span><span>  </span><span id="local-6989586621679088180"><span class="annot"><span class="annottext">xt :: X ZMod
</span><a href="#local-6989586621679088180"><span class="hs-identifier hs-var hs-var">xt</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[N]
</span><a href="#local-6989586621679088181"><span class="hs-identifier hs-var">fs</span></a></span><span> </span><span class="annot"><span class="annottext">[N] -&gt; [N] -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">X ZMod
forall x. X x
</span><span class="hs-identifier hs-var">XEmpty</span></span><span>
</span><span id="line-870"></span><span>     </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-871"></span><span>    </span><span id="local-6989586621679088182"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679088182"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; X N
</span><span class="hs-identifier hs-var">xNB</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">5</span></span><span>
</span><span id="line-872"></span><span>    </span><span id="local-6989586621679088183"><span class="annot"><span class="annottext">[N]
</span><a href="#local-6989586621679088183"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">N -&gt; X N -&gt; X [N]
forall x. N -&gt; X x -&gt; X [x]
</span><span class="hs-identifier hs-var">xTakeN</span></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679088182"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[N] -&gt; X N
forall a. [a] -&gt; X a
</span><span class="hs-identifier hs-var">xOneOf</span></span><span> </span><span class="annot"><span class="annottext">[N]
</span><a href="#local-6989586621679088181"><span class="hs-identifier hs-var">fs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-873"></span><span>    </span><span class="annot"><span class="annottext">ZMod -&gt; X ZMod
forall a. a -&gt; X a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(ZMod -&gt; X ZMod) -&gt; ZMod -&gt; X ZMod
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">N -&gt; ZMod
</span><a href="OAlg.AbelianGroup.ZMod.html#ZMod"><span class="hs-identifier hs-var">ZMod</span></a></span><span> </span><span class="annot"><span class="annottext">(N -&gt; ZMod) -&gt; N -&gt; ZMod
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(N -&gt; N -&gt; N) -&gt; N -&gt; [N] -&gt; N
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; N
forall c. Multiplicative c =&gt; c -&gt; c -&gt; c
</span><span class="hs-operator hs-var">(*)</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">[N]
</span><a href="#local-6989586621679088183"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-874"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679088181"><span class="annot"><span class="annottext">fs :: [N]
</span><a href="#local-6989586621679088181"><span class="hs-identifier hs-var hs-var">fs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">N -&gt; [N] -&gt; [N]
forall a. N -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">takeN</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="annottext">([N] -&gt; [N]) -&gt; [N] -&gt; [N]
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(N -&gt; Bool) -&gt; [N] -&gt; [N]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">N -&gt; N -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(N -&gt; Bool) -&gt; (N -&gt; N) -&gt; N -&gt; Bool
forall y z x. (y -&gt; z) -&gt; (x -&gt; y) -&gt; x -&gt; z
forall (c :: * -&gt; * -&gt; *) y z x.
Category c =&gt;
c y z -&gt; c x y -&gt; c x z
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; N
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">mod</span></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679088164"><span class="hs-identifier hs-var">lms</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[N]
</span><a href="OAlg.AbelianGroup.Definition.html#stdPrimes"><span class="hs-identifier hs-var">stdPrimes</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-875"></span><span>    </span><span>
</span><span id="line-876"></span><span>  </span><span id="local-6989586621679088016"><span class="annot"><span class="annottext">xdt :: X (ProductSymbol ZMod)
</span><a href="#local-6989586621679088016"><span class="hs-identifier hs-var hs-var">xdt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">X ZMod
</span><a href="#local-6989586621679088180"><span class="hs-identifier hs-var">xt</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-877"></span><span>    </span><span class="annot"><span class="annottext">X ZMod
</span><span class="hs-identifier hs-var">XEmpty</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ProductSymbol ZMod -&gt; X (ProductSymbol ZMod)
forall a. a -&gt; X a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[ZMod] -&gt; ProductSymbol ZMod
forall x. Entity x =&gt; [x] -&gt; ProductSymbol x
</span><span class="hs-identifier hs-var">productSymbol</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-878"></span><span>    </span><span class="annot"><span class="annottext">X ZMod
</span><span class="hs-identifier">_</span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">N -&gt; X ZMod -&gt; X [ZMod]
forall x. N -&gt; X x -&gt; X [x]
</span><span class="hs-identifier hs-var">xTakeN</span></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679088009"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">X ZMod
</span><a href="#local-6989586621679088180"><span class="hs-identifier hs-var">xt</span></a></span><span> </span><span class="annot"><span class="annottext">X [ZMod]
-&gt; ([ZMod] -&gt; X (ProductSymbol ZMod)) -&gt; X (ProductSymbol ZMod)
forall a b. X a -&gt; (a -&gt; X b) -&gt; X b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">ProductSymbol ZMod -&gt; X (ProductSymbol ZMod)
forall a. a -&gt; X a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(ProductSymbol ZMod -&gt; X (ProductSymbol ZMod))
-&gt; ([ZMod] -&gt; ProductSymbol ZMod)
-&gt; [ZMod]
-&gt; X (ProductSymbol ZMod)
forall y z x. (y -&gt; z) -&gt; (x -&gt; y) -&gt; x -&gt; z
forall (c :: * -&gt; * -&gt; *) y z x.
Category c =&gt;
c y z -&gt; c x y -&gt; c x z
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[ZMod] -&gt; ProductSymbol ZMod
forall x. Entity x =&gt; [x] -&gt; ProductSymbol x
</span><span class="hs-identifier hs-var">productSymbol</span></span><span>
</span><span id="line-879"></span><span>
</span><span id="line-880"></span><span>
</span><span id="line-881"></span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#dstXAbHomTo"><span class="hs-identifier hs-type">dstXAbHomTo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">N</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">N</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">N</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbGroup"><span class="hs-identifier hs-type">AbGroup</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-882"></span><span id="dstXAbHomTo"><span class="annot"><span class="annottext">dstXAbHomTo :: (AbHom -&gt; String) -&gt; Int -&gt; Q -&gt; N -&gt; N -&gt; N -&gt; X AbGroup -&gt; IO ()
</span><a href="OAlg.AbelianGroup.Definition.html#dstXAbHomTo"><span class="hs-identifier hs-var hs-var">dstXAbHomTo</span></a></span></span><span> </span><span id="local-6989586621679088185"><span class="annot"><span class="annottext">AbHom -&gt; String
</span><a href="#local-6989586621679088185"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679088186"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679088186"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679088187"><span class="annot"><span class="annottext">Q
</span><a href="#local-6989586621679088187"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span id="local-6989586621679088188"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679088188"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679088189"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679088189"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679088190"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679088190"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679088191"><span class="annot"><span class="annottext">X AbGroup
</span><a href="#local-6989586621679088191"><span class="hs-identifier hs-var">xg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO Omega
</span><span class="hs-identifier hs-var">getOmega</span></span><span> </span><span class="annot"><span class="annottext">IO Omega -&gt; (Omega -&gt; IO ()) -&gt; IO ()
forall a b. IO a -&gt; (a -&gt; IO b) -&gt; IO b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; X String -&gt; Omega -&gt; IO ()
forall x. (Show x, Ord x) =&gt; Int -&gt; X x -&gt; Omega -&gt; IO ()
</span><span class="hs-identifier hs-var">putDistribution</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679088186"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(AbHom -&gt; String) -&gt; X AbHom -&gt; X String
forall a b. (a -&gt; b) -&gt; X a -&gt; X b
forall (h :: * -&gt; * -&gt; *) (f :: * -&gt; *) a b.
Applicative1 h f =&gt;
h a b -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">amap1</span></span><span> </span><span class="annot"><span class="annottext">AbHom -&gt; String
</span><a href="#local-6989586621679088185"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">(X AbHom -&gt; X String) -&gt; X AbHom -&gt; X String
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">X AbHom
</span><a href="#local-6989586621679088192"><span class="hs-identifier hs-var">xh</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-883"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679088192"><span class="annot"><span class="annottext">xh :: X AbHom
</span><a href="#local-6989586621679088192"><span class="hs-identifier hs-var hs-var">xh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">X AbGroup
</span><a href="#local-6989586621679088191"><span class="hs-identifier hs-var">xg</span></a></span><span> </span><span class="annot"><span class="annottext">X AbGroup -&gt; (AbGroup -&gt; X AbHom) -&gt; X AbHom
forall a b. X a -&gt; (a -&gt; X b) -&gt; X b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Q -&gt; N -&gt; N -&gt; N -&gt; AbGroup -&gt; X AbHom
</span><a href="OAlg.AbelianGroup.Definition.html#xAbHomTo"><span class="hs-identifier hs-var">xAbHomTo</span></a></span><span> </span><span class="annot"><span class="annottext">Q
</span><a href="#local-6989586621679088187"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679088188"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679088189"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679088190"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-884"></span><span>
</span><span id="line-885"></span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#dns"><span class="hs-identifier hs-type">dns</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-886"></span><span id="dns"><span class="annot"><span class="annottext">dns :: AbHom -&gt; String
</span><a href="OAlg.AbelianGroup.Definition.html#dns"><span class="hs-identifier hs-var hs-var">dns</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Matrix</span></span><span> </span><span id="local-6989586621679088194"><span class="annot"><span class="annottext">Dim' ZModHom
</span><a href="#local-6989586621679088194"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679088195"><span class="annot"><span class="annottext">Dim' ZModHom
</span><a href="#local-6989586621679088195"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679088196"><span class="annot"><span class="annottext">Entries N N ZModHom
</span><a href="#local-6989586621679088196"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-887"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679088197"><span class="hs-identifier hs-var">rc</span></a></span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;empty&quot;</span></span><span>
</span><span id="line-888"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Z
</span><a href="#local-6989586621679088198"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Z -&gt; Z -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Z
</span><span class="hs-number">0</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;(&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Z -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Z
</span><a href="#local-6989586621679088198"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;,&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Z -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Z
</span><a href="#local-6989586621679088198"><span class="hs-identifier hs-var">p</span></a></span><span class="annot"><span class="annottext">Z -&gt; Z -&gt; Z
forall a. Additive a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Z
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;%)&quot;</span></span><span>
</span><span id="line-889"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Z
</span><a href="#local-6989586621679088198"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Z -&gt; Z -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Z
</span><span class="hs-number">100</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;full&quot;</span></span><span>
</span><span id="line-890"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;[&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Z -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Z
</span><a href="#local-6989586621679088198"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;,&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Z -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Z
</span><a href="#local-6989586621679088198"><span class="hs-identifier hs-var">p</span></a></span><span class="annot"><span class="annottext">Z -&gt; Z -&gt; Z
forall a. Additive a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Z
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;%)&quot;</span></span><span>
</span><span id="line-891"></span><span>  </span><span>
</span><span id="line-892"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679088198"><span class="annot"><span class="annottext">p :: Z
</span><a href="#local-6989586621679088198"><span class="hs-identifier hs-var hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Q -&gt; Z
forall r. Number r =&gt; r -&gt; Z
</span><span class="hs-identifier hs-var">zFloor</span></span><span> </span><span class="annot"><span class="annottext">(Q -&gt; Z) -&gt; Q -&gt; Z
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Q
</span><span class="hs-number">100</span></span><span class="annot"><span class="annottext">Q -&gt; Q -&gt; Q
forall c. Multiplicative c =&gt; c -&gt; c -&gt; c
</span><span class="hs-operator hs-var">*</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Q -&gt; Q) -&gt; Q -&gt; Q
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">N -&gt; Z
forall a b. Embeddable a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">inj</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Entries N N ZModHom -&gt; N
forall x. LengthN x =&gt; x -&gt; N
</span><span class="hs-identifier hs-var">lengthN</span></span><span> </span><span class="annot"><span class="annottext">Entries N N ZModHom
</span><a href="#local-6989586621679088196"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Z -&gt; N -&gt; Q
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679088197"><span class="hs-identifier hs-var">rc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-893"></span><span>        </span><span id="local-6989586621679088197"><span class="annot"><span class="annottext">rc :: N
</span><a href="#local-6989586621679088197"><span class="hs-identifier hs-var hs-var">rc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dim ZModHom ZMod -&gt; N
forall x. LengthN x =&gt; x -&gt; N
</span><span class="hs-identifier hs-var">lengthN</span></span><span> </span><span class="annot"><span class="annottext">Dim' ZModHom
Dim ZModHom ZMod
</span><a href="#local-6989586621679088194"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; N
forall c. Multiplicative c =&gt; c -&gt; c -&gt; c
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Dim ZModHom ZMod -&gt; N
forall x. LengthN x =&gt; x -&gt; N
</span><span class="hs-identifier hs-var">lengthN</span></span><span> </span><span class="annot"><span class="annottext">Dim' ZModHom
Dim ZModHom ZMod
</span><a href="#local-6989586621679088195"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-894"></span><span>
</span><span id="line-895"></span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#lng"><span class="hs-identifier hs-type">lng</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-896"></span><span id="lng"><span class="annot"><span class="annottext">lng :: AbHom -&gt; String
</span><a href="OAlg.AbelianGroup.Definition.html#lng"><span class="hs-identifier hs-var hs-var">lng</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Matrix</span></span><span> </span><span id="local-6989586621679088201"><span class="annot"><span class="annottext">Dim' ZModHom
</span><a href="#local-6989586621679088201"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679088202"><span class="annot"><span class="annottext">Dim' ZModHom
</span><a href="#local-6989586621679088202"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="annot"><span class="annottext">Entries N N ZModHom
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(N, N) -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dim ZModHom ZMod -&gt; N
forall x. LengthN x =&gt; x -&gt; N
</span><span class="hs-identifier hs-var">lengthN</span></span><span> </span><span class="annot"><span class="annottext">Dim' ZModHom
Dim ZModHom ZMod
</span><a href="#local-6989586621679088201"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Dim ZModHom ZMod -&gt; N
forall x. LengthN x =&gt; x -&gt; N
</span><span class="hs-identifier hs-var">lengthN</span></span><span> </span><span class="annot"><span class="annottext">Dim' ZModHom
Dim ZModHom ZMod
</span><a href="#local-6989586621679088202"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-897"></span><span>
</span><span id="line-898"></span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#lngMax"><span class="hs-identifier hs-type">lngMax</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-899"></span><span id="lngMax"><span class="annot"><span class="annottext">lngMax :: AbHom -&gt; String
</span><a href="OAlg.AbelianGroup.Definition.html#lngMax"><span class="hs-identifier hs-var hs-var">lngMax</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Matrix</span></span><span> </span><span id="local-6989586621679088204"><span class="annot"><span class="annottext">Dim' ZModHom
</span><a href="#local-6989586621679088204"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679088205"><span class="annot"><span class="annottext">Dim' ZModHom
</span><a href="#local-6989586621679088205"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="annot"><span class="annottext">Entries N N ZModHom
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">N -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dim ZModHom ZMod -&gt; N
forall x. LengthN x =&gt; x -&gt; N
</span><span class="hs-identifier hs-var">lengthN</span></span><span> </span><span class="annot"><span class="annottext">Dim' ZModHom
Dim ZModHom ZMod
</span><a href="#local-6989586621679088204"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; N
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`max`</span></span><span> </span><span class="annot"><span class="annottext">Dim ZModHom ZMod -&gt; N
forall x. LengthN x =&gt; x -&gt; N
</span><span class="hs-identifier hs-var">lengthN</span></span><span> </span><span class="annot"><span class="annottext">Dim' ZModHom
Dim ZModHom ZMod
</span><a href="#local-6989586621679088205"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-900"></span><span>
</span><span id="line-901"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-902"></span><span class="hs-comment">-- xAbHomFrom -</span><span>
</span><span id="line-903"></span><span>
</span><span id="line-904"></span><span class="hs-comment">-- | random variable of homomorphisms between abelian groups with 'start' equal to the given</span><span>
</span><span id="line-905"></span><span class="hs-comment">-- one.</span><span>
</span><span id="line-906"></span><span class="hs-comment">--</span><span>
</span><span id="line-907"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-908"></span><span class="hs-comment">--    a b c</span><span>
</span><span id="line-909"></span><span class="hs-comment">--   [f    ] r</span><span>
</span><span id="line-910"></span><span class="hs-comment">--   [g   l] s</span><span>
</span><span id="line-911"></span><span class="hs-comment">--   [h    ] t</span><span>
</span><span id="line-912"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-913"></span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#xAbHomFrom"><span class="hs-identifier hs-type">xAbHomFrom</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">N</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">N</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">N</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbGroup"><span class="hs-identifier hs-type">AbGroup</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span><span>
</span><span id="line-914"></span><span id="xAbHomFrom"><span class="annot"><span class="annottext">xAbHomFrom :: Q -&gt; N -&gt; N -&gt; N -&gt; AbGroup -&gt; X AbHom
</span><a href="OAlg.AbelianGroup.Definition.html#xAbHomFrom"><span class="hs-identifier hs-var hs-var">xAbHomFrom</span></a></span></span><span> </span><span id="local-6989586621679088207"><span class="annot"><span class="annottext">Q
</span><a href="#local-6989586621679088207"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679088208"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679088208"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679088209"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679088209"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679088210"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679088210"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbGroup"><span class="hs-identifier hs-type">AbGroup</span></a></span><span> </span><span id="local-6989586621679088211"><span class="annot"><span class="annottext">ProductSymbol ZMod
</span><a href="#local-6989586621679088211"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Matrix ZModHom -&gt; AbHom) -&gt; X (Matrix ZModHom) -&gt; X AbHom
forall a b. (a -&gt; b) -&gt; X a -&gt; X b
forall (h :: * -&gt; * -&gt; *) (f :: * -&gt; *) a b.
Applicative1 h f =&gt;
h a b -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">amap1</span></span><span> </span><span class="annot"><span class="annottext">Matrix ZModHom -&gt; AbHom
</span><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-var">AbHom</span></a></span><span> </span><span class="annot"><span class="annottext">X (Matrix ZModHom)
</span><a href="#local-6989586621679088212"><span class="hs-identifier hs-var">xm</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-915"></span><span>
</span><span id="line-916"></span><span>  </span><span class="annot"><a href="#local-6989586621679088212"><span class="hs-identifier hs-type">xm</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Matrix</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.ZMod.html#ZModHom"><span class="hs-identifier hs-type">ZModHom</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-917"></span><span>  </span><span id="local-6989586621679088212"><span class="annot"><span class="annottext">xm :: X (Matrix ZModHom)
</span><a href="#local-6989586621679088212"><span class="hs-identifier hs-var hs-var">xm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-918"></span><span>    </span><span id="local-6989586621679088213"><span class="annot"><span class="annottext">ProductSymbol ZMod
</span><a href="#local-6989586621679088213"><span class="hs-identifier hs-var">dr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ProductSymbol ZMod -&gt; X (ProductSymbol ZMod)
forall a. a -&gt; X a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ZMod -&gt; ProductSymbol ZMod
forall x. Entity x =&gt; x -&gt; ProductSymbol x
</span><span class="hs-identifier hs-var">sy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">N -&gt; ZMod
</span><a href="OAlg.AbelianGroup.ZMod.html#ZMod"><span class="hs-identifier hs-var">ZMod</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ProductSymbol ZMod
-&gt; Exponent (ProductSymbol ZMod) -&gt; ProductSymbol ZMod
forall f. Exponential f =&gt; f -&gt; Exponent f -&gt; f
</span><span class="hs-operator hs-var">^</span></span><span> </span><span class="annot"><span class="annottext">N
Exponent (ProductSymbol ZMod)
</span><a href="#local-6989586621679088208"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-919"></span><span>    </span><span id="local-6989586621679088214"><span class="annot"><span class="annottext">ProductSymbol ZMod
</span><a href="#local-6989586621679088214"><span class="hs-identifier hs-var">ds</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">X (ProductSymbol ZMod)
</span><a href="#local-6989586621679088215"><span class="hs-identifier hs-var">xds</span></a></span><span>
</span><span id="line-920"></span><span>    </span><span id="local-6989586621679088216"><span class="annot"><span class="annottext">ProductSymbol ZMod
</span><a href="#local-6989586621679088216"><span class="hs-identifier hs-var">dt</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">X (ProductSymbol ZMod)
</span><a href="#local-6989586621679088217"><span class="hs-identifier hs-var">xdt</span></a></span><span>
</span><span id="line-921"></span><span>    </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span><span> </span><span id="local-6989586621679088218"><span class="annot"><span class="annottext">Matrix ZModHom
</span><a href="#local-6989586621679088218"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Q -&gt; Orientation AbGroup -&gt; X AbHom
</span><a href="OAlg.AbelianGroup.Definition.html#xAbHom"><span class="hs-identifier hs-var">xAbHom</span></a></span><span> </span><span class="annot"><span class="annottext">Q
</span><a href="#local-6989586621679088207"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProductSymbol ZMod -&gt; AbGroup
</span><a href="OAlg.AbelianGroup.Definition.html#AbGroup"><span class="hs-identifier hs-var">AbGroup</span></a></span><span> </span><span class="annot"><span class="annottext">ProductSymbol ZMod
</span><a href="#local-6989586621679088219"><span class="hs-identifier hs-var">da</span></a></span><span> </span><span class="annot"><span class="annottext">AbGroup -&gt; AbGroup -&gt; Orientation AbGroup
forall p. p -&gt; p -&gt; Orientation p
</span><span class="hs-operator hs-var">:&gt;</span></span><span> </span><span class="annot"><span class="annottext">ProductSymbol ZMod -&gt; AbGroup
</span><a href="OAlg.AbelianGroup.Definition.html#AbGroup"><span class="hs-identifier hs-var">AbGroup</span></a></span><span> </span><span class="annot"><span class="annottext">ProductSymbol ZMod
</span><a href="#local-6989586621679088213"><span class="hs-identifier hs-var">dr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-922"></span><span>    </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span><span> </span><span id="local-6989586621679088220"><span class="annot"><span class="annottext">Matrix ZModHom
</span><a href="#local-6989586621679088220"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Q -&gt; Orientation AbGroup -&gt; X AbHom
</span><a href="OAlg.AbelianGroup.Definition.html#xAbHom"><span class="hs-identifier hs-var">xAbHom</span></a></span><span> </span><span class="annot"><span class="annottext">Q
</span><a href="#local-6989586621679088207"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProductSymbol ZMod -&gt; AbGroup
</span><a href="OAlg.AbelianGroup.Definition.html#AbGroup"><span class="hs-identifier hs-var">AbGroup</span></a></span><span> </span><span class="annot"><span class="annottext">ProductSymbol ZMod
</span><a href="#local-6989586621679088219"><span class="hs-identifier hs-var">da</span></a></span><span> </span><span class="annot"><span class="annottext">AbGroup -&gt; AbGroup -&gt; Orientation AbGroup
forall p. p -&gt; p -&gt; Orientation p
</span><span class="hs-operator hs-var">:&gt;</span></span><span> </span><span class="annot"><span class="annottext">ProductSymbol ZMod -&gt; AbGroup
</span><a href="OAlg.AbelianGroup.Definition.html#AbGroup"><span class="hs-identifier hs-var">AbGroup</span></a></span><span> </span><span class="annot"><span class="annottext">ProductSymbol ZMod
</span><a href="#local-6989586621679088214"><span class="hs-identifier hs-var">ds</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-923"></span><span>    </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span><span> </span><span id="local-6989586621679088221"><span class="annot"><span class="annottext">Matrix ZModHom
</span><a href="#local-6989586621679088221"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Q -&gt; Orientation AbGroup -&gt; X AbHom
</span><a href="OAlg.AbelianGroup.Definition.html#xAbHom"><span class="hs-identifier hs-var">xAbHom</span></a></span><span> </span><span class="annot"><span class="annottext">Q
</span><a href="#local-6989586621679088207"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProductSymbol ZMod -&gt; AbGroup
</span><a href="OAlg.AbelianGroup.Definition.html#AbGroup"><span class="hs-identifier hs-var">AbGroup</span></a></span><span> </span><span class="annot"><span class="annottext">ProductSymbol ZMod
</span><a href="#local-6989586621679088219"><span class="hs-identifier hs-var">da</span></a></span><span> </span><span class="annot"><span class="annottext">AbGroup -&gt; AbGroup -&gt; Orientation AbGroup
forall p. p -&gt; p -&gt; Orientation p
</span><span class="hs-operator hs-var">:&gt;</span></span><span> </span><span class="annot"><span class="annottext">ProductSymbol ZMod -&gt; AbGroup
</span><a href="OAlg.AbelianGroup.Definition.html#AbGroup"><span class="hs-identifier hs-var">AbGroup</span></a></span><span> </span><span class="annot"><span class="annottext">ProductSymbol ZMod
</span><a href="#local-6989586621679088216"><span class="hs-identifier hs-var">dt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-924"></span><span>    </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span><span> </span><span id="local-6989586621679088222"><span class="annot"><span class="annottext">Matrix ZModHom
</span><a href="#local-6989586621679088222"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Q -&gt; Orientation AbGroup -&gt; X AbHom
</span><a href="OAlg.AbelianGroup.Definition.html#xAbHom"><span class="hs-identifier hs-var">xAbHom</span></a></span><span> </span><span class="annot"><span class="annottext">Q
</span><a href="#local-6989586621679088207"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProductSymbol ZMod -&gt; AbGroup
</span><a href="OAlg.AbelianGroup.Definition.html#AbGroup"><span class="hs-identifier hs-var">AbGroup</span></a></span><span> </span><span class="annot"><span class="annottext">ProductSymbol ZMod
</span><a href="#local-6989586621679088223"><span class="hs-identifier hs-var">dc</span></a></span><span> </span><span class="annot"><span class="annottext">AbGroup -&gt; AbGroup -&gt; Orientation AbGroup
forall p. p -&gt; p -&gt; Orientation p
</span><span class="hs-operator hs-var">:&gt;</span></span><span> </span><span class="annot"><span class="annottext">ProductSymbol ZMod -&gt; AbGroup
</span><a href="OAlg.AbelianGroup.Definition.html#AbGroup"><span class="hs-identifier hs-var">AbGroup</span></a></span><span> </span><span class="annot"><span class="annottext">ProductSymbol ZMod
</span><a href="#local-6989586621679088214"><span class="hs-identifier hs-var">ds</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-925"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679088224"><span class="annot"><span class="annottext">cl :: [Dim' ZModHom]
</span><a href="#local-6989586621679088224"><span class="hs-identifier hs-var hs-var">cl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ProductSymbol ZMod -&gt; Dim' ZModHom)
-&gt; [ProductSymbol ZMod] -&gt; [Dim' ZModHom]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
forall (h :: * -&gt; * -&gt; *) (f :: * -&gt; *) a b.
Applicative1 h f =&gt;
h a b -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">amap1</span></span><span> </span><span class="annot"><span class="annottext">CSequence (Point ZModHom) -&gt; Dim' ZModHom
ProductSymbol ZMod -&gt; Dim' ZModHom
forall x. CSequence (Point x) -&gt; Dim x (Point x)
</span><span class="hs-identifier hs-var">Dim</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ProductSymbol ZMod
</span><a href="#local-6989586621679088219"><span class="hs-identifier hs-var">da</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">ProductSymbol ZMod
</span><a href="#local-6989586621679088225"><span class="hs-identifier hs-var">db</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">ProductSymbol ZMod
</span><a href="#local-6989586621679088223"><span class="hs-identifier hs-var">dc</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-926"></span><span>        </span><span id="local-6989586621679088226"><span class="annot"><span class="annottext">rw :: [Dim' ZModHom]
</span><a href="#local-6989586621679088226"><span class="hs-identifier hs-var hs-var">rw</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ProductSymbol ZMod -&gt; Dim' ZModHom)
-&gt; [ProductSymbol ZMod] -&gt; [Dim' ZModHom]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
forall (h :: * -&gt; * -&gt; *) (f :: * -&gt; *) a b.
Applicative1 h f =&gt;
h a b -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">amap1</span></span><span> </span><span class="annot"><span class="annottext">CSequence (Point ZModHom) -&gt; Dim' ZModHom
ProductSymbol ZMod -&gt; Dim' ZModHom
forall x. CSequence (Point x) -&gt; Dim x (Point x)
</span><span class="hs-identifier hs-var">Dim</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ProductSymbol ZMod
</span><a href="#local-6989586621679088213"><span class="hs-identifier hs-var">dr</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">ProductSymbol ZMod
</span><a href="#local-6989586621679088214"><span class="hs-identifier hs-var">ds</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">ProductSymbol ZMod
</span><a href="#local-6989586621679088216"><span class="hs-identifier hs-var">dt</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-927"></span><span>        </span><span id="local-6989586621679088227"><span class="annot"><span class="annottext">m :: Matrix ZModHom
</span><a href="#local-6989586621679088227"><span class="hs-identifier hs-var hs-var">m</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix (Matrix ZModHom) -&gt; Matrix ZModHom
forall x. Oriented x =&gt; Matrix (Matrix x) -&gt; Matrix x
</span><span class="hs-identifier hs-var">mtxJoin</span></span><span> </span><span class="annot"><span class="annottext">(Matrix (Matrix ZModHom) -&gt; Matrix ZModHom)
-&gt; Matrix (Matrix ZModHom) -&gt; Matrix ZModHom
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Dim' ZModHom]
-&gt; [Dim' ZModHom]
-&gt; [(Matrix ZModHom, N, N)]
-&gt; Matrix (Matrix ZModHom)
forall x.
(Additive x, FibredOriented x) =&gt;
[Dim' x] -&gt; [Dim' x] -&gt; [(Matrix x, N, N)] -&gt; Matrix (Matrix x)
</span><span class="hs-identifier hs-var">matrixBlc</span></span><span> </span><span class="annot"><span class="annottext">[Dim' ZModHom]
</span><a href="#local-6989586621679088226"><span class="hs-identifier hs-var">rw</span></a></span><span> </span><span class="annot"><span class="annottext">[Dim' ZModHom]
</span><a href="#local-6989586621679088224"><span class="hs-identifier hs-var">cl</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix ZModHom
</span><a href="#local-6989586621679088218"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix ZModHom
</span><a href="#local-6989586621679088220"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">N
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix ZModHom
</span><a href="#local-6989586621679088221"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">N
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix ZModHom
</span><a href="#local-6989586621679088222"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">N
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">N
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-928"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-929"></span><span>      </span><span id="local-6989586621679088228"><span class="annot"><span class="annottext">RowTrafo ZModHom
</span><a href="#local-6989586621679088228"><span class="hs-identifier hs-var">pr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Dim' ZModHom -&gt; X (RowTrafo ZModHom)
forall {a}. Distributive a =&gt; Dim a (Point a) -&gt; X (RowTrafo a)
</span><a href="#local-6989586621679088229"><span class="hs-identifier hs-var">xpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix ZModHom -&gt; Point (Matrix ZModHom)
forall q. Oriented q =&gt; q -&gt; Point q
</span><span class="hs-identifier hs-var">end</span></span><span> </span><span class="annot"><span class="annottext">Matrix ZModHom
</span><a href="#local-6989586621679088227"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-930"></span><span>      </span><span class="annot"><span class="annottext">Matrix ZModHom -&gt; X (Matrix ZModHom)
forall a. a -&gt; X a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">RowTrafo ZModHom
</span><a href="#local-6989586621679088228"><span class="hs-identifier hs-var">pr</span></a></span><span> </span><span class="annot"><span class="annottext">RowTrafo ZModHom -&gt; Matrix ZModHom -&gt; Matrix ZModHom
forall f x. Opl f x =&gt; f -&gt; x -&gt; x
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Matrix ZModHom
</span><a href="#local-6989586621679088227"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Matrix ZModHom -&gt; ColTrafo ZModHom -&gt; Matrix ZModHom
forall f x. Opr f x =&gt; x -&gt; f -&gt; x
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">ColTrafo ZModHom
</span><a href="#local-6989586621679088230"><span class="hs-identifier hs-var">pc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-931"></span><span>
</span><span id="line-932"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679088231"><span class="annot"><span class="annottext">ProductSymbol ZMod
</span><a href="#local-6989586621679088231"><span class="hs-identifier hs-var">g'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679088232"><span class="annot"><span class="annottext">Permutation N
</span><a href="#local-6989586621679088232"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ZMod -&gt; ZMod -&gt; Ordering)
-&gt; (ZMod -&gt; ZMod)
-&gt; ProductSymbol ZMod
-&gt; (ProductSymbol ZMod, Permutation N)
forall (s :: * -&gt; *) x w.
PermutableSequence s N x =&gt;
(w -&gt; w -&gt; Ordering) -&gt; (x -&gt; w) -&gt; s x -&gt; (s x, Permutation N)
</span><span class="hs-identifier hs-var">permuteByN</span></span><span> </span><span class="annot"><span class="annottext">ZMod -&gt; ZMod -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><span class="annottext">ZMod -&gt; ZMod
forall x. x -&gt; x
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="annot"><span class="annottext">ProductSymbol ZMod
</span><a href="#local-6989586621679088211"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-933"></span><span>
</span><span id="line-934"></span><span>  </span><span class="annot"><a href="#local-6989586621679088230"><span class="hs-identifier hs-type">pc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ColTrafo</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.ZMod.html#ZModHom"><span class="hs-identifier hs-type">ZModHom</span></a></span><span>
</span><span id="line-935"></span><span>  </span><span id="local-6989586621679088230"><span class="annot"><span class="annottext">pc :: ColTrafo ZModHom
</span><a href="#local-6989586621679088230"><span class="hs-identifier hs-var hs-var">pc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GLT ZModHom -&gt; ColTrafo ZModHom
forall x. GLT x -&gt; ColTrafo x
</span><span class="hs-identifier hs-var">ColTrafo</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dim' ZModHom -&gt; Dim' ZModHom -&gt; Permutation N -&gt; GLT ZModHom
forall x.
Distributive x =&gt;
Dim' x -&gt; Dim' x -&gt; Permutation N -&gt; GLT x
</span><span class="hs-identifier hs-var">permute</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CSequence (Point ZModHom) -&gt; Dim' ZModHom
forall x. CSequence (Point x) -&gt; Dim x (Point x)
</span><span class="hs-identifier hs-var">Dim</span></span><span> </span><span class="annot"><span class="annottext">CSequence (Point ZModHom)
ProductSymbol ZMod
</span><a href="#local-6989586621679088231"><span class="hs-identifier hs-var">g'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CSequence (Point ZModHom) -&gt; Dim' ZModHom
forall x. CSequence (Point x) -&gt; Dim x (Point x)
</span><span class="hs-identifier hs-var">Dim</span></span><span> </span><span class="annot"><span class="annottext">CSequence (Point ZModHom)
ProductSymbol ZMod
</span><a href="#local-6989586621679088211"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Permutation N
</span><a href="#local-6989586621679088232"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-936"></span><span>
</span><span id="line-937"></span><span>  </span><span id="local-6989586621679088229"><span class="annot"><span class="annottext">xpr :: Dim a (Point a) -&gt; X (RowTrafo a)
</span><a href="#local-6989586621679088229"><span class="hs-identifier hs-var hs-var">xpr</span></a></span></span><span> </span><span id="local-6989586621679088315"><span class="annot"><span class="annottext">Dim a (Point a)
</span><a href="#local-6989586621679088315"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-938"></span><span>    </span><span id="local-6989586621679088316"><span class="annot"><span class="annottext">Permutation N
</span><a href="#local-6989586621679088316"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">N -&gt; X (Permutation N)
</span><span class="hs-identifier hs-var">xPermutationN</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dim a (Point a) -&gt; N
forall x. LengthN x =&gt; x -&gt; N
</span><span class="hs-identifier hs-var">lengthN</span></span><span> </span><span class="annot"><span class="annottext">Dim a (Point a)
</span><a href="#local-6989586621679088315"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-939"></span><span>    </span><span class="annot"><span class="annottext">RowTrafo a -&gt; X (RowTrafo a)
forall a. a -&gt; X a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GLT a -&gt; RowTrafo a
forall a. GLT a -&gt; RowTrafo a
</span><span class="hs-identifier hs-var">RowTrafo</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dim a (Point a) -&gt; Dim a (Point a) -&gt; Permutation N -&gt; GLT a
forall x.
Distributive x =&gt;
Dim' x -&gt; Dim' x -&gt; Permutation N -&gt; GLT x
</span><span class="hs-identifier hs-var">permute</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dim a (Point a)
</span><a href="#local-6989586621679088315"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Dim a (Point a) -&gt; Permutation N -&gt; Dim a (Point a)
forall f x. Opr f x =&gt; x -&gt; f -&gt; x
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Permutation N
</span><a href="#local-6989586621679088316"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Dim a (Point a)
</span><a href="#local-6989586621679088315"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Permutation N
</span><a href="#local-6989586621679088316"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-940"></span><span>
</span><span id="line-941"></span><span>  </span><span id="local-6989586621679088320"><span class="annot"><span class="annottext">expAt :: N -&gt; Word r ZMod -&gt; (r, Word r ZMod)
</span><a href="#local-6989586621679088320"><span class="hs-identifier hs-var hs-var">expAt</span></a></span></span><span> </span><span id="local-6989586621679088321"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679088321"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679088322"><span class="annot"><span class="annottext">Word r ZMod
</span><a href="#local-6989586621679088322"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Word r ZMod
</span><a href="#local-6989586621679088322"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-942"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Word</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="OAlg.AbelianGroup.ZMod.html#ZMod"><span class="hs-identifier hs-type">ZMod</span></a></span><span> </span><span id="local-6989586621679088323"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679088323"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679088324"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679088324"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679088325"><span class="annot"><span class="annottext">[(ZMod, r)]
</span><a href="#local-6989586621679088325"><span class="hs-identifier hs-var">w'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679088321"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679088323"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679088324"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[(ZMod, r)] -&gt; Word r ZMod
forall r a. [(a, r)] -&gt; Word r a
</span><span class="hs-identifier hs-var">Word</span></span><span> </span><span class="annot"><span class="annottext">[(ZMod, r)]
</span><a href="#local-6989586621679088325"><span class="hs-identifier hs-var">w'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-943"></span><span>    </span><span class="annot"><span class="annottext">Word r ZMod
</span><span class="hs-identifier">_</span></span><span>                             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Word r ZMod
</span><a href="#local-6989586621679088322"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-944"></span><span>
</span><span id="line-945"></span><span>  </span><span id="local-6989586621679088326"><span class="annot"><span class="annottext">w' :: Word N ZMod
</span><a href="#local-6989586621679088326"><span class="hs-identifier hs-var hs-var">w'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProductSymbol ZMod -&gt; Word N ZMod
forall x. Entity x =&gt; ProductSymbol x -&gt; Word N x
</span><span class="hs-identifier hs-var">psywrd</span></span><span> </span><span class="annot"><span class="annottext">ProductSymbol ZMod
</span><a href="#local-6989586621679088231"><span class="hs-identifier hs-var">g'</span></a></span><span>
</span><span id="line-946"></span><span>
</span><span id="line-947"></span><span>  </span><span id="local-6989586621679088219"><span class="annot"><span class="annottext">da :: ProductSymbol ZMod
</span><a href="#local-6989586621679088219"><span class="hs-identifier hs-var hs-var">da</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ZMod -&gt; ProductSymbol ZMod
forall x. Entity x =&gt; x -&gt; ProductSymbol x
</span><span class="hs-identifier hs-var">sy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">N -&gt; ZMod
</span><a href="OAlg.AbelianGroup.ZMod.html#ZMod"><span class="hs-identifier hs-var">ZMod</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ProductSymbol ZMod
-&gt; Exponent (ProductSymbol ZMod) -&gt; ProductSymbol ZMod
forall f. Exponential f =&gt; f -&gt; Exponent f -&gt; f
</span><span class="hs-operator hs-var">^</span></span><span> </span><span class="annot"><span class="annottext">N
Exponent (ProductSymbol ZMod)
</span><a href="#local-6989586621679088327"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-948"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679088327"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679088327"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679088328"><span class="annot"><span class="annottext">Word N ZMod
</span><a href="#local-6989586621679088328"><span class="hs-identifier hs-var">w''</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">N -&gt; Word N ZMod -&gt; (N, Word N ZMod)
forall {r}. Num r =&gt; N -&gt; Word r ZMod -&gt; (r, Word r ZMod)
</span><a href="#local-6989586621679088320"><span class="hs-identifier hs-var">expAt</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Word N ZMod
</span><a href="#local-6989586621679088326"><span class="hs-identifier hs-var">w'</span></a></span><span>
</span><span id="line-949"></span><span>  </span><span>
</span><span id="line-950"></span><span>  </span><span id="local-6989586621679088225"><span class="annot"><span class="annottext">db :: ProductSymbol ZMod
</span><a href="#local-6989586621679088225"><span class="hs-identifier hs-var hs-var">db</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ZMod -&gt; ProductSymbol ZMod
forall x. Entity x =&gt; x -&gt; ProductSymbol x
</span><span class="hs-identifier hs-var">sy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">N -&gt; ZMod
</span><a href="OAlg.AbelianGroup.ZMod.html#ZMod"><span class="hs-identifier hs-var">ZMod</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ProductSymbol ZMod
-&gt; Exponent (ProductSymbol ZMod) -&gt; ProductSymbol ZMod
forall f. Exponential f =&gt; f -&gt; Exponent f -&gt; f
</span><span class="hs-operator hs-var">^</span></span><span> </span><span class="annot"><span class="annottext">N
Exponent (ProductSymbol ZMod)
</span><a href="#local-6989586621679088329"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-951"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679088329"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679088329"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679088330"><span class="annot"><span class="annottext">Word N ZMod
</span><a href="#local-6989586621679088330"><span class="hs-identifier hs-var">w'''</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">N -&gt; Word N ZMod -&gt; (N, Word N ZMod)
forall {r}. Num r =&gt; N -&gt; Word r ZMod -&gt; (r, Word r ZMod)
</span><a href="#local-6989586621679088320"><span class="hs-identifier hs-var">expAt</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Word N ZMod
</span><a href="#local-6989586621679088328"><span class="hs-identifier hs-var">w''</span></a></span><span>
</span><span id="line-952"></span><span>  </span><span class="hs-comment">-- for all ((ZMod n),_) in w''' holds: 2 &lt;= n</span><span>
</span><span id="line-953"></span><span>    </span><span>
</span><span id="line-954"></span><span>  </span><span id="local-6989586621679088223"><span class="annot"><span class="annottext">dc :: ProductSymbol ZMod
</span><a href="#local-6989586621679088223"><span class="hs-identifier hs-var hs-var">dc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word N ZMod -&gt; ProductSymbol ZMod
forall x. Entity x =&gt; Word N x -&gt; ProductSymbol x
</span><span class="hs-identifier hs-var">wrdpsy</span></span><span> </span><span class="annot"><span class="annottext">Word N ZMod
</span><a href="#local-6989586621679088330"><span class="hs-identifier hs-var">w'''</span></a></span><span>
</span><span id="line-955"></span><span>
</span><span id="line-956"></span><span>  </span><span id="local-6989586621679088331"><span class="annot"><span class="annottext">ms :: [N]
</span><a href="#local-6989586621679088331"><span class="hs-identifier hs-var hs-var">ms</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((ZMod, N) -&gt; N) -&gt; [(ZMod, N)] -&gt; [N]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
forall (h :: * -&gt; * -&gt; *) (f :: * -&gt; *) a b.
Applicative1 h f =&gt;
h a b -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">amap1</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="OAlg.AbelianGroup.ZMod.html#ZMod"><span class="hs-identifier hs-type">ZMod</span></a></span><span> </span><span id="local-6989586621679088332"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679088332"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679088332"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ZMod -&gt; N) -&gt; ((ZMod, N) -&gt; ZMod) -&gt; (ZMod, N) -&gt; N
forall y z x. (y -&gt; z) -&gt; (x -&gt; y) -&gt; x -&gt; z
forall (c :: * -&gt; * -&gt; *) y z x.
Category c =&gt;
c y z -&gt; c x y -&gt; c x z
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(ZMod, N) -&gt; ZMod
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(ZMod, N)] -&gt; [N]) -&gt; [(ZMod, N)] -&gt; [N]
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Word N ZMod -&gt; [(ZMod, N)]
forall r a. Word r a -&gt; [(a, r)]
</span><span class="hs-identifier hs-var">fromWord</span></span><span> </span><span class="annot"><span class="annottext">Word N ZMod
</span><a href="#local-6989586621679088330"><span class="hs-identifier hs-var">w'''</span></a></span><span>
</span><span id="line-957"></span><span>  </span><span id="local-6989586621679088333"><span class="annot"><span class="annottext">gms :: N
</span><a href="#local-6989586621679088333"><span class="hs-identifier hs-var hs-var">gms</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[N] -&gt; N
</span><a href="OAlg.AbelianGroup.Euclid.html#gcds"><span class="hs-identifier hs-var">gcds</span></a></span><span> </span><span class="annot"><span class="annottext">[N]
</span><a href="#local-6989586621679088331"><span class="hs-identifier hs-var">ms</span></a></span><span>  </span><span>
</span><span id="line-958"></span><span>  </span><span id="local-6989586621679088334"><span class="annot"><span class="annottext">lms :: N
</span><a href="#local-6989586621679088334"><span class="hs-identifier hs-var hs-var">lms</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[N] -&gt; N
</span><a href="OAlg.AbelianGroup.Euclid.html#lcms"><span class="hs-identifier hs-var">lcms</span></a></span><span> </span><span class="annot"><span class="annottext">[N]
</span><a href="#local-6989586621679088331"><span class="hs-identifier hs-var">ms</span></a></span><span>
</span><span id="line-959"></span><span>  </span><span class="hs-comment">-- 1 &lt;= lms, because 2 &lt;= m for all m in ms</span><span>
</span><span id="line-960"></span><span>  </span><span>
</span><span id="line-961"></span><span>  </span><span id="local-6989586621679088335"><span class="annot"><span class="annottext">xsl :: X ZMod
</span><a href="#local-6989586621679088335"><span class="hs-identifier hs-var hs-var">xsl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-962"></span><span>    </span><span id="local-6989586621679088336"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679088336"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; X N
</span><span class="hs-identifier hs-var">xNB</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">10</span></span><span>
</span><span id="line-963"></span><span>    </span><span class="annot"><span class="annottext">ZMod -&gt; X ZMod
forall a. a -&gt; X a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(ZMod -&gt; X ZMod) -&gt; ZMod -&gt; X ZMod
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">N -&gt; ZMod
</span><a href="OAlg.AbelianGroup.ZMod.html#ZMod"><span class="hs-identifier hs-var">ZMod</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679088336"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">N -&gt; N -&gt; N
forall c. Multiplicative c =&gt; c -&gt; c -&gt; c
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679088334"><span class="hs-identifier hs-var">lms</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-964"></span><span>
</span><span id="line-965"></span><span>  </span><span id="local-6989586621679088337"><span class="annot"><span class="annottext">xsg :: X ZMod
</span><a href="#local-6989586621679088337"><span class="hs-identifier hs-var hs-var">xsg</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679088333"><span class="hs-identifier hs-var">gms</span></a></span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">2</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">X ZMod
forall x. X x
</span><span class="hs-identifier hs-var">XEmpty</span></span><span>
</span><span id="line-966"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[(N, N)]
</span><a href="#local-6989586621679088338"><span class="hs-identifier hs-var">ws</span></a></span><span> </span><span class="annot"><span class="annottext">[(N, N)] -&gt; [(N, N)] -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">X ZMod
forall x. X x
</span><span class="hs-identifier hs-var">XEmpty</span></span><span>
</span><span id="line-967"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-968"></span><span>          </span><span id="local-6989586621679088339"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679088339"><span class="hs-identifier hs-var">r</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; X N
</span><span class="hs-identifier hs-var">xNB</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679088340"><span class="hs-identifier hs-var">rMax</span></a></span><span>
</span><span id="line-969"></span><span>          </span><span id="local-6989586621679088341"><span class="annot"><span class="annottext">[N]
</span><a href="#local-6989586621679088341"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">N -&gt; X N -&gt; X [N]
forall x. N -&gt; X x -&gt; X [x]
</span><span class="hs-identifier hs-var">xTakeN</span></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679088339"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[N] -&gt; X N
forall a. [a] -&gt; X a
</span><span class="hs-identifier hs-var">xOneOf</span></span><span> </span><span class="annot"><span class="annottext">[N]
</span><a href="#local-6989586621679088342"><span class="hs-identifier hs-var">fs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-970"></span><span>          </span><span id="local-6989586621679088343"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679088343"><span class="hs-identifier hs-var">n</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; X N
</span><span class="hs-identifier hs-var">xNB</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">10</span></span><span>
</span><span id="line-971"></span><span>          </span><span class="annot"><span class="annottext">ZMod -&gt; X ZMod
forall a. a -&gt; X a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(ZMod -&gt; X ZMod) -&gt; ZMod -&gt; X ZMod
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">N -&gt; ZMod
</span><a href="OAlg.AbelianGroup.ZMod.html#ZMod"><span class="hs-identifier hs-var">ZMod</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679088343"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; N
forall c. Multiplicative c =&gt; c -&gt; c -&gt; c
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">(N -&gt; N -&gt; N) -&gt; N -&gt; [N] -&gt; N
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; N
forall c. Multiplicative c =&gt; c -&gt; c -&gt; c
</span><span class="hs-operator hs-var">(*)</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">[N]
</span><a href="#local-6989586621679088341"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-972"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word</span></span><span> </span><span id="local-6989586621679088338"><span class="annot"><span class="annottext">[(N, N)]
</span><a href="#local-6989586621679088338"><span class="hs-identifier hs-var">ws</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; Word N N
</span><span class="hs-identifier hs-var">nFactorize'</span></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="OAlg.AbelianGroup.Definition.html#stdMaxPrime"><span class="hs-identifier hs-var">stdMaxPrime</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679088333"><span class="hs-identifier hs-var">gms</span></a></span><span>
</span><span id="line-973"></span><span>          </span><span id="local-6989586621679088342"><span class="annot"><span class="annottext">fs :: [N]
</span><a href="#local-6989586621679088342"><span class="hs-identifier hs-var hs-var">fs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((N, N) -&gt; N) -&gt; [(N, N)] -&gt; [N]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
forall (h :: * -&gt; * -&gt; *) (f :: * -&gt; *) a b.
Applicative1 h f =&gt;
h a b -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">amap1</span></span><span> </span><span class="annot"><span class="annottext">(N, N) -&gt; N
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">[(N, N)]
</span><a href="#local-6989586621679088338"><span class="hs-identifier hs-var">ws</span></a></span><span>
</span><span id="line-974"></span><span>          </span><span id="local-6989586621679088340"><span class="annot"><span class="annottext">rMax :: N
</span><a href="#local-6989586621679088340"><span class="hs-identifier hs-var hs-var">rMax</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(N -&gt; N -&gt; N) -&gt; N -&gt; [N] -&gt; N
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; N
forall a. Additive a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(+)</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">([N] -&gt; N) -&gt; [N] -&gt; N
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((N, N) -&gt; N) -&gt; [(N, N)] -&gt; [N]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
forall (h :: * -&gt; * -&gt; *) (f :: * -&gt; *) a b.
Applicative1 h f =&gt;
h a b -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">amap1</span></span><span> </span><span class="annot"><span class="annottext">(N, N) -&gt; N
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">[(N, N)]
</span><a href="#local-6989586621679088338"><span class="hs-identifier hs-var">ws</span></a></span><span>
</span><span id="line-975"></span><span>          </span><span class="hs-comment">-- 0 &lt; nMax, because ws is not empty</span><span>
</span><span id="line-976"></span><span>          </span><span>
</span><span id="line-977"></span><span>  </span><span id="local-6989586621679088215"><span class="annot"><span class="annottext">xds :: X (ProductSymbol ZMod)
</span><a href="#local-6989586621679088215"><span class="hs-identifier hs-var hs-var">xds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">N -&gt; X ZMod -&gt; X [ZMod]
forall x. N -&gt; X x -&gt; X [x]
</span><span class="hs-identifier hs-var">xTakeN</span></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679088209"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">X ZMod
</span><a href="#local-6989586621679088337"><span class="hs-identifier hs-var">xsg</span></a></span><span> </span><span class="annot"><span class="annottext">X ZMod -&gt; X ZMod -&gt; X ZMod
forall a. X a -&gt; X a -&gt; X a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">X ZMod
</span><a href="#local-6989586621679088335"><span class="hs-identifier hs-var">xsl</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">X [ZMod]
-&gt; ([ZMod] -&gt; X (ProductSymbol ZMod)) -&gt; X (ProductSymbol ZMod)
forall a b. X a -&gt; (a -&gt; X b) -&gt; X b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">ProductSymbol ZMod -&gt; X (ProductSymbol ZMod)
forall a. a -&gt; X a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(ProductSymbol ZMod -&gt; X (ProductSymbol ZMod))
-&gt; ([ZMod] -&gt; ProductSymbol ZMod)
-&gt; [ZMod]
-&gt; X (ProductSymbol ZMod)
forall y z x. (y -&gt; z) -&gt; (x -&gt; y) -&gt; x -&gt; z
forall (c :: * -&gt; * -&gt; *) y z x.
Category c =&gt;
c y z -&gt; c x y -&gt; c x z
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[ZMod] -&gt; ProductSymbol ZMod
forall x. Entity x =&gt; [x] -&gt; ProductSymbol x
</span><span class="hs-identifier hs-var">productSymbol</span></span><span>
</span><span id="line-978"></span><span>
</span><span id="line-979"></span><span>  </span><span id="local-6989586621679088344"><span class="annot"><span class="annottext">xt :: X ZMod
</span><a href="#local-6989586621679088344"><span class="hs-identifier hs-var hs-var">xt</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[N]
</span><a href="#local-6989586621679088345"><span class="hs-identifier hs-var">fs</span></a></span><span> </span><span class="annot"><span class="annottext">[N] -&gt; [N] -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">X ZMod
forall x. X x
</span><span class="hs-identifier hs-var">XEmpty</span></span><span>
</span><span id="line-980"></span><span>     </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-981"></span><span>    </span><span id="local-6989586621679088346"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679088346"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; X N
</span><span class="hs-identifier hs-var">xNB</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">5</span></span><span>
</span><span id="line-982"></span><span>    </span><span id="local-6989586621679088347"><span class="annot"><span class="annottext">[N]
</span><a href="#local-6989586621679088347"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">N -&gt; X N -&gt; X [N]
forall x. N -&gt; X x -&gt; X [x]
</span><span class="hs-identifier hs-var">xTakeN</span></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679088346"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[N] -&gt; X N
forall a. [a] -&gt; X a
</span><span class="hs-identifier hs-var">xOneOf</span></span><span> </span><span class="annot"><span class="annottext">[N]
</span><a href="#local-6989586621679088345"><span class="hs-identifier hs-var">fs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-983"></span><span>    </span><span class="annot"><span class="annottext">ZMod -&gt; X ZMod
forall a. a -&gt; X a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(ZMod -&gt; X ZMod) -&gt; ZMod -&gt; X ZMod
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">N -&gt; ZMod
</span><a href="OAlg.AbelianGroup.ZMod.html#ZMod"><span class="hs-identifier hs-var">ZMod</span></a></span><span> </span><span class="annot"><span class="annottext">(N -&gt; ZMod) -&gt; N -&gt; ZMod
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(N -&gt; N -&gt; N) -&gt; N -&gt; [N] -&gt; N
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; N
forall c. Multiplicative c =&gt; c -&gt; c -&gt; c
</span><span class="hs-operator hs-var">(*)</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">[N]
</span><a href="#local-6989586621679088347"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-984"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679088345"><span class="annot"><span class="annottext">fs :: [N]
</span><a href="#local-6989586621679088345"><span class="hs-identifier hs-var hs-var">fs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">N -&gt; [N] -&gt; [N]
forall a. N -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">takeN</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="annottext">([N] -&gt; [N]) -&gt; [N] -&gt; [N]
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(N -&gt; Bool) -&gt; [N] -&gt; [N]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">N -&gt; N -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(N -&gt; Bool) -&gt; (N -&gt; N) -&gt; N -&gt; Bool
forall y z x. (y -&gt; z) -&gt; (x -&gt; y) -&gt; x -&gt; z
forall (c :: * -&gt; * -&gt; *) y z x.
Category c =&gt;
c y z -&gt; c x y -&gt; c x z
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; N
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">mod</span></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679088334"><span class="hs-identifier hs-var">lms</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[N]
</span><a href="OAlg.AbelianGroup.Definition.html#stdPrimes"><span class="hs-identifier hs-var">stdPrimes</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-985"></span><span>    </span><span>
</span><span id="line-986"></span><span>  </span><span id="local-6989586621679088217"><span class="annot"><span class="annottext">xdt :: X (ProductSymbol ZMod)
</span><a href="#local-6989586621679088217"><span class="hs-identifier hs-var hs-var">xdt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">X ZMod
</span><a href="#local-6989586621679088344"><span class="hs-identifier hs-var">xt</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-987"></span><span>    </span><span class="annot"><span class="annottext">X ZMod
</span><span class="hs-identifier hs-var">XEmpty</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ProductSymbol ZMod -&gt; X (ProductSymbol ZMod)
forall a. a -&gt; X a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[ZMod] -&gt; ProductSymbol ZMod
forall x. Entity x =&gt; [x] -&gt; ProductSymbol x
</span><span class="hs-identifier hs-var">productSymbol</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-988"></span><span>    </span><span class="annot"><span class="annottext">X ZMod
</span><span class="hs-identifier">_</span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">N -&gt; X ZMod -&gt; X [ZMod]
forall x. N -&gt; X x -&gt; X [x]
</span><span class="hs-identifier hs-var">xTakeN</span></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679088210"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">X ZMod
</span><a href="#local-6989586621679088344"><span class="hs-identifier hs-var">xt</span></a></span><span> </span><span class="annot"><span class="annottext">X [ZMod]
-&gt; ([ZMod] -&gt; X (ProductSymbol ZMod)) -&gt; X (ProductSymbol ZMod)
forall a b. X a -&gt; (a -&gt; X b) -&gt; X b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">ProductSymbol ZMod -&gt; X (ProductSymbol ZMod)
forall a. a -&gt; X a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(ProductSymbol ZMod -&gt; X (ProductSymbol ZMod))
-&gt; ([ZMod] -&gt; ProductSymbol ZMod)
-&gt; [ZMod]
-&gt; X (ProductSymbol ZMod)
forall y z x. (y -&gt; z) -&gt; (x -&gt; y) -&gt; x -&gt; z
forall (c :: * -&gt; * -&gt; *) y z x.
Category c =&gt;
c y z -&gt; c x y -&gt; c x z
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[ZMod] -&gt; ProductSymbol ZMod
forall x. Entity x =&gt; [x] -&gt; ProductSymbol x
</span><span class="hs-identifier hs-var">productSymbol</span></span><span>
</span><span id="line-989"></span><span> </span><span>
</span><span id="line-990"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-991"></span><span class="hs-comment">-- AbHom - XStandardOrtSite -</span><span>
</span><span id="line-992"></span><span>
</span><span id="line-993"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">XStandardOrtSite</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">To</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-994"></span><span>  </span><span id="local-6989586621679088365"><span class="annot"><span class="annottext">xStandardOrtSite :: XOrtSite 'To AbHom
</span><a href="#local-6989586621679088365"><span class="hs-identifier hs-var hs-var hs-var hs-var">xStandardOrtSite</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">X (Point AbHom) -&gt; (Point AbHom -&gt; X AbHom) -&gt; XOrtSite 'To AbHom
forall q. X (Point q) -&gt; (Point q -&gt; X q) -&gt; XOrtSite 'To q
</span><span class="hs-identifier hs-var">XEnd</span></span><span> </span><span class="annot"><span class="annottext">X (Point AbHom)
X AbGroup
forall x. XStandard x =&gt; X x
</span><span class="hs-identifier hs-var">xStandard</span></span><span> </span><span class="annot"><span class="annottext">Point AbHom -&gt; X AbHom
AbGroup -&gt; X AbHom
</span><a href="#local-6989586621679088368"><span class="hs-identifier hs-var">xTo</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-995"></span><span>    </span><span id="local-6989586621679088371"><span class="annot"><span class="annottext">q :: Q
</span><a href="#local-6989586621679088371"><span class="hs-identifier hs-var hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Q
</span><span class="hs-number">0.1</span></span><span>
</span><span id="line-996"></span><span>    </span><span id="local-6989586621679088374"><span class="annot"><span class="annottext">d3 :: N
</span><a href="#local-6989586621679088374"><span class="hs-identifier hs-var hs-var">d3</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">N
</span><a href="OAlg.AbelianGroup.Definition.html#stdMaxDim"><span class="hs-identifier hs-var">stdMaxDim</span></a></span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; N
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">3</span></span><span>
</span><span id="line-997"></span><span>    </span><span id="local-6989586621679088368"><span class="annot"><span class="annottext">xTo :: AbGroup -&gt; X AbHom
</span><a href="#local-6989586621679088368"><span class="hs-identifier hs-var hs-var">xTo</span></a></span></span><span> </span><span id="local-6989586621679088375"><span class="annot"><span class="annottext">AbGroup
</span><a href="#local-6989586621679088375"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-998"></span><span>      </span><span id="local-6989586621679088376"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679088376"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; X N
</span><span class="hs-identifier hs-var">xNB</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">N
</span><a href="OAlg.AbelianGroup.Definition.html#stdMaxDim"><span class="hs-identifier hs-var">stdMaxDim</span></a></span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; N
</span><span class="hs-operator hs-var">&gt;-</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">N -&gt; N -&gt; N
forall c. Multiplicative c =&gt; c -&gt; c -&gt; c
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679088374"><span class="hs-identifier hs-var">d3</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-999"></span><span>      </span><span id="local-6989586621679088378"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679088378"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; X N
</span><span class="hs-identifier hs-var">xNB</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679088374"><span class="hs-identifier hs-var">d3</span></a></span><span>
</span><span id="line-1000"></span><span>      </span><span id="local-6989586621679088379"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679088379"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; X N
</span><span class="hs-identifier hs-var">xNB</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679088374"><span class="hs-identifier hs-var">d3</span></a></span><span>
</span><span id="line-1001"></span><span>      </span><span id="local-6989586621679088380"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679088380"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; X N
</span><span class="hs-identifier hs-var">xNB</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">10</span></span><span>
</span><span id="line-1002"></span><span>      </span><span class="annot"><span class="annottext">Q -&gt; N -&gt; N -&gt; N -&gt; AbGroup -&gt; X AbHom
</span><a href="OAlg.AbelianGroup.Definition.html#xAbHomTo"><span class="hs-identifier hs-var">xAbHomTo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">N -&gt; Q
forall a b. Embeddable a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">inj</span></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679088380"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Q -&gt; Q -&gt; Q
forall c. Multiplicative c =&gt; c -&gt; c -&gt; c
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Q
</span><a href="#local-6989586621679088371"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679088376"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679088378"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679088379"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">AbGroup
</span><a href="#local-6989586621679088375"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-1003"></span><span>
</span><span id="line-1004"></span><span class="hs-comment">-- | distribution of the density of the random variable of @'X' 'AbHom'@, induced by the</span><span>
</span><span id="line-1005"></span><span class="hs-comment">-- standard random variable of type @'XOrtSite' 'To' 'AbHom'@.</span><span>
</span><span id="line-1006"></span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#dstXStdOrtSiteToAbHom"><span class="hs-identifier hs-type">dstXStdOrtSiteToAbHom</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1007"></span><span id="dstXStdOrtSiteToAbHom"><span class="annot"><span class="annottext">dstXStdOrtSiteToAbHom :: Int -&gt; (AbHom -&gt; String) -&gt; IO ()
</span><a href="OAlg.AbelianGroup.Definition.html#dstXStdOrtSiteToAbHom"><span class="hs-identifier hs-var hs-var">dstXStdOrtSiteToAbHom</span></a></span></span><span> </span><span id="local-6989586621679088382"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679088382"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679088383"><span class="annot"><span class="annottext">AbHom -&gt; String
</span><a href="#local-6989586621679088383"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO Omega
</span><span class="hs-identifier hs-var">getOmega</span></span><span> </span><span class="annot"><span class="annottext">IO Omega -&gt; (Omega -&gt; IO ()) -&gt; IO ()
forall a b. IO a -&gt; (a -&gt; IO b) -&gt; IO b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; X String -&gt; Omega -&gt; IO ()
forall x. (Show x, Ord x) =&gt; Int -&gt; X x -&gt; Omega -&gt; IO ()
</span><span class="hs-identifier hs-var">putDistribution</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679088382"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(AbHom -&gt; String) -&gt; X AbHom -&gt; X String
forall a b. (a -&gt; b) -&gt; X a -&gt; X b
forall (h :: * -&gt; * -&gt; *) (f :: * -&gt; *) a b.
Applicative1 h f =&gt;
h a b -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">amap1</span></span><span> </span><span class="annot"><span class="annottext">AbHom -&gt; String
</span><a href="#local-6989586621679088383"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">X AbHom
</span><a href="#local-6989586621679088384"><span class="hs-identifier hs-var">xh</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1008"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">XEnd</span></span><span> </span><span id="local-6989586621679088387"><span class="annot"><span class="annottext">X (Point AbHom)
X AbGroup
</span><a href="#local-6989586621679088387"><span class="hs-identifier hs-var">xg</span></a></span></span><span> </span><span id="local-6989586621679088388"><span class="annot"><span class="annottext">Point AbHom -&gt; X AbHom
AbGroup -&gt; X AbHom
</span><a href="#local-6989586621679088388"><span class="hs-identifier hs-var">xt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XOrtSite 'To AbHom
forall (s :: Site) a. XStandardOrtSite s a =&gt; XOrtSite s a
</span><span class="hs-identifier hs-var">xStandardOrtSite</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">XOrtSite</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">To</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span><span>
</span><span id="line-1009"></span><span>  </span><span id="local-6989586621679088384"><span class="annot"><span class="annottext">xh :: X AbHom
</span><a href="#local-6989586621679088384"><span class="hs-identifier hs-var hs-var">xh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">X AbGroup
</span><a href="#local-6989586621679088387"><span class="hs-identifier hs-var">xg</span></a></span><span> </span><span class="annot"><span class="annottext">X AbGroup -&gt; (AbGroup -&gt; X AbHom) -&gt; X AbHom
forall a b. X a -&gt; (a -&gt; X b) -&gt; X b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">AbGroup -&gt; X AbHom
</span><a href="#local-6989586621679088388"><span class="hs-identifier hs-var">xt</span></a></span><span>
</span><span id="line-1010"></span><span>
</span><span id="line-1011"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">XStandardOrtSiteTo</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span><span>
</span><span id="line-1012"></span><span>
</span><span id="line-1013"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">XStandardOrtSite</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">From</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1014"></span><span>  </span><span id="local-6989586621679088410"><span class="annot"><span class="annottext">xStandardOrtSite :: XOrtSite 'From AbHom
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">xStandardOrtSite</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">X (Point AbHom) -&gt; (Point AbHom -&gt; X AbHom) -&gt; XOrtSite 'From AbHom
forall q. X (Point q) -&gt; (Point q -&gt; X q) -&gt; XOrtSite 'From q
</span><span class="hs-identifier hs-var">XStart</span></span><span> </span><span class="annot"><span class="annottext">X (Point AbHom)
X AbGroup
forall x. XStandard x =&gt; X x
</span><span class="hs-identifier hs-var">xStandard</span></span><span> </span><span class="annot"><span class="annottext">Point AbHom -&gt; X AbHom
AbGroup -&gt; X AbHom
</span><a href="#local-6989586621679088412"><span class="hs-identifier hs-var">xFrom</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1015"></span><span>    </span><span id="local-6989586621679088415"><span class="annot"><span class="annottext">q :: Q
</span><a href="#local-6989586621679088415"><span class="hs-identifier hs-var hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Q
</span><span class="hs-number">0.1</span></span><span>
</span><span id="line-1016"></span><span>    </span><span id="local-6989586621679088418"><span class="annot"><span class="annottext">d3 :: N
</span><a href="#local-6989586621679088418"><span class="hs-identifier hs-var hs-var">d3</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">N
</span><a href="OAlg.AbelianGroup.Definition.html#stdMaxDim"><span class="hs-identifier hs-var">stdMaxDim</span></a></span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; N
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">3</span></span><span>
</span><span id="line-1017"></span><span>    </span><span id="local-6989586621679088412"><span class="annot"><span class="annottext">xFrom :: AbGroup -&gt; X AbHom
</span><a href="#local-6989586621679088412"><span class="hs-identifier hs-var hs-var">xFrom</span></a></span></span><span> </span><span id="local-6989586621679088419"><span class="annot"><span class="annottext">AbGroup
</span><a href="#local-6989586621679088419"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1018"></span><span>      </span><span id="local-6989586621679088420"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679088420"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; X N
</span><span class="hs-identifier hs-var">xNB</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">N
</span><a href="OAlg.AbelianGroup.Definition.html#stdMaxDim"><span class="hs-identifier hs-var">stdMaxDim</span></a></span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; N
</span><span class="hs-operator hs-var">&gt;-</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">N -&gt; N -&gt; N
forall c. Multiplicative c =&gt; c -&gt; c -&gt; c
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679088418"><span class="hs-identifier hs-var">d3</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1019"></span><span>      </span><span id="local-6989586621679088421"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679088421"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; X N
</span><span class="hs-identifier hs-var">xNB</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679088418"><span class="hs-identifier hs-var">d3</span></a></span><span>
</span><span id="line-1020"></span><span>      </span><span id="local-6989586621679088422"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679088422"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; X N
</span><span class="hs-identifier hs-var">xNB</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679088418"><span class="hs-identifier hs-var">d3</span></a></span><span>
</span><span id="line-1021"></span><span>      </span><span id="local-6989586621679088423"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679088423"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; X N
</span><span class="hs-identifier hs-var">xNB</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">10</span></span><span>
</span><span id="line-1022"></span><span>      </span><span class="annot"><span class="annottext">Q -&gt; N -&gt; N -&gt; N -&gt; AbGroup -&gt; X AbHom
</span><a href="OAlg.AbelianGroup.Definition.html#xAbHomFrom"><span class="hs-identifier hs-var">xAbHomFrom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">N -&gt; Q
forall a b. Embeddable a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">inj</span></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679088423"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Q -&gt; Q -&gt; Q
forall c. Multiplicative c =&gt; c -&gt; c -&gt; c
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Q
</span><a href="#local-6989586621679088415"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679088420"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679088421"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679088422"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">AbGroup
</span><a href="#local-6989586621679088419"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-1023"></span><span>
</span><span id="line-1024"></span><span class="hs-comment">-- | distribution of the density of the random variable of @'X' 'AbHom'@, induced by the</span><span>
</span><span id="line-1025"></span><span class="hs-comment">-- standard random variable of type @'XOrtSite' 'From' 'AbHom'@.</span><span>
</span><span id="line-1026"></span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#dstXStdOrtSiteFromAbHom"><span class="hs-identifier hs-type">dstXStdOrtSiteFromAbHom</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1027"></span><span id="dstXStdOrtSiteFromAbHom"><span class="annot"><span class="annottext">dstXStdOrtSiteFromAbHom :: Int -&gt; (AbHom -&gt; String) -&gt; IO ()
</span><a href="OAlg.AbelianGroup.Definition.html#dstXStdOrtSiteFromAbHom"><span class="hs-identifier hs-var hs-var">dstXStdOrtSiteFromAbHom</span></a></span></span><span> </span><span id="local-6989586621679088425"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679088425"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679088426"><span class="annot"><span class="annottext">AbHom -&gt; String
</span><a href="#local-6989586621679088426"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO Omega
</span><span class="hs-identifier hs-var">getOmega</span></span><span> </span><span class="annot"><span class="annottext">IO Omega -&gt; (Omega -&gt; IO ()) -&gt; IO ()
forall a b. IO a -&gt; (a -&gt; IO b) -&gt; IO b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; X String -&gt; Omega -&gt; IO ()
forall x. (Show x, Ord x) =&gt; Int -&gt; X x -&gt; Omega -&gt; IO ()
</span><span class="hs-identifier hs-var">putDistribution</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679088425"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(AbHom -&gt; String) -&gt; X AbHom -&gt; X String
forall a b. (a -&gt; b) -&gt; X a -&gt; X b
forall (h :: * -&gt; * -&gt; *) (f :: * -&gt; *) a b.
Applicative1 h f =&gt;
h a b -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">amap1</span></span><span> </span><span class="annot"><span class="annottext">AbHom -&gt; String
</span><a href="#local-6989586621679088426"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">X AbHom
</span><a href="#local-6989586621679088427"><span class="hs-identifier hs-var">xh</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1028"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">XStart</span></span><span> </span><span id="local-6989586621679088430"><span class="annot"><span class="annottext">X (Point AbHom)
X AbGroup
</span><a href="#local-6989586621679088430"><span class="hs-identifier hs-var">xg</span></a></span></span><span> </span><span id="local-6989586621679088431"><span class="annot"><span class="annottext">Point AbHom -&gt; X AbHom
AbGroup -&gt; X AbHom
</span><a href="#local-6989586621679088431"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XOrtSite 'From AbHom
forall (s :: Site) a. XStandardOrtSite s a =&gt; XOrtSite s a
</span><span class="hs-identifier hs-var">xStandardOrtSite</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">XOrtSite</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">From</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span><span>
</span><span id="line-1029"></span><span>  </span><span id="local-6989586621679088427"><span class="annot"><span class="annottext">xh :: X AbHom
</span><a href="#local-6989586621679088427"><span class="hs-identifier hs-var hs-var">xh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">X AbGroup
</span><a href="#local-6989586621679088430"><span class="hs-identifier hs-var">xg</span></a></span><span> </span><span class="annot"><span class="annottext">X AbGroup -&gt; (AbGroup -&gt; X AbHom) -&gt; X AbHom
forall a b. X a -&gt; (a -&gt; X b) -&gt; X b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">AbGroup -&gt; X AbHom
</span><a href="#local-6989586621679088431"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-1030"></span><span>
</span><span id="line-1031"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">XStandardOrtSiteFrom</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span><span>
</span><span id="line-1032"></span><span>
</span><span id="line-1033"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">XStandardOrtOrientation</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1034"></span><span>  </span><span id="local-6989586621679088444"><span class="annot"><span class="annottext">xStandardOrtOrientation :: XOrtOrientation AbHom
</span><a href="#local-6989586621679088444"><span class="hs-identifier hs-var hs-var hs-var hs-var">xStandardOrtOrientation</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">X (Orientation (Point AbHom))
-&gt; (Orientation (Point AbHom) -&gt; X AbHom) -&gt; XOrtOrientation AbHom
forall q.
X (Orientation (Point q))
-&gt; (Orientation (Point q) -&gt; X q) -&gt; XOrtOrientation q
</span><span class="hs-identifier hs-var">XOrtOrientation</span></span><span> </span><span class="annot"><span class="annottext">X (Orientation (Point AbHom))
X (Orientation AbGroup)
</span><a href="#local-6989586621679088447"><span class="hs-identifier hs-var">xo</span></a></span><span> </span><span class="annot"><span class="annottext">Orientation (Point AbHom) -&gt; X AbHom
Orientation AbGroup -&gt; X AbHom
</span><a href="#local-6989586621679088448"><span class="hs-identifier hs-var">xh</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1035"></span><span>    </span><span id="local-6989586621679088451"><span class="annot"><span class="annottext">q :: Q
</span><a href="#local-6989586621679088451"><span class="hs-identifier hs-var hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Q
</span><span class="hs-number">0.1</span></span><span>
</span><span id="line-1036"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">XStart</span></span><span> </span><span id="local-6989586621679088454"><span class="annot"><span class="annottext">X (Point AbHom)
X AbGroup
</span><a href="#local-6989586621679088454"><span class="hs-identifier hs-var">xg</span></a></span></span><span> </span><span id="local-6989586621679088455"><span class="annot"><span class="annottext">Point AbHom -&gt; X AbHom
AbGroup -&gt; X AbHom
</span><a href="#local-6989586621679088455"><span class="hs-identifier hs-var">xFrom</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XOrtSite 'From AbHom
forall (s :: Site) a. XStandardOrtSite s a =&gt; XOrtSite s a
</span><span class="hs-identifier hs-var">xStandardOrtSite</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">XOrtSite</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">From</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span><span>
</span><span id="line-1037"></span><span>    </span><span>
</span><span id="line-1038"></span><span>    </span><span id="local-6989586621679088447"><span class="annot"><span class="annottext">xo :: X (Orientation AbGroup)
</span><a href="#local-6989586621679088447"><span class="hs-identifier hs-var hs-var">xo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1039"></span><span>      </span><span id="local-6989586621679088463"><span class="annot"><span class="annottext">AbGroup
</span><a href="#local-6989586621679088463"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">X AbGroup
</span><a href="#local-6989586621679088454"><span class="hs-identifier hs-var">xg</span></a></span><span>
</span><span id="line-1040"></span><span>      </span><span id="local-6989586621679088464"><span class="annot"><span class="annottext">AbGroup
</span><a href="#local-6989586621679088464"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(AbHom -&gt; AbGroup) -&gt; X AbHom -&gt; X AbGroup
forall a b. (a -&gt; b) -&gt; X a -&gt; X b
forall (h :: * -&gt; * -&gt; *) (f :: * -&gt; *) a b.
Applicative1 h f =&gt;
h a b -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">amap1</span></span><span> </span><span class="annot"><span class="annottext">AbHom -&gt; Point AbHom
AbHom -&gt; AbGroup
forall q. Oriented q =&gt; q -&gt; Point q
</span><span class="hs-identifier hs-var">end</span></span><span> </span><span class="annot"><span class="annottext">(X AbHom -&gt; X AbGroup) -&gt; X AbHom -&gt; X AbGroup
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">AbGroup -&gt; X AbHom
</span><a href="#local-6989586621679088455"><span class="hs-identifier hs-var">xFrom</span></a></span><span> </span><span class="annot"><span class="annottext">AbGroup
</span><a href="#local-6989586621679088463"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-1041"></span><span>      </span><span class="annot"><span class="annottext">Orientation AbGroup -&gt; X (Orientation AbGroup)
forall a. a -&gt; X a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AbGroup
</span><a href="#local-6989586621679088463"><span class="hs-identifier hs-var">s</span></a></span><span class="annot"><span class="annottext">AbGroup -&gt; AbGroup -&gt; Orientation AbGroup
forall p. p -&gt; p -&gt; Orientation p
</span><span class="hs-operator hs-var">:&gt;</span></span><span class="annot"><span class="annottext">AbGroup
</span><a href="#local-6989586621679088464"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1042"></span><span>      </span><span>
</span><span id="line-1043"></span><span>    </span><span id="local-6989586621679088448"><span class="annot"><span class="annottext">xh :: Orientation AbGroup -&gt; X AbHom
</span><a href="#local-6989586621679088448"><span class="hs-identifier hs-var hs-var">xh</span></a></span></span><span> </span><span id="local-6989586621679088465"><span class="annot"><span class="annottext">Orientation AbGroup
</span><a href="#local-6989586621679088465"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1044"></span><span>      </span><span id="local-6989586621679088466"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679088466"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; X N
</span><span class="hs-identifier hs-var">xNB</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">10</span></span><span>
</span><span id="line-1045"></span><span>      </span><span class="annot"><span class="annottext">Q -&gt; Orientation AbGroup -&gt; X AbHom
</span><a href="OAlg.AbelianGroup.Definition.html#xAbHom"><span class="hs-identifier hs-var">xAbHom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">N -&gt; Q
forall a b. Embeddable a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">inj</span></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679088466"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Q -&gt; Q -&gt; Q
forall c. Multiplicative c =&gt; c -&gt; c -&gt; c
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Q
</span><a href="#local-6989586621679088451"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Orientation AbGroup
</span><a href="#local-6989586621679088465"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-1046"></span><span>      </span><span>
</span><span id="line-1047"></span><span>    </span><span>
</span><span id="line-1048"></span><span>
</span><span id="line-1049"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-1050"></span><span class="hs-comment">-- AbHom - XStandard -</span><span>
</span><span id="line-1051"></span><span>
</span><span id="line-1052"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">XStandard</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1053"></span><span>  </span><span id="local-6989586621679088472"><span class="annot"><span class="annottext">xStandard :: X AbHom
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">xStandard</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XOrtSite 'From AbHom -&gt; X AbHom
forall q (s :: Site). Oriented q =&gt; XOrtSite s q -&gt; XOrt q
</span><span class="hs-identifier hs-var">xosOrt</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XOrtSite 'From AbHom
forall (s :: Site) a. XStandardOrtSite s a =&gt; XOrtSite s a
</span><span class="hs-identifier hs-var">xStandardOrtSite</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">XOrtSite</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">From</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1054"></span><span>
</span><span id="line-1055"></span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#dstXStdAbHom"><span class="hs-identifier hs-type">dstXStdAbHom</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1056"></span><span id="dstXStdAbHom"><span class="annot"><span class="annottext">dstXStdAbHom :: Int -&gt; (AbHom -&gt; String) -&gt; IO ()
</span><a href="OAlg.AbelianGroup.Definition.html#dstXStdAbHom"><span class="hs-identifier hs-var hs-var">dstXStdAbHom</span></a></span></span><span> </span><span id="local-6989586621679088475"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679088475"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679088476"><span class="annot"><span class="annottext">AbHom -&gt; String
</span><a href="#local-6989586621679088476"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO Omega
</span><span class="hs-identifier hs-var">getOmega</span></span><span> </span><span class="annot"><span class="annottext">IO Omega -&gt; (Omega -&gt; IO ()) -&gt; IO ()
forall a b. IO a -&gt; (a -&gt; IO b) -&gt; IO b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; X String -&gt; Omega -&gt; IO ()
forall x. (Show x, Ord x) =&gt; Int -&gt; X x -&gt; Omega -&gt; IO ()
</span><span class="hs-identifier hs-var">putDistribution</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679088475"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(AbHom -&gt; String) -&gt; X AbHom -&gt; X String
forall a b. (a -&gt; b) -&gt; X a -&gt; X b
forall (h :: * -&gt; * -&gt; *) (f :: * -&gt; *) a b.
Applicative1 h f =&gt;
h a b -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">amap1</span></span><span> </span><span class="annot"><span class="annottext">AbHom -&gt; String
</span><a href="#local-6989586621679088476"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">X AbHom
forall x. XStandard x =&gt; X x
</span><span class="hs-identifier hs-var">xStandard</span></span><span class="hs-special">)</span><span>
</span><span id="line-1057"></span><span>
</span><span id="line-1058"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-1059"></span><span class="hs-comment">-- prpAbHom -</span><span>
</span><span id="line-1060"></span><span>
</span><span id="line-1061"></span><span class="annot"><span class="hs-comment">-- | validity of the algebraic structure of 'AbHom'.</span></span><span>
</span><span id="line-1062"></span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#prpAbHom"><span class="hs-identifier hs-type">prpAbHom</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Statement</span></span><span>
</span><span id="line-1063"></span><span id="prpAbHom"><span class="annot"><span class="annottext">prpAbHom :: Statement
</span><a href="OAlg.AbelianGroup.Definition.html#prpAbHom"><span class="hs-identifier hs-var hs-var">prpAbHom</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Label
</span><span class="hs-identifier hs-var">Prp</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;AbHom&quot;</span></span><span> </span><span class="annot"><span class="annottext">Label -&gt; Statement -&gt; Statement
</span><span class="hs-operator hs-var">:&lt;=&gt;:</span></span><span>
</span><span id="line-1064"></span><span>  </span><span class="annot"><span class="annottext">[Statement] -&gt; Statement
</span><span class="hs-identifier hs-var">And</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">X AbHom -&gt; Statement
forall q. Oriented q =&gt; XOrt q -&gt; Statement
</span><span class="hs-identifier hs-var">prpOrt</span></span><span> </span><span class="annot"><span class="annottext">X AbHom
</span><a href="#local-6989586621679088481"><span class="hs-identifier hs-var">xOrt</span></a></span><span>
</span><span id="line-1065"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">XMlt AbHom -&gt; Statement
forall c. Multiplicative c =&gt; XMlt c -&gt; Statement
</span><span class="hs-identifier hs-var">prpMlt</span></span><span> </span><span class="annot"><span class="annottext">XMlt AbHom
</span><a href="#local-6989586621679088483"><span class="hs-identifier hs-var">xMlt</span></a></span><span>
</span><span id="line-1066"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">X AbHom -&gt; Statement
forall f. Fibred f =&gt; XFbr f -&gt; Statement
</span><span class="hs-identifier hs-var">prpFbr</span></span><span> </span><span class="annot"><span class="annottext">X AbHom
</span><a href="#local-6989586621679088485"><span class="hs-identifier hs-var">xFbr</span></a></span><span>
</span><span id="line-1067"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">XAdd AbHom -&gt; Statement
forall a. Additive a =&gt; XAdd a -&gt; Statement
</span><span class="hs-identifier hs-var">prpAdd</span></span><span> </span><span class="annot"><span class="annottext">XAdd AbHom
</span><a href="#local-6989586621679088487"><span class="hs-identifier hs-var">xAdd</span></a></span><span>
</span><span id="line-1068"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">XAbl AbHom -&gt; Statement
forall a. Abelian a =&gt; XAbl a -&gt; Statement
</span><span class="hs-identifier hs-var">prpAbl</span></span><span> </span><span class="annot"><span class="annottext">XAbl AbHom
</span><a href="#local-6989586621679088489"><span class="hs-identifier hs-var">xAbl</span></a></span><span>
</span><span id="line-1069"></span><span>      </span><span class="hs-special">]</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1070"></span><span>
</span><span id="line-1071"></span><span>  </span><span id="local-6989586621679088491"><span class="annot"><span class="annottext">xHomTo :: XOrtSite 'To AbHom
</span><a href="#local-6989586621679088491"><span class="hs-identifier hs-var">xHomTo</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">XEnd</span></span><span> </span><span id="local-6989586621679088493"><span class="annot"><span class="annottext">X (Point AbHom)
X AbGroup
</span><a href="#local-6989586621679088493"><span class="hs-identifier hs-var">xG</span></a></span></span><span> </span><span id="local-6989586621679088494"><span class="annot"><span class="annottext">Point AbHom -&gt; X AbHom
AbGroup -&gt; X AbHom
</span><a href="#local-6989586621679088494"><span class="hs-identifier hs-var">xTo</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XOrtSite 'To AbHom
forall (s :: Site) a. XStandardOrtSite s a =&gt; XOrtSite s a
</span><span class="hs-identifier hs-var">xStandardOrtSite</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">XOrtSite</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">To</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span><span>
</span><span id="line-1072"></span><span>
</span><span id="line-1073"></span><span>  </span><span id="local-6989586621679088481"><span class="annot"><span class="annottext">xOrt :: X AbHom
</span><a href="#local-6989586621679088481"><span class="hs-identifier hs-var hs-var">xOrt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XOrtSite 'To AbHom -&gt; X AbHom
forall q (s :: Site). Oriented q =&gt; XOrtSite s q -&gt; XOrt q
</span><span class="hs-identifier hs-var">xosOrt</span></span><span> </span><span class="annot"><span class="annottext">XOrtSite 'To AbHom
</span><a href="#local-6989586621679088491"><span class="hs-identifier hs-var">xHomTo</span></a></span><span>
</span><span id="line-1074"></span><span>
</span><span id="line-1075"></span><span>  </span><span id="local-6989586621679088483"><span class="annot"><span class="annottext">xMlt :: XMlt AbHom
</span><a href="#local-6989586621679088483"><span class="hs-identifier hs-var hs-var">xMlt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">X N
-&gt; X (Point AbHom)
-&gt; X AbHom
-&gt; X (Endo AbHom)
-&gt; X (Mltp2 AbHom)
-&gt; X (Mltp3 AbHom)
-&gt; XMlt AbHom
forall c.
X N
-&gt; X (Point c)
-&gt; X c
-&gt; X (Endo c)
-&gt; X (Mltp2 c)
-&gt; X (Mltp3 c)
-&gt; XMlt c
</span><span class="hs-identifier hs-var">XMlt</span></span><span> </span><span class="annot"><span class="annottext">X N
</span><a href="#local-6989586621679088497"><span class="hs-identifier hs-var">xn</span></a></span><span> </span><span class="annot"><span class="annottext">X (Point AbHom)
X AbGroup
</span><a href="#local-6989586621679088493"><span class="hs-identifier hs-var">xG</span></a></span><span> </span><span class="annot"><span class="annottext">X AbHom
</span><a href="#local-6989586621679088481"><span class="hs-identifier hs-var">xOrt</span></a></span><span> </span><span class="annot"><span class="annottext">X (Endo AbHom)
</span><a href="#local-6989586621679088498"><span class="hs-identifier hs-var">xe</span></a></span><span> </span><span class="annot"><span class="annottext">X (Mltp2 AbHom)
</span><a href="#local-6989586621679088499"><span class="hs-identifier hs-var">xh2</span></a></span><span> </span><span class="annot"><span class="annottext">X (Mltp3 AbHom)
</span><a href="#local-6989586621679088500"><span class="hs-identifier hs-var">xh3</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1076"></span><span>    </span><span id="local-6989586621679088497"><span class="annot"><span class="annottext">xn :: X N
</span><a href="#local-6989586621679088497"><span class="hs-identifier hs-var hs-var">xn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; X N
</span><span class="hs-identifier hs-var">xNB</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">10</span></span><span>
</span><span id="line-1077"></span><span>    </span><span id="local-6989586621679088498"><span class="annot"><span class="annottext">xe :: X (Endo AbHom)
</span><a href="#local-6989586621679088498"><span class="hs-identifier hs-var hs-var">xe</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1078"></span><span>      </span><span id="local-6989586621679088508"><span class="annot"><span class="annottext">AbGroup
</span><a href="#local-6989586621679088508"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">X AbGroup
</span><a href="#local-6989586621679088493"><span class="hs-identifier hs-var">xG</span></a></span><span>
</span><span id="line-1079"></span><span>      </span><span id="local-6989586621679088509"><span class="annot"><span class="annottext">AbHom
</span><a href="#local-6989586621679088509"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Q -&gt; Orientation AbGroup -&gt; X AbHom
</span><a href="OAlg.AbelianGroup.Definition.html#xAbHom"><span class="hs-identifier hs-var">xAbHom</span></a></span><span> </span><span class="annot"><span class="annottext">Q
</span><span class="hs-number">0.8</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AbGroup
</span><a href="#local-6989586621679088508"><span class="hs-identifier hs-var">g</span></a></span><span class="annot"><span class="annottext">AbGroup -&gt; AbGroup -&gt; Orientation AbGroup
forall p. p -&gt; p -&gt; Orientation p
</span><span class="hs-operator hs-var">:&gt;</span></span><span class="annot"><span class="annottext">AbGroup
</span><a href="#local-6989586621679088508"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1080"></span><span>      </span><span class="annot"><span class="annottext">Endo AbHom -&gt; X (Endo AbHom)
forall a. a -&gt; X a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Endo AbHom -&gt; X (Endo AbHom)) -&gt; Endo AbHom -&gt; X (Endo AbHom)
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">AbHom -&gt; Endo AbHom
forall q. q -&gt; Endo q
</span><span class="hs-identifier hs-var">Endo</span></span><span> </span><span class="annot"><span class="annottext">AbHom
</span><a href="#local-6989586621679088509"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-1081"></span><span>    </span><span id="local-6989586621679088499"><span class="annot"><span class="annottext">xh2 :: X (Mltp2 AbHom)
</span><a href="#local-6989586621679088499"><span class="hs-identifier hs-var hs-var">xh2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XOrtSite 'To AbHom -&gt; X (Mltp2 AbHom)
forall c (d :: Site).
Multiplicative c =&gt;
XOrtSite d c -&gt; X (Mltp2 c)
</span><span class="hs-identifier hs-var">xMltp2</span></span><span> </span><span class="annot"><span class="annottext">XOrtSite 'To AbHom
</span><a href="#local-6989586621679088491"><span class="hs-identifier hs-var">xHomTo</span></a></span><span>
</span><span id="line-1082"></span><span>    </span><span id="local-6989586621679088500"><span class="annot"><span class="annottext">xh3 :: X (Mltp3 AbHom)
</span><a href="#local-6989586621679088500"><span class="hs-identifier hs-var hs-var">xh3</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XOrtSite 'To AbHom -&gt; X (Mltp3 AbHom)
forall c (d :: Site).
Multiplicative c =&gt;
XOrtSite d c -&gt; X (Mltp3 c)
</span><span class="hs-identifier hs-var">xMltp3</span></span><span> </span><span class="annot"><span class="annottext">XOrtSite 'To AbHom
</span><a href="#local-6989586621679088491"><span class="hs-identifier hs-var">xHomTo</span></a></span><span>
</span><span id="line-1083"></span><span>
</span><span id="line-1084"></span><span>  </span><span id="local-6989586621679088485"><span class="annot"><span class="annottext">xFbr :: X AbHom
</span><a href="#local-6989586621679088485"><span class="hs-identifier hs-var hs-var">xFbr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">X AbHom
</span><a href="#local-6989586621679088481"><span class="hs-identifier hs-var">xOrt</span></a></span><span>
</span><span id="line-1085"></span><span>
</span><span id="line-1086"></span><span>  </span><span id="local-6989586621679088520"><span class="annot"><span class="annottext">xRoot :: X (Orientation AbGroup)
</span><a href="#local-6989586621679088520"><span class="hs-identifier hs-var hs-var">xRoot</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1087"></span><span>    </span><span id="local-6989586621679088521"><span class="annot"><span class="annottext">AbGroup
</span><a href="#local-6989586621679088521"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">X AbGroup
</span><a href="#local-6989586621679088493"><span class="hs-identifier hs-var">xG</span></a></span><span>
</span><span id="line-1088"></span><span>    </span><span id="local-6989586621679088522"><span class="annot"><span class="annottext">AbHom
</span><a href="#local-6989586621679088522"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">AbGroup -&gt; X AbHom
</span><a href="#local-6989586621679088494"><span class="hs-identifier hs-var">xTo</span></a></span><span> </span><span class="annot"><span class="annottext">AbGroup
</span><a href="#local-6989586621679088521"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1089"></span><span>    </span><span class="annot"><span class="annottext">Orientation AbGroup -&gt; X (Orientation AbGroup)
forall a. a -&gt; X a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Orientation AbGroup -&gt; X (Orientation AbGroup))
-&gt; Orientation AbGroup -&gt; X (Orientation AbGroup)
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">AbHom -&gt; Orientation (Point AbHom)
forall q. Oriented q =&gt; q -&gt; Orientation (Point q)
</span><span class="hs-identifier hs-var">orientation</span></span><span> </span><span class="annot"><span class="annottext">AbHom
</span><a href="#local-6989586621679088522"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-1090"></span><span>
</span><span id="line-1091"></span><span>  </span><span id="local-6989586621679088524"><span class="annot"><span class="annottext">xStalk :: XStalk AbHom
</span><a href="#local-6989586621679088524"><span class="hs-identifier hs-var hs-var">xStalk</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">X (Root AbHom) -&gt; (Root AbHom -&gt; X AbHom) -&gt; XStalk AbHom
forall x. X (Root x) -&gt; (Root x -&gt; X x) -&gt; XStalk x
</span><span class="hs-identifier hs-var">XStalk</span></span><span> </span><span class="annot"><span class="annottext">X (Orientation AbGroup)
X (Root AbHom)
</span><a href="#local-6989586621679088520"><span class="hs-identifier hs-var">xRoot</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Q -&gt; Orientation AbGroup -&gt; X AbHom
</span><a href="OAlg.AbelianGroup.Definition.html#xAbHom"><span class="hs-identifier hs-var">xAbHom</span></a></span><span> </span><span class="annot"><span class="annottext">Q
</span><span class="hs-number">0.8</span></span><span class="hs-special">)</span><span>
</span><span id="line-1092"></span><span>  </span><span id="local-6989586621679088487"><span class="annot"><span class="annottext">xAdd :: XAdd AbHom
</span><a href="#local-6989586621679088487"><span class="hs-identifier hs-var hs-var">xAdd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XStalk AbHom -&gt; X N -&gt; XAdd AbHom
forall a. Additive a =&gt; XStalk a -&gt; X N -&gt; XAdd a
</span><span class="hs-identifier hs-var">xAddStalk</span></span><span> </span><span class="annot"><span class="annottext">XStalk AbHom
</span><a href="#local-6989586621679088524"><span class="hs-identifier hs-var">xStalk</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">N -&gt; N -&gt; X N
</span><span class="hs-identifier hs-var">xNB</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">1000</span></span><span class="hs-special">)</span><span>
</span><span id="line-1093"></span><span>  </span><span id="local-6989586621679088489"><span class="annot"><span class="annottext">xAbl :: XAbl AbHom
</span><a href="#local-6989586621679088489"><span class="hs-identifier hs-var hs-var">xAbl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">X Z -&gt; X AbHom -&gt; X (Adbl2 AbHom) -&gt; XAbl AbHom
forall a. X Z -&gt; X a -&gt; X (Adbl2 a) -&gt; XAbl a
</span><span class="hs-identifier hs-var">XAbl</span></span><span> </span><span class="annot"><span class="annottext">X Z
forall x. XStandard x =&gt; X x
</span><span class="hs-identifier hs-var">xStandard</span></span><span> </span><span class="annot"><span class="annottext">X AbHom
</span><a href="#local-6989586621679088485"><span class="hs-identifier hs-var">xFbr</span></a></span><span> </span><span class="annot"><span class="annottext">X (Adbl2 AbHom)
</span><a href="#local-6989586621679088533"><span class="hs-identifier hs-var">xa2</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1094"></span><span>    </span><span id="local-6989586621679088533"><span class="annot"><span class="annottext">xa2 :: X (Adbl2 AbHom)
</span><a href="#local-6989586621679088533"><span class="hs-identifier hs-var hs-var">xa2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">X (Orientation AbGroup)
</span><a href="#local-6989586621679088520"><span class="hs-identifier hs-var">xRoot</span></a></span><span> </span><span class="annot"><span class="annottext">X (Orientation AbGroup)
-&gt; (Orientation AbGroup -&gt; X (Adbl2 AbHom)) -&gt; X (Adbl2 AbHom)
forall a b. X a -&gt; (a -&gt; X b) -&gt; X b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">XStalk AbHom -&gt; Root AbHom -&gt; X (Adbl2 AbHom)
forall a. Additive a =&gt; XStalk a -&gt; Root a -&gt; X (Adbl2 a)
</span><span class="hs-identifier hs-var">xStalkAdbl2</span></span><span> </span><span class="annot"><span class="annottext">XStalk AbHom
</span><a href="#local-6989586621679088524"><span class="hs-identifier hs-var">xStalk</span></a></span><span>
</span><span id="line-1095"></span><span>
</span><span id="line-1096"></span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#xMltAbh"><span class="hs-identifier hs-type">xMltAbh</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">XMlt</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span><span>
</span><span id="line-1097"></span><span id="xMltAbh"><span class="annot"><span class="annottext">xMltAbh :: XMlt AbHom
</span><a href="OAlg.AbelianGroup.Definition.html#xMltAbh"><span class="hs-identifier hs-var hs-var">xMltAbh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">X N -&gt; XOrtOrientation AbHom -&gt; XMlt AbHom
forall c. Multiplicative c =&gt; X N -&gt; XOrtOrientation c -&gt; XMlt c
</span><span class="hs-identifier hs-var">xoMlt</span></span><span> </span><span class="annot"><span class="annottext">X N
</span><span class="hs-identifier hs-var">xN</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XOrtOrientation AbHom
forall q. XStandardOrtOrientation q =&gt; XOrtOrientation q
</span><span class="hs-identifier hs-var">xStandardOrtOrientation</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">XOrtOrientation</span></span><span> </span><span class="annot"><a href="OAlg.AbelianGroup.Definition.html#AbHom"><span class="hs-identifier hs-type">AbHom</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1098"></span><span>
</span><span id="line-1099"></span></pre></body></html>