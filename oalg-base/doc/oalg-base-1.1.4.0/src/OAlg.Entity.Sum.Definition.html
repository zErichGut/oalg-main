<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE NoImplicitPrelude #-}</span><span>
</span><span id="line-3"></span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE StandaloneDeriving #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE GeneralizedNewtypeDeriving #-}</span><span>
</span><span id="line-9"></span><span>
</span><span id="line-10"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- Module      : OAlg.Entity.Sum.Definition</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- Description : definition of free sums over fibred symbols.</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- Copyright   : (c) Erich Gut</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- License     : BSD3</span><span>
</span><span id="line-15"></span><span class="hs-comment">-- Maintainer  : zerich.gut@gmail.com</span><span>
</span><span id="line-16"></span><span class="hs-comment">--</span><span>
</span><span id="line-17"></span><span class="hs-comment">-- definition of free 'Sum's over 'Fibred' symbols.</span><span>
</span><span id="line-18"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">OAlg.Entity.Sum.Definition</span><span>
</span><span id="line-19"></span><span>  </span><span class="hs-special">(</span><span>
</span><span id="line-20"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Sum</span></span><span>
</span><span id="line-21"></span><span>    </span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#Sum"><span class="hs-identifier">Sum</span></a></span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#smlc"><span class="hs-identifier">smlc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#smJoin"><span class="hs-identifier">smJoin</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#nSum"><span class="hs-identifier">nSum</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#zSum"><span class="hs-identifier">zSum</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#smMap"><span class="hs-identifier">smMap</span></a></span><span>
</span><span id="line-22"></span><span>
</span><span id="line-23"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Form</span></span><span>
</span><span id="line-24"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#SumForm"><span class="hs-identifier">SumForm</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#smfLength"><span class="hs-identifier">smfLength</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#smflc"><span class="hs-identifier">smflc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#lcsmf"><span class="hs-identifier">lcsmf</span></a></span><span>
</span><span id="line-25"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#smfMap"><span class="hs-identifier">smfMap</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#smfJoin"><span class="hs-identifier">smfJoin</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#smfReduce"><span class="hs-identifier">smfReduce</span></a></span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Linear Combination</span></span><span>
</span><span id="line-28"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#LinearCombination"><span class="hs-identifier">LinearCombination</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#lcs"><span class="hs-identifier">lcs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#lcAggr"><span class="hs-identifier">lcAggr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#lcSort"><span class="hs-identifier">lcSort</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#lcSclFilter"><span class="hs-identifier">lcSclFilter</span></a></span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-31"></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">map</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">groupBy</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-operator">(++)</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">filter</span></span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Foldable</span></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Monoid</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Sum</span></span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="OAlg.Prelude.html"><span class="hs-identifier">OAlg.Prelude</span></a></span><span>
</span><span id="line-37"></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="OAlg.Data.Canonical.html"><span class="hs-identifier">OAlg.Data.Canonical</span></a></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="OAlg.Data.Reducible.html"><span class="hs-identifier">OAlg.Data.Reducible</span></a></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="OAlg.Data.Constructable.html"><span class="hs-identifier">OAlg.Data.Constructable</span></a></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="OAlg.Data.Singleton.html"><span class="hs-identifier">OAlg.Data.Singleton</span></a></span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="OAlg.Structure.Exception.html"><span class="hs-identifier">OAlg.Structure.Exception</span></a></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="OAlg.Structure.Fibred.Definition.html"><span class="hs-identifier">OAlg.Structure.Fibred.Definition</span></a></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="OAlg.Structure.Additive.Definition.html"><span class="hs-identifier">OAlg.Structure.Additive.Definition</span></a></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="OAlg.Structure.Multiplicative.Definition.html"><span class="hs-identifier">OAlg.Structure.Multiplicative.Definition</span></a></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="OAlg.Structure.Ring.Definition.html"><span class="hs-identifier">OAlg.Structure.Ring.Definition</span></a></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="OAlg.Structure.Number.html"><span class="hs-identifier">OAlg.Structure.Number</span></a></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="OAlg.Structure.Vectorial.html"><span class="hs-identifier">OAlg.Structure.Vectorial</span></a></span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="OAlg.Hom.Definition.html"><span class="hs-identifier">OAlg.Hom.Definition</span></a></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="OAlg.Hom.Fibred.html"><span class="hs-identifier">OAlg.Hom.Fibred</span></a></span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-55"></span><span class="hs-comment">-- SumForm -</span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span class="hs-keyword">infixr</span><span> </span><span class="hs-number">6</span><span> </span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#%3A%2B"><span class="hs-operator hs-type">:+</span></a></span><span>
</span><span id="line-58"></span><span class="hs-keyword">infixr</span><span> </span><span class="hs-number">9</span><span> </span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#%3A%21"><span class="hs-operator hs-type">:!</span></a></span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span class="hs-comment">-- | form for a free sum over 'Fibred' symbols in @__a__@ with scalars in @__r__@.</span><span>
</span><span id="line-61"></span><span class="hs-comment">--</span><span>
</span><span id="line-62"></span><span class="hs-comment">-- __Definition__ Let @__r__@ be a 'Commutative' 'Semiring' and @__a__@ a 'Fibred' structure.</span><span>
</span><span id="line-63"></span><span class="hs-comment">-- A 'SumForm' @a@ is 'valid' if and only if all scalars in @a@ are 'valid' and all symbols in @__a__@</span><span>
</span><span id="line-64"></span><span class="hs-comment">-- are 'valid' and have the same @'root'@.</span><span>
</span><span id="line-65"></span><span class="hs-keyword">data</span><span> </span><span id="SumForm"><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#SumForm"><span class="hs-identifier hs-var">SumForm</span></a></span></span><span> </span><span id="local-6989586621679392027"><span class="annot"><a href="#local-6989586621679392027"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span id="local-6989586621679392028"><span class="annot"><a href="#local-6989586621679392028"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-66"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="Zero"><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#Zero"><span class="hs-identifier hs-var">Zero</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Structure.Fibred.Definition.html#Root"><span class="hs-identifier hs-type">Root</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392028"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="S"><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#S"><span class="hs-identifier hs-var">S</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621679392028"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-68"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="#local-6989586621679392027"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span id="%3A%21"><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#%3A%21"><span class="hs-operator hs-var">:!</span></a></span></span><span> </span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#SumForm"><span class="hs-identifier hs-type">SumForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392027"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392028"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-69"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#SumForm"><span class="hs-identifier hs-type">SumForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392027"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392028"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span id="%3A%2B"><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#%3A%2B"><span class="hs-operator hs-var">:+</span></a></span></span><span> </span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#SumForm"><span class="hs-identifier hs-type">SumForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392027"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392028"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span id="local-6989586621679391952"><span id="local-6989586621679391953"><span id="local-6989586621679392296"><span id="local-6989586621679392313"><span id="local-6989586621679392316"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Structure.Fibred.Definition.html#Fibred"><span class="hs-identifier hs-type">Fibred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679391952"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Definition.html#Entity"><span class="hs-identifier hs-type">Entity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679391953"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#SumForm"><span class="hs-identifier hs-type">SumForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679391953"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679391952"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-72"></span><span id="local-6989586621679391957"><span id="local-6989586621679391958"><span id="local-6989586621679392327"><span id="local-6989586621679392339"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Structure.Fibred.Definition.html#Fibred"><span class="hs-identifier hs-type">Fibred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679391957"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Definition.html#Entity"><span class="hs-identifier hs-type">Entity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679391958"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#SumForm"><span class="hs-identifier hs-type">SumForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679391958"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679391957"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-73"></span><span id="local-6989586621679391964"><span id="local-6989586621679391965"><span id="local-6989586621679392353"><span id="local-6989586621679392363"><span id="local-6989586621679392366"><span id="local-6989586621679392369"><span id="local-6989586621679392372"><span id="local-6989586621679392375"><span id="local-6989586621679392378"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="OAlg.Structure.Fibred.Definition.html#Fibred"><span class="hs-identifier hs-type">Fibred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679391964"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Definition.html#Entity"><span class="hs-identifier hs-type">Entity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679391965"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-74"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Fibred.Definition.html#OrdRoot"><span class="hs-identifier hs-type">OrdRoot</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679391964"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679391965"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679391964"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-75"></span><span>                  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#SumForm"><span class="hs-identifier hs-type">SumForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679391965"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679391964"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-78"></span><span class="hs-comment">-- SumForm - Entity -</span><span>
</span><span id="line-79"></span><span>
</span><span id="line-80"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679391973"><span id="local-6989586621679391974"><span class="hs-special">(</span><span class="annot"><a href="OAlg.Structure.Fibred.Definition.html#Fibred"><span class="hs-identifier hs-type">Fibred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679391973"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Ring.Definition.html#Semiring"><span class="hs-identifier hs-type">Semiring</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679391974"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Multiplicative.Definition.html#Commutative"><span class="hs-identifier hs-type">Commutative</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679391974"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.Validable.html#Validable"><span class="hs-identifier hs-type">Validable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#SumForm"><span class="hs-identifier hs-type">SumForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679391974"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679391973"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-81"></span><span>  </span><span id="local-6989586621679392406"><span class="annot"><span class="annottext">valid :: SumForm r a -&gt; Statement
</span><a href="OAlg.Data.Validable.html#valid"><span class="hs-identifier hs-var hs-var hs-var hs-var">valid</span></a></span></span><span> </span><span id="local-6989586621679392407"><span class="annot"><span class="annottext">SumForm r a
</span><a href="#local-6989586621679392407"><span class="hs-identifier hs-var">sf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Statement] -&gt; Statement
</span><a href="OAlg.Data.Statement.Definition.html#And"><span class="hs-identifier hs-var">And</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String -&gt; Label
</span><a href="OAlg.Data.Statement.Definition.html#Label"><span class="hs-identifier hs-var">Label</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;root&quot;</span></span><span> </span><span class="annot"><span class="annottext">Label -&gt; Statement -&gt; Statement
</span><a href="OAlg.Data.Statement.Definition.html#%3A%3C%3D%3E%3A"><span class="hs-operator hs-var">:&lt;=&gt;:</span></a></span><span> </span><span class="annot"><span class="annottext">Root a -&gt; Statement
forall a. Validable a =&gt; a -&gt; Statement
</span><a href="OAlg.Data.Validable.html#valid"><span class="hs-identifier hs-var">valid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SumForm r a -&gt; Root (SumForm r a)
forall f. Fibred f =&gt; f -&gt; Root f
</span><a href="OAlg.Structure.Fibred.Definition.html#root"><span class="hs-identifier hs-var">root</span></a></span><span> </span><span class="annot"><span class="annottext">SumForm r a
</span><a href="#local-6989586621679392407"><span class="hs-identifier hs-var">sf</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span>                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Label
</span><a href="OAlg.Data.Statement.Definition.html#Label"><span class="hs-identifier hs-var">Label</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;symbols&quot;</span></span><span> </span><span class="annot"><span class="annottext">Label -&gt; Statement -&gt; Statement
</span><a href="OAlg.Data.Statement.Definition.html#%3A%3C%3D%3E%3A"><span class="hs-operator hs-var">:&lt;=&gt;:</span></a></span><span> </span><span class="annot"><span class="annottext">SumForm r a -&gt; Statement
forall {a} {a}.
(Validable a, Validable a, Validable (Root a)) =&gt;
SumForm a a -&gt; Statement
</span><a href="#local-6989586621679392411"><span class="hs-identifier hs-var">vld</span></a></span><span> </span><span class="annot"><span class="annottext">SumForm r a
</span><a href="#local-6989586621679392407"><span class="hs-identifier hs-var">sf</span></a></span><span>
</span><span id="line-83"></span><span>                 </span><span class="hs-special">]</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-84"></span><span>    </span><span>
</span><span id="line-85"></span><span>    </span><span id="local-6989586621679392411"><span class="annot"><span class="annottext">vld :: SumForm a a -&gt; Statement
</span><a href="#local-6989586621679392411"><span class="hs-identifier hs-var hs-var">vld</span></a></span></span><span> </span><span id="local-6989586621679392421"><span class="annot"><span class="annottext">SumForm a a
</span><a href="#local-6989586621679392421"><span class="hs-identifier hs-var">sf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SumForm a a
</span><a href="#local-6989586621679392421"><span class="hs-identifier hs-var">sf</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-86"></span><span>      </span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#Zero"><span class="hs-identifier hs-type">Zero</span></a></span><span> </span><span id="local-6989586621679392422"><span class="annot"><span class="annottext">Root a
</span><a href="#local-6989586621679392422"><span class="hs-identifier hs-var">e</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Root a -&gt; Statement
forall a. Validable a =&gt; a -&gt; Statement
</span><a href="OAlg.Data.Validable.html#valid"><span class="hs-identifier hs-var">valid</span></a></span><span> </span><span class="annot"><span class="annottext">Root a
</span><a href="#local-6989586621679392422"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-87"></span><span>      </span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#S"><span class="hs-identifier hs-type">S</span></a></span><span> </span><span id="local-6989586621679392423"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679392423"><span class="hs-identifier hs-var">a</span></a></span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; Statement
forall a. Validable a =&gt; a -&gt; Statement
</span><a href="OAlg.Data.Validable.html#valid"><span class="hs-identifier hs-var">valid</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679392423"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-88"></span><span>      </span><span id="local-6989586621679392424"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679392424"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#%3A%21"><span class="hs-operator hs-type">:!</span></a></span><span> </span><span id="local-6989586621679392425"><span class="annot"><span class="annottext">SumForm a a
</span><a href="#local-6989586621679392425"><span class="hs-identifier hs-var">a</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; Statement
forall a. Validable a =&gt; a -&gt; Statement
</span><a href="OAlg.Data.Validable.html#valid"><span class="hs-identifier hs-var">valid</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679392424"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Statement -&gt; Statement -&gt; Statement
forall b. Boolean b =&gt; b -&gt; b -&gt; b
</span><a href="OAlg.Data.Boolean.Definition.html#%26%26"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">SumForm a a -&gt; Statement
</span><a href="#local-6989586621679392411"><span class="hs-identifier hs-var">vld</span></a></span><span> </span><span class="annot"><span class="annottext">SumForm a a
</span><a href="#local-6989586621679392425"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-89"></span><span>      </span><span id="local-6989586621679392427"><span class="annot"><span class="annottext">SumForm a a
</span><a href="#local-6989586621679392427"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#%3A%2B"><span class="hs-operator hs-type">:+</span></a></span><span> </span><span id="local-6989586621679392428"><span class="annot"><span class="annottext">SumForm a a
</span><a href="#local-6989586621679392428"><span class="hs-identifier hs-var">b</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SumForm a a -&gt; Statement
</span><a href="#local-6989586621679392411"><span class="hs-identifier hs-var">vld</span></a></span><span> </span><span class="annot"><span class="annottext">SumForm a a
</span><a href="#local-6989586621679392427"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Statement -&gt; Statement -&gt; Statement
forall b. Boolean b =&gt; b -&gt; b -&gt; b
</span><a href="OAlg.Data.Boolean.Definition.html#%26%26"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">SumForm a a -&gt; Statement
</span><a href="#local-6989586621679392411"><span class="hs-identifier hs-var">vld</span></a></span><span> </span><span class="annot"><span class="annottext">SumForm a a
</span><a href="#local-6989586621679392428"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-90"></span><span>      </span><span>
</span><span id="line-91"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679391990"><span id="local-6989586621679391991"><span class="hs-special">(</span><span class="annot"><a href="OAlg.Structure.Fibred.Definition.html#Fibred"><span class="hs-identifier hs-type">Fibred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679391990"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Ring.Definition.html#Semiring"><span class="hs-identifier hs-type">Semiring</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679391991"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Multiplicative.Definition.html#Commutative"><span class="hs-identifier hs-type">Commutative</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679391991"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Definition.html#Entity"><span class="hs-identifier hs-type">Entity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#SumForm"><span class="hs-identifier hs-type">SumForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679391991"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679391990"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-94"></span><span class="hs-comment">-- SumForm - Fibred -</span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679391981"><span id="local-6989586621679391982"><span class="hs-special">(</span><span class="annot"><a href="OAlg.Structure.Fibred.Definition.html#Fibred"><span class="hs-identifier hs-type">Fibred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679391981"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Ring.Definition.html#Semiring"><span class="hs-identifier hs-type">Semiring</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679391982"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Multiplicative.Definition.html#Commutative"><span class="hs-identifier hs-type">Commutative</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679391982"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Structure.Fibred.Definition.html#Fibred"><span class="hs-identifier hs-type">Fibred</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#SumForm"><span class="hs-identifier hs-type">SumForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679391982"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679391981"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-97"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Root"><span class="annot"><a href="OAlg.Structure.Fibred.Definition.html#Root"><span class="hs-identifier hs-var">Root</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#SumForm"><span class="hs-identifier hs-type">SumForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679391982"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679391981"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="OAlg.Structure.Fibred.Definition.html#Root"><span class="hs-identifier hs-type">Root</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679391981"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-98"></span><span>  </span><span id="local-6989586621679392470"><span class="annot"><span class="annottext">root :: SumForm r a -&gt; Root (SumForm r a)
</span><a href="OAlg.Structure.Fibred.Definition.html#root"><span class="hs-identifier hs-var hs-var hs-var hs-var">root</span></a></span></span><span> </span><span id="local-6989586621679392471"><span class="annot"><span class="annottext">SumForm r a
</span><a href="#local-6989586621679392471"><span class="hs-identifier hs-var">sf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SumForm r a
</span><a href="#local-6989586621679392471"><span class="hs-identifier hs-var">sf</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-99"></span><span>    </span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#Zero"><span class="hs-identifier hs-type">Zero</span></a></span><span> </span><span id="local-6989586621679392472"><span class="annot"><span class="annottext">Root a
</span><a href="#local-6989586621679392472"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Root a
Root (SumForm r a)
</span><a href="#local-6989586621679392472"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-100"></span><span>    </span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#S"><span class="hs-identifier hs-type">S</span></a></span><span> </span><span id="local-6989586621679392473"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679392473"><span class="hs-identifier hs-var">a</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; Root a
forall f. Fibred f =&gt; f -&gt; Root f
</span><a href="OAlg.Structure.Fibred.Definition.html#root"><span class="hs-identifier hs-var">root</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679392473"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-101"></span><span>    </span><span class="annot"><span class="annottext">r
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#%3A%21"><span class="hs-operator hs-type">:!</span></a></span><span> </span><span id="local-6989586621679392474"><span class="annot"><span class="annottext">SumForm r a
</span><a href="#local-6989586621679392474"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SumForm r a -&gt; Root (SumForm r a)
forall f. Fibred f =&gt; f -&gt; Root f
</span><a href="OAlg.Structure.Fibred.Definition.html#root"><span class="hs-identifier hs-var">root</span></a></span><span> </span><span class="annot"><span class="annottext">SumForm r a
</span><a href="#local-6989586621679392474"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-102"></span><span>    </span><span id="local-6989586621679392475"><span class="annot"><span class="annottext">SumForm r a
</span><a href="#local-6989586621679392475"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#%3A%2B"><span class="hs-operator hs-type">:+</span></a></span><span> </span><span id="local-6989586621679392476"><span class="annot"><span class="annottext">SumForm r a
</span><a href="#local-6989586621679392476"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679392477"><span class="annot"><span class="annottext">r :: Root (SumForm r a)
</span><a href="#local-6989586621679392477"><span class="hs-identifier hs-var hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SumForm r a -&gt; Root (SumForm r a)
forall f. Fibred f =&gt; f -&gt; Root f
</span><a href="OAlg.Structure.Fibred.Definition.html#root"><span class="hs-identifier hs-var">root</span></a></span><span> </span><span class="annot"><span class="annottext">SumForm r a
</span><a href="#local-6989586621679392475"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Root a
Root (SumForm r a)
</span><a href="#local-6989586621679392477"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Root a -&gt; Root a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">SumForm r a -&gt; Root (SumForm r a)
forall f. Fibred f =&gt; f -&gt; Root f
</span><a href="OAlg.Structure.Fibred.Definition.html#root"><span class="hs-identifier hs-var">root</span></a></span><span> </span><span class="annot"><span class="annottext">SumForm r a
</span><a href="#local-6989586621679392476"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Root (SumForm r a)
</span><a href="#local-6989586621679392477"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">ArithmeticException -&gt; Root a
forall a e. Exception e =&gt; e -&gt; a
</span><span class="hs-identifier hs-var">throw</span></span><span> </span><span class="annot"><span class="annottext">ArithmeticException
</span><a href="OAlg.Structure.Exception.html#NotAddable"><span class="hs-identifier hs-var">NotAddable</span></a></span><span>
</span><span id="line-103"></span><span>    </span><span>
</span><span id="line-104"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-105"></span><span class="hs-comment">-- SumFrom - Foldable -</span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679392481"><span id="local-6989586621679392488"><span id="local-6989586621679392493"><span id="local-6989586621679392496"><span id="local-6989586621679392499"><span id="local-6989586621679392502"><span id="local-6989586621679392505"><span id="local-6989586621679392508"><span id="local-6989586621679392511"><span id="local-6989586621679392514"><span id="local-6989586621679392517"><span id="local-6989586621679392520"><span id="local-6989586621679392525"><span id="local-6989586621679392530"><span id="local-6989586621679392535"><span id="local-6989586621679392540"><span class="annot"><span class="hs-identifier hs-type">Foldable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#SumForm"><span class="hs-identifier hs-type">SumForm</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-108"></span><span>  </span><span id="local-6989586621679392566"><span class="annot"><span class="annottext">foldMap :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; SumForm N a -&gt; m
</span><a href="#local-6989586621679392566"><span class="hs-identifier hs-var hs-var hs-var hs-var">foldMap</span></a></span></span><span> </span><span class="annot"><span class="annottext">a -&gt; m
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#Zero"><span class="hs-identifier hs-type">Zero</span></a></span><span> </span><span class="annot"><span class="annottext">Root a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-109"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span id="local-6989586621679392568"><span class="annot"><span class="annottext">a -&gt; m
</span><a href="#local-6989586621679392568"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#S"><span class="hs-identifier hs-type">S</span></a></span><span> </span><span id="local-6989586621679392569"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679392569"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; m
</span><a href="#local-6989586621679392568"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679392569"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-110"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; m
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#%3A%21"><span class="hs-operator hs-type">:!</span></a></span><span> </span><span class="annot"><span class="annottext">SumForm N a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-111"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span id="local-6989586621679392570"><span class="annot"><span class="annottext">a -&gt; m
</span><a href="#local-6989586621679392570"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679392571"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679392571"><span class="hs-identifier hs-var">n</span></a></span></span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#%3A%21"><span class="hs-operator hs-type">:!</span></a></span><span id="local-6989586621679392572"><span class="annot"><span class="annottext">SumForm N a
</span><a href="#local-6989586621679392572"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; m) -&gt; SumForm N a -&gt; m
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; SumForm N a -&gt; m
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; m
</span><a href="#local-6989586621679392570"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">SumForm N a
</span><a href="#local-6989586621679392572"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">m -&gt; m -&gt; m
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; m) -&gt; SumForm N a -&gt; m
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; SumForm N a -&gt; m
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; m
</span><a href="#local-6989586621679392570"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">N -&gt; N
forall a. Enum a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">pred</span></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679392571"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">N -&gt; SumForm N a -&gt; SumForm N a
forall r a. r -&gt; SumForm r a -&gt; SumForm r a
</span><a href="OAlg.Entity.Sum.Definition.html#%3A%21"><span class="hs-operator hs-var">:!</span></a></span><span> </span><span class="annot"><span class="annottext">SumForm N a
</span><a href="#local-6989586621679392572"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-112"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span id="local-6989586621679392574"><span class="annot"><span class="annottext">a -&gt; m
</span><a href="#local-6989586621679392574"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679392575"><span class="annot"><span class="annottext">SumForm N a
</span><a href="#local-6989586621679392575"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#%3A%2B"><span class="hs-operator hs-type">:+</span></a></span><span> </span><span id="local-6989586621679392576"><span class="annot"><span class="annottext">SumForm N a
</span><a href="#local-6989586621679392576"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; m) -&gt; SumForm N a -&gt; m
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; SumForm N a -&gt; m
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; m
</span><a href="#local-6989586621679392574"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">SumForm N a
</span><a href="#local-6989586621679392575"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">m -&gt; m -&gt; m
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; m) -&gt; SumForm N a -&gt; m
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; SumForm N a -&gt; m
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; m
</span><a href="#local-6989586621679392574"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">SumForm N a
</span><a href="#local-6989586621679392576"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-113"></span><span>
</span><span id="line-114"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-115"></span><span class="hs-comment">-- smfSum -</span><span>
</span><span id="line-116"></span><span>
</span><span id="line-117"></span><span id="local-6989586621679392029"><span id="local-6989586621679392030"><span id="local-6989586621679392031"><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#smfSum"><span class="hs-identifier hs-type">smfSum</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Structure.Fibred.Definition.html#Root"><span class="hs-identifier hs-type">Root</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392029"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679392030"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679392031"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679392030"><span class="hs-identifier hs-type">y</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679392030"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679392030"><span class="hs-identifier hs-type">y</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679392030"><span class="hs-identifier hs-type">y</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679392030"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679392029"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679392030"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#SumForm"><span class="hs-identifier hs-type">SumForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392031"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392029"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679392030"><span class="hs-identifier hs-type">y</span></a></span></span></span></span><span>
</span><span id="line-118"></span><span id="smfSum"><span class="annot"><span class="annottext">smfSum :: forall x y r.
(Root x -&gt; y)
-&gt; (r -&gt; y -&gt; y) -&gt; (y -&gt; y -&gt; y) -&gt; (x -&gt; y) -&gt; SumForm r x -&gt; y
</span><a href="OAlg.Entity.Sum.Definition.html#smfSum"><span class="hs-identifier hs-var hs-var">smfSum</span></a></span></span><span> </span><span id="local-6989586621679392578"><span class="annot"><span class="annottext">Root x -&gt; y
</span><a href="#local-6989586621679392578"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span id="local-6989586621679392579"><span class="annot"><span class="annottext">r -&gt; y -&gt; y
</span><a href="#local-6989586621679392579"><span class="hs-operator hs-var">(!)</span></a></span></span><span> </span><span id="local-6989586621679392580"><span class="annot"><span class="annottext">y -&gt; y -&gt; y
</span><a href="#local-6989586621679392580"><span class="hs-operator hs-var">(+)</span></a></span></span><span> </span><span id="local-6989586621679392581"><span class="annot"><span class="annottext">x -&gt; y
</span><a href="#local-6989586621679392581"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679392582"><span class="annot"><span class="annottext">SumForm r x
</span><a href="#local-6989586621679392582"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SumForm r x -&gt; y
</span><a href="#local-6989586621679392583"><span class="hs-identifier hs-var">sm</span></a></span><span> </span><span class="annot"><span class="annottext">SumForm r x
</span><a href="#local-6989586621679392582"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-119"></span><span>  </span><span id="local-6989586621679392583"><span class="annot"><span class="annottext">sm :: SumForm r x -&gt; y
</span><a href="#local-6989586621679392583"><span class="hs-identifier hs-var hs-var">sm</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#Zero"><span class="hs-identifier hs-type">Zero</span></a></span><span> </span><span id="local-6989586621679392584"><span class="annot"><span class="annottext">Root x
</span><a href="#local-6989586621679392584"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Root x -&gt; y
</span><a href="#local-6989586621679392578"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">Root x
</span><a href="#local-6989586621679392584"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-120"></span><span>  </span><span class="annot"><a href="#local-6989586621679392583"><span class="hs-identifier hs-var">sm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#S"><span class="hs-identifier hs-type">S</span></a></span><span> </span><span id="local-6989586621679392585"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679392585"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">x -&gt; y
</span><a href="#local-6989586621679392581"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679392585"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-121"></span><span>  </span><span class="annot"><a href="#local-6989586621679392583"><span class="hs-identifier hs-var">sm</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679392586"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679392586"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#%3A%21"><span class="hs-operator hs-type">:!</span></a></span><span> </span><span id="local-6989586621679392587"><span class="annot"><span class="annottext">SumForm r x
</span><a href="#local-6989586621679392587"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679392586"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; y -&gt; y
</span><a href="#local-6989586621679392579"><span class="hs-operator hs-var">!</span></a></span><span> </span><span class="annot"><span class="annottext">SumForm r x -&gt; y
</span><a href="#local-6989586621679392583"><span class="hs-identifier hs-var">sm</span></a></span><span> </span><span class="annot"><span class="annottext">SumForm r x
</span><a href="#local-6989586621679392587"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-122"></span><span>  </span><span class="annot"><a href="#local-6989586621679392583"><span class="hs-identifier hs-var">sm</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679392588"><span class="annot"><span class="annottext">SumForm r x
</span><a href="#local-6989586621679392588"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#%3A%2B"><span class="hs-operator hs-type">:+</span></a></span><span> </span><span id="local-6989586621679392589"><span class="annot"><span class="annottext">SumForm r x
</span><a href="#local-6989586621679392589"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SumForm r x -&gt; y
</span><a href="#local-6989586621679392583"><span class="hs-identifier hs-var">sm</span></a></span><span> </span><span class="annot"><span class="annottext">SumForm r x
</span><a href="#local-6989586621679392588"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">y -&gt; y -&gt; y
</span><a href="#local-6989586621679392580"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">SumForm r x -&gt; y
</span><a href="#local-6989586621679392583"><span class="hs-identifier hs-var">sm</span></a></span><span> </span><span class="annot"><span class="annottext">SumForm r x
</span><a href="#local-6989586621679392589"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-123"></span><span>
</span><span id="line-124"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-125"></span><span class="hs-comment">-- smfJoin -</span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span class="annot"><span class="hs-comment">-- | joining a sum form of sum forms.</span></span><span>
</span><span id="line-128"></span><span id="local-6989586621679392035"><span id="local-6989586621679392036"><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#smfJoin"><span class="hs-identifier hs-type">smfJoin</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#SumForm"><span class="hs-identifier hs-type">SumForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392035"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#SumForm"><span class="hs-identifier hs-type">SumForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392035"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392036"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#SumForm"><span class="hs-identifier hs-type">SumForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392035"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392036"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-129"></span><span id="smfJoin"><span class="annot"><span class="annottext">smfJoin :: forall r a. SumForm r (SumForm r a) -&gt; SumForm r a
</span><a href="OAlg.Entity.Sum.Definition.html#smfJoin"><span class="hs-identifier hs-var hs-var">smfJoin</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Root (SumForm r a) -&gt; SumForm r a)
-&gt; (r -&gt; SumForm r a -&gt; SumForm r a)
-&gt; (SumForm r a -&gt; SumForm r a -&gt; SumForm r a)
-&gt; (SumForm r a -&gt; SumForm r a)
-&gt; SumForm r (SumForm r a)
-&gt; SumForm r a
forall x y r.
(Root x -&gt; y)
-&gt; (r -&gt; y -&gt; y) -&gt; (y -&gt; y -&gt; y) -&gt; (x -&gt; y) -&gt; SumForm r x -&gt; y
</span><a href="OAlg.Entity.Sum.Definition.html#smfSum"><span class="hs-identifier hs-var">smfSum</span></a></span><span> </span><span class="annot"><span class="annottext">Root a -&gt; SumForm r a
Root (SumForm r a) -&gt; SumForm r a
forall r a. Root a -&gt; SumForm r a
</span><a href="OAlg.Entity.Sum.Definition.html#Zero"><span class="hs-identifier hs-var">Zero</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; SumForm r a -&gt; SumForm r a
forall r a. r -&gt; SumForm r a -&gt; SumForm r a
</span><a href="OAlg.Entity.Sum.Definition.html#%3A%21"><span class="hs-operator hs-var">(:!)</span></a></span><span> </span><span class="annot"><span class="annottext">SumForm r a -&gt; SumForm r a -&gt; SumForm r a
forall r a. SumForm r a -&gt; SumForm r a -&gt; SumForm r a
</span><a href="OAlg.Entity.Sum.Definition.html#%3A%2B"><span class="hs-operator hs-var">(:+)</span></a></span><span> </span><span class="annot"><span class="annottext">SumForm r a -&gt; SumForm r a
forall x. x -&gt; x
</span><a href="OAlg.Category.Definition.html#id"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-130"></span><span>
</span><span id="line-131"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-132"></span><span class="hs-comment">-- smfMap -</span><span>
</span><span id="line-133"></span><span>
</span><span id="line-134"></span><span class="annot"><span class="hs-comment">-- | mapping of sum forms.</span></span><span>
</span><span id="line-135"></span><span id="local-6989586621679392040"><span id="local-6989586621679392042"><span id="local-6989586621679392043"><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#smfMap"><span class="hs-identifier hs-type">smfMap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.Data.Singleton.html#Singleton"><span class="hs-identifier hs-type">Singleton</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Structure.Fibred.Definition.html#Root"><span class="hs-identifier hs-type">Root</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392040"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679392042"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679392040"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#SumForm"><span class="hs-identifier hs-type">SumForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392043"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392042"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#SumForm"><span class="hs-identifier hs-type">SumForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392043"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392040"><span class="hs-identifier hs-type">y</span></a></span></span></span></span><span>
</span><span id="line-136"></span><span id="smfMap"><span class="annot"><span class="annottext">smfMap :: forall y x r.
Singleton (Root y) =&gt;
(x -&gt; y) -&gt; SumForm r x -&gt; SumForm r y
</span><a href="OAlg.Entity.Sum.Definition.html#smfMap"><span class="hs-identifier hs-var hs-var">smfMap</span></a></span></span><span> </span><span id="local-6989586621679392595"><span class="annot"><span class="annottext">x -&gt; y
</span><a href="#local-6989586621679392595"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Root x -&gt; SumForm r y)
-&gt; (r -&gt; SumForm r y -&gt; SumForm r y)
-&gt; (SumForm r y -&gt; SumForm r y -&gt; SumForm r y)
-&gt; (x -&gt; SumForm r y)
-&gt; SumForm r x
-&gt; SumForm r y
forall x y r.
(Root x -&gt; y)
-&gt; (r -&gt; y -&gt; y) -&gt; (y -&gt; y -&gt; y) -&gt; (x -&gt; y) -&gt; SumForm r x -&gt; y
</span><a href="OAlg.Entity.Sum.Definition.html#smfSum"><span class="hs-identifier hs-var">smfSum</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SumForm r y -&gt; Root x -&gt; SumForm r y
forall b a. b -&gt; a -&gt; b
</span><a href="OAlg.Category.Definition.html#const"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Root y -&gt; SumForm r y
forall r a. Root a -&gt; SumForm r a
</span><a href="OAlg.Entity.Sum.Definition.html#Zero"><span class="hs-identifier hs-var">Zero</span></a></span><span> </span><span class="annot"><span class="annottext">Root y
forall s. Singleton s =&gt; s
</span><a href="OAlg.Data.Singleton.html#unit"><span class="hs-keyword hs-var">unit</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">r -&gt; SumForm r y -&gt; SumForm r y
forall r a. r -&gt; SumForm r a -&gt; SumForm r a
</span><a href="OAlg.Entity.Sum.Definition.html#%3A%21"><span class="hs-operator hs-var">(:!)</span></a></span><span> </span><span class="annot"><span class="annottext">SumForm r y -&gt; SumForm r y -&gt; SumForm r y
forall r a. SumForm r a -&gt; SumForm r a -&gt; SumForm r a
</span><a href="OAlg.Entity.Sum.Definition.html#%3A%2B"><span class="hs-operator hs-var">(:+)</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">y -&gt; SumForm r y
forall r a. a -&gt; SumForm r a
</span><a href="OAlg.Entity.Sum.Definition.html#S"><span class="hs-identifier hs-var">S</span></a></span><span> </span><span class="annot"><span class="annottext">(y -&gt; SumForm r y) -&gt; (x -&gt; y) -&gt; x -&gt; SumForm r y
forall y z x. (y -&gt; z) -&gt; (x -&gt; y) -&gt; x -&gt; z
forall (c :: * -&gt; * -&gt; *) y z x.
Category c =&gt;
c y z -&gt; c x y -&gt; c x z
</span><a href="OAlg.Category.Definition.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">x -&gt; y
</span><a href="#local-6989586621679392595"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-137"></span><span>
</span><span id="line-138"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-139"></span><span class="hs-comment">-- smfLength -</span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span class="annot"><span class="hs-comment">-- | the length of a sum form,</span></span><span>
</span><span id="line-142"></span><span id="local-6989586621679392055"><span id="local-6989586621679392057"><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#smfLength"><span class="hs-identifier hs-type">smfLength</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Number"><span class="hs-identifier hs-type">Number</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392055"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#SumForm"><span class="hs-identifier hs-type">SumForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392055"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392057"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span></span></span><span>
</span><span id="line-143"></span><span id="smfLength"><span class="annot"><span class="annottext">smfLength :: forall r a. Number r =&gt; SumForm r a -&gt; N
</span><a href="OAlg.Entity.Sum.Definition.html#smfLength"><span class="hs-identifier hs-var hs-var">smfLength</span></a></span></span><span> </span><span id="local-6989586621679392612"><span class="annot"><span class="annottext">SumForm r a
</span><a href="#local-6989586621679392612"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SumForm r a
</span><a href="#local-6989586621679392612"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-144"></span><span>  </span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#Zero"><span class="hs-identifier hs-type">Zero</span></a></span><span> </span><span class="annot"><span class="annottext">Root a
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span>
</span><span id="line-145"></span><span>  </span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#S"><span class="hs-identifier hs-type">S</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">1</span></span><span>
</span><span id="line-146"></span><span>  </span><span id="local-6989586621679392613"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679392613"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#%3A%21"><span class="hs-operator hs-type">:!</span></a></span><span> </span><span id="local-6989586621679392614"><span class="annot"><span class="annottext">SumForm r a
</span><a href="#local-6989586621679392614"><span class="hs-identifier hs-var">a</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">r -&gt; N
forall {r} {b}. (Projectible b Z, Number r) =&gt; r -&gt; b
</span><a href="#local-6989586621679392615"><span class="hs-identifier hs-var">nFloor</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679392613"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; N
forall c. Multiplicative c =&gt; c -&gt; c -&gt; c
</span><a href="OAlg.Structure.Multiplicative.Definition.html#%2A"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">SumForm r a -&gt; N
forall r a. Number r =&gt; SumForm r a -&gt; N
</span><a href="OAlg.Entity.Sum.Definition.html#smfLength"><span class="hs-identifier hs-var">smfLength</span></a></span><span> </span><span class="annot"><span class="annottext">SumForm r a
</span><a href="#local-6989586621679392614"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-147"></span><span>  </span><span id="local-6989586621679392617"><span class="annot"><span class="annottext">SumForm r a
</span><a href="#local-6989586621679392617"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#%3A%2B"><span class="hs-operator hs-type">:+</span></a></span><span> </span><span id="local-6989586621679392618"><span class="annot"><span class="annottext">SumForm r a
</span><a href="#local-6989586621679392618"><span class="hs-identifier hs-var">b</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SumForm r a -&gt; N
forall r a. Number r =&gt; SumForm r a -&gt; N
</span><a href="OAlg.Entity.Sum.Definition.html#smfLength"><span class="hs-identifier hs-var">smfLength</span></a></span><span> </span><span class="annot"><span class="annottext">SumForm r a
</span><a href="#local-6989586621679392617"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; N
forall a. Additive a =&gt; a -&gt; a -&gt; a
</span><a href="OAlg.Structure.Additive.Definition.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">SumForm r a -&gt; N
forall r a. Number r =&gt; SumForm r a -&gt; N
</span><a href="OAlg.Entity.Sum.Definition.html#smfLength"><span class="hs-identifier hs-var">smfLength</span></a></span><span> </span><span class="annot"><span class="annottext">SumForm r a
</span><a href="#local-6989586621679392618"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-148"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679392615"><span class="annot"><span class="annottext">nFloor :: r -&gt; b
</span><a href="#local-6989586621679392615"><span class="hs-identifier hs-var hs-var">nFloor</span></a></span></span><span> </span><span id="local-6989586621679392744"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679392744"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Z -&gt; b
forall a b. Projectible a b =&gt; b -&gt; a
</span><a href="OAlg.Data.Canonical.html#prj"><span class="hs-identifier hs-var">prj</span></a></span><span> </span><span class="annot"><span class="annottext">(Z -&gt; b) -&gt; Z -&gt; b
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><a href="OAlg.Category.Applicative.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Z, r) -&gt; Z
forall a b. (a, b) -&gt; a
</span><a href="OAlg.Category.Definition.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">((Z, r) -&gt; Z) -&gt; (Z, r) -&gt; Z
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><a href="OAlg.Category.Applicative.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; (Z, r)
forall r. Number r =&gt; r -&gt; (Z, r)
</span><a href="OAlg.Structure.Number.Definition.html#zFloorFraction"><span class="hs-identifier hs-var">zFloorFraction</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679392744"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-149"></span><span>
</span><span id="line-150"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679392090"><span class="annot"><a href="OAlg.Data.Number.html#LengthN"><span class="hs-identifier hs-type">LengthN</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#SumForm"><span class="hs-identifier hs-type">SumForm</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392090"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-151"></span><span>  </span><span id="local-6989586621679392754"><span class="annot"><span class="annottext">lengthN :: SumForm N a -&gt; N
</span><a href="#local-6989586621679392754"><span class="hs-identifier hs-var hs-var hs-var hs-var">lengthN</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SumForm N a -&gt; N
forall r a. Number r =&gt; SumForm r a -&gt; N
</span><a href="OAlg.Entity.Sum.Definition.html#smfLength"><span class="hs-identifier hs-var">smfLength</span></a></span><span>
</span><span id="line-152"></span><span>
</span><span id="line-153"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-154"></span><span class="hs-comment">-- LinearCombination -</span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span class="hs-comment">-- | list of symbols in @__a__@ together with a scalar in @__r__@.</span><span>
</span><span id="line-157"></span><span class="hs-comment">--</span><span>
</span><span id="line-158"></span><span class="hs-comment">-- __Note__ 'valid' linear combinations must not be sorted according to the second component!</span><span>
</span><span id="line-159"></span><span class="hs-keyword">newtype</span><span> </span><span id="LinearCombination"><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#LinearCombination"><span class="hs-identifier hs-var">LinearCombination</span></a></span></span><span> </span><span id="local-6989586621679392125"><span class="annot"><a href="#local-6989586621679392125"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span id="local-6989586621679392126"><span class="annot"><a href="#local-6989586621679392126"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="LinearCombination"><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#LinearCombination"><span class="hs-identifier hs-var">LinearCombination</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679392125"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679392126"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679392760"><span id="local-6989586621679392766"><span id="local-6989586621679392770"><span class="annot"><span class="annottext">Int -&gt; LinearCombination r a -&gt; ShowS
[LinearCombination r a] -&gt; ShowS
LinearCombination r a -&gt; String
(Int -&gt; LinearCombination r a -&gt; ShowS)
-&gt; (LinearCombination r a -&gt; String)
-&gt; ([LinearCombination r a] -&gt; ShowS)
-&gt; Show (LinearCombination r a)
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall r a.
(Show r, Show a) =&gt;
Int -&gt; LinearCombination r a -&gt; ShowS
forall r a. (Show r, Show a) =&gt; [LinearCombination r a] -&gt; ShowS
forall r a. (Show r, Show a) =&gt; LinearCombination r a -&gt; String
$cshowsPrec :: forall r a.
(Show r, Show a) =&gt;
Int -&gt; LinearCombination r a -&gt; ShowS
showsPrec :: Int -&gt; LinearCombination r a -&gt; ShowS
$cshow :: forall r a. (Show r, Show a) =&gt; LinearCombination r a -&gt; String
show :: LinearCombination r a -&gt; String
$cshowList :: forall r a. (Show r, Show a) =&gt; [LinearCombination r a] -&gt; ShowS
showList :: [LinearCombination r a] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679392776"><span id="local-6989586621679392782"><span class="annot"><span class="annottext">LinearCombination r a -&gt; LinearCombination r a -&gt; Bool
(LinearCombination r a -&gt; LinearCombination r a -&gt; Bool)
-&gt; (LinearCombination r a -&gt; LinearCombination r a -&gt; Bool)
-&gt; Eq (LinearCombination r a)
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall r a.
(Eq r, Eq a) =&gt;
LinearCombination r a -&gt; LinearCombination r a -&gt; Bool
$c== :: forall r a.
(Eq r, Eq a) =&gt;
LinearCombination r a -&gt; LinearCombination r a -&gt; Bool
== :: LinearCombination r a -&gt; LinearCombination r a -&gt; Bool
$c/= :: forall r a.
(Eq r, Eq a) =&gt;
LinearCombination r a -&gt; LinearCombination r a -&gt; Bool
/= :: LinearCombination r a -&gt; LinearCombination r a -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679392791"><span class="annot"><span class="annottext">LinearCombination r a -&gt; Statement
(LinearCombination r a -&gt; Statement)
-&gt; Validable (LinearCombination r a)
forall a. (a -&gt; Statement) -&gt; Validable a
forall r a.
(Validable r, Validable a) =&gt;
LinearCombination r a -&gt; Statement
$cvalid :: forall r a.
(Validable r, Validable a) =&gt;
LinearCombination r a -&gt; Statement
valid :: LinearCombination r a -&gt; Statement
</span><a href="OAlg.Data.Validable.html#Validable"><span class="hs-identifier hs-var hs-var hs-var hs-var">Validable</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-160"></span><span>
</span><span id="line-161"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679392115"><span id="local-6989586621679392116"><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Definition.html#Entity"><span class="hs-identifier hs-type">Entity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392115"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Definition.html#Entity"><span class="hs-identifier hs-type">Entity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392116"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Definition.html#Entity"><span class="hs-identifier hs-type">Entity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#LinearCombination"><span class="hs-identifier hs-type">LinearCombination</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392116"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392115"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-162"></span><span>
</span><span id="line-163"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-164"></span><span class="hs-comment">-- lcs -</span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span class="annot"><span class="hs-comment">-- | the underlying list of symbols with their scalar.</span></span><span>
</span><span id="line-167"></span><span id="local-6989586621679392117"><span id="local-6989586621679392118"><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#lcs"><span class="hs-identifier hs-type">lcs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#LinearCombination"><span class="hs-identifier hs-type">LinearCombination</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392117"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392118"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679392117"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679392118"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span></span><span>
</span><span id="line-168"></span><span id="lcs"><span class="annot"><span class="annottext">lcs :: forall r a. LinearCombination r a -&gt; [(r, a)]
</span><a href="OAlg.Entity.Sum.Definition.html#lcs"><span class="hs-identifier hs-var hs-var">lcs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#LinearCombination"><span class="hs-identifier hs-type">LinearCombination</span></a></span><span> </span><span id="local-6989586621679392819"><span class="annot"><span class="annottext">[(r, a)]
</span><a href="#local-6989586621679392819"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(r, a)]
</span><a href="#local-6989586621679392819"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-169"></span><span>
</span><span id="line-170"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-171"></span><span class="hs-comment">-- lcAggr -</span><span>
</span><span id="line-172"></span><span>
</span><span id="line-173"></span><span class="annot"><span class="hs-comment">-- | aggregating linear combinations with same symbols.</span></span><span>
</span><span id="line-174"></span><span id="local-6989586621679392121"><span id="local-6989586621679392122"><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#lcAggr"><span class="hs-identifier hs-type">lcAggr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679392121"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Ring.Definition.html#Semiring"><span class="hs-identifier hs-type">Semiring</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392122"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#LinearCombination"><span class="hs-identifier hs-type">LinearCombination</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392122"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392121"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#LinearCombination"><span class="hs-identifier hs-type">LinearCombination</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392122"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392121"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-175"></span><span id="lcAggr"><span class="annot"><span class="annottext">lcAggr :: forall a r.
(Eq a, Semiring r) =&gt;
LinearCombination r a -&gt; LinearCombination r a
</span><a href="OAlg.Entity.Sum.Definition.html#lcAggr"><span class="hs-identifier hs-var hs-var">lcAggr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(r, a)] -&gt; LinearCombination r a
forall r a. [(r, a)] -&gt; LinearCombination r a
</span><a href="OAlg.Entity.Sum.Definition.html#LinearCombination"><span class="hs-identifier hs-var">LinearCombination</span></a></span><span> </span><span class="annot"><span class="annottext">([(r, a)] -&gt; LinearCombination r a)
-&gt; (LinearCombination r a -&gt; [(r, a)])
-&gt; LinearCombination r a
-&gt; LinearCombination r a
forall y z x. (y -&gt; z) -&gt; (x -&gt; y) -&gt; x -&gt; z
forall (c :: * -&gt; * -&gt; *) y z x.
Category c =&gt;
c y z -&gt; c x y -&gt; c x z
</span><a href="OAlg.Category.Definition.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">([(r, a)] -&gt; (r, a)) -&gt; [[(r, a)]] -&gt; [(r, a)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">[(r, a)] -&gt; (r, a)
forall {b} {b}. (Distributive b, Total b) =&gt; [(b, b)] -&gt; (b, b)
</span><a href="#local-6989586621679392830"><span class="hs-identifier hs-var">aggr</span></a></span><span> </span><span class="annot"><span class="annottext">([[(r, a)]] -&gt; [(r, a)])
-&gt; (LinearCombination r a -&gt; [[(r, a)]])
-&gt; LinearCombination r a
-&gt; [(r, a)]
forall y z x. (y -&gt; z) -&gt; (x -&gt; y) -&gt; x -&gt; z
forall (c :: * -&gt; * -&gt; *) y z x.
Category c =&gt;
c y z -&gt; c x y -&gt; c x z
</span><a href="OAlg.Category.Definition.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">((r, a) -&gt; (r, a) -&gt; Bool) -&gt; [(r, a)] -&gt; [[(r, a)]]
forall a. (a -&gt; a -&gt; Bool) -&gt; [a] -&gt; [[a]]
</span><span class="hs-identifier hs-var">groupBy</span></span><span> </span><span class="annot"><span class="annottext">(r, a) -&gt; (r, a) -&gt; Bool
forall {a} {a} {a}. Eq a =&gt; (a, a) -&gt; (a, a) -&gt; Bool
</span><a href="#local-6989586621679392831"><span class="hs-operator hs-var">(&lt;=&gt;)</span></a></span><span> </span><span class="annot"><span class="annottext">([(r, a)] -&gt; [[(r, a)]])
-&gt; (LinearCombination r a -&gt; [(r, a)])
-&gt; LinearCombination r a
-&gt; [[(r, a)]]
forall y z x. (y -&gt; z) -&gt; (x -&gt; y) -&gt; x -&gt; z
forall (c :: * -&gt; * -&gt; *) y z x.
Category c =&gt;
c y z -&gt; c x y -&gt; c x z
</span><a href="OAlg.Category.Definition.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">LinearCombination r a -&gt; [(r, a)]
forall r a. LinearCombination r a -&gt; [(r, a)]
</span><a href="OAlg.Entity.Sum.Definition.html#lcs"><span class="hs-identifier hs-var">lcs</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-176"></span><span>  </span><span id="local-6989586621679392834"><span class="annot"><span class="annottext">(a, a)
</span><a href="#local-6989586621679392834"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679392831"><span class="annot"><span class="annottext">&lt;=&gt; :: (a, a) -&gt; (a, a) -&gt; Bool
</span><a href="#local-6989586621679392831"><span class="hs-operator hs-var hs-var">&lt;=&gt;</span></a></span></span><span> </span><span id="local-6989586621679392835"><span class="annot"><span class="annottext">(a, a)
</span><a href="#local-6989586621679392835"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a, a) -&gt; a
forall a b. (a, b) -&gt; b
</span><a href="OAlg.Category.Definition.html#snd"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">(a, a)
</span><a href="#local-6989586621679392834"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">(a, a) -&gt; a
forall a b. (a, b) -&gt; b
</span><a href="OAlg.Category.Definition.html#snd"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">(a, a)
</span><a href="#local-6989586621679392835"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-177"></span><span>  </span><span id="local-6989586621679392830"><span class="annot"><span class="annottext">aggr :: [(b, b)] -&gt; (b, b)
</span><a href="#local-6989586621679392830"><span class="hs-identifier hs-var hs-var">aggr</span></a></span></span><span> </span><span id="local-6989586621679392935"><span class="annot"><span class="annottext">as :: [(b, b)]
</span><a href="#local-6989586621679392935"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679392936"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679392936"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[(b, b)]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(b -&gt; b -&gt; b) -&gt; b -&gt; [b] -&gt; b
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="annot"><span class="annottext">b -&gt; b -&gt; b
forall a. Additive a =&gt; a -&gt; a -&gt; a
</span><a href="OAlg.Structure.Additive.Definition.html#%2B"><span class="hs-operator hs-var">(+)</span></a></span><span> </span><span class="annot"><span class="annottext">b
forall r. Semiring r =&gt; r
</span><a href="OAlg.Structure.Ring.Definition.html#rZero"><span class="hs-identifier hs-var">rZero</span></a></span><span> </span><span class="annot"><span class="annottext">([b] -&gt; b) -&gt; [b] -&gt; b
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><a href="OAlg.Category.Applicative.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">((b, b) -&gt; b) -&gt; [(b, b)] -&gt; [b]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(b, b) -&gt; b
forall a b. (a, b) -&gt; a
</span><a href="OAlg.Category.Definition.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">[(b, b)]
</span><a href="#local-6989586621679392935"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679392936"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-178"></span><span>
</span><span id="line-179"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-180"></span><span class="hs-comment">-- lcSort -</span><span>
</span><span id="line-181"></span><span>
</span><span id="line-182"></span><span class="annot"><span class="hs-comment">-- | sorting a linear combination according to its symbols.</span></span><span>
</span><span id="line-183"></span><span id="local-6989586621679392138"><span id="local-6989586621679392139"><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#lcSort"><span class="hs-identifier hs-type">lcSort</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679392138"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#LinearCombination"><span class="hs-identifier hs-type">LinearCombination</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392139"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392138"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#LinearCombination"><span class="hs-identifier hs-type">LinearCombination</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392139"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392138"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-184"></span><span id="lcSort"><span class="annot"><span class="annottext">lcSort :: forall a r. Ord a =&gt; LinearCombination r a -&gt; LinearCombination r a
</span><a href="OAlg.Entity.Sum.Definition.html#lcSort"><span class="hs-identifier hs-var hs-var">lcSort</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#LinearCombination"><span class="hs-identifier hs-type">LinearCombination</span></a></span><span> </span><span id="local-6989586621679392941"><span class="annot"><span class="annottext">[(r, a)]
</span><a href="#local-6989586621679392941"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(r, a)] -&gt; LinearCombination r a
forall r a. [(r, a)] -&gt; LinearCombination r a
</span><a href="OAlg.Entity.Sum.Definition.html#LinearCombination"><span class="hs-identifier hs-var">LinearCombination</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(r, a)] -&gt; [(r, a)]
forall b a. Ord b =&gt; [(a, b)] -&gt; [(a, b)]
</span><a href="OAlg.Data.Ord.html#sortSnd"><span class="hs-identifier hs-var">sortSnd</span></a></span><span> </span><span class="annot"><span class="annottext">[(r, a)]
</span><a href="#local-6989586621679392941"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-185"></span><span>
</span><span id="line-186"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-187"></span><span class="hs-comment">-- lcSclFilter -</span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span class="annot"><span class="hs-comment">-- | filtering a word according to the scalars.</span></span><span>
</span><span id="line-190"></span><span id="local-6989586621679392144"><span id="local-6989586621679392145"><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#lcSclFilter"><span class="hs-identifier hs-type">lcSclFilter</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679392144"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#LinearCombination"><span class="hs-identifier hs-type">LinearCombination</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392144"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392145"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#LinearCombination"><span class="hs-identifier hs-type">LinearCombination</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392144"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392145"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-191"></span><span id="lcSclFilter"><span class="annot"><span class="annottext">lcSclFilter :: forall r a.
(r -&gt; Bool) -&gt; LinearCombination r a -&gt; LinearCombination r a
</span><a href="OAlg.Entity.Sum.Definition.html#lcSclFilter"><span class="hs-identifier hs-var hs-var">lcSclFilter</span></a></span></span><span> </span><span id="local-6989586621679392945"><span class="annot"><span class="annottext">r -&gt; Bool
</span><a href="#local-6989586621679392945"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#LinearCombination"><span class="hs-identifier hs-type">LinearCombination</span></a></span><span> </span><span id="local-6989586621679392946"><span class="annot"><span class="annottext">[(r, a)]
</span><a href="#local-6989586621679392946"><span class="hs-identifier hs-var">ws</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(r, a)] -&gt; LinearCombination r a
forall r a. [(r, a)] -&gt; LinearCombination r a
</span><a href="OAlg.Entity.Sum.Definition.html#LinearCombination"><span class="hs-identifier hs-var">LinearCombination</span></a></span><span> </span><span class="annot"><span class="annottext">([(r, a)] -&gt; LinearCombination r a)
-&gt; [(r, a)] -&gt; LinearCombination r a
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><a href="OAlg.Category.Applicative.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">((r, a) -&gt; Bool) -&gt; [(r, a)] -&gt; [(r, a)]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r -&gt; Bool
</span><a href="#local-6989586621679392945"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">(r -&gt; Bool) -&gt; ((r, a) -&gt; r) -&gt; (r, a) -&gt; Bool
forall y z x. (y -&gt; z) -&gt; (x -&gt; y) -&gt; x -&gt; z
forall (c :: * -&gt; * -&gt; *) y z x.
Category c =&gt;
c y z -&gt; c x y -&gt; c x z
</span><a href="OAlg.Category.Definition.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(r, a) -&gt; r
forall a b. (a, b) -&gt; a
</span><a href="OAlg.Category.Definition.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(r, a)]
</span><a href="#local-6989586621679392946"><span class="hs-identifier hs-var">ws</span></a></span><span>
</span><span id="line-192"></span><span>
</span><span id="line-193"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-194"></span><span class="hs-comment">-- smflc -</span><span>
</span><span id="line-195"></span><span>
</span><span id="line-196"></span><span class="annot"><span class="hs-comment">-- | transforming a sum form to its corresponding linear combination..</span></span><span>
</span><span id="line-197"></span><span id="local-6989586621679392149"><span id="local-6989586621679392150"><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#smflc"><span class="hs-identifier hs-type">smflc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.Structure.Ring.Definition.html#Semiring"><span class="hs-identifier hs-type">Semiring</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392149"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#SumForm"><span class="hs-identifier hs-type">SumForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392149"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392150"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#LinearCombination"><span class="hs-identifier hs-type">LinearCombination</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392149"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392150"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-198"></span><span id="smflc"><span class="annot"><span class="annottext">smflc :: forall r a. Semiring r =&gt; SumForm r a -&gt; LinearCombination r a
</span><a href="OAlg.Entity.Sum.Definition.html#smflc"><span class="hs-identifier hs-var hs-var">smflc</span></a></span></span><span> </span><span id="local-6989586621679392952"><span class="annot"><span class="annottext">SumForm r a
</span><a href="#local-6989586621679392952"><span class="hs-identifier hs-var">sf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(r, a)] -&gt; LinearCombination r a
forall r a. [(r, a)] -&gt; LinearCombination r a
</span><a href="OAlg.Entity.Sum.Definition.html#LinearCombination"><span class="hs-identifier hs-var">LinearCombination</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SumForm r a -&gt; [(r, a)]
forall {a} {b}.
(Distributive a, Total a) =&gt;
SumForm a b -&gt; [(a, b)]
</span><a href="#local-6989586621679392953"><span class="hs-identifier hs-var">tow</span></a></span><span> </span><span class="annot"><span class="annottext">SumForm r a
</span><a href="#local-6989586621679392952"><span class="hs-identifier hs-var">sf</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-199"></span><span>  </span><span id="local-6989586621679392953"><span class="annot"><span class="annottext">tow :: SumForm a b -&gt; [(a, b)]
</span><a href="#local-6989586621679392953"><span class="hs-identifier hs-var hs-var">tow</span></a></span></span><span> </span><span id="local-6989586621679393046"><span class="annot"><span class="annottext">SumForm a b
</span><a href="#local-6989586621679393046"><span class="hs-identifier hs-var">sf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SumForm a b
</span><a href="#local-6989586621679393046"><span class="hs-identifier hs-var">sf</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-200"></span><span>    </span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#Zero"><span class="hs-identifier hs-type">Zero</span></a></span><span> </span><span class="annot"><span class="annottext">Root b
</span><span class="hs-identifier">_</span></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-201"></span><span>    </span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#S"><span class="hs-identifier hs-type">S</span></a></span><span> </span><span id="local-6989586621679393047"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679393047"><span class="hs-identifier hs-var">a</span></a></span></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
forall r. Semiring r =&gt; r
</span><a href="OAlg.Structure.Ring.Definition.html#rOne"><span class="hs-identifier hs-var">rOne</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679393047"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-202"></span><span>    </span><span id="local-6989586621679393049"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679393049"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#%3A%21"><span class="hs-operator hs-type">:!</span></a></span><span> </span><span id="local-6989586621679393050"><span class="annot"><span class="annottext">SumForm a b
</span><a href="#local-6989586621679393050"><span class="hs-identifier hs-var">a</span></a></span></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">((a, b) -&gt; (a, b)) -&gt; [(a, b)] -&gt; [(a, b)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679393051"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679393051"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679393052"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679393052"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679393049"><span class="hs-identifier hs-var">r</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall c. Multiplicative c =&gt; c -&gt; c -&gt; c
</span><a href="OAlg.Structure.Multiplicative.Definition.html#%2A"><span class="hs-operator hs-var">*</span></a></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679393051"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679393052"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(a, b)] -&gt; [(a, b)]) -&gt; [(a, b)] -&gt; [(a, b)]
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><a href="OAlg.Category.Applicative.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">SumForm a b -&gt; [(a, b)]
</span><a href="#local-6989586621679392953"><span class="hs-identifier hs-var">tow</span></a></span><span> </span><span class="annot"><span class="annottext">SumForm a b
</span><a href="#local-6989586621679393050"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-203"></span><span>    </span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#S"><span class="hs-identifier hs-type">S</span></a></span><span> </span><span id="local-6989586621679393053"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679393053"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#%3A%2B"><span class="hs-operator hs-type">:+</span></a></span><span> </span><span id="local-6989586621679393054"><span class="annot"><span class="annottext">SumForm a b
</span><a href="#local-6989586621679393054"><span class="hs-identifier hs-var">b</span></a></span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
forall r. Semiring r =&gt; r
</span><a href="OAlg.Structure.Ring.Definition.html#rOne"><span class="hs-identifier hs-var">rOne</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679393053"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">(a, b) -&gt; [(a, b)] -&gt; [(a, b)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">SumForm a b -&gt; [(a, b)]
</span><a href="#local-6989586621679392953"><span class="hs-identifier hs-var">tow</span></a></span><span> </span><span class="annot"><span class="annottext">SumForm a b
</span><a href="#local-6989586621679393054"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-204"></span><span>    </span><span id="local-6989586621679393055"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679393055"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#%3A%21"><span class="hs-operator hs-type">:!</span></a></span><span> </span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#S"><span class="hs-identifier hs-type">S</span></a></span><span> </span><span id="local-6989586621679393056"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679393056"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#%3A%2B"><span class="hs-operator hs-type">:+</span></a></span><span> </span><span id="local-6989586621679393057"><span class="annot"><span class="annottext">SumForm a b
</span><a href="#local-6989586621679393057"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679393055"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679393056"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">(a, b) -&gt; [(a, b)] -&gt; [(a, b)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">SumForm a b -&gt; [(a, b)]
</span><a href="#local-6989586621679392953"><span class="hs-identifier hs-var">tow</span></a></span><span> </span><span class="annot"><span class="annottext">SumForm a b
</span><a href="#local-6989586621679393057"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-205"></span><span>    </span><span id="local-6989586621679393058"><span class="annot"><span class="annottext">SumForm a b
</span><a href="#local-6989586621679393058"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#%3A%2B"><span class="hs-operator hs-type">:+</span></a></span><span> </span><span id="local-6989586621679393059"><span class="annot"><span class="annottext">SumForm a b
</span><a href="#local-6989586621679393059"><span class="hs-identifier hs-var">b</span></a></span></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SumForm a b -&gt; [(a, b)]
</span><a href="#local-6989586621679392953"><span class="hs-identifier hs-var">tow</span></a></span><span> </span><span class="annot"><span class="annottext">SumForm a b
</span><a href="#local-6989586621679393058"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">[(a, b)] -&gt; [(a, b)] -&gt; [(a, b)]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">SumForm a b -&gt; [(a, b)]
</span><a href="#local-6989586621679392953"><span class="hs-identifier hs-var">tow</span></a></span><span> </span><span class="annot"><span class="annottext">SumForm a b
</span><a href="#local-6989586621679393059"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-206"></span><span>                   </span><span>
</span><span id="line-207"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-208"></span><span class="hs-comment">-- lcsmf -</span><span>
</span><span id="line-209"></span><span>
</span><span id="line-210"></span><span class="annot"><span class="hs-comment">-- | transforming a word to its corresponding sum form.</span></span><span>
</span><span id="line-211"></span><span id="local-6989586621679392156"><span id="local-6989586621679392157"><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#lcsmf"><span class="hs-identifier hs-type">lcsmf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.Structure.Ring.Definition.html#Semiring"><span class="hs-identifier hs-type">Semiring</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392156"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Structure.Fibred.Definition.html#Root"><span class="hs-identifier hs-type">Root</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392157"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#LinearCombination"><span class="hs-identifier hs-type">LinearCombination</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392156"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392157"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#SumForm"><span class="hs-identifier hs-type">SumForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392156"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392157"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-212"></span><span id="lcsmf"><span class="annot"><span class="annottext">lcsmf :: forall r a.
Semiring r =&gt;
Root a -&gt; LinearCombination r a -&gt; SumForm r a
</span><a href="OAlg.Entity.Sum.Definition.html#lcsmf"><span class="hs-identifier hs-var hs-var">lcsmf</span></a></span></span><span> </span><span id="local-6989586621679393065"><span class="annot"><span class="annottext">Root a
</span><a href="#local-6989586621679393065"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#LinearCombination"><span class="hs-identifier hs-type">LinearCombination</span></a></span><span> </span><span id="local-6989586621679393066"><span class="annot"><span class="annottext">[(r, a)]
</span><a href="#local-6989586621679393066"><span class="hs-identifier hs-var">ws</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Root a -&gt; [(r, a)] -&gt; SumForm r a
forall {r} {a}.
(Distributive r, Total r) =&gt;
Root a -&gt; [(r, a)] -&gt; SumForm r a
</span><a href="#local-6989586621679393067"><span class="hs-identifier hs-var">smf</span></a></span><span> </span><span class="annot"><span class="annottext">Root a
</span><a href="#local-6989586621679393065"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">[(r, a)]
</span><a href="#local-6989586621679393066"><span class="hs-identifier hs-var">ws</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-213"></span><span>  </span><span id="local-6989586621679393067"><span class="annot"><span class="annottext">smf :: Root a -&gt; [(r, a)] -&gt; SumForm r a
</span><a href="#local-6989586621679393067"><span class="hs-identifier hs-var hs-var">smf</span></a></span></span><span> </span><span id="local-6989586621679393152"><span class="annot"><span class="annottext">Root a
</span><a href="#local-6989586621679393152"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679393153"><span class="annot"><span class="annottext">[(r, a)]
</span><a href="#local-6989586621679393153"><span class="hs-identifier hs-var">ws</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[(r, a)]
</span><a href="#local-6989586621679393153"><span class="hs-identifier hs-var">ws</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-214"></span><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Root a -&gt; SumForm r a
forall r a. Root a -&gt; SumForm r a
</span><a href="OAlg.Entity.Sum.Definition.html#Zero"><span class="hs-identifier hs-var">Zero</span></a></span><span> </span><span class="annot"><span class="annottext">Root a
</span><a href="#local-6989586621679393152"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-215"></span><span>    </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621679393154"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679393154"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679393155"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679393155"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679393154"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">r
forall r. Semiring r =&gt; r
</span><a href="OAlg.Structure.Ring.Definition.html#rOne"><span class="hs-identifier hs-var">rOne</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">a -&gt; SumForm r a
forall r a. a -&gt; SumForm r a
</span><a href="OAlg.Entity.Sum.Definition.html#S"><span class="hs-identifier hs-var">S</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679393155"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679393154"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; SumForm r a -&gt; SumForm r a
forall r a. r -&gt; SumForm r a -&gt; SumForm r a
</span><a href="OAlg.Entity.Sum.Definition.html#%3A%21"><span class="hs-operator hs-var">:!</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; SumForm r a
forall r a. a -&gt; SumForm r a
</span><a href="OAlg.Entity.Sum.Definition.html#S"><span class="hs-identifier hs-var">S</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679393155"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-216"></span><span>    </span><span id="local-6989586621679393156"><span class="annot"><span class="annottext">(r, a)
</span><a href="#local-6989586621679393156"><span class="hs-identifier hs-var">w</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679393157"><span class="annot"><span class="annottext">[(r, a)]
</span><a href="#local-6989586621679393157"><span class="hs-identifier hs-var">ws</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Root a -&gt; [(r, a)] -&gt; SumForm r a
</span><a href="#local-6989586621679393067"><span class="hs-identifier hs-var">smf</span></a></span><span> </span><span class="annot"><span class="annottext">Root a
</span><a href="#local-6989586621679393152"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">(r, a)
</span><a href="#local-6989586621679393156"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">SumForm r a -&gt; SumForm r a -&gt; SumForm r a
forall r a. SumForm r a -&gt; SumForm r a -&gt; SumForm r a
</span><a href="OAlg.Entity.Sum.Definition.html#%3A%2B"><span class="hs-operator hs-var">:+</span></a></span><span> </span><span class="annot"><span class="annottext">Root a -&gt; [(r, a)] -&gt; SumForm r a
</span><a href="#local-6989586621679393067"><span class="hs-identifier hs-var">smf</span></a></span><span> </span><span class="annot"><span class="annottext">Root a
</span><a href="#local-6989586621679393152"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">[(r, a)]
</span><a href="#local-6989586621679393157"><span class="hs-identifier hs-var">ws</span></a></span><span>
</span><span id="line-217"></span><span>
</span><span id="line-218"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-219"></span><span class="hs-comment">-- smfReduce -</span><span>
</span><span id="line-220"></span><span>
</span><span id="line-221"></span><span class="annot"><span class="hs-comment">-- | reducing a sum form to its canonical form,</span></span><span>
</span><span id="line-222"></span><span id="local-6989586621679392162"><span id="local-6989586621679392163"><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#smfReduce"><span class="hs-identifier hs-type">smfReduce</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Structure.Fibred.Definition.html#Fibred"><span class="hs-identifier hs-type">Fibred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392162"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679392162"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Ring.Definition.html#Semiring"><span class="hs-identifier hs-type">Semiring</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392163"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Multiplicative.Definition.html#Commutative"><span class="hs-identifier hs-type">Commutative</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392163"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#SumForm"><span class="hs-identifier hs-type">SumForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392163"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392162"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#SumForm"><span class="hs-identifier hs-type">SumForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392163"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392162"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-223"></span><span id="smfReduce"><span class="annot"><span class="annottext">smfReduce :: forall a r.
(Fibred a, Ord a, Semiring r, Commutative r) =&gt;
SumForm r a -&gt; SumForm r a
</span><a href="OAlg.Entity.Sum.Definition.html#smfReduce"><span class="hs-identifier hs-var hs-var">smfReduce</span></a></span></span><span> </span><span id="local-6989586621679393179"><span class="annot"><span class="annottext">SumForm r a
</span><a href="#local-6989586621679393179"><span class="hs-identifier hs-var">sf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Root a -&gt; LinearCombination r a -&gt; SumForm r a
forall r a.
Semiring r =&gt;
Root a -&gt; LinearCombination r a -&gt; SumForm r a
</span><a href="OAlg.Entity.Sum.Definition.html#lcsmf"><span class="hs-identifier hs-var">lcsmf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SumForm r a -&gt; Root (SumForm r a)
forall f. Fibred f =&gt; f -&gt; Root f
</span><a href="OAlg.Structure.Fibred.Definition.html#root"><span class="hs-identifier hs-var">root</span></a></span><span> </span><span class="annot"><span class="annottext">SumForm r a
</span><a href="#local-6989586621679393179"><span class="hs-identifier hs-var">sf</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(LinearCombination r a -&gt; SumForm r a)
-&gt; LinearCombination r a -&gt; SumForm r a
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><a href="OAlg.Category.Applicative.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(r -&gt; Bool) -&gt; LinearCombination r a -&gt; LinearCombination r a
forall r a.
(r -&gt; Bool) -&gt; LinearCombination r a -&gt; LinearCombination r a
</span><a href="OAlg.Entity.Sum.Definition.html#lcSclFilter"><span class="hs-identifier hs-var">lcSclFilter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
forall b. Boolean b =&gt; b -&gt; b
</span><a href="OAlg.Data.Boolean.Definition.html#not"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; (r -&gt; Bool) -&gt; r -&gt; Bool
forall y z x. (y -&gt; z) -&gt; (x -&gt; y) -&gt; x -&gt; z
forall (c :: * -&gt; * -&gt; *) y z x.
Category c =&gt;
c y z -&gt; c x y -&gt; c x z
</span><a href="OAlg.Category.Definition.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; Bool
forall a. Additive a =&gt; a -&gt; Bool
</span><a href="OAlg.Structure.Additive.Definition.html#isZero"><span class="hs-identifier hs-var">isZero</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(LinearCombination r a -&gt; LinearCombination r a)
-&gt; LinearCombination r a -&gt; LinearCombination r a
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><a href="OAlg.Category.Applicative.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">LinearCombination r a -&gt; LinearCombination r a
forall a r.
(Eq a, Semiring r) =&gt;
LinearCombination r a -&gt; LinearCombination r a
</span><a href="OAlg.Entity.Sum.Definition.html#lcAggr"><span class="hs-identifier hs-var">lcAggr</span></a></span><span> </span><span class="annot"><span class="annottext">(LinearCombination r a -&gt; LinearCombination r a)
-&gt; LinearCombination r a -&gt; LinearCombination r a
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><a href="OAlg.Category.Applicative.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">LinearCombination r a -&gt; LinearCombination r a
forall a r. Ord a =&gt; LinearCombination r a -&gt; LinearCombination r a
</span><a href="OAlg.Entity.Sum.Definition.html#lcSort"><span class="hs-identifier hs-var">lcSort</span></a></span><span> </span><span class="annot"><span class="annottext">(LinearCombination r a -&gt; LinearCombination r a)
-&gt; LinearCombination r a -&gt; LinearCombination r a
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><a href="OAlg.Category.Applicative.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">SumForm r a -&gt; LinearCombination r a
forall r a. Semiring r =&gt; SumForm r a -&gt; LinearCombination r a
</span><a href="OAlg.Entity.Sum.Definition.html#smflc"><span class="hs-identifier hs-var">smflc</span></a></span><span> </span><span class="annot"><span class="annottext">SumForm r a
</span><a href="#local-6989586621679393179"><span class="hs-identifier hs-var">sf</span></a></span><span>
</span><span id="line-224"></span><span>
</span><span id="line-225"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679392171"><span id="local-6989586621679392172"><span class="hs-special">(</span><span class="annot"><a href="OAlg.Structure.Fibred.Definition.html#Fibred"><span class="hs-identifier hs-type">Fibred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392171"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679392171"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Ring.Definition.html#Semiring"><span class="hs-identifier hs-type">Semiring</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392172"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Multiplicative.Definition.html#Commutative"><span class="hs-identifier hs-type">Commutative</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392172"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.Reducible.html#Reducible"><span class="hs-identifier hs-type">Reducible</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#SumForm"><span class="hs-identifier hs-type">SumForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392172"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392171"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-226"></span><span>  </span><span id="local-6989586621679393193"><span class="annot"><span class="annottext">reduce :: SumForm r a -&gt; SumForm r a
</span><a href="#local-6989586621679393193"><span class="hs-identifier hs-var hs-var hs-var hs-var">reduce</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SumForm r a -&gt; SumForm r a
forall a r.
(Fibred a, Ord a, Semiring r, Commutative r) =&gt;
SumForm r a -&gt; SumForm r a
</span><a href="OAlg.Entity.Sum.Definition.html#smfReduce"><span class="hs-identifier hs-var">smfReduce</span></a></span><span>
</span><span id="line-227"></span><span>
</span><span id="line-228"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-229"></span><span class="hs-comment">-- Sum -</span><span>
</span><span id="line-230"></span><span>
</span><span id="line-231"></span><span class="hs-comment">-- | free sum over 'Fibred' symbols in @__a__@ with scalars in @__r__@.</span><span>
</span><span id="line-232"></span><span class="hs-comment">--</span><span>
</span><span id="line-233"></span><span class="hs-comment">-- __Definition__ A 'Sum' @s@ is 'valid' if and only if its underlying 'SumForm' @s'@ is 'valid' and</span><span>
</span><span id="line-234"></span><span class="hs-comment">-- @s'@ is reduced, i.e. @s' '==' 'reduce' s'@.</span><span>
</span><span id="line-235"></span><span class="hs-keyword">newtype</span><span> </span><span id="Sum"><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#Sum"><span class="hs-identifier hs-var">Sum</span></a></span></span><span> </span><span id="local-6989586621679392207"><span class="annot"><a href="#local-6989586621679392207"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span id="local-6989586621679392208"><span class="annot"><a href="#local-6989586621679392208"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Sum"><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#Sum"><span class="hs-identifier hs-var">Sum</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#SumForm"><span class="hs-identifier hs-type">SumForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392207"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392208"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679393198"><span id="local-6989586621679393202"><span id="local-6989586621679393206"><span class="annot"><span class="annottext">Int -&gt; Sum r a -&gt; ShowS
[Sum r a] -&gt; ShowS
Sum r a -&gt; String
(Int -&gt; Sum r a -&gt; ShowS)
-&gt; (Sum r a -&gt; String) -&gt; ([Sum r a] -&gt; ShowS) -&gt; Show (Sum r a)
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall r a. (Fibred a, Entity r) =&gt; Int -&gt; Sum r a -&gt; ShowS
forall r a. (Fibred a, Entity r) =&gt; [Sum r a] -&gt; ShowS
forall r a. (Fibred a, Entity r) =&gt; Sum r a -&gt; String
$cshowsPrec :: forall r a. (Fibred a, Entity r) =&gt; Int -&gt; Sum r a -&gt; ShowS
showsPrec :: Int -&gt; Sum r a -&gt; ShowS
$cshow :: forall r a. (Fibred a, Entity r) =&gt; Sum r a -&gt; String
show :: Sum r a -&gt; String
$cshowList :: forall r a. (Fibred a, Entity r) =&gt; [Sum r a] -&gt; ShowS
showList :: [Sum r a] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679393211"><span id="local-6989586621679393215"><span class="annot"><span class="annottext">Sum r a -&gt; Sum r a -&gt; Bool
(Sum r a -&gt; Sum r a -&gt; Bool)
-&gt; (Sum r a -&gt; Sum r a -&gt; Bool) -&gt; Eq (Sum r a)
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall r a. (Fibred a, Entity r) =&gt; Sum r a -&gt; Sum r a -&gt; Bool
$c== :: forall r a. (Fibred a, Entity r) =&gt; Sum r a -&gt; Sum r a -&gt; Bool
== :: Sum r a -&gt; Sum r a -&gt; Bool
$c/= :: forall r a. (Fibred a, Entity r) =&gt; Sum r a -&gt; Sum r a -&gt; Bool
/= :: Sum r a -&gt; Sum r a -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679393227"><span id="local-6989586621679393231"><span id="local-6989586621679393235"><span id="local-6989586621679393239"><span id="local-6989586621679393243"><span id="local-6989586621679393247"><span id="local-6989586621679393251"><span class="annot"><span class="annottext">Eq (Sum r a)
Eq (Sum r a)
-&gt; (Sum r a -&gt; Sum r a -&gt; Ordering)
-&gt; (Sum r a -&gt; Sum r a -&gt; Bool)
-&gt; (Sum r a -&gt; Sum r a -&gt; Bool)
-&gt; (Sum r a -&gt; Sum r a -&gt; Bool)
-&gt; (Sum r a -&gt; Sum r a -&gt; Bool)
-&gt; (Sum r a -&gt; Sum r a -&gt; Sum r a)
-&gt; (Sum r a -&gt; Sum r a -&gt; Sum r a)
-&gt; Ord (Sum r a)
Sum r a -&gt; Sum r a -&gt; Bool
Sum r a -&gt; Sum r a -&gt; Ordering
Sum r a -&gt; Sum r a -&gt; Sum r a
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall {r} {a}.
(Fibred a, OrdRoot a, Ord r, Ord a, Entity r) =&gt;
Eq (Sum r a)
forall r a.
(Fibred a, OrdRoot a, Ord r, Ord a, Entity r) =&gt;
Sum r a -&gt; Sum r a -&gt; Bool
forall r a.
(Fibred a, OrdRoot a, Ord r, Ord a, Entity r) =&gt;
Sum r a -&gt; Sum r a -&gt; Ordering
forall r a.
(Fibred a, OrdRoot a, Ord r, Ord a, Entity r) =&gt;
Sum r a -&gt; Sum r a -&gt; Sum r a
$ccompare :: forall r a.
(Fibred a, OrdRoot a, Ord r, Ord a, Entity r) =&gt;
Sum r a -&gt; Sum r a -&gt; Ordering
compare :: Sum r a -&gt; Sum r a -&gt; Ordering
$c&lt; :: forall r a.
(Fibred a, OrdRoot a, Ord r, Ord a, Entity r) =&gt;
Sum r a -&gt; Sum r a -&gt; Bool
&lt; :: Sum r a -&gt; Sum r a -&gt; Bool
$c&lt;= :: forall r a.
(Fibred a, OrdRoot a, Ord r, Ord a, Entity r) =&gt;
Sum r a -&gt; Sum r a -&gt; Bool
&lt;= :: Sum r a -&gt; Sum r a -&gt; Bool
$c&gt; :: forall r a.
(Fibred a, OrdRoot a, Ord r, Ord a, Entity r) =&gt;
Sum r a -&gt; Sum r a -&gt; Bool
&gt; :: Sum r a -&gt; Sum r a -&gt; Bool
$c&gt;= :: forall r a.
(Fibred a, OrdRoot a, Ord r, Ord a, Entity r) =&gt;
Sum r a -&gt; Sum r a -&gt; Bool
&gt;= :: Sum r a -&gt; Sum r a -&gt; Bool
$cmax :: forall r a.
(Fibred a, OrdRoot a, Ord r, Ord a, Entity r) =&gt;
Sum r a -&gt; Sum r a -&gt; Sum r a
max :: Sum r a -&gt; Sum r a -&gt; Sum r a
$cmin :: forall r a.
(Fibred a, OrdRoot a, Ord r, Ord a, Entity r) =&gt;
Sum r a -&gt; Sum r a -&gt; Sum r a
min :: Sum r a -&gt; Sum r a -&gt; Sum r a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679393260"><span class="annot"><span class="annottext">Sum r a -&gt; Statement
(Sum r a -&gt; Statement) -&gt; Validable (Sum r a)
forall a. (a -&gt; Statement) -&gt; Validable a
forall r a.
(Distributive r, Total r, Commutative r, Fibred a) =&gt;
Sum r a -&gt; Statement
$cvalid :: forall r a.
(Distributive r, Total r, Commutative r, Fibred a) =&gt;
Sum r a -&gt; Statement
valid :: Sum r a -&gt; Statement
</span><a href="OAlg.Data.Validable.html#Validable"><span class="hs-identifier hs-var hs-var hs-var hs-var">Validable</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-236"></span><span>
</span><span id="line-237"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679392192"><span id="local-6989586621679392193"><span class="hs-special">(</span><span class="annot"><a href="OAlg.Structure.Fibred.Definition.html#Fibred"><span class="hs-identifier hs-type">Fibred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392192"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Ring.Definition.html#Semiring"><span class="hs-identifier hs-type">Semiring</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392193"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Multiplicative.Definition.html#Commutative"><span class="hs-identifier hs-type">Commutative</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392193"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Definition.html#Entity"><span class="hs-identifier hs-type">Entity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#Sum"><span class="hs-identifier hs-type">Sum</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392193"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392192"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-238"></span><span>
</span><span id="line-239"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-240"></span><span class="hs-comment">-- Sum - Constructable -</span><span>
</span><span id="line-241"></span><span>
</span><span id="line-242"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679392199"><span id="local-6989586621679392200"><span class="annot"><a href="OAlg.Data.Constructable.html#Exposable"><span class="hs-identifier hs-type">Exposable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#Sum"><span class="hs-identifier hs-type">Sum</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392199"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392200"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-243"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Form"><span class="annot"><a href="OAlg.Data.Constructable.html#Form"><span class="hs-identifier hs-var">Form</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#Sum"><span class="hs-identifier hs-type">Sum</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392199"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392200"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#SumForm"><span class="hs-identifier hs-type">SumForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392199"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392200"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-244"></span><span>  </span><span id="local-6989586621679393290"><span class="annot"><span class="annottext">form :: Sum r a -&gt; Form (Sum r a)
</span><a href="#local-6989586621679393290"><span class="hs-identifier hs-var hs-var hs-var hs-var">form</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#Sum"><span class="hs-identifier hs-type">Sum</span></a></span><span> </span><span id="local-6989586621679393292"><span class="annot"><span class="annottext">SumForm r a
</span><a href="#local-6989586621679393292"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Form (Sum r a)
SumForm r a
</span><a href="#local-6989586621679393292"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-245"></span><span>
</span><span id="line-246"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679392205"><span id="local-6989586621679392206"><span class="hs-special">(</span><span class="annot"><a href="OAlg.Structure.Fibred.Definition.html#Fibred"><span class="hs-identifier hs-type">Fibred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392205"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679392205"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Ring.Definition.html#Semiring"><span class="hs-identifier hs-type">Semiring</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392206"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Multiplicative.Definition.html#Commutative"><span class="hs-identifier hs-type">Commutative</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392206"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.Constructable.html#Constructable"><span class="hs-identifier hs-type">Constructable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#Sum"><span class="hs-identifier hs-type">Sum</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392206"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392205"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-247"></span><span>  </span><span id="local-6989586621679393304"><span class="annot"><span class="annottext">make :: Form (Sum r a) -&gt; Sum r a
</span><a href="#local-6989586621679393304"><span class="hs-identifier hs-var hs-var hs-var hs-var">make</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SumForm r a -&gt; Sum r a
forall r a. SumForm r a -&gt; Sum r a
</span><a href="OAlg.Entity.Sum.Definition.html#Sum"><span class="hs-identifier hs-var">Sum</span></a></span><span> </span><span class="annot"><span class="annottext">(SumForm r a -&gt; Sum r a)
-&gt; (SumForm r a -&gt; SumForm r a) -&gt; SumForm r a -&gt; Sum r a
forall y z x. (y -&gt; z) -&gt; (x -&gt; y) -&gt; x -&gt; z
forall (c :: * -&gt; * -&gt; *) y z x.
Category c =&gt;
c y z -&gt; c x y -&gt; c x z
</span><a href="OAlg.Category.Definition.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">SumForm r a -&gt; SumForm r a
forall e. Reducible e =&gt; e -&gt; e
</span><a href="OAlg.Data.Reducible.html#reduce"><span class="hs-identifier hs-var">reduce</span></a></span><span>
</span><span id="line-248"></span><span>  </span><span>
</span><span id="line-249"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-250"></span><span class="hs-comment">-- Sum - Abelian -</span><span>
</span><span id="line-251"></span><span>
</span><span id="line-252"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679392211"><span id="local-6989586621679392212"><span class="hs-special">(</span><span class="annot"><a href="OAlg.Structure.Fibred.Definition.html#Fibred"><span class="hs-identifier hs-type">Fibred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392211"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Ring.Definition.html#Semiring"><span class="hs-identifier hs-type">Semiring</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392212"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Multiplicative.Definition.html#Commutative"><span class="hs-identifier hs-type">Commutative</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392212"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Structure.Fibred.Definition.html#Fibred"><span class="hs-identifier hs-type">Fibred</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#Sum"><span class="hs-identifier hs-type">Sum</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392212"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392211"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-253"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Root"><span class="annot"><a href="OAlg.Structure.Fibred.Definition.html#Root"><span class="hs-identifier hs-var">Root</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#Sum"><span class="hs-identifier hs-type">Sum</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392212"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392211"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="OAlg.Structure.Fibred.Definition.html#Root"><span class="hs-identifier hs-type">Root</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392211"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-254"></span><span>  </span><span id="local-6989586621679393317"><span class="annot"><span class="annottext">root :: Sum r a -&gt; Root (Sum r a)
</span><a href="OAlg.Structure.Fibred.Definition.html#root"><span class="hs-identifier hs-var hs-var hs-var hs-var">root</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#Sum"><span class="hs-identifier hs-type">Sum</span></a></span><span> </span><span id="local-6989586621679393318"><span class="annot"><span class="annottext">SumForm r a
</span><a href="#local-6989586621679393318"><span class="hs-identifier hs-var">sf</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SumForm r a -&gt; Root (SumForm r a)
forall f. Fibred f =&gt; f -&gt; Root f
</span><a href="OAlg.Structure.Fibred.Definition.html#root"><span class="hs-identifier hs-var">root</span></a></span><span> </span><span class="annot"><span class="annottext">SumForm r a
</span><a href="#local-6989586621679393318"><span class="hs-identifier hs-var">sf</span></a></span><span>
</span><span id="line-255"></span><span>  </span><span>
</span><span id="line-256"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679392215"><span id="local-6989586621679392216"><span class="hs-special">(</span><span class="annot"><a href="OAlg.Structure.Fibred.Definition.html#Fibred"><span class="hs-identifier hs-type">Fibred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392215"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679392215"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Ring.Definition.html#Semiring"><span class="hs-identifier hs-type">Semiring</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392216"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Multiplicative.Definition.html#Commutative"><span class="hs-identifier hs-type">Commutative</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392216"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Structure.Additive.Definition.html#Additive"><span class="hs-identifier hs-type">Additive</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#Sum"><span class="hs-identifier hs-type">Sum</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392216"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392215"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-257"></span><span>  </span><span id="local-6989586621679393334"><span class="annot"><span class="annottext">zero :: Root (Sum r a) -&gt; Sum r a
</span><a href="#local-6989586621679393334"><span class="hs-identifier hs-var hs-var hs-var hs-var">zero</span></a></span></span><span> </span><span id="local-6989586621679393336"><span class="annot"><span class="annottext">Root (Sum r a)
</span><a href="#local-6989586621679393336"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SumForm r a -&gt; Sum r a
forall r a. SumForm r a -&gt; Sum r a
</span><a href="OAlg.Entity.Sum.Definition.html#Sum"><span class="hs-identifier hs-var">Sum</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Root a -&gt; SumForm r a
forall r a. Root a -&gt; SumForm r a
</span><a href="OAlg.Entity.Sum.Definition.html#Zero"><span class="hs-identifier hs-var">Zero</span></a></span><span> </span><span class="annot"><span class="annottext">Root a
Root (Sum r a)
</span><a href="#local-6989586621679393336"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-258"></span><span>  </span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#Sum"><span class="hs-identifier hs-type">Sum</span></a></span><span> </span><span id="local-6989586621679393342"><span class="annot"><span class="annottext">SumForm r a
</span><a href="#local-6989586621679393342"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679393343"><span class="annot"><span class="annottext">+ :: Sum r a -&gt; Sum r a -&gt; Sum r a
</span><a href="OAlg.Structure.Additive.Definition.html#%2B"><span class="hs-operator hs-var hs-var hs-var hs-var">+</span></a></span></span><span> </span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#Sum"><span class="hs-identifier hs-type">Sum</span></a></span><span> </span><span id="local-6989586621679393344"><span class="annot"><span class="annottext">SumForm r a
</span><a href="#local-6989586621679393344"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">SumForm r a -&gt; Root (SumForm r a)
forall f. Fibred f =&gt; f -&gt; Root f
</span><a href="OAlg.Structure.Fibred.Definition.html#root"><span class="hs-identifier hs-var">root</span></a></span><span> </span><span class="annot"><span class="annottext">SumForm r a
</span><a href="#local-6989586621679393342"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Root a -&gt; Root a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">SumForm r a -&gt; Root (SumForm r a)
forall f. Fibred f =&gt; f -&gt; Root f
</span><a href="OAlg.Structure.Fibred.Definition.html#root"><span class="hs-identifier hs-var">root</span></a></span><span> </span><span class="annot"><span class="annottext">SumForm r a
</span><a href="#local-6989586621679393344"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Form (Sum r a) -&gt; Sum r a
forall x. Constructable x =&gt; Form x -&gt; x
</span><a href="OAlg.Data.Constructable.html#make"><span class="hs-identifier hs-var">make</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SumForm r a
</span><a href="#local-6989586621679393342"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">SumForm r a -&gt; SumForm r a -&gt; SumForm r a
forall r a. SumForm r a -&gt; SumForm r a -&gt; SumForm r a
</span><a href="OAlg.Entity.Sum.Definition.html#%3A%2B"><span class="hs-operator hs-var">:+</span></a></span><span> </span><span class="annot"><span class="annottext">SumForm r a
</span><a href="#local-6989586621679393344"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-259"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ArithmeticException -&gt; Sum r a
forall a e. Exception e =&gt; e -&gt; a
</span><span class="hs-identifier hs-var">throw</span></span><span> </span><span class="annot"><span class="annottext">ArithmeticException
</span><a href="OAlg.Structure.Exception.html#NotAddable"><span class="hs-identifier hs-var">NotAddable</span></a></span><span>
</span><span id="line-260"></span><span>
</span><span id="line-261"></span><span>  </span><span id="local-6989586621679393348"><span class="annot"><span class="annottext">ntimes :: N -&gt; Sum r a -&gt; Sum r a
</span><a href="#local-6989586621679393348"><span class="hs-identifier hs-var hs-var hs-var hs-var">ntimes</span></a></span></span><span> </span><span id="local-6989586621679393350"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679393350"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#Sum"><span class="hs-identifier hs-type">Sum</span></a></span><span> </span><span id="local-6989586621679393351"><span class="annot"><span class="annottext">SumForm r a
</span><a href="#local-6989586621679393351"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Form (Sum r a) -&gt; Sum r a
forall x. Constructable x =&gt; Form x -&gt; x
</span><a href="OAlg.Data.Constructable.html#make"><span class="hs-identifier hs-var">make</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">N -&gt; r -&gt; r
forall a. Additive a =&gt; N -&gt; a -&gt; a
</span><a href="OAlg.Structure.Additive.Definition.html#ntimes"><span class="hs-identifier hs-var">ntimes</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679393350"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">r
forall r. Semiring r =&gt; r
</span><a href="OAlg.Structure.Ring.Definition.html#rOne"><span class="hs-identifier hs-var">rOne</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; SumForm r a -&gt; SumForm r a
forall r a. r -&gt; SumForm r a -&gt; SumForm r a
</span><a href="OAlg.Entity.Sum.Definition.html#%3A%21"><span class="hs-operator hs-var">:!</span></a></span><span> </span><span class="annot"><span class="annottext">SumForm r a
</span><a href="#local-6989586621679393351"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-262"></span><span>
</span><span id="line-263"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679392222"><span id="local-6989586621679392223"><span id="local-6989586621679393361"><span class="hs-special">(</span><span class="annot"><a href="OAlg.Structure.Fibred.Definition.html#Fibred"><span class="hs-identifier hs-type">Fibred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392222"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679392222"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Ring.Definition.html#Ring"><span class="hs-identifier hs-type">Ring</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392223"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Multiplicative.Definition.html#Commutative"><span class="hs-identifier hs-type">Commutative</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392223"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Structure.Additive.Definition.html#Abelian"><span class="hs-identifier hs-type">Abelian</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#Sum"><span class="hs-identifier hs-type">Sum</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392223"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392222"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-264"></span><span>  </span><span id="local-6989586621679393370"><span class="annot"><span class="annottext">negate :: Sum r a -&gt; Sum r a
</span><a href="#local-6989586621679393370"><span class="hs-identifier hs-var hs-var hs-var hs-var">negate</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#Sum"><span class="hs-identifier hs-type">Sum</span></a></span><span> </span><span id="local-6989586621679393372"><span class="annot"><span class="annottext">SumForm r a
</span><a href="#local-6989586621679393372"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Form (Sum r a) -&gt; Sum r a
forall x. Constructable x =&gt; Form x -&gt; x
</span><a href="OAlg.Data.Constructable.html#make"><span class="hs-identifier hs-var">make</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r -&gt; r
forall a. Abelian a =&gt; a -&gt; a
</span><a href="OAlg.Structure.Additive.Definition.html#negate"><span class="hs-identifier hs-var">negate</span></a></span><span> </span><span class="annot"><span class="annottext">r
forall r. Semiring r =&gt; r
</span><a href="OAlg.Structure.Ring.Definition.html#rOne"><span class="hs-identifier hs-var">rOne</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; SumForm r a -&gt; SumForm r a
forall r a. r -&gt; SumForm r a -&gt; SumForm r a
</span><a href="OAlg.Entity.Sum.Definition.html#%3A%21"><span class="hs-operator hs-var">:!</span></a></span><span> </span><span class="annot"><span class="annottext">SumForm r a
</span><a href="#local-6989586621679393372"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-265"></span><span>  </span><span id="local-6989586621679393376"><span class="annot"><span class="annottext">ztimes :: Z -&gt; Sum r a -&gt; Sum r a
</span><a href="#local-6989586621679393376"><span class="hs-identifier hs-var hs-var hs-var hs-var">ztimes</span></a></span></span><span> </span><span id="local-6989586621679393378"><span class="annot"><span class="annottext">Z
</span><a href="#local-6989586621679393378"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#Sum"><span class="hs-identifier hs-type">Sum</span></a></span><span> </span><span id="local-6989586621679393379"><span class="annot"><span class="annottext">SumForm r a
</span><a href="#local-6989586621679393379"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Form (Sum r a) -&gt; Sum r a
forall x. Constructable x =&gt; Form x -&gt; x
</span><a href="OAlg.Data.Constructable.html#make"><span class="hs-identifier hs-var">make</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Z -&gt; r -&gt; r
forall a. Abelian a =&gt; Z -&gt; a -&gt; a
</span><a href="OAlg.Structure.Additive.Definition.html#ztimes"><span class="hs-identifier hs-var">ztimes</span></a></span><span> </span><span class="annot"><span class="annottext">Z
</span><a href="#local-6989586621679393378"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">r
forall r. Semiring r =&gt; r
</span><a href="OAlg.Structure.Ring.Definition.html#rOne"><span class="hs-identifier hs-var">rOne</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; SumForm r a -&gt; SumForm r a
forall r a. r -&gt; SumForm r a -&gt; SumForm r a
</span><a href="OAlg.Entity.Sum.Definition.html#%3A%21"><span class="hs-operator hs-var">:!</span></a></span><span> </span><span class="annot"><span class="annottext">SumForm r a
</span><a href="#local-6989586621679393379"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-266"></span><span>
</span><span id="line-267"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679392229"><span id="local-6989586621679392230"><span class="hs-special">(</span><span class="annot"><a href="OAlg.Structure.Fibred.Definition.html#Fibred"><span class="hs-identifier hs-type">Fibred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392229"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679392229"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Ring.Definition.html#Semiring"><span class="hs-identifier hs-type">Semiring</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392230"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Multiplicative.Definition.html#Commutative"><span class="hs-identifier hs-type">Commutative</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392230"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Structure.Vectorial.Definition.html#Vectorial"><span class="hs-identifier hs-type">Vectorial</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#Sum"><span class="hs-identifier hs-type">Sum</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392230"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392229"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-268"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Scalar"><span class="annot"><a href="OAlg.Structure.Vectorial.Definition.html#Scalar"><span class="hs-identifier hs-var">Scalar</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#Sum"><span class="hs-identifier hs-type">Sum</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392230"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392229"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679392230"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-269"></span><span>  </span><span id="local-6989586621679393394"><span class="annot"><span class="annottext">Scalar (Sum r a)
</span><a href="#local-6989586621679393394"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679393395"><span class="annot"><span class="annottext">! :: Scalar (Sum r a) -&gt; Sum r a -&gt; Sum r a
</span><a href="#local-6989586621679393395"><span class="hs-operator hs-var hs-var hs-var hs-var">!</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#Sum"><span class="hs-identifier hs-type">Sum</span></a></span><span> </span><span id="local-6989586621679393397"><span class="annot"><span class="annottext">SumForm r a
</span><a href="#local-6989586621679393397"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Form (Sum r a) -&gt; Sum r a
forall x. Constructable x =&gt; Form x -&gt; x
</span><a href="OAlg.Data.Constructable.html#make"><span class="hs-identifier hs-var">make</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r
Scalar (Sum r a)
</span><a href="#local-6989586621679393394"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; SumForm r a -&gt; SumForm r a
forall r a. r -&gt; SumForm r a -&gt; SumForm r a
</span><a href="OAlg.Entity.Sum.Definition.html#%3A%21"><span class="hs-operator hs-var">:!</span></a></span><span> </span><span class="annot"><span class="annottext">SumForm r a
</span><a href="#local-6989586621679393397"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-270"></span><span>  </span><span>
</span><span id="line-271"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-272"></span><span class="hs-comment">-- smlc -</span><span>
</span><span id="line-273"></span><span>
</span><span id="line-274"></span><span class="hs-comment">-- | the associated linear combination.</span><span>
</span><span id="line-275"></span><span class="hs-comment">--</span><span>
</span><span id="line-276"></span><span class="hs-comment">-- __Note__ The associated linear combination of a sum is sorted according to the second component!</span><span>
</span><span id="line-277"></span><span id="local-6989586621679392231"><span id="local-6989586621679392232"><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#smlc"><span class="hs-identifier hs-type">smlc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.Structure.Ring.Definition.html#Semiring"><span class="hs-identifier hs-type">Semiring</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392231"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#Sum"><span class="hs-identifier hs-type">Sum</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392231"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392232"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#LinearCombination"><span class="hs-identifier hs-type">LinearCombination</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392231"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392232"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-278"></span><span id="smlc"><span class="annot"><span class="annottext">smlc :: forall r a. Semiring r =&gt; Sum r a -&gt; LinearCombination r a
</span><a href="OAlg.Entity.Sum.Definition.html#smlc"><span class="hs-identifier hs-var hs-var">smlc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Form (Sum r a) -&gt; LinearCombination r a)
-&gt; Sum r a -&gt; LinearCombination r a
forall x y. Exposable x =&gt; (Form x -&gt; y) -&gt; x -&gt; y
</span><a href="OAlg.Data.Constructable.html#restrict"><span class="hs-identifier hs-var">restrict</span></a></span><span> </span><span class="annot"><span class="annottext">Form (Sum r a) -&gt; LinearCombination r a
SumForm r a -&gt; LinearCombination r a
forall r a. Semiring r =&gt; SumForm r a -&gt; LinearCombination r a
</span><a href="OAlg.Entity.Sum.Definition.html#smflc"><span class="hs-identifier hs-var">smflc</span></a></span><span>
</span><span id="line-279"></span><span>
</span><span id="line-280"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-281"></span><span class="hs-comment">-- smJoin -</span><span>
</span><span id="line-282"></span><span>
</span><span id="line-283"></span><span class="annot"><span class="hs-comment">-- | joining a sum of sums.</span></span><span>
</span><span id="line-284"></span><span id="local-6989586621679392237"><span id="local-6989586621679392238"><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#smJoin"><span class="hs-identifier hs-type">smJoin</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Structure.Ring.Definition.html#Semiring"><span class="hs-identifier hs-type">Semiring</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392237"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Multiplicative.Definition.html#Commutative"><span class="hs-identifier hs-type">Commutative</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392237"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Fibred.Definition.html#Fibred"><span class="hs-identifier hs-type">Fibred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392238"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679392238"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#Sum"><span class="hs-identifier hs-type">Sum</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392237"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#Sum"><span class="hs-identifier hs-type">Sum</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392237"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392238"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#Sum"><span class="hs-identifier hs-type">Sum</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392237"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392238"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-285"></span><span id="smJoin"><span class="annot"><span class="annottext">smJoin :: forall r a.
(Semiring r, Commutative r, Fibred a, Ord a) =&gt;
Sum r (Sum r a) -&gt; Sum r a
</span><a href="OAlg.Entity.Sum.Definition.html#smJoin"><span class="hs-identifier hs-var hs-var">smJoin</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Form (Sum r a) -&gt; Sum r a
SumForm r a -&gt; Sum r a
forall x. Constructable x =&gt; Form x -&gt; x
</span><a href="OAlg.Data.Constructable.html#make"><span class="hs-identifier hs-var">make</span></a></span><span> </span><span class="annot"><span class="annottext">(SumForm r a -&gt; Sum r a)
-&gt; (Sum r (Sum r a) -&gt; SumForm r a) -&gt; Sum r (Sum r a) -&gt; Sum r a
forall y z x. (y -&gt; z) -&gt; (x -&gt; y) -&gt; x -&gt; z
forall (c :: * -&gt; * -&gt; *) y z x.
Category c =&gt;
c y z -&gt; c x y -&gt; c x z
</span><a href="OAlg.Category.Definition.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">SumForm r (SumForm r a) -&gt; SumForm r a
forall r a. SumForm r (SumForm r a) -&gt; SumForm r a
</span><a href="OAlg.Entity.Sum.Definition.html#smfJoin"><span class="hs-identifier hs-var">smfJoin</span></a></span><span> </span><span class="annot"><span class="annottext">(SumForm r (SumForm r a) -&gt; SumForm r a)
-&gt; (Sum r (Sum r a) -&gt; SumForm r (SumForm r a))
-&gt; Sum r (Sum r a)
-&gt; SumForm r a
forall y z x. (y -&gt; z) -&gt; (x -&gt; y) -&gt; x -&gt; z
forall (c :: * -&gt; * -&gt; *) y z x.
Category c =&gt;
c y z -&gt; c x y -&gt; c x z
</span><a href="OAlg.Category.Definition.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(Form (Sum r (Sum r a)) -&gt; SumForm r (SumForm r a))
-&gt; Sum r (Sum r a) -&gt; SumForm r (SumForm r a)
forall x y. Exposable x =&gt; (Form x -&gt; y) -&gt; x -&gt; y
</span><a href="OAlg.Data.Constructable.html#restrict"><span class="hs-identifier hs-var">restrict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Root (Sum r a) -&gt; SumForm r (SumForm r a))
-&gt; (r -&gt; SumForm r (SumForm r a) -&gt; SumForm r (SumForm r a))
-&gt; (SumForm r (SumForm r a)
    -&gt; SumForm r (SumForm r a) -&gt; SumForm r (SumForm r a))
-&gt; (Sum r a -&gt; SumForm r (SumForm r a))
-&gt; SumForm r (Sum r a)
-&gt; SumForm r (SumForm r a)
forall x y r.
(Root x -&gt; y)
-&gt; (r -&gt; y -&gt; y) -&gt; (y -&gt; y -&gt; y) -&gt; (x -&gt; y) -&gt; SumForm r x -&gt; y
</span><a href="OAlg.Entity.Sum.Definition.html#smfSum"><span class="hs-identifier hs-var">smfSum</span></a></span><span> </span><span class="annot"><span class="annottext">Root (Sum r a) -&gt; SumForm r (SumForm r a)
Root (SumForm r a) -&gt; SumForm r (SumForm r a)
forall r a. Root a -&gt; SumForm r a
</span><a href="OAlg.Entity.Sum.Definition.html#Zero"><span class="hs-identifier hs-var">Zero</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; SumForm r (SumForm r a) -&gt; SumForm r (SumForm r a)
forall r a. r -&gt; SumForm r a -&gt; SumForm r a
</span><a href="OAlg.Entity.Sum.Definition.html#%3A%21"><span class="hs-operator hs-var">(:!)</span></a></span><span> </span><span class="annot"><span class="annottext">SumForm r (SumForm r a)
-&gt; SumForm r (SumForm r a) -&gt; SumForm r (SumForm r a)
forall r a. SumForm r a -&gt; SumForm r a -&gt; SumForm r a
</span><a href="OAlg.Entity.Sum.Definition.html#%3A%2B"><span class="hs-operator hs-var">(:+)</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SumForm r a -&gt; SumForm r (SumForm r a)
forall r a. a -&gt; SumForm r a
</span><a href="OAlg.Entity.Sum.Definition.html#S"><span class="hs-identifier hs-var">S</span></a></span><span> </span><span class="annot"><span class="annottext">(SumForm r a -&gt; SumForm r (SumForm r a))
-&gt; (Sum r a -&gt; SumForm r a) -&gt; Sum r a -&gt; SumForm r (SumForm r a)
forall y z x. (y -&gt; z) -&gt; (x -&gt; y) -&gt; x -&gt; z
forall (c :: * -&gt; * -&gt; *) y z x.
Category c =&gt;
c y z -&gt; c x y -&gt; c x z
</span><a href="OAlg.Category.Definition.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Sum r a -&gt; Form (Sum r a)
Sum r a -&gt; SumForm r a
forall x. Exposable x =&gt; x -&gt; Form x
</span><a href="OAlg.Data.Constructable.html#form"><span class="hs-identifier hs-var">form</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-286"></span><span>
</span><span id="line-287"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-288"></span><span class="hs-comment">-- smMap -</span><span>
</span><span id="line-289"></span><span>
</span><span id="line-290"></span><span class="annot"><span class="hs-comment">-- | additive homomorphism to a totally defined sum.</span></span><span>
</span><span id="line-291"></span><span id="local-6989586621679392241"><span id="local-6989586621679392242"><span id="local-6989586621679392243"><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#smMap"><span class="hs-identifier hs-type">smMap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Data.Singleton.html#Singleton"><span class="hs-identifier hs-type">Singleton</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Structure.Fibred.Definition.html#Root"><span class="hs-identifier hs-type">Root</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392241"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Fibred.Definition.html#Fibred"><span class="hs-identifier hs-type">Fibred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392241"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679392241"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Ring.Definition.html#Semiring"><span class="hs-identifier hs-type">Semiring</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392242"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Multiplicative.Definition.html#Commutative"><span class="hs-identifier hs-type">Commutative</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392242"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-292"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679392243"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679392241"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#Sum"><span class="hs-identifier hs-type">Sum</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392242"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392243"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#Sum"><span class="hs-identifier hs-type">Sum</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392242"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392241"><span class="hs-identifier hs-type">y</span></a></span></span></span></span><span>
</span><span id="line-293"></span><span id="smMap"><span class="annot"><span class="annottext">smMap :: forall y r x.
(Singleton (Root y), Fibred y, Ord y, Semiring r, Commutative r) =&gt;
(x -&gt; y) -&gt; Sum r x -&gt; Sum r y
</span><a href="OAlg.Entity.Sum.Definition.html#smMap"><span class="hs-identifier hs-var hs-var">smMap</span></a></span></span><span> </span><span id="local-6989586621679393419"><span class="annot"><span class="annottext">x -&gt; y
</span><a href="#local-6989586621679393419"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#Sum"><span class="hs-identifier hs-type">Sum</span></a></span><span> </span><span id="local-6989586621679393420"><span class="annot"><span class="annottext">SumForm r x
</span><a href="#local-6989586621679393420"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Form (Sum r y) -&gt; Sum r y
forall x. Constructable x =&gt; Form x -&gt; x
</span><a href="OAlg.Data.Constructable.html#make"><span class="hs-identifier hs-var">make</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(x -&gt; y) -&gt; SumForm r x -&gt; SumForm r y
forall y x r.
Singleton (Root y) =&gt;
(x -&gt; y) -&gt; SumForm r x -&gt; SumForm r y
</span><a href="OAlg.Entity.Sum.Definition.html#smfMap"><span class="hs-identifier hs-var">smfMap</span></a></span><span> </span><span class="annot"><span class="annottext">x -&gt; y
</span><a href="#local-6989586621679393419"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">SumForm r x
</span><a href="#local-6989586621679393420"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-294"></span><span>
</span><span id="line-295"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-296"></span><span class="hs-comment">-- nSum -</span><span>
</span><span id="line-297"></span><span>
</span><span id="line-298"></span><span class="annot"><span class="hs-comment">-- | additive homomorphism for sums over 'N'.</span></span><span>
</span><span id="line-299"></span><span id="local-6989586621679392248"><span id="local-6989586621679392250"><span id="local-6989586621679392251"><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#nSum"><span class="hs-identifier hs-type">nSum</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Hom.Definition.html#Hom"><span class="hs-identifier hs-type">Hom</span></a></span><span> </span><span class="annot"><a href="OAlg.Structure.Fibred.Definition.html#Fbr"><span class="hs-identifier hs-type">Fbr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392248"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">,</span><span class="annot"><a href="OAlg.Structure.Additive.Definition.html#Additive"><span class="hs-identifier hs-type">Additive</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392250"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679392248"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392251"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392250"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#Sum"><span class="hs-identifier hs-type">Sum</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392251"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679392250"><span class="hs-identifier hs-type">x</span></a></span></span></span></span><span>
</span><span id="line-300"></span><span id="nSum"><span class="annot"><span class="annottext">nSum :: forall (h :: * -&gt; * -&gt; *) x a.
(Hom Fbr h, Additive x) =&gt;
h a x -&gt; Sum N a -&gt; x
</span><a href="OAlg.Entity.Sum.Definition.html#nSum"><span class="hs-identifier hs-var hs-var">nSum</span></a></span></span><span> </span><span id="local-6989586621679393433"><span class="annot"><span class="annottext">h a x
</span><a href="#local-6989586621679393433"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Form (Sum N a) -&gt; x) -&gt; Sum N a -&gt; x
forall x y. Exposable x =&gt; (Form x -&gt; y) -&gt; x -&gt; y
</span><a href="OAlg.Data.Constructable.html#restrict"><span class="hs-identifier hs-var">restrict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Root a -&gt; x)
-&gt; (N -&gt; x -&gt; x) -&gt; (x -&gt; x -&gt; x) -&gt; (a -&gt; x) -&gt; SumForm N a -&gt; x
forall x y r.
(Root x -&gt; y)
-&gt; (r -&gt; y -&gt; y) -&gt; (y -&gt; y -&gt; y) -&gt; (x -&gt; y) -&gt; SumForm r x -&gt; y
</span><a href="OAlg.Entity.Sum.Definition.html#smfSum"><span class="hs-identifier hs-var">smfSum</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Root x -&gt; x
forall a. Additive a =&gt; Root a -&gt; a
</span><a href="OAlg.Structure.Additive.Definition.html#zero"><span class="hs-identifier hs-var">zero</span></a></span><span> </span><span class="annot"><span class="annottext">(Root x -&gt; x) -&gt; (Root a -&gt; Root x) -&gt; Root a -&gt; x
forall y z x. (y -&gt; z) -&gt; (x -&gt; y) -&gt; x -&gt; z
forall (c :: * -&gt; * -&gt; *) y z x.
Category c =&gt;
c y z -&gt; c x y -&gt; c x z
</span><a href="OAlg.Category.Definition.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">h a x -&gt; Root a -&gt; Root x
forall a b. h a b -&gt; Root a -&gt; Root b
forall (h :: * -&gt; * -&gt; *) a b.
HomFibred h =&gt;
h a b -&gt; Root a -&gt; Root b
</span><a href="OAlg.Hom.Fibred.html#rmap"><span class="hs-identifier hs-var">rmap</span></a></span><span> </span><span class="annot"><span class="annottext">h a x
</span><a href="#local-6989586621679393433"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">N -&gt; x -&gt; x
forall a. Additive a =&gt; N -&gt; a -&gt; a
</span><a href="OAlg.Structure.Additive.Definition.html#ntimes"><span class="hs-identifier hs-var">ntimes</span></a></span><span> </span><span class="annot"><span class="annottext">x -&gt; x -&gt; x
forall a. Additive a =&gt; a -&gt; a -&gt; a
</span><a href="OAlg.Structure.Additive.Definition.html#%2B"><span class="hs-operator hs-var">(+)</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">h a x -&gt; a -&gt; x
forall a b. h a b -&gt; a -&gt; b
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><a href="OAlg.Category.Applicative.html#amap"><span class="hs-identifier hs-var">amap</span></a></span><span> </span><span class="annot"><span class="annottext">h a x
</span><a href="#local-6989586621679393433"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-301"></span><span>
</span><span id="line-302"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-303"></span><span class="hs-comment">-- zSum -</span><span>
</span><span id="line-304"></span><span>
</span><span id="line-305"></span><span class="annot"><span class="hs-comment">-- | additive homomorphism for sums over 'Z'.</span></span><span>
</span><span id="line-306"></span><span id="local-6989586621679392262"><span id="local-6989586621679392263"><span id="local-6989586621679392264"><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#zSum"><span class="hs-identifier hs-type">zSum</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Hom.Definition.html#Hom"><span class="hs-identifier hs-type">Hom</span></a></span><span> </span><span class="annot"><a href="OAlg.Structure.Fibred.Definition.html#Fbr"><span class="hs-identifier hs-type">Fbr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392262"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">,</span><span class="annot"><a href="OAlg.Structure.Additive.Definition.html#Abelian"><span class="hs-identifier hs-type">Abelian</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392263"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679392262"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392264"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392263"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Sum.Definition.html#Sum"><span class="hs-identifier hs-type">Sum</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#Z"><span class="hs-identifier hs-type">Z</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679392264"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679392263"><span class="hs-identifier hs-type">x</span></a></span></span></span></span><span>
</span><span id="line-307"></span><span id="zSum"><span class="annot"><span class="annottext">zSum :: forall (h :: * -&gt; * -&gt; *) x a.
(Hom Fbr h, Abelian x) =&gt;
h a x -&gt; Sum Z a -&gt; x
</span><a href="OAlg.Entity.Sum.Definition.html#zSum"><span class="hs-identifier hs-var hs-var">zSum</span></a></span></span><span> </span><span id="local-6989586621679393449"><span class="annot"><span class="annottext">h a x
</span><a href="#local-6989586621679393449"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Form (Sum Z a) -&gt; x) -&gt; Sum Z a -&gt; x
forall x y. Exposable x =&gt; (Form x -&gt; y) -&gt; x -&gt; y
</span><a href="OAlg.Data.Constructable.html#restrict"><span class="hs-identifier hs-var">restrict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Root a -&gt; x)
-&gt; (Z -&gt; x -&gt; x) -&gt; (x -&gt; x -&gt; x) -&gt; (a -&gt; x) -&gt; SumForm Z a -&gt; x
forall x y r.
(Root x -&gt; y)
-&gt; (r -&gt; y -&gt; y) -&gt; (y -&gt; y -&gt; y) -&gt; (x -&gt; y) -&gt; SumForm r x -&gt; y
</span><a href="OAlg.Entity.Sum.Definition.html#smfSum"><span class="hs-identifier hs-var">smfSum</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Root x -&gt; x
forall a. Additive a =&gt; Root a -&gt; a
</span><a href="OAlg.Structure.Additive.Definition.html#zero"><span class="hs-identifier hs-var">zero</span></a></span><span> </span><span class="annot"><span class="annottext">(Root x -&gt; x) -&gt; (Root a -&gt; Root x) -&gt; Root a -&gt; x
forall y z x. (y -&gt; z) -&gt; (x -&gt; y) -&gt; x -&gt; z
forall (c :: * -&gt; * -&gt; *) y z x.
Category c =&gt;
c y z -&gt; c x y -&gt; c x z
</span><a href="OAlg.Category.Definition.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">h a x -&gt; Root a -&gt; Root x
forall a b. h a b -&gt; Root a -&gt; Root b
forall (h :: * -&gt; * -&gt; *) a b.
HomFibred h =&gt;
h a b -&gt; Root a -&gt; Root b
</span><a href="OAlg.Hom.Fibred.html#rmap"><span class="hs-identifier hs-var">rmap</span></a></span><span> </span><span class="annot"><span class="annottext">h a x
</span><a href="#local-6989586621679393449"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Z -&gt; x -&gt; x
forall a. Abelian a =&gt; Z -&gt; a -&gt; a
</span><a href="OAlg.Structure.Additive.Definition.html#ztimes"><span class="hs-identifier hs-var">ztimes</span></a></span><span> </span><span class="annot"><span class="annottext">x -&gt; x -&gt; x
forall a. Additive a =&gt; a -&gt; a -&gt; a
</span><a href="OAlg.Structure.Additive.Definition.html#%2B"><span class="hs-operator hs-var">(+)</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">h a x -&gt; a -&gt; x
forall a b. h a b -&gt; a -&gt; b
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><a href="OAlg.Category.Applicative.html#amap"><span class="hs-identifier hs-var">amap</span></a></span><span> </span><span class="annot"><span class="annottext">h a x
</span><a href="#local-6989586621679393449"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-308"></span><span>
</span><span id="line-309"></span></pre></body></html>