<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE NoImplicitPrelude #-}</span><span>
</span><span id="line-3"></span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE TypeOperators #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE GADTs, StandaloneDeriving #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE ConstraintKinds #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE KindSignatures #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE DataKinds #-}</span><span>
</span><span id="line-11"></span><span>
</span><span id="line-12"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- Module      : OAlg.Structure.Number.Definition</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- Description : definition of numbers as ordered semi rings with infinitely many elements</span><span>
</span><span id="line-15"></span><span class="hs-comment">-- Copyright   : (c) Erich Gut</span><span>
</span><span id="line-16"></span><span class="hs-comment">-- License     : BSD3</span><span>
</span><span id="line-17"></span><span class="hs-comment">-- Maintainer  : zerich.gut@gmail.com</span><span>
</span><span id="line-18"></span><span class="hs-comment">-- </span><span>
</span><span id="line-19"></span><span class="hs-comment">-- definition of numbers as ordered 'Semiring' with infinitely many elements.</span><span>
</span><span id="line-20"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">OAlg.Structure.Number.Definition</span><span>
</span><span id="line-21"></span><span>  </span><span class="hs-special">(</span><span>
</span><span id="line-22"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Number</span></span><span>
</span><span id="line-23"></span><span>    </span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Number"><span class="hs-identifier">Number</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#zFloor"><span class="hs-identifier">zFloor</span></a></span><span>
</span><span id="line-24"></span><span>
</span><span id="line-25"></span><span>    </span><span class="annot"><span class="hs-comment">-- | digital represenation of numbers</span></span><span>
</span><span id="line-26"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#toDigits"><span class="hs-identifier">toDigits</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Digits"><span class="hs-identifier">Digits</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#toDigitsFinite"><span class="hs-identifier">toDigitsFinite</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#fromDigits"><span class="hs-identifier">fromDigits</span></a></span><span>
</span><span id="line-28"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#dgsBase"><span class="hs-identifier">dgsBase</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#dgsProxy"><span class="hs-identifier">dgsProxy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#dgsFrcTake"><span class="hs-identifier">dgsFrcTake</span></a></span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Integral</span></span><span>
</span><span id="line-31"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Integral"><span class="hs-identifier">Integral</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#primes"><span class="hs-identifier">primes</span></a></span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Acyclic</span></span><span>
</span><span id="line-34"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Acyclic"><span class="hs-identifier">Acyclic</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Fractional</span></span><span>
</span><span id="line-37"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Fractional"><span class="hs-identifier">Fractional</span></a></span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Measurable</span></span><span>
</span><span id="line-40"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Measurable"><span class="hs-identifier">Measurable</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-43"></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Prelude</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">A</span></span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Proxy</span></span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="OAlg.Prelude.html"><span class="hs-identifier">OAlg.Prelude</span></a></span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="OAlg.Data.TypeLits.html"><span class="hs-identifier">OAlg.Data.TypeLits</span></a></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="OAlg.Data.Canonical.html"><span class="hs-identifier">OAlg.Data.Canonical</span></a></span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html"><span class="hs-identifier">OAlg.Structure.Oriented.Definition</span></a></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="OAlg.Structure.Multiplicative.Definition.html"><span class="hs-identifier">OAlg.Structure.Multiplicative.Definition</span></a></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="OAlg.Structure.Additive.Definition.html"><span class="hs-identifier">OAlg.Structure.Additive.Definition</span></a></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="OAlg.Structure.Distributive.Definition.html"><span class="hs-identifier">OAlg.Structure.Distributive.Definition</span></a></span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="OAlg.Structure.Ring.Definition.html"><span class="hs-identifier">OAlg.Structure.Ring.Definition</span></a></span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-60"></span><span class="hs-comment">-- Number -</span><span>
</span><span id="line-61"></span><span>
</span><span id="line-62"></span><span class="hs-comment">-- | ordered commutative semi ring where v'+' and v'*' respect the given ordering.</span><span>
</span><span id="line-63"></span><span class="hs-comment">--</span><span>
</span><span id="line-64"></span><span class="hs-comment">-- __Definitions__</span><span>
</span><span id="line-65"></span><span class="hs-comment">--</span><span>
</span><span id="line-66"></span><span class="hs-comment">-- (1) A number @x@ is called __/positive/__ if @0 &lt; x@ and __/negative/__ if @x &lt; 0@.</span><span>
</span><span id="line-67"></span><span class="hs-comment">--</span><span>
</span><span id="line-68"></span><span class="hs-comment">-- (2) A number structure is called __/positive/__ if it contains no negative elements.</span><span>
</span><span id="line-69"></span><span class="hs-comment">--</span><span>
</span><span id="line-70"></span><span class="hs-comment">-- __Properties__</span><span>
</span><span id="line-71"></span><span class="hs-comment">--</span><span>
</span><span id="line-72"></span><span class="hs-comment">-- (1) @1@ is positive.</span><span>
</span><span id="line-73"></span><span class="hs-comment">--</span><span>
</span><span id="line-74"></span><span class="hs-comment">-- (2) For all @x &lt; y@ and @z@ holds: @x v'+' z &lt; y v'+' z@</span><span>
</span><span id="line-75"></span><span class="hs-comment">--</span><span>
</span><span id="line-76"></span><span class="hs-comment">-- (3) For all @0 &lt; x@, @0 &lt; y@ holds: @0 &lt; x v'*' y@.</span><span>
</span><span id="line-77"></span><span class="hs-comment">--</span><span>
</span><span id="line-78"></span><span class="hs-comment">-- (4) For all @x@ holds: @x == 'signum' x v'*' 'abs' x@.</span><span>
</span><span id="line-79"></span><span class="hs-comment">--</span><span>
</span><span id="line-80"></span><span class="hs-comment">-- (5) For all @x@ holds: @'floor' x  v'+' 'fraction' x == x@.</span><span>
</span><span id="line-81"></span><span class="hs-comment">--</span><span>
</span><span id="line-82"></span><span class="hs-comment">-- __Note__</span><span>
</span><span id="line-83"></span><span class="hs-comment">--</span><span>
</span><span id="line-84"></span><span class="hs-comment">-- (1) A not positive structure of numbers contain always also the additive inverse of @1@</span><span>
</span><span id="line-85"></span><span class="hs-comment">-- which is negative.</span><span>
</span><span id="line-86"></span><span class="hs-comment">--</span><span>
</span><span id="line-87"></span><span class="hs-comment">-- (2) Structures of numbers have infinitely many values, because from the</span><span>
</span><span id="line-88"></span><span class="hs-comment">-- properties above follows that</span><span>
</span><span id="line-89"></span><span class="hs-comment">-- @0 &lt; 1 &lt; 2 &lt; .. &lt; 'ntimes' n 1 &lt; 'ntimes' (n v'+' 1) 1 &lt; .. @ for all @0 &lt;= n@.</span><span>
</span><span id="line-90"></span><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Structure.Ring.Definition.html#Semiring"><span class="hs-identifier hs-type">Semiring</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377675"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Multiplicative.Definition.html#Commutative"><span class="hs-identifier hs-type">Commutative</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377675"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679377675"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="Number"><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Number"><span class="hs-identifier hs-var">Number</span></a></span></span><span> </span><span id="local-6989586621679377675"><span class="annot"><a href="#local-6989586621679377675"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-91"></span><span>  </span><span class="hs-pragma">{-# MINIMAL</span><span> </span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#minusOne"><span class="hs-pragma hs-type">minusOne</span></a></span><span class="hs-pragma">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#zFloorFraction"><span class="hs-pragma hs-type">zFloorFraction</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span>  </span><span class="hs-comment">-- | the additive inverse of @1@ - if it exists - and will be</span><span>
</span><span id="line-94"></span><span>  </span><span class="hs-comment">--   denoted by @-1@ (see the note above).</span><span>
</span><span id="line-95"></span><span>  </span><span id="minusOne"><span class="annot"><a href="OAlg.Structure.Number.Definition.html#minusOne"><span class="hs-identifier hs-type">minusOne</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679377675"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-96"></span><span>
</span><span id="line-97"></span><span>  </span><span class="hs-comment">-- | sign of a number.</span><span>
</span><span id="line-98"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-99"></span><span>  </span><span class="hs-comment">-- __Property__ For all @x@ holds: if @0 &lt; x@ then @signum x == 1@ and if @x == 0@</span><span>
</span><span id="line-100"></span><span>  </span><span class="hs-comment">-- then @signum x == 0@ and if @x &lt; 0@ then @signum x == -1@ (for @-1@ see @'minusOne'@).</span><span>
</span><span id="line-101"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-102"></span><span>  </span><span class="hs-comment">-- __Note__ The default implementation is:</span><span>
</span><span id="line-103"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-104"></span><span>  </span><span class="hs-comment">-- @</span><span>
</span><span id="line-105"></span><span>  </span><span class="hs-comment">-- signum x = case rZero `compare` x of</span><span>
</span><span id="line-106"></span><span>  </span><span class="hs-comment">--              GT -&gt; rOne</span><span>
</span><span id="line-107"></span><span>  </span><span class="hs-comment">--              EQ -&gt; rZero</span><span>
</span><span id="line-108"></span><span>  </span><span class="hs-comment">--              LT -&gt; e where Just e = minusOne</span><span>
</span><span id="line-109"></span><span>  </span><span class="hs-comment">-- @</span><span>
</span><span id="line-110"></span><span>  </span><span id="signum"><span class="annot"><a href="OAlg.Structure.Number.Definition.html#signum"><span class="hs-identifier hs-type">signum</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679377675"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679377675"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-111"></span><span>  </span><span id="local-6989586621679377877"><span class="annot"><a href="OAlg.Structure.Number.Definition.html#signum"><span class="hs-identifier hs-var hs-var">signum</span></a></span><span> </span><span id="local-6989586621679377919"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679377919"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">r
forall r. Semiring r =&gt; r
</span><a href="OAlg.Structure.Ring.Definition.html#rZero"><span class="hs-identifier hs-var">rZero</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-operator hs-var">`compare`</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679377919"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-112"></span><span>             </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">GT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">r
forall r. Semiring r =&gt; r
</span><a href="OAlg.Structure.Ring.Definition.html#rOne"><span class="hs-identifier hs-var">rOne</span></a></span><span>
</span><span id="line-113"></span><span>             </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">EQ</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">r
forall r. Semiring r =&gt; r
</span><a href="OAlg.Structure.Ring.Definition.html#rZero"><span class="hs-identifier hs-var">rZero</span></a></span><span>
</span><span id="line-114"></span><span>             </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">LT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679377923"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">where</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679377923"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679377923"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe r
forall r. Number r =&gt; Maybe r
</span><a href="OAlg.Structure.Number.Definition.html#minusOne"><span class="hs-identifier hs-var">minusOne</span></a></span></span><span>
</span><span id="line-115"></span><span>             </span><span>
</span><span id="line-116"></span><span>  </span><span class="hs-comment">-- | absolute value of a number.</span><span>
</span><span id="line-117"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-118"></span><span>  </span><span class="hs-comment">-- __Definition__ The __/absolute value/__ of a @x@ is defined by</span><span>
</span><span id="line-119"></span><span>  </span><span class="hs-comment">-- @abs x = 'signum' x v'*' x@ (which serves as the default implementation).</span><span>
</span><span id="line-120"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-121"></span><span>  </span><span class="hs-comment">-- __Properties__ For all @x@ holds:</span><span>
</span><span id="line-122"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-123"></span><span>  </span><span class="hs-comment">-- (1) @0 &lt;= abs x@.</span><span>
</span><span id="line-124"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-125"></span><span>  </span><span class="hs-comment">-- (2) if @0 &lt;= x@ then @abs x == x@.</span><span>
</span><span id="line-126"></span><span>  </span><span id="abs"><span class="annot"><a href="OAlg.Structure.Number.Definition.html#abs"><span class="hs-identifier hs-type">abs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679377675"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679377675"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-127"></span><span>  </span><span id="local-6989586621679378009"><span class="annot"><a href="OAlg.Structure.Number.Definition.html#abs"><span class="hs-identifier hs-var hs-var">abs</span></a></span><span> </span><span id="local-6989586621679378015"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679378015"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r -&gt; r
forall r. Number r =&gt; r -&gt; r
</span><a href="OAlg.Structure.Number.Definition.html#signum"><span class="hs-identifier hs-var">signum</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679378015"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall c. Multiplicative c =&gt; c -&gt; c -&gt; c
</span><a href="OAlg.Structure.Multiplicative.Definition.html#%2A"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679378015"><span class="hs-identifier hs-var">x</span></a></span></span><span>
</span><span id="line-128"></span><span>
</span><span id="line-129"></span><span>  </span><span class="hs-comment">-- | floor of a value of a number.</span><span>
</span><span id="line-130"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-131"></span><span>  </span><span class="hs-comment">-- __Properties__</span><span>
</span><span id="line-132"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-133"></span><span>  </span><span class="hs-comment">-- (1) @floor 0 == 0@.</span><span>
</span><span id="line-134"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-135"></span><span>  </span><span class="hs-comment">-- (2) For all @x@ holds: @floor (x v'+' 1) = floor x v'+' 1@.</span><span>
</span><span id="line-136"></span><span>  </span><span id="floor"><span class="annot"><a href="OAlg.Structure.Number.Definition.html#floor"><span class="hs-identifier hs-type">floor</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679377675"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679377675"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-137"></span><span>  </span><span id="local-6989586621679378016"><span class="annot"><a href="OAlg.Structure.Number.Definition.html#floor"><span class="hs-identifier hs-var hs-var">floor</span></a></span><span> </span><span id="local-6989586621679378029"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679378029"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">N -&gt; r -&gt; r
forall a. Additive a =&gt; N -&gt; a -&gt; a
</span><a href="OAlg.Structure.Additive.Definition.html#ntimes"><span class="hs-identifier hs-var">ntimes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Z -&gt; N
forall a b. Projectible a b =&gt; b -&gt; a
</span><a href="OAlg.Data.Canonical.html#prj"><span class="hs-identifier hs-var">prj</span></a></span><span> </span><span class="annot"><span class="annottext">(Z -&gt; N) -&gt; Z -&gt; N
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><a href="OAlg.Category.Applicative.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Z, r) -&gt; Z
forall a b. (a, b) -&gt; a
</span><a href="OAlg.Category.Definition.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">((Z, r) -&gt; Z) -&gt; (Z, r) -&gt; Z
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><a href="OAlg.Category.Applicative.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; (Z, r)
forall r. Number r =&gt; r -&gt; (Z, r)
</span><a href="OAlg.Structure.Number.Definition.html#zFloorFraction"><span class="hs-identifier hs-var">zFloorFraction</span></a></span><span> </span><span class="annot"><span class="annottext">(r -&gt; (Z, r)) -&gt; r -&gt; (Z, r)
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><a href="OAlg.Category.Applicative.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679378029"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r -&gt; r
forall r. Number r =&gt; r -&gt; r
</span><a href="OAlg.Structure.Number.Definition.html#signum"><span class="hs-identifier hs-var">signum</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679378029"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-138"></span><span>
</span><span id="line-139"></span><span>  </span><span class="hs-comment">-- | fractional part of a number.</span><span>
</span><span id="line-140"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-141"></span><span>  </span><span class="hs-comment">-- __Property__ For all @x@ holds: 0 &lt;= fraction x &lt; 1.</span><span>
</span><span id="line-142"></span><span>  </span><span id="fraction"><span class="annot"><a href="OAlg.Structure.Number.Definition.html#fraction"><span class="hs-identifier hs-type">fraction</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679377675"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679377675"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-143"></span><span>  </span><span id="local-6989586621679378033"><span class="annot"><a href="OAlg.Structure.Number.Definition.html#fraction"><span class="hs-identifier hs-var hs-var">fraction</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Z, r) -&gt; r
forall a b. (a, b) -&gt; b
</span><a href="OAlg.Category.Definition.html#snd"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">((Z, r) -&gt; r) -&gt; (r -&gt; (Z, r)) -&gt; r -&gt; r
forall y z x. (y -&gt; z) -&gt; (x -&gt; y) -&gt; x -&gt; z
forall (c :: * -&gt; * -&gt; *) y z x.
Category c =&gt;
c y z -&gt; c x y -&gt; c x z
</span><a href="OAlg.Category.Definition.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; (Z, r)
forall r. Number r =&gt; r -&gt; (Z, r)
</span><a href="OAlg.Structure.Number.Definition.html#zFloorFraction"><span class="hs-identifier hs-var">zFloorFraction</span></a></span></span><span>
</span><span id="line-144"></span><span>
</span><span id="line-145"></span><span>  </span><span class="hs-comment">-- | simultaneous evaluation of @'floor'@ - represented as an integer - and its</span><span>
</span><span id="line-146"></span><span>  </span><span class="hs-comment">-- @'fraction'@.</span><span>
</span><span id="line-147"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-148"></span><span>  </span><span class="hs-comment">-- __Properties__ For all @x@ holds:</span><span>
</span><span id="line-149"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-150"></span><span>  </span><span class="hs-comment">-- (1) @'floor' x == 'ntimes' ('prj' '$' fst '$' 'zFloorFraction' '$' x) ('signum' x)@.</span><span>
</span><span id="line-151"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-152"></span><span>  </span><span class="hs-comment">-- (2) @'fraction' x == 'snd' '.' 'zFloorFraction'@.</span><span>
</span><span id="line-153"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-154"></span><span>  </span><span class="hs-comment">-- __Note__ This properties are used for the default implementation of @'floor'@</span><span>
</span><span id="line-155"></span><span>  </span><span class="hs-comment">-- and @'fraction'@.</span><span>
</span><span id="line-156"></span><span>  </span><span id="zFloorFraction"><span class="annot"><a href="OAlg.Structure.Number.Definition.html#zFloorFraction"><span class="hs-identifier hs-type">zFloorFraction</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679377675"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Data.Number.html#Z"><span class="hs-identifier hs-type">Z</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679377675"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-157"></span><span>
</span><span id="line-158"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-159"></span><span class="hs-comment">-- zFloor -</span><span>
</span><span id="line-160"></span><span>
</span><span id="line-161"></span><span class="annot"><span class="hs-comment">-- | floor to 'Z'.</span></span><span>
</span><span id="line-162"></span><span id="local-6989586621679377725"><span class="annot"><a href="OAlg.Structure.Number.Definition.html#zFloor"><span class="hs-identifier hs-type">zFloor</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Number"><span class="hs-identifier hs-type">Number</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377725"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679377725"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#Z"><span class="hs-identifier hs-type">Z</span></a></span></span><span>
</span><span id="line-163"></span><span id="zFloor"><span class="annot"><span class="annottext">zFloor :: forall r. Number r =&gt; r -&gt; Z
</span><a href="OAlg.Structure.Number.Definition.html#zFloor"><span class="hs-identifier hs-var hs-var">zFloor</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Z, r) -&gt; Z
forall a b. (a, b) -&gt; a
</span><a href="OAlg.Category.Definition.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span class="annot"><span class="annottext">((Z, r) -&gt; Z) -&gt; (r -&gt; (Z, r)) -&gt; r -&gt; Z
forall y z x. (y -&gt; z) -&gt; (x -&gt; y) -&gt; x -&gt; z
forall (c :: * -&gt; * -&gt; *) y z x.
Category c =&gt;
c y z -&gt; c x y -&gt; c x z
</span><a href="OAlg.Category.Definition.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; (Z, r)
forall r. Number r =&gt; r -&gt; (Z, r)
</span><a href="OAlg.Structure.Number.Definition.html#zFloorFraction"><span class="hs-identifier hs-var">zFloorFraction</span></a></span><span>
</span><span id="line-164"></span><span>
</span><span id="line-165"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-166"></span><span class="hs-comment">-- Number - Instances -</span><span>
</span><span id="line-167"></span><span>
</span><span id="line-168"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Number"><span class="hs-identifier hs-type">Number</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-169"></span><span>  </span><span id="local-6989586621679378061"><span class="annot"><span class="annottext">minusOne :: Maybe N
</span><a href="OAlg.Structure.Number.Definition.html#minusOne"><span class="hs-identifier hs-var hs-var hs-var hs-var">minusOne</span></a></span></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe N
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-170"></span><span>  </span><span id="local-6989586621679378062"><span class="annot"><span class="annottext">abs :: N -&gt; N
</span><a href="OAlg.Structure.Number.Definition.html#abs"><span class="hs-identifier hs-var hs-var hs-var hs-var">abs</span></a></span></span><span>             </span><span id="local-6989586621679378063"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679378063"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679378063"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-171"></span><span>  </span><span id="local-6989586621679378068"><span class="annot"><span class="annottext">signum :: N -&gt; N
</span><a href="OAlg.Structure.Number.Definition.html#signum"><span class="hs-identifier hs-var hs-var hs-var hs-var">signum</span></a></span></span><span>          </span><span id="local-6989586621679378069"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679378069"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679378069"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">1</span></span><span>
</span><span id="line-172"></span><span>  </span><span id="local-6989586621679378070"><span class="annot"><span class="annottext">floor :: N -&gt; N
</span><a href="OAlg.Structure.Number.Definition.html#floor"><span class="hs-identifier hs-var hs-var hs-var hs-var">floor</span></a></span></span><span>           </span><span id="local-6989586621679378071"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679378071"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679378071"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-173"></span><span>  </span><span id="local-6989586621679378073"><span class="annot"><span class="annottext">fraction :: N -&gt; N
</span><a href="OAlg.Structure.Number.Definition.html#fraction"><span class="hs-identifier hs-var hs-var hs-var hs-var">fraction</span></a></span></span><span>        </span><span class="annot"><span class="annottext">N
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span>
</span><span id="line-174"></span><span>  </span><span id="local-6989586621679378077"><span class="annot"><span class="annottext">zFloorFraction :: N -&gt; (Z, N)
</span><a href="OAlg.Structure.Number.Definition.html#zFloorFraction"><span class="hs-identifier hs-var hs-var hs-var hs-var">zFloorFraction</span></a></span></span><span>  </span><span id="local-6989586621679378078"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679378078"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">N -&gt; Z
forall a b. Embeddable a b =&gt; a -&gt; b
</span><a href="OAlg.Data.Canonical.html#inj"><span class="hs-identifier hs-var">inj</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679378078"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>  </span><span>
</span><span id="line-175"></span><span>  </span><span>
</span><span id="line-176"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Number"><span class="hs-identifier hs-type">Number</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-177"></span><span>  </span><span id="local-6989586621679378102"><span class="annot"><span class="annottext">minusOne :: Maybe Integer
</span><a href="OAlg.Structure.Number.Definition.html#minusOne"><span class="hs-identifier hs-var hs-var hs-var hs-var">minusOne</span></a></span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Maybe Integer
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-178"></span><span>  </span><span id="local-6989586621679378104"><span class="annot"><span class="annottext">abs :: Integer -&gt; Integer
</span><a href="OAlg.Structure.Number.Definition.html#abs"><span class="hs-identifier hs-var hs-var hs-var hs-var">abs</span></a></span></span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">A.abs</span></span><span>
</span><span id="line-179"></span><span>  </span><span id="local-6989586621679378107"><span class="annot"><span class="annottext">signum :: Integer -&gt; Integer
</span><a href="OAlg.Structure.Number.Definition.html#signum"><span class="hs-identifier hs-var hs-var hs-var hs-var">signum</span></a></span></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">A.signum</span></span><span>
</span><span id="line-180"></span><span>  </span><span id="local-6989586621679378109"><span class="annot"><span class="annottext">floor :: Integer -&gt; Integer
</span><a href="OAlg.Structure.Number.Definition.html#floor"><span class="hs-identifier hs-var hs-var hs-var hs-var">floor</span></a></span></span><span>          </span><span id="local-6989586621679378110"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679378110"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679378110"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-181"></span><span>  </span><span id="local-6989586621679378111"><span class="annot"><span class="annottext">fraction :: Integer -&gt; Integer
</span><a href="OAlg.Structure.Number.Definition.html#fraction"><span class="hs-identifier hs-var hs-var hs-var hs-var">fraction</span></a></span></span><span>       </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-182"></span><span>  </span><span id="local-6989586621679378114"><span class="annot"><span class="annottext">zFloorFraction :: Integer -&gt; (Z, Integer)
</span><a href="OAlg.Structure.Number.Definition.html#zFloorFraction"><span class="hs-identifier hs-var hs-var hs-var hs-var">zFloorFraction</span></a></span></span><span> </span><span id="local-6989586621679378115"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679378115"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Z
forall a b. Embeddable a b =&gt; a -&gt; b
</span><a href="OAlg.Data.Canonical.html#inj"><span class="hs-identifier hs-var">inj</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679378115"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-183"></span><span>
</span><span id="line-184"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Number"><span class="hs-identifier hs-type">Number</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#Z"><span class="hs-identifier hs-type">Z</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-185"></span><span>  </span><span id="local-6989586621679378138"><span class="annot"><span class="annottext">minusOne :: Maybe Z
</span><a href="OAlg.Structure.Number.Definition.html#minusOne"><span class="hs-identifier hs-var hs-var hs-var hs-var">minusOne</span></a></span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Z -&gt; Maybe Z
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Z
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-186"></span><span>  </span><span id="local-6989586621679378140"><span class="annot"><span class="annottext">abs :: Z -&gt; Z
</span><a href="OAlg.Structure.Number.Definition.html#abs"><span class="hs-identifier hs-var hs-var hs-var hs-var">abs</span></a></span></span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Z -&gt; Z
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">A.abs</span></span><span>
</span><span id="line-187"></span><span>  </span><span id="local-6989586621679378142"><span class="annot"><span class="annottext">signum :: Z -&gt; Z
</span><a href="OAlg.Structure.Number.Definition.html#signum"><span class="hs-identifier hs-var hs-var hs-var hs-var">signum</span></a></span></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Z -&gt; Z
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">A.signum</span></span><span>
</span><span id="line-188"></span><span>  </span><span id="local-6989586621679378143"><span class="annot"><span class="annottext">floor :: Z -&gt; Z
</span><a href="OAlg.Structure.Number.Definition.html#floor"><span class="hs-identifier hs-var hs-var hs-var hs-var">floor</span></a></span></span><span>          </span><span id="local-6989586621679378144"><span class="annot"><span class="annottext">Z
</span><a href="#local-6989586621679378144"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Z
</span><a href="#local-6989586621679378144"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-189"></span><span>  </span><span id="local-6989586621679378146"><span class="annot"><span class="annottext">fraction :: Z -&gt; Z
</span><a href="OAlg.Structure.Number.Definition.html#fraction"><span class="hs-identifier hs-var hs-var hs-var hs-var">fraction</span></a></span></span><span>       </span><span class="annot"><span class="annottext">Z
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Z
</span><span class="hs-number">0</span></span><span>
</span><span id="line-190"></span><span>  </span><span id="local-6989586621679378148"><span class="annot"><span class="annottext">zFloorFraction :: Z -&gt; (Z, Z)
</span><a href="OAlg.Structure.Number.Definition.html#zFloorFraction"><span class="hs-identifier hs-var hs-var hs-var hs-var">zFloorFraction</span></a></span></span><span> </span><span id="local-6989586621679378149"><span class="annot"><span class="annottext">Z
</span><a href="#local-6989586621679378149"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Z
</span><a href="#local-6989586621679378149"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Z
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-191"></span><span>
</span><span id="line-192"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679378165"><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Number"><span class="hs-identifier hs-type">Number</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#Q"><span class="hs-identifier hs-type">Q</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-193"></span><span>  </span><span id="local-6989586621679378174"><span class="annot"><span class="annottext">minusOne :: Maybe Q
</span><a href="OAlg.Structure.Number.Definition.html#minusOne"><span class="hs-identifier hs-var hs-var hs-var hs-var">minusOne</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Q -&gt; Maybe Q
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Q
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-194"></span><span>  </span><span id="local-6989586621679378176"><span class="annot"><span class="annottext">abs :: Q -&gt; Q
</span><a href="OAlg.Structure.Number.Definition.html#abs"><span class="hs-identifier hs-var hs-var hs-var hs-var">abs</span></a></span></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Q -&gt; Q
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">A.abs</span></span><span>
</span><span id="line-195"></span><span>  </span><span id="local-6989586621679378178"><span class="annot"><span class="annottext">signum :: Q -&gt; Q
</span><a href="OAlg.Structure.Number.Definition.html#signum"><span class="hs-identifier hs-var hs-var hs-var hs-var">signum</span></a></span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Q -&gt; Q
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">A.signum</span></span><span>
</span><span id="line-196"></span><span>  </span><span id="local-6989586621679378184"><span class="annot"><span class="annottext">floor :: Q -&gt; Q
</span><a href="OAlg.Structure.Number.Definition.html#floor"><span class="hs-identifier hs-var hs-var hs-var hs-var">floor</span></a></span></span><span>  </span><span id="local-6989586621679378185"><span class="annot"><span class="annottext">Q
</span><a href="#local-6989586621679378185"><span class="hs-identifier hs-var">q</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Q -&gt; Z
forall b. Integral b =&gt; Q -&gt; b
forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">A.floor</span></span><span> </span><span class="annot"><span class="annottext">Q
</span><a href="#local-6989586621679378185"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Z -&gt; N -&gt; Q
</span><a href="OAlg.Data.Number.html#%25"><span class="hs-operator hs-var">%</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">1</span></span><span>
</span><span id="line-197"></span><span>  </span><span id="local-6989586621679378190"><span class="annot"><span class="annottext">zFloorFraction :: Q -&gt; (Z, Q)
</span><a href="OAlg.Structure.Number.Definition.html#zFloorFraction"><span class="hs-identifier hs-var hs-var hs-var hs-var">zFloorFraction</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Q -&gt; (Z, Q)
forall b. Integral b =&gt; Q -&gt; (b, Q)
forall a b. (RealFrac a, Integral b) =&gt; a -&gt; (b, a)
</span><span class="hs-identifier hs-var">A.properFraction</span></span><span>
</span><span id="line-198"></span><span>
</span><span id="line-199"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-200"></span><span class="hs-comment">-- Integral -</span><span>
</span><span id="line-201"></span><span>
</span><span id="line-202"></span><span class="hs-comment">-- | discrete numbers.</span><span>
</span><span id="line-203"></span><span class="hs-comment">--</span><span>
</span><span id="line-204"></span><span class="hs-comment">-- __Property__ For all @x@ holds: @'fraction' x '==' 0@.</span><span>
</span><span id="line-205"></span><span class="hs-keyword">class</span><span> </span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Number"><span class="hs-identifier hs-type">Number</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377736"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="Integral"><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Integral"><span class="hs-identifier hs-var">Integral</span></a></span></span><span> </span><span id="local-6989586621679377736"><span class="annot"><a href="#local-6989586621679377736"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-206"></span><span>  </span><span class="hs-pragma">{-# MINIMAL</span><span> </span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#divMod"><span class="hs-pragma hs-type">divMod</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-207"></span><span>
</span><span id="line-208"></span><span>  </span><span id="divMod"><span class="annot"><a href="OAlg.Structure.Number.Definition.html#divMod"><span class="hs-identifier hs-type">divMod</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679377736"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679377736"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679377736"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679377736"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-209"></span><span>
</span><span id="line-210"></span><span>  </span><span id="div"><span class="annot"><a href="OAlg.Structure.Number.Definition.html#div"><span class="hs-identifier hs-type">div</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679377736"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679377736"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679377736"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-211"></span><span>  </span><span id="local-6989586621679378196"><span class="annot"><a href="OAlg.Structure.Number.Definition.html#div"><span class="hs-identifier hs-var hs-var">div</span></a></span><span> </span><span id="local-6989586621679378198"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679378198"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679378199"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679378199"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a, a) -&gt; a
forall a b. (a, b) -&gt; a
</span><a href="OAlg.Category.Definition.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a -&gt; (a, a)
forall a. Integral a =&gt; a -&gt; a -&gt; (a, a)
</span><a href="OAlg.Structure.Number.Definition.html#divMod"><span class="hs-identifier hs-var">divMod</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679378198"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679378199"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-212"></span><span>
</span><span id="line-213"></span><span>  </span><span id="mod"><span class="annot"><a href="OAlg.Structure.Number.Definition.html#mod"><span class="hs-identifier hs-type">mod</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679377736"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679377736"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679377736"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-214"></span><span>  </span><span id="local-6989586621679378201"><span class="annot"><a href="OAlg.Structure.Number.Definition.html#mod"><span class="hs-identifier hs-var hs-var">mod</span></a></span><span> </span><span id="local-6989586621679378203"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679378203"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679378204"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679378204"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a, a) -&gt; a
forall a b. (a, b) -&gt; b
</span><a href="OAlg.Category.Definition.html#snd"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a -&gt; (a, a)
forall a. Integral a =&gt; a -&gt; a -&gt; (a, a)
</span><a href="OAlg.Structure.Number.Definition.html#divMod"><span class="hs-identifier hs-var">divMod</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679378203"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679378204"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-215"></span><span>
</span><span id="line-216"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Integral"><span class="hs-identifier hs-type">Integral</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-217"></span><span>  </span><span id="local-6989586621679378213"><span class="annot"><span class="annottext">divMod :: N -&gt; N -&gt; (N, N)
</span><a href="OAlg.Structure.Number.Definition.html#divMod"><span class="hs-identifier hs-var hs-var hs-var hs-var">divMod</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; (N, N)
forall a. Integral a =&gt; a -&gt; a -&gt; (a, a)
</span><span class="hs-identifier hs-var">A.divMod</span></span><span>
</span><span id="line-218"></span><span>  </span><span id="local-6989586621679378216"><span class="annot"><span class="annottext">div :: N -&gt; N -&gt; N
</span><a href="OAlg.Structure.Number.Definition.html#div"><span class="hs-identifier hs-var hs-var hs-var hs-var">div</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; N
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">A.div</span></span><span>
</span><span id="line-219"></span><span>  </span><span id="local-6989586621679378219"><span class="annot"><span class="annottext">mod :: N -&gt; N -&gt; N
</span><a href="OAlg.Structure.Number.Definition.html#mod"><span class="hs-identifier hs-var hs-var hs-var hs-var">mod</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; N
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">A.mod</span></span><span>
</span><span id="line-220"></span><span>  </span><span>
</span><span id="line-221"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Integral"><span class="hs-identifier hs-type">Integral</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#Z"><span class="hs-identifier hs-type">Z</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-222"></span><span>  </span><span id="local-6989586621679378228"><span class="annot"><span class="annottext">divMod :: Z -&gt; Z -&gt; (Z, Z)
</span><a href="OAlg.Structure.Number.Definition.html#divMod"><span class="hs-identifier hs-var hs-var hs-var hs-var">divMod</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Z -&gt; Z -&gt; (Z, Z)
forall a. Integral a =&gt; a -&gt; a -&gt; (a, a)
</span><span class="hs-identifier hs-var">A.divMod</span></span><span>
</span><span id="line-223"></span><span>  </span><span id="local-6989586621679378230"><span class="annot"><span class="annottext">div :: Z -&gt; Z -&gt; Z
</span><a href="OAlg.Structure.Number.Definition.html#div"><span class="hs-identifier hs-var hs-var hs-var hs-var">div</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Z -&gt; Z -&gt; Z
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">A.div</span></span><span>
</span><span id="line-224"></span><span>  </span><span id="local-6989586621679378232"><span class="annot"><span class="annottext">mod :: Z -&gt; Z -&gt; Z
</span><a href="OAlg.Structure.Number.Definition.html#mod"><span class="hs-identifier hs-var hs-var hs-var hs-var">mod</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Z -&gt; Z -&gt; Z
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">A.mod</span></span><span>
</span><span id="line-225"></span><span>  </span><span>
</span><span id="line-226"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-227"></span><span class="hs-comment">-- primes </span><span>
</span><span id="line-228"></span><span>
</span><span id="line-229"></span><span class="annot"><span class="hs-comment">-- | the list of prime numbers.</span></span><span>
</span><span id="line-230"></span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#primes"><span class="hs-identifier hs-type">primes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-231"></span><span id="primes"><span class="annot"><span class="annottext">primes :: [N]
</span><a href="OAlg.Structure.Number.Definition.html#primes"><span class="hs-identifier hs-var hs-var">primes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[N] -&gt; [N]
forall {a}. (Integral a, Num a) =&gt; [a] -&gt; [a]
</span><a href="#local-6989586621679378233"><span class="hs-identifier hs-var">filterPrime</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">N
</span><span class="hs-number">2</span></span><span class="hs-glyph">..</span><span class="hs-special">]</span><span>
</span><span id="line-232"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679378233"><span class="annot"><span class="annottext">filterPrime :: [a] -&gt; [a]
</span><a href="#local-6989586621679378233"><span class="hs-identifier hs-var hs-var">filterPrime</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679378344"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679378344"><span class="hs-identifier hs-var">p</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679378345"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679378345"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679378344"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a]
</span><a href="#local-6989586621679378233"><span class="hs-identifier hs-var">filterPrime</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679378346"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679378346"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679378346"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679378345"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679378346"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><a href="OAlg.Structure.Number.Definition.html#mod"><span class="hs-operator hs-var">`mod`</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679378344"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span class="hs-special">]</span><span>
</span><span id="line-233"></span><span>
</span><span id="line-234"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-235"></span><span class="hs-comment">-- Acyclic -</span><span>
</span><span id="line-236"></span><span>
</span><span id="line-237"></span><span class="hs-comment">-- | distributive structure with entities scaleable by 'Q'.</span><span>
</span><span id="line-238"></span><span class="hs-comment">--</span><span>
</span><span id="line-239"></span><span class="hs-comment">-- __Property__ For every @0 '&lt;' n@ and point @p@ holds: @'ntimes' n ('one' p)@ is</span><span>
</span><span id="line-240"></span><span class="hs-comment">-- invertible.</span><span>
</span><span id="line-241"></span><span class="hs-comment">--</span><span>
</span><span id="line-242"></span><span class="hs-comment">-- __Note__</span><span>
</span><span id="line-243"></span><span class="hs-comment">--</span><span>
</span><span id="line-244"></span><span class="hs-comment">-- (1) The cyclic rings @'OAlg.Entity.Commutative.Mod' n@ for @2 &lt;= n@ are not scaleable by</span><span>
</span><span id="line-245"></span><span class="hs-comment">-- @'Q'@, because @1 '/=' 0@ and @'ntimes' n 1 '==' 0@!</span><span>
</span><span id="line-246"></span><span class="hs-comment">--</span><span>
</span><span id="line-247"></span><span class="hs-comment">-- (2) If for every point @p@ holds that @'zero' (p':&gt;'p) '==' 'one' p@ then the structure</span><span>
</span><span id="line-248"></span><span class="hs-comment">-- is scaleable by 'Q' (e.g. @'Orientation' p@).</span><span>
</span><span id="line-249"></span><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Structure.Distributive.Definition.html#Distributive"><span class="hs-identifier hs-type">Distributive</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377739"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Additive.Definition.html#Abelian"><span class="hs-identifier hs-type">Abelian</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377739"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Multiplicative.Definition.html#Invertible"><span class="hs-identifier hs-type">Invertible</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377739"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="Acyclic"><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Acyclic"><span class="hs-identifier hs-var">Acyclic</span></a></span></span><span> </span><span id="local-6989586621679377739"><span class="annot"><a href="#local-6989586621679377739"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-250"></span><span>  </span><span>
</span><span id="line-251"></span><span>  </span><span class="hs-comment">-- | @'qtimes' q a '==' 'ztimes' z a v'*' 'invert' ('ntimes' n ('one' ('start' a)))@.</span><span>
</span><span id="line-252"></span><span>  </span><span class="hs-comment">--   where @z = 'numerator' q@ and @n = 'denominator' q@.</span><span>
</span><span id="line-253"></span><span>  </span><span id="qtimes"><span class="annot"><a href="OAlg.Structure.Number.Definition.html#qtimes"><span class="hs-identifier hs-type">qtimes</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#Q"><span class="hs-identifier hs-type">Q</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679377739"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679377739"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-254"></span><span>  </span><span id="local-6989586621679378357"><span class="annot"><a href="OAlg.Structure.Number.Definition.html#qtimes"><span class="hs-identifier hs-var hs-var">qtimes</span></a></span><span> </span><span id="local-6989586621679378371"><span class="annot"><span class="annottext">Q
</span><a href="#local-6989586621679378371"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span id="local-6989586621679378372"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679378372"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Z -&gt; a -&gt; a
forall a. Abelian a =&gt; Z -&gt; a -&gt; a
</span><a href="OAlg.Structure.Additive.Definition.html#ztimes"><span class="hs-identifier hs-var">ztimes</span></a></span><span> </span><span class="annot"><span class="annottext">Z
</span><a href="#local-6989586621679378374"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679378372"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall c. Multiplicative c =&gt; c -&gt; c -&gt; c
</span><a href="OAlg.Structure.Multiplicative.Definition.html#%2A"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall c. Invertible c =&gt; c -&gt; c
</span><a href="OAlg.Structure.Multiplicative.Definition.html#invert"><span class="hs-identifier hs-var">invert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">N -&gt; a -&gt; a
forall a. Additive a =&gt; N -&gt; a -&gt; a
</span><a href="OAlg.Structure.Additive.Definition.html#ntimes"><span class="hs-identifier hs-var">ntimes</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679378376"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point a -&gt; a
forall c. Multiplicative c =&gt; Point c -&gt; c
</span><a href="OAlg.Structure.Multiplicative.Definition.html#one"><span class="hs-identifier hs-var">one</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Point a
forall q. Oriented q =&gt; q -&gt; Point q
</span><a href="OAlg.Structure.Oriented.Definition.html#start"><span class="hs-identifier hs-var">start</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679378372"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-255"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679378374"><span class="annot"><span class="annottext">z :: Z
</span><a href="#local-6989586621679378374"><span class="hs-identifier hs-var hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Q -&gt; Z
</span><a href="OAlg.Data.Number.html#numerator"><span class="hs-identifier hs-var">numerator</span></a></span><span> </span><span class="annot"><span class="annottext">Q
</span><a href="#local-6989586621679378371"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-256"></span><span>          </span><span id="local-6989586621679378376"><span class="annot"><span class="annottext">n :: N
</span><a href="#local-6989586621679378376"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Q -&gt; N
</span><a href="OAlg.Data.Number.html#denominator"><span class="hs-identifier hs-var">denominator</span></a></span><span> </span><span class="annot"><span class="annottext">Q
</span><a href="#local-6989586621679378371"><span class="hs-identifier hs-var">q</span></a></span></span><span>
</span><span id="line-257"></span><span>
</span><span id="line-258"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Acyclic"><span class="hs-identifier hs-type">Acyclic</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-259"></span><span>  </span><span id="local-6989586621679378392"><span class="annot"><span class="annottext">qtimes :: Q -&gt; () -&gt; ()
</span><a href="OAlg.Structure.Number.Definition.html#qtimes"><span class="hs-identifier hs-var hs-var hs-var hs-var">qtimes</span></a></span></span><span> </span><span class="annot"><span class="annottext">Q
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-260"></span><span>  </span><span>
</span><span id="line-261"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Acyclic"><span class="hs-identifier hs-type">Acyclic</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#Q"><span class="hs-identifier hs-type">Q</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-262"></span><span>  </span><span id="local-6989586621679378405"><span class="annot"><span class="annottext">qtimes :: Q -&gt; Q -&gt; Q
</span><a href="OAlg.Structure.Number.Definition.html#qtimes"><span class="hs-identifier hs-var hs-var hs-var hs-var">qtimes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Q -&gt; Q -&gt; Q
forall c. Multiplicative c =&gt; c -&gt; c -&gt; c
</span><a href="OAlg.Structure.Multiplicative.Definition.html#%2A"><span class="hs-operator hs-var">(*)</span></a></span><span>
</span><span id="line-263"></span><span>  </span><span>
</span><span id="line-264"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-265"></span><span class="hs-comment">-- Fractional -</span><span>
</span><span id="line-266"></span><span>
</span><span id="line-267"></span><span class="hs-comment">-- | continuous numbers, i.e acyclic and negateable numbers. They induce a sub</span><span>
</span><span id="line-268"></span><span class="hs-comment">--   @'Q'@-vectorial structures of the real numbers.</span><span>
</span><span id="line-269"></span><span class="hs-comment">--</span><span>
</span><span id="line-270"></span><span class="hs-comment">--   __Note__ We will distinguish here instances of @'Fractional'@ and the mathematical</span><span>
</span><span id="line-271"></span><span class="hs-comment">--   entities of real numbers! </span><span>
</span><span id="line-272"></span><span class="hs-keyword">type</span><span> </span><span id="Fractional"><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Fractional"><span class="hs-identifier hs-var">Fractional</span></a></span></span><span> </span><span id="local-6989586621679378406"><span class="annot"><a href="#local-6989586621679378406"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Number"><span class="hs-identifier hs-type">Number</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679378406"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Additive.Definition.html#Abelian"><span class="hs-identifier hs-type">Abelian</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679378406"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Acyclic"><span class="hs-identifier hs-type">Acyclic</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679378406"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-273"></span><span>
</span><span id="line-274"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-275"></span><span class="hs-comment">-- Measurable -</span><span>
</span><span id="line-276"></span><span>
</span><span id="line-277"></span><span class="annot"><span class="hs-comment">-- | measurable entities.</span></span><span>
</span><span id="line-278"></span><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Definition.html#Entity"><span class="hs-identifier hs-type">Entity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377745"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Number"><span class="hs-identifier hs-type">Number</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377746"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="Measurable"><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Measurable"><span class="hs-identifier hs-var">Measurable</span></a></span></span><span> </span><span id="local-6989586621679377745"><span class="annot"><a href="#local-6989586621679377745"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679377746"><span class="annot"><a href="#local-6989586621679377746"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-279"></span><span>
</span><span id="line-280"></span><span>  </span><span class="hs-comment">-- | distance of two points.</span><span>
</span><span id="line-281"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-282"></span><span>  </span><span class="hs-comment">--   __Properties__ Let @__a__@ @__r__@ be 'Measurable', then holds:</span><span>
</span><span id="line-283"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-284"></span><span>  </span><span class="hs-comment">--   (1) For all @x@ and @y@ in @__a__@ holds: @0 &lt;= dist x y@</span><span>
</span><span id="line-285"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-286"></span><span>  </span><span class="hs-comment">--   (2) For all @x@ and @y@ in @__a__@ holds: @dist x y == 0@ if and only if @x == y@.</span><span>
</span><span id="line-287"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-288"></span><span>  </span><span class="hs-comment">--   (3) For all @x@ and @y@ in @__a__@ holds: @dist x y == dist y x@.</span><span>
</span><span id="line-289"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-290"></span><span>  </span><span class="hs-comment">--   (4) For all @x@, @y@ and @z@ in @__a__@ holds: @dist x z@ &lt;= @dist x y@ v'+' @dist y z@</span><span>
</span><span id="line-291"></span><span>  </span><span id="dist"><span class="annot"><a href="OAlg.Structure.Number.Definition.html#dist"><span class="hs-identifier hs-type">dist</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679377745"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679377745"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679377746"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-292"></span><span>
</span><span id="line-293"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679377749"><span class="hs-special">(</span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Number"><span class="hs-identifier hs-type">Number</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377749"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Additive.Definition.html#Abelian"><span class="hs-identifier hs-type">Abelian</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377749"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Measurable"><span class="hs-identifier hs-type">Measurable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377749"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377749"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-294"></span><span>  </span><span id="local-6989586621679378426"><span class="annot"><span class="annottext">dist :: r -&gt; r -&gt; r
</span><a href="OAlg.Structure.Number.Definition.html#dist"><span class="hs-identifier hs-var hs-var hs-var hs-var">dist</span></a></span></span><span> </span><span id="local-6989586621679378427"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679378427"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679378428"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679378428"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r -&gt; r
forall r. Number r =&gt; r -&gt; r
</span><a href="OAlg.Structure.Number.Definition.html#abs"><span class="hs-identifier hs-var">abs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679378428"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Abelian a =&gt; a -&gt; a -&gt; a
</span><a href="OAlg.Structure.Additive.Definition.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679378427"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-295"></span><span>
</span><span id="line-296"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Measurable"><span class="hs-identifier hs-type">Measurable</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#Z"><span class="hs-identifier hs-type">Z</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-297"></span><span>  </span><span id="local-6989586621679378442"><span class="annot"><span class="annottext">dist :: N -&gt; N -&gt; Z
</span><a href="OAlg.Structure.Number.Definition.html#dist"><span class="hs-identifier hs-var hs-var hs-var hs-var">dist</span></a></span></span><span> </span><span id="local-6989586621679378443"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679378443"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679378444"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679378444"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">N -&gt; Z
forall a b. Embeddable a b =&gt; a -&gt; b
</span><a href="OAlg.Data.Canonical.html#inj"><span class="hs-identifier hs-var">inj</span></a></span><span> </span><span class="annot"><span class="annottext">(N -&gt; Z) -&gt; N -&gt; Z
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><a href="OAlg.Category.Applicative.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">N -&gt; N
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">A.abs</span></span><span> </span><span class="annot"><span class="annottext">(N -&gt; N) -&gt; N -&gt; N
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><a href="OAlg.Category.Applicative.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679378444"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; N
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">A.-</span></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679378443"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-298"></span><span>
</span><span id="line-299"></span><span class="hs-comment">----------------------------------------</span><span>
</span><span id="line-300"></span><span class="hs-comment">-- Digits -</span><span>
</span><span id="line-301"></span><span>
</span><span id="line-302"></span><span class="hs-comment">-- | digital representation of numbers for the given base @b@.</span><span>
</span><span id="line-303"></span><span class="hs-comment">--</span><span>
</span><span id="line-304"></span><span class="hs-comment">-- __Note__</span><span>
</span><span id="line-305"></span><span class="hs-comment">--</span><span>
</span><span id="line-306"></span><span class="hs-comment">-- (1) 'dgsFlr' is a finite list</span><span>
</span><span id="line-307"></span><span class="hs-comment">--</span><span>
</span><span id="line-308"></span><span class="hs-comment">-- (2) 'dgsFrc' maybe a infinite list and as such 'valid' could end up in an</span><span>
</span><span id="line-309"></span><span class="hs-comment">-- infinite proposition!</span><span>
</span><span id="line-310"></span><span class="hs-keyword">data</span><span> </span><span id="Digits"><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Digits"><span class="hs-identifier hs-var">Digits</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679378448"><span class="annot"><a href="#local-6989586621679378448"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679378450"><span class="annot"><a href="#local-6989586621679378450"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-311"></span><span>  </span><span id="local-6989586621679377750"><span id="local-6989586621679377751"><span id="Digits"><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Digits"><span class="hs-identifier hs-var">Digits</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;=</span></span><span> </span><span class="annot"><a href="#local-6989586621679377750"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-312"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">{</span><span> </span><span id="dgsSig"><span class="annot"><span class="annottext">forall (b :: Natural) r. Digits b r -&gt; r
</span><a href="OAlg.Structure.Number.Definition.html#dgsSig"><span class="hs-identifier hs-var hs-var">dgsSig</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679377751"><span class="hs-identifier hs-type">r</span></a></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ the signum.</span></span><span>
</span><span id="line-313"></span><span>       </span><span class="hs-special">,</span><span> </span><span id="dgsFlr"><span class="annot"><span class="annottext">forall (b :: Natural) r. Digits b r -&gt; [N]
</span><a href="OAlg.Structure.Number.Definition.html#dgsFlr"><span class="hs-identifier hs-var hs-var">dgsFlr</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span class="hs-special">]</span><span>  </span><span class="annot"><span class="hs-comment">-- ^ the digital representation of the floor part</span></span><span>
</span><span id="line-314"></span><span>       </span><span class="hs-special">,</span><span> </span><span id="dgsFrc"><span class="annot"><span class="annottext">forall (b :: Natural) r. Digits b r -&gt; [N]
</span><a href="OAlg.Structure.Number.Definition.html#dgsFrc"><span class="hs-identifier hs-var hs-var">dgsFrc</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span class="hs-special">]</span><span>  </span><span class="annot"><span class="hs-comment">-- ^ the digital representation of the fractional part</span></span><span>
</span><span id="line-315"></span><span>       </span><span class="hs-special">}</span><span>
</span><span id="line-316"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Digits"><span class="hs-identifier hs-type">Digits</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377750"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377751"><span class="hs-identifier hs-type">r</span></a></span></span></span><span>
</span><span id="line-317"></span><span>
</span><span id="line-318"></span><span id="local-6989586621679377761"><span id="local-6989586621679377762"><span id="local-6989586621679378457"><span id="local-6989586621679378459"><span id="local-6989586621679378463"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679377761"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Digits"><span class="hs-identifier hs-type">Digits</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377762"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377761"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-319"></span><span id="local-6989586621679377763"><span id="local-6989586621679377764"><span id="local-6989586621679378467"><span id="local-6989586621679378469"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679377763"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Digits"><span class="hs-identifier hs-type">Digits</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377764"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377763"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-320"></span><span id="local-6989586621679377765"><span id="local-6989586621679377766"><span id="local-6989586621679378477"><span id="local-6989586621679378479"><span id="local-6989586621679378481"><span id="local-6989586621679378485"><span id="local-6989586621679378488"><span id="local-6989586621679378491"><span id="local-6989586621679378494"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679377765"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Digits"><span class="hs-identifier hs-type">Digits</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377766"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377765"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-321"></span><span>
</span><span id="line-322"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679377771"><span id="local-6989586621679377772"><span class="annot"><a href="OAlg.Data.Validable.html#Validable"><span class="hs-identifier hs-type">Validable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377771"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.Validable.html#Validable"><span class="hs-identifier hs-type">Validable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Digits"><span class="hs-identifier hs-type">Digits</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377772"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377771"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-323"></span><span>  </span><span id="local-6989586621679378501"><span class="annot"><span class="annottext">valid :: Digits b r -&gt; Statement
</span><a href="OAlg.Data.Validable.html#valid"><span class="hs-identifier hs-var hs-var hs-var hs-var">valid</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Digits"><span class="hs-identifier hs-type">Digits</span></a></span><span> </span><span id="local-6989586621679378509"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679378509"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679378510"><span class="annot"><span class="annottext">[N]
</span><a href="#local-6989586621679378510"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679378511"><span class="annot"><span class="annottext">[N]
</span><a href="#local-6989586621679378511"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Statement] -&gt; Statement
</span><a href="OAlg.Data.Statement.Definition.html#And"><span class="hs-identifier hs-var">And</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">r -&gt; Statement
forall a. Validable a =&gt; a -&gt; Statement
</span><a href="OAlg.Data.Validable.html#valid"><span class="hs-identifier hs-var">valid</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679378509"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[N] -&gt; Statement
forall a. Validable a =&gt; a -&gt; Statement
</span><a href="OAlg.Data.Validable.html#valid"><span class="hs-identifier hs-var">valid</span></a></span><span> </span><span class="annot"><span class="annottext">[N]
</span><a href="#local-6989586621679378510"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[N] -&gt; Statement
forall a. Validable a =&gt; a -&gt; Statement
</span><a href="OAlg.Data.Validable.html#valid"><span class="hs-identifier hs-var">valid</span></a></span><span> </span><span class="annot"><span class="annottext">[N]
</span><a href="#local-6989586621679378511"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-324"></span><span>  </span><span>
</span><span id="line-325"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679377776"><span id="local-6989586621679377777"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679377776"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Definition.html#Entity"><span class="hs-identifier hs-type">Entity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377777"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Definition.html#Entity"><span class="hs-identifier hs-type">Entity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Digits"><span class="hs-identifier hs-type">Digits</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377776"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377777"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-326"></span><span>
</span><span id="line-327"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-328"></span><span class="hs-comment">-- dgsProxy -</span><span>
</span><span id="line-329"></span><span>
</span><span id="line-330"></span><span class="annot"><span class="hs-comment">-- | the proxy with the same type @b@.</span></span><span>
</span><span id="line-331"></span><span id="local-6989586621679377778"><span id="local-6989586621679377779"><span class="annot"><a href="OAlg.Structure.Number.Definition.html#dgsProxy"><span class="hs-identifier hs-type">dgsProxy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Digits"><span class="hs-identifier hs-type">Digits</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377778"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377779"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="#local-6989586621679377778"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-332"></span><span id="dgsProxy"><span class="annot"><span class="annottext">dgsProxy :: forall (b :: Natural) r. Digits b r -&gt; Proxy b
</span><a href="OAlg.Structure.Number.Definition.html#dgsProxy"><span class="hs-identifier hs-var hs-var">dgsProxy</span></a></span></span><span> </span><span class="annot"><span class="annottext">Digits b r
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy b
forall {k} (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span>
</span><span id="line-333"></span><span>
</span><span id="line-334"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-335"></span><span class="hs-comment">-- dgsBase -</span><span>
</span><span id="line-336"></span><span>
</span><span id="line-337"></span><span class="annot"><span class="hs-comment">-- | the base of a digit, i.e. the corresponding natural number of the type literal @b@.</span></span><span>
</span><span id="line-338"></span><span id="local-6989586621679377785"><span id="local-6989586621679377786"><span class="annot"><a href="OAlg.Structure.Number.Definition.html#dgsBase"><span class="hs-identifier hs-type">dgsBase</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679377785"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Digits"><span class="hs-identifier hs-type">Digits</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377785"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377786"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span></span></span><span>
</span><span id="line-339"></span><span id="dgsBase"><span class="annot"><span class="annottext">dgsBase :: forall (b :: Natural) r. KnownNat b =&gt; Digits b r -&gt; N
</span><a href="OAlg.Structure.Number.Definition.html#dgsBase"><span class="hs-identifier hs-var hs-var">dgsBase</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; N
forall a b. Projectible a b =&gt; b -&gt; a
</span><a href="OAlg.Data.Canonical.html#prj"><span class="hs-identifier hs-var">prj</span></a></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; N) -&gt; (Digits b r -&gt; Integer) -&gt; Digits b r -&gt; N
forall y z x. (y -&gt; z) -&gt; (x -&gt; y) -&gt; x -&gt; z
forall (c :: * -&gt; * -&gt; *) y z x.
Category c =&gt;
c y z -&gt; c x y -&gt; c x z
</span><a href="OAlg.Category.Definition.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy b -&gt; Integer
forall (n :: Natural) (proxy :: Natural -&gt; *).
KnownNat n =&gt;
proxy n -&gt; Integer
</span><span class="hs-identifier hs-var">natVal</span></span><span> </span><span class="annot"><span class="annottext">(Proxy b -&gt; Integer)
-&gt; (Digits b r -&gt; Proxy b) -&gt; Digits b r -&gt; Integer
forall y z x. (y -&gt; z) -&gt; (x -&gt; y) -&gt; x -&gt; z
forall (c :: * -&gt; * -&gt; *) y z x.
Category c =&gt;
c y z -&gt; c x y -&gt; c x z
</span><a href="OAlg.Category.Definition.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Digits b r -&gt; Proxy b
forall (b :: Natural) r. Digits b r -&gt; Proxy b
</span><a href="OAlg.Structure.Number.Definition.html#dgsProxy"><span class="hs-identifier hs-var">dgsProxy</span></a></span><span>
</span><span id="line-340"></span><span>
</span><span id="line-341"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-342"></span><span class="hs-comment">-- dgsFrcTake -</span><span>
</span><span id="line-343"></span><span>
</span><span id="line-344"></span><span class="annot"><span class="hs-comment">-- | limits the fractional part 'dgsFrc' to the length of @n@.</span></span><span>
</span><span id="line-345"></span><span id="local-6989586621679377791"><span id="local-6989586621679377792"><span class="annot"><a href="OAlg.Structure.Number.Definition.html#dgsFrcTake"><span class="hs-identifier hs-type">dgsFrcTake</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Digits"><span class="hs-identifier hs-type">Digits</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377791"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377792"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Digits"><span class="hs-identifier hs-type">Digits</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377791"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377792"><span class="hs-identifier hs-type">r</span></a></span></span></span><span>
</span><span id="line-346"></span><span id="dgsFrcTake"><span class="annot"><span class="annottext">dgsFrcTake :: forall (b :: Natural) r. N -&gt; Digits b r -&gt; Digits b r
</span><a href="OAlg.Structure.Number.Definition.html#dgsFrcTake"><span class="hs-identifier hs-var hs-var">dgsFrcTake</span></a></span></span><span> </span><span id="local-6989586621679378540"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679378540"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Digits"><span class="hs-identifier hs-type">Digits</span></a></span><span> </span><span id="local-6989586621679378546"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679378546"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679378547"><span class="annot"><span class="annottext">[N]
</span><a href="#local-6989586621679378547"><span class="hs-identifier hs-var">flr</span></a></span></span><span> </span><span id="local-6989586621679378548"><span class="annot"><span class="annottext">[N]
</span><a href="#local-6989586621679378548"><span class="hs-identifier hs-var">frc</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r -&gt; [N] -&gt; [N] -&gt; Digits b r
forall (b :: Natural) r. (2 &lt;= b) =&gt; r -&gt; [N] -&gt; [N] -&gt; Digits b r
</span><a href="OAlg.Structure.Number.Definition.html#Digits"><span class="hs-identifier hs-var">Digits</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679378546"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">[N]
</span><a href="#local-6989586621679378547"><span class="hs-identifier hs-var">flr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">N -&gt; [N] -&gt; [N]
forall a. N -&gt; [a] -&gt; [a]
</span><a href="OAlg.Data.Number.html#takeN"><span class="hs-identifier hs-var">takeN</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679378540"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">([N] -&gt; [N]) -&gt; [N] -&gt; [N]
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><a href="OAlg.Category.Applicative.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[N]
</span><a href="#local-6989586621679378548"><span class="hs-identifier hs-var">frc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-347"></span><span>
</span><span id="line-348"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-349"></span><span class="hs-comment">-- toDigits -</span><span>
</span><span id="line-350"></span><span class="hs-comment">-- | the digital representation of @x@ in the base @b@.</span><span>
</span><span id="line-351"></span><span class="hs-comment">--</span><span>
</span><span id="line-352"></span><span class="hs-comment">--   Let @'Digits' s xs ys = 'toDigits' r@ then</span><span>
</span><span id="line-353"></span><span class="hs-comment">--</span><span>
</span><span id="line-354"></span><span class="hs-comment">--   * @s@ is the @'signum' x@.</span><span>
</span><span id="line-355"></span><span class="hs-comment">--</span><span>
</span><span id="line-356"></span><span class="hs-comment">--   * @xs@ is the digital representation of @'abs' ('floor' x)@ .</span><span>
</span><span id="line-357"></span><span class="hs-comment">--</span><span>
</span><span id="line-358"></span><span class="hs-comment">--   * @ys@ is the - possibly infinite - digital representation of @'abs' ('fraction' x)@</span><span>
</span><span id="line-359"></span><span class="hs-comment">--     in the base @b@.</span><span>
</span><span id="line-360"></span><span class="hs-comment">--</span><span>
</span><span id="line-361"></span><span class="hs-comment">--   __Examples__</span><span>
</span><span id="line-362"></span><span class="hs-comment">--</span><span>
</span><span id="line-363"></span><span class="hs-comment">-- &gt;&gt;&gt; toDigits (1/3) :: Digits 10 Q</span><span>
</span><span id="line-364"></span><span class="hs-comment">-- Digits 1 [] [3,3,3..]</span><span>
</span><span id="line-365"></span><span class="hs-comment">--</span><span>
</span><span id="line-366"></span><span class="hs-comment">-- &gt;&gt;&gt; toDigits (-4/3) :: Digits 3 Q</span><span>
</span><span id="line-367"></span><span class="hs-comment">-- Digits (-1) [1] [1]</span><span>
</span><span id="line-368"></span><span class="hs-comment">--</span><span>
</span><span id="line-369"></span><span class="hs-comment">-- __Note__ To get the first @n@ digits of the fractional part @ys@ for the digital</span><span>
</span><span id="line-370"></span><span class="hs-comment">-- representation of @x@ use @'toDigitsFinite' n x@.</span><span>
</span><span id="line-371"></span><span id="local-6989586621679377798"><span id="local-6989586621679377799"><span class="annot"><a href="OAlg.Structure.Number.Definition.html#toDigits"><span class="hs-identifier hs-type">toDigits</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Number"><span class="hs-identifier hs-type">Number</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377798"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679377799"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;=</span></span><span> </span><span class="annot"><a href="#local-6989586621679377799"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679377798"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Digits"><span class="hs-identifier hs-type">Digits</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377799"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377798"><span class="hs-identifier hs-type">r</span></a></span></span></span><span>
</span><span id="line-372"></span><span id="toDigits"><span class="annot"><span class="annottext">toDigits :: forall r (b :: Natural).
(Number r, KnownNat b, 2 &lt;= b) =&gt;
r -&gt; Digits b r
</span><a href="OAlg.Structure.Number.Definition.html#toDigits"><span class="hs-identifier hs-var hs-var">toDigits</span></a></span></span><span> </span><span id="local-6989586621679378579"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679378579"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Digits b r
</span><a href="#local-6989586621679378580"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-373"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679378580"><span class="annot"><span class="annottext">res :: Digits b r
</span><a href="#local-6989586621679378580"><span class="hs-identifier hs-var hs-var">res</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r -&gt; [N] -&gt; [N] -&gt; Digits b r
forall (b :: Natural) r. (2 &lt;= b) =&gt; r -&gt; [N] -&gt; [N] -&gt; Digits b r
</span><a href="OAlg.Structure.Number.Definition.html#Digits"><span class="hs-identifier hs-var">Digits</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679378581"><span class="hs-identifier hs-var">sig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Z -&gt; [N] -&gt; [N]
</span><a href="#local-6989586621679378582"><span class="hs-identifier hs-var">dgtsFlr</span></a></span><span> </span><span class="annot"><span class="annottext">Z
</span><a href="#local-6989586621679378583"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r -&gt; [N]
</span><a href="#local-6989586621679378584"><span class="hs-identifier hs-var">dgtsFrc</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679378585"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-374"></span><span>        </span><span id="local-6989586621679378586"><span class="annot"><span class="annottext">base :: N
</span><a href="#local-6989586621679378586"><span class="hs-identifier hs-var hs-var">base</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Digits b r -&gt; N
forall (b :: Natural) r. KnownNat b =&gt; Digits b r -&gt; N
</span><a href="OAlg.Structure.Number.Definition.html#dgsBase"><span class="hs-identifier hs-var">dgsBase</span></a></span><span> </span><span class="annot"><span class="annottext">Digits b r
</span><a href="#local-6989586621679378580"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-375"></span><span>        </span><span id="local-6989586621679378581"><span class="annot"><span class="annottext">sig :: r
</span><a href="#local-6989586621679378581"><span class="hs-identifier hs-var hs-var">sig</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r -&gt; r
forall r. Number r =&gt; r -&gt; r
</span><a href="OAlg.Structure.Number.Definition.html#signum"><span class="hs-identifier hs-var">signum</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679378579"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-376"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679378583"><span class="annot"><span class="annottext">Z
</span><a href="#local-6989586621679378583"><span class="hs-identifier hs-var">z</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679378585"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679378585"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r -&gt; (Z, r)
forall r. Number r =&gt; r -&gt; (Z, r)
</span><a href="OAlg.Structure.Number.Definition.html#zFloorFraction"><span class="hs-identifier hs-var">zFloorFraction</span></a></span><span> </span><span class="annot"><span class="annottext">(r -&gt; (Z, r)) -&gt; r -&gt; (Z, r)
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><a href="OAlg.Category.Applicative.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r
forall r. Number r =&gt; r -&gt; r
</span><a href="OAlg.Structure.Number.Definition.html#abs"><span class="hs-identifier hs-var">abs</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679378579"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-377"></span><span>          </span><span>
</span><span id="line-378"></span><span>        </span><span id="local-6989586621679378587"><span class="annot"><span class="annottext">zbs :: Z
</span><a href="#local-6989586621679378587"><span class="hs-identifier hs-var hs-var">zbs</span></a></span></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">N -&gt; Z
forall a b. Embeddable a b =&gt; a -&gt; b
</span><a href="OAlg.Data.Canonical.html#inj"><span class="hs-identifier hs-var">inj</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679378586"><span class="hs-identifier hs-var">base</span></a></span><span>
</span><span id="line-379"></span><span>        </span><span id="local-6989586621679378582"><span class="annot"><span class="annottext">dgtsFlr :: Z -&gt; [N] -&gt; [N]
</span><a href="#local-6989586621679378582"><span class="hs-identifier hs-var hs-var">dgtsFlr</span></a></span></span><span> </span><span id="local-6989586621679378588"><span class="annot"><span class="annottext">Z
</span><a href="#local-6989586621679378588"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679378589"><span class="annot"><span class="annottext">[N]
</span><a href="#local-6989586621679378589"><span class="hs-identifier hs-var">ds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Z
</span><a href="#local-6989586621679378588"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Z -&gt; Z -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Z
forall r. Semiring r =&gt; r
</span><a href="OAlg.Structure.Ring.Definition.html#rZero"><span class="hs-identifier hs-var">rZero</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[N]
</span><a href="#local-6989586621679378589"><span class="hs-identifier hs-var">ds</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Z -&gt; [N] -&gt; [N]
</span><a href="#local-6989586621679378582"><span class="hs-identifier hs-var">dgtsFlr</span></a></span><span> </span><span class="annot"><span class="annottext">Z
</span><a href="#local-6989586621679378590"><span class="hs-identifier hs-var">z'</span></a></span><span> </span><span class="annot"><span class="annottext">[N]
</span><a href="#local-6989586621679378591"><span class="hs-identifier hs-var">ds'</span></a></span><span>
</span><span id="line-380"></span><span>          </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679378590"><span class="annot"><span class="annottext">Z
</span><a href="#local-6989586621679378590"><span class="hs-identifier hs-var">z'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679378592"><span class="annot"><span class="annottext">Z
</span><a href="#local-6989586621679378592"><span class="hs-identifier hs-var">zn</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Z -&gt; Z -&gt; (Z, Z)
forall a. Integral a =&gt; a -&gt; a -&gt; (a, a)
</span><a href="OAlg.Structure.Number.Definition.html#divMod"><span class="hs-identifier hs-var">divMod</span></a></span><span> </span><span class="annot"><span class="annottext">Z
</span><a href="#local-6989586621679378588"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Z
</span><a href="#local-6989586621679378587"><span class="hs-identifier hs-var">zbs</span></a></span><span>
</span><span id="line-381"></span><span>                </span><span id="local-6989586621679378591"><span class="annot"><span class="annottext">ds' :: [N]
</span><a href="#local-6989586621679378591"><span class="hs-identifier hs-var hs-var">ds'</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Z -&gt; N
forall a b. Projectible a b =&gt; b -&gt; a
</span><a href="OAlg.Data.Canonical.html#prj"><span class="hs-identifier hs-var">prj</span></a></span><span> </span><span class="annot"><span class="annottext">Z
</span><a href="#local-6989586621679378592"><span class="hs-identifier hs-var">zn</span></a></span><span> </span><span class="annot"><span class="annottext">N -&gt; [N] -&gt; [N]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[N]
</span><a href="#local-6989586621679378589"><span class="hs-identifier hs-var">ds</span></a></span><span>
</span><span id="line-382"></span><span>          </span><span>
</span><span id="line-383"></span><span>        </span><span id="local-6989586621679378584"><span class="annot"><span class="annottext">dgtsFrc :: r -&gt; [N]
</span><a href="#local-6989586621679378584"><span class="hs-identifier hs-var hs-var">dgtsFrc</span></a></span></span><span> </span><span id="local-6989586621679378593"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679378593"><span class="hs-identifier hs-var">frc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679378593"><span class="hs-identifier hs-var">frc</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">r
forall r. Semiring r =&gt; r
</span><a href="OAlg.Structure.Ring.Definition.html#rZero"><span class="hs-identifier hs-var">rZero</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Z -&gt; N
forall a b. Projectible a b =&gt; b -&gt; a
</span><a href="OAlg.Data.Canonical.html#prj"><span class="hs-identifier hs-var">prj</span></a></span><span> </span><span class="annot"><span class="annottext">Z
</span><a href="#local-6989586621679378594"><span class="hs-identifier hs-var">flr</span></a></span><span> </span><span class="annot"><span class="annottext">N -&gt; [N] -&gt; [N]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">r -&gt; [N]
</span><a href="#local-6989586621679378584"><span class="hs-identifier hs-var">dgtsFrc</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679378595"><span class="hs-identifier hs-var">frc'</span></a></span><span>
</span><span id="line-384"></span><span>          </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679378594"><span class="annot"><span class="annottext">Z
</span><a href="#local-6989586621679378594"><span class="hs-identifier hs-var">flr</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679378595"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679378595"><span class="hs-identifier hs-var">frc'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r -&gt; (Z, r)
forall r. Number r =&gt; r -&gt; (Z, r)
</span><a href="OAlg.Structure.Number.Definition.html#zFloorFraction"><span class="hs-identifier hs-var">zFloorFraction</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">N -&gt; r -&gt; r
forall a. Additive a =&gt; N -&gt; a -&gt; a
</span><a href="OAlg.Structure.Additive.Definition.html#ntimes"><span class="hs-identifier hs-var">ntimes</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679378586"><span class="hs-identifier hs-var">base</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679378593"><span class="hs-identifier hs-var">frc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-385"></span><span>
</span><span id="line-386"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-387"></span><span class="hs-comment">-- toDigitsFinite -</span><span>
</span><span id="line-388"></span><span>
</span><span id="line-389"></span><span class="hs-comment">-- | @toDigitsFinite n@ is like 'toDigits' but the fractional part is limited to the</span><span>
</span><span id="line-390"></span><span class="hs-comment">-- length of @n@ and is given by @'dgsFrcTake' n '.' 'toDigits'@.</span><span>
</span><span id="line-391"></span><span id="local-6989586621679377802"><span id="local-6989586621679377803"><span class="annot"><a href="OAlg.Structure.Number.Definition.html#toDigitsFinite"><span class="hs-identifier hs-type">toDigitsFinite</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Number"><span class="hs-identifier hs-type">Number</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377802"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679377803"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;=</span></span><span> </span><span class="annot"><a href="#local-6989586621679377803"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679377802"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Digits"><span class="hs-identifier hs-type">Digits</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377803"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377802"><span class="hs-identifier hs-type">r</span></a></span></span></span><span>
</span><span id="line-392"></span><span id="toDigitsFinite"><span class="annot"><span class="annottext">toDigitsFinite :: forall r (b :: Natural).
(Number r, KnownNat b, 2 &lt;= b) =&gt;
N -&gt; r -&gt; Digits b r
</span><a href="OAlg.Structure.Number.Definition.html#toDigitsFinite"><span class="hs-identifier hs-var hs-var">toDigitsFinite</span></a></span></span><span> </span><span id="local-6989586621679378605"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679378605"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">N -&gt; Digits b r -&gt; Digits b r
forall (b :: Natural) r. N -&gt; Digits b r -&gt; Digits b r
</span><a href="OAlg.Structure.Number.Definition.html#dgsFrcTake"><span class="hs-identifier hs-var">dgsFrcTake</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679378605"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">(Digits b r -&gt; Digits b r) -&gt; (r -&gt; Digits b r) -&gt; r -&gt; Digits b r
forall y z x. (y -&gt; z) -&gt; (x -&gt; y) -&gt; x -&gt; z
forall (c :: * -&gt; * -&gt; *) y z x.
Category c =&gt;
c y z -&gt; c x y -&gt; c x z
</span><a href="OAlg.Category.Definition.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; Digits b r
forall r (b :: Natural).
(Number r, KnownNat b, 2 &lt;= b) =&gt;
r -&gt; Digits b r
</span><a href="OAlg.Structure.Number.Definition.html#toDigits"><span class="hs-identifier hs-var">toDigits</span></a></span><span>
</span><span id="line-393"></span><span>
</span><span id="line-394"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-395"></span><span class="hs-comment">-- fromDigits -</span><span>
</span><span id="line-396"></span><span>
</span><span id="line-397"></span><span class="hs-comment">-- | @fromDigits n dgs\@('Digits' s xs ys)@ is given by</span><span>
</span><span id="line-398"></span><span class="hs-comment">--   @s v'*' (xm v'*' b'^'m v'+' .. v'+' xi v'*' b'^'i v'+' .. v'+' x0 v'*' b'^'0  v'+' y1 v'*' r'^'1 v'+' .. v'+' yj v'*' r'^'j v'+' .. v'+' yn v'*' r'^'n@</span><span>
</span><span id="line-399"></span><span class="hs-comment">-- where @b = 'dgsBase' dgs@, @xs = [xm..xi..x0]@, @ys = [y1,y2..yj..yn..]@</span><span>
</span><span id="line-400"></span><span class="hs-comment">-- and @r = 'invert' b@.</span><span>
</span><span id="line-401"></span><span class="hs-comment">--</span><span>
</span><span id="line-402"></span><span class="hs-comment">-- __Property__ Let @1 '&lt;' b@ and @dgs = 'Digits' s xs ys@ where @s@ is either 1 or -1</span><span>
</span><span id="line-403"></span><span class="hs-comment">-- and @0 v'&lt;=' xi '&lt;' b@ for all @i@ and @0 v'&lt;=' yj '&lt;' b@ for all @j@</span><span>
</span><span id="line-404"></span><span class="hs-comment">-- then for all @n@ holds: @'toDigits' b n ('fromDigits' b n dgs) '==' dgs@.</span><span>
</span><span id="line-405"></span><span class="hs-comment">--</span><span>
</span><span id="line-406"></span><span class="hs-comment">-- __Note__</span><span>
</span><span id="line-407"></span><span class="hs-comment">--</span><span>
</span><span id="line-408"></span><span class="hs-comment">-- (1) All the elements of the above formula are lifted to the type @r@ via</span><span>
</span><span id="line-409"></span><span class="hs-comment">-- @\\x -&gt; 'ntimes' x 'rOne'@.</span><span>
</span><span id="line-410"></span><span class="hs-comment">--</span><span>
</span><span id="line-411"></span><span class="hs-comment">-- (2) Because the type @r@ is acyclic, the expression @'invert' b@ - which is actually</span><span>
</span><span id="line-412"></span><span class="hs-comment">-- @'invert' ('ntimes' b 'rOne')@ - is regular.</span><span>
</span><span id="line-413"></span><span class="hs-comment">--</span><span>
</span><span id="line-414"></span><span class="hs-comment">-- (3) If @b@ is not bigger then 1 then an exception 'Undefined' will be thrown.</span><span>
</span><span id="line-415"></span><span id="local-6989586621679377806"><span id="local-6989586621679377807"><span class="annot"><a href="OAlg.Structure.Number.Definition.html#fromDigits"><span class="hs-identifier hs-type">fromDigits</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Number"><span class="hs-identifier hs-type">Number</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377806"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Acyclic"><span class="hs-identifier hs-type">Acyclic</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377806"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679377807"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Digits"><span class="hs-identifier hs-type">Digits</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377807"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377806"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679377806"><span class="hs-identifier hs-type">r</span></a></span></span></span><span>
</span><span id="line-416"></span><span id="fromDigits"><span class="annot"><span class="annottext">fromDigits :: forall r (b :: Natural).
(Number r, Acyclic r, KnownNat b) =&gt;
N -&gt; Digits b r -&gt; r
</span><a href="OAlg.Structure.Number.Definition.html#fromDigits"><span class="hs-identifier hs-var hs-var">fromDigits</span></a></span></span><span> </span><span id="local-6989586621679378616"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679378616"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679378617"><span class="annot"><span class="annottext">dgs :: Digits b r
</span><a href="#local-6989586621679378617"><span class="hs-identifier hs-var">dgs</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Digits"><span class="hs-identifier hs-type">Digits</span></a></span><span> </span><span id="local-6989586621679378629"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679378629"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679378630"><span class="annot"><span class="annottext">[N]
</span><a href="#local-6989586621679378630"><span class="hs-identifier hs-var">flr</span></a></span></span><span> </span><span id="local-6989586621679378631"><span class="annot"><span class="annottext">[N]
</span><a href="#local-6989586621679378631"><span class="hs-identifier hs-var">frc</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-417"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679378629"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall c. Multiplicative c =&gt; c -&gt; c -&gt; c
</span><a href="OAlg.Structure.Multiplicative.Definition.html#%2A"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r -&gt; [N] -&gt; r -&gt; r
forall r. Number r =&gt; r -&gt; [N] -&gt; r -&gt; r
</span><a href="#local-6989586621679378632"><span class="hs-identifier hs-var">rFlr</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679378633"><span class="hs-identifier hs-var">b'</span></a></span><span> </span><span class="annot"><span class="annottext">[N]
</span><a href="#local-6989586621679378630"><span class="hs-identifier hs-var">flr</span></a></span><span> </span><span class="annot"><span class="annottext">r
forall r. Semiring r =&gt; r
</span><a href="OAlg.Structure.Ring.Definition.html#rZero"><span class="hs-identifier hs-var">rZero</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Additive a =&gt; a -&gt; a -&gt; a
</span><a href="OAlg.Structure.Additive.Definition.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; [N] -&gt; r -&gt; r
forall r. Number r =&gt; r -&gt; r -&gt; [N] -&gt; r -&gt; r
</span><a href="#local-6989586621679378634"><span class="hs-identifier hs-var">rFrc</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679378635"><span class="hs-identifier hs-var">br</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679378635"><span class="hs-identifier hs-var">br</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">N -&gt; [N] -&gt; [N]
forall a. N -&gt; [a] -&gt; [a]
</span><a href="OAlg.Data.Number.html#takeN"><span class="hs-identifier hs-var">takeN</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679378616"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[N]
</span><a href="#local-6989586621679378631"><span class="hs-identifier hs-var">frc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">r
forall r. Semiring r =&gt; r
</span><a href="OAlg.Structure.Ring.Definition.html#rZero"><span class="hs-identifier hs-var">rZero</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-418"></span><span>    </span><span id="local-6989586621679378636"><span class="annot"><span class="annottext">b :: N
</span><a href="#local-6989586621679378636"><span class="hs-identifier hs-var hs-var">b</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Digits b r -&gt; N
forall (b :: Natural) r. KnownNat b =&gt; Digits b r -&gt; N
</span><a href="OAlg.Structure.Number.Definition.html#dgsBase"><span class="hs-identifier hs-var">dgsBase</span></a></span><span> </span><span class="annot"><span class="annottext">Digits b r
</span><a href="#local-6989586621679378617"><span class="hs-identifier hs-var">dgs</span></a></span><span>
</span><span id="line-419"></span><span>    </span><span id="local-6989586621679378633"><span class="annot"><span class="annottext">b' :: r
</span><a href="#local-6989586621679378633"><span class="hs-identifier hs-var hs-var">b'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">N -&gt; r -&gt; r
forall a. Additive a =&gt; N -&gt; a -&gt; a
</span><a href="OAlg.Structure.Additive.Definition.html#ntimes"><span class="hs-identifier hs-var">ntimes</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679378636"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">r
forall r. Semiring r =&gt; r
</span><a href="OAlg.Structure.Ring.Definition.html#rOne"><span class="hs-identifier hs-var">rOne</span></a></span><span>
</span><span id="line-420"></span><span>    </span><span id="local-6989586621679378635"><span class="annot"><span class="annottext">br :: r
</span><a href="#local-6989586621679378635"><span class="hs-identifier hs-var hs-var">br</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r -&gt; r
forall c. Invertible c =&gt; c -&gt; c
</span><a href="OAlg.Structure.Multiplicative.Definition.html#invert"><span class="hs-identifier hs-var">invert</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679378633"><span class="hs-identifier hs-var">b'</span></a></span><span>
</span><span id="line-421"></span><span>        </span><span class="hs-comment">-- invert b' is regular, because r is acyclic!!</span><span>
</span><span id="line-422"></span><span>        </span><span>
</span><span id="line-423"></span><span>    </span><span id="local-6989586621679377810"><span class="annot"><a href="#local-6989586621679378632"><span class="hs-identifier hs-type">rFlr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Number"><span class="hs-identifier hs-type">Number</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377810"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679377810"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679377810"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679377810"><span class="hs-identifier hs-type">r</span></a></span></span><span>
</span><span id="line-424"></span><span>    </span><span id="local-6989586621679378632"><span class="annot"><span class="annottext">rFlr :: forall r. Number r =&gt; r -&gt; [N] -&gt; r -&gt; r
</span><a href="#local-6989586621679378632"><span class="hs-identifier hs-var hs-var">rFlr</span></a></span></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span id="local-6989586621679378647"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679378647"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679378647"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-425"></span><span>    </span><span class="annot"><a href="#local-6989586621679378632"><span class="hs-identifier hs-var">rFlr</span></a></span><span> </span><span id="local-6989586621679378648"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679378648"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679378649"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679378649"><span class="hs-identifier hs-var">d</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679378650"><span class="annot"><span class="annottext">[N]
</span><a href="#local-6989586621679378650"><span class="hs-identifier hs-var">ds</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679378651"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679378651"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r -&gt; [N] -&gt; r -&gt; r
forall r. Number r =&gt; r -&gt; [N] -&gt; r -&gt; r
</span><a href="#local-6989586621679378632"><span class="hs-identifier hs-var">rFlr</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679378648"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">[N]
</span><a href="#local-6989586621679378650"><span class="hs-identifier hs-var">ds</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679378648"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall c. Multiplicative c =&gt; c -&gt; c -&gt; c
</span><a href="OAlg.Structure.Multiplicative.Definition.html#%2A"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679378651"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Additive a =&gt; a -&gt; a -&gt; a
</span><a href="OAlg.Structure.Additive.Definition.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">N -&gt; r -&gt; r
forall a. Additive a =&gt; N -&gt; a -&gt; a
</span><a href="OAlg.Structure.Additive.Definition.html#ntimes"><span class="hs-identifier hs-var">ntimes</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679378649"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">r
forall r. Semiring r =&gt; r
</span><a href="OAlg.Structure.Ring.Definition.html#rOne"><span class="hs-identifier hs-var">rOne</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-426"></span><span>
</span><span id="line-427"></span><span>    </span><span id="local-6989586621679377811"><span class="annot"><a href="#local-6989586621679378634"><span class="hs-identifier hs-type">rFrc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Number"><span class="hs-identifier hs-type">Number</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679377811"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679377811"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679377811"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679377811"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679377811"><span class="hs-identifier hs-type">r</span></a></span></span><span>
</span><span id="line-428"></span><span>    </span><span id="local-6989586621679378634"><span class="annot"><span class="annottext">rFrc :: forall r. Number r =&gt; r -&gt; r -&gt; [N] -&gt; r -&gt; r
</span><a href="#local-6989586621679378634"><span class="hs-identifier hs-var hs-var">rFrc</span></a></span></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-identifier">_</span></span><span>  </span><span class="annot"><span class="annottext">r
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621679378663"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679378663"><span class="hs-identifier hs-var">r</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679378663"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-429"></span><span>    </span><span class="annot"><a href="#local-6989586621679378634"><span class="hs-identifier hs-var">rFrc</span></a></span><span> </span><span id="local-6989586621679378664"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679378664"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679378665"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679378665"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679378666"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679378666"><span class="hs-identifier hs-var">d</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679378667"><span class="annot"><span class="annottext">[N]
</span><a href="#local-6989586621679378667"><span class="hs-identifier hs-var">ds</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679378668"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679378668"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; [N] -&gt; r -&gt; r
forall r. Number r =&gt; r -&gt; r -&gt; [N] -&gt; r -&gt; r
</span><a href="#local-6989586621679378634"><span class="hs-identifier hs-var">rFrc</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679378664"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679378669"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">[N]
</span><a href="#local-6989586621679378667"><span class="hs-identifier hs-var">ds</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679378668"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Additive a =&gt; a -&gt; a -&gt; a
</span><a href="OAlg.Structure.Additive.Definition.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679378665"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall c. Multiplicative c =&gt; c -&gt; c -&gt; c
</span><a href="OAlg.Structure.Multiplicative.Definition.html#%2A"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">N -&gt; r -&gt; r
forall a. Additive a =&gt; N -&gt; a -&gt; a
</span><a href="OAlg.Structure.Additive.Definition.html#ntimes"><span class="hs-identifier hs-var">ntimes</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679378666"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">r
forall r. Semiring r =&gt; r
</span><a href="OAlg.Structure.Ring.Definition.html#rOne"><span class="hs-identifier hs-var">rOne</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679378669"><span class="annot"><span class="annottext">z :: r
</span><a href="#local-6989586621679378669"><span class="hs-identifier hs-var hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679378664"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall c. Multiplicative c =&gt; c -&gt; c -&gt; c
</span><a href="OAlg.Structure.Multiplicative.Definition.html#%2A"><span class="hs-operator hs-var">*</span></a></span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679378665"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-430"></span></pre></body></html>