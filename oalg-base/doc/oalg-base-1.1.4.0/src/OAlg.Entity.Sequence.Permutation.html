<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE NoImplicitPrelude #-}</span><span>
</span><span id="line-3"></span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE GADTs #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances, FlexibleContexts #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE GeneralizedNewtypeDeriving #-}</span><span>
</span><span id="line-9"></span><span>
</span><span id="line-10"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- Module      : OAlg.Entity.Sequence.Permutation</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- Description : permutations on totally ordered index types</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- Copyright   : (c) Erich Gut</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- License     : BSD3</span><span>
</span><span id="line-15"></span><span class="hs-comment">-- Maintainer  : zerich.gut@gmail.com</span><span>
</span><span id="line-16"></span><span class="hs-comment">--</span><span>
</span><span id="line-17"></span><span class="hs-comment">-- permutations on totally ordered index types @__i__@ to permute the items of sequences.</span><span>
</span><span id="line-18"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">OAlg.Entity.Sequence.Permutation</span><span>
</span><span id="line-19"></span><span>  </span><span class="hs-special">(</span><span>
</span><span id="line-20"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Permutation</span></span><span>
</span><span id="line-21"></span><span>    </span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#Permutation"><span class="hs-identifier">Permutation</span></a></span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#pmt"><span class="hs-identifier">pmt</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#swap"><span class="hs-identifier">swap</span></a></span><span>
</span><span id="line-22"></span><span>
</span><span id="line-23"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Permutable</span></span><span>
</span><span id="line-24"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#PermutableSequence"><span class="hs-identifier">PermutableSequence</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#permuteByN"><span class="hs-identifier">permuteByN</span></a></span><span>
</span><span id="line-25"></span><span>
</span><span id="line-26"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Form</span></span><span>
</span><span id="line-27"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#PermutationForm"><span class="hs-identifier">PermutationForm</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#pmf"><span class="hs-identifier">pmf</span></a></span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span>    </span><span class="annot"><span class="hs-comment">-- * X</span></span><span>
</span><span id="line-30"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#xPermutation"><span class="hs-identifier">xPermutation</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#xPermutationB"><span class="hs-identifier">xPermutationB</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#xPermutationN"><span class="hs-identifier">xPermutationN</span></a></span><span>
</span><span id="line-31"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#xMltPermutation"><span class="hs-identifier">xMltPermutation</span></a></span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Propositions</span></span><span>
</span><span id="line-34"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#prpPermutation"><span class="hs-identifier">prpPermutation</span></a></span><span>
</span><span id="line-35"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#prpPermutableSequence"><span class="hs-identifier">prpPermutableSequence</span></a></span><span>
</span><span id="line-36"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#prpOprPermutation"><span class="hs-identifier">prpOprPermutation</span></a></span><span>
</span><span id="line-37"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">sequence</span></span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">map</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">filter</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">zip</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">repeat</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-operator">(++)</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">head</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">tail</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">splitAt</span></span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Foldable</span></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Proxy</span></span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="OAlg.Prelude.html"><span class="hs-identifier">OAlg.Prelude</span></a></span><span>
</span><span id="line-46"></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="OAlg.Data.Canonical.html"><span class="hs-identifier">OAlg.Data.Canonical</span></a></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="OAlg.Data.Reducible.html"><span class="hs-identifier">OAlg.Data.Reducible</span></a></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="OAlg.Data.Constructable.html"><span class="hs-identifier">OAlg.Data.Constructable</span></a></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="OAlg.Data.Symbol.html"><span class="hs-identifier">OAlg.Data.Symbol</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Data.Symbol.html#Symbol"><span class="hs-identifier">Symbol</span></a></span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.html"><span class="hs-identifier">OAlg.Entity.Product</span></a></span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="OAlg.Entity.Sequence.Definition.html"><span class="hs-identifier">OAlg.Entity.Sequence.Definition</span></a></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="OAlg.Entity.Sequence.PSequence.html"><span class="hs-identifier">OAlg.Entity.Sequence.PSequence</span></a></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="OAlg.Entity.Sequence.CSequence.html"><span class="hs-identifier">OAlg.Entity.Sequence.CSequence</span></a></span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="OAlg.Entity.Sequence.Set.html"><span class="hs-identifier">OAlg.Entity.Sequence.Set</span></a></span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="OAlg.Structure.Oriented.html"><span class="hs-identifier">OAlg.Structure.Oriented</span></a></span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="OAlg.Structure.Multiplicative.html"><span class="hs-identifier">OAlg.Structure.Multiplicative</span></a></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="OAlg.Structure.Additive.html"><span class="hs-identifier">OAlg.Structure.Additive</span></a></span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="OAlg.Structure.Exponential.html"><span class="hs-identifier">OAlg.Structure.Exponential</span></a></span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="OAlg.Structure.Operational.html"><span class="hs-identifier">OAlg.Structure.Operational</span></a></span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-66"></span><span class="hs-comment">-- PermutationForm -</span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span class="hs-comment">-- | form of a permutation from @__i__@ to @__i__@ which is given by 'pmf'.</span><span>
</span><span id="line-69"></span><span class="hs-comment">--</span><span>
</span><span id="line-70"></span><span class="hs-comment">--  __Property__ Let @p = 'PermutationForm' jis@ be in @'PermutationForm' __i__@, then</span><span>
</span><span id="line-71"></span><span class="hs-comment">-- holds: @'support' z p '==' 'image' z p@ for some proxy @z@ in @__z__ __i__@.</span><span>
</span><span id="line-72"></span><span class="hs-comment">--</span><span>
</span><span id="line-73"></span><span class="hs-comment">-- The partial sequence @ijs@ is called the __/relevant part/__ of @p@.</span><span>
</span><span id="line-74"></span><span class="hs-keyword">newtype</span><span> </span><span id="PermutationForm"><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#PermutationForm"><span class="hs-identifier hs-var">PermutationForm</span></a></span></span><span> </span><span id="local-6989586621679387402"><span class="annot"><a href="#local-6989586621679387402"><span class="hs-identifier hs-type">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="PermutationForm"><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#PermutationForm"><span class="hs-identifier hs-var">PermutationForm</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sequence.PSequence.html#PSequence"><span class="hs-identifier hs-type">PSequence</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387402"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387402"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679387852"><span id="local-6989586621679387858"><span id="local-6989586621679387862"><span class="annot"><span class="annottext">Int -&gt; PermutationForm i -&gt; ShowS
[PermutationForm i] -&gt; ShowS
PermutationForm i -&gt; String
(Int -&gt; PermutationForm i -&gt; ShowS)
-&gt; (PermutationForm i -&gt; String)
-&gt; ([PermutationForm i] -&gt; ShowS)
-&gt; Show (PermutationForm i)
forall i. Show i =&gt; Int -&gt; PermutationForm i -&gt; ShowS
forall i. Show i =&gt; [PermutationForm i] -&gt; ShowS
forall i. Show i =&gt; PermutationForm i -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: forall i. Show i =&gt; Int -&gt; PermutationForm i -&gt; ShowS
showsPrec :: Int -&gt; PermutationForm i -&gt; ShowS
$cshow :: forall i. Show i =&gt; PermutationForm i -&gt; String
show :: PermutationForm i -&gt; String
$cshowList :: forall i. Show i =&gt; [PermutationForm i] -&gt; ShowS
showList :: [PermutationForm i] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679387867"><span id="local-6989586621679387872"><span class="annot"><span class="annottext">PermutationForm i -&gt; PermutationForm i -&gt; Bool
(PermutationForm i -&gt; PermutationForm i -&gt; Bool)
-&gt; (PermutationForm i -&gt; PermutationForm i -&gt; Bool)
-&gt; Eq (PermutationForm i)
forall i. Eq i =&gt; PermutationForm i -&gt; PermutationForm i -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: forall i. Eq i =&gt; PermutationForm i -&gt; PermutationForm i -&gt; Bool
== :: PermutationForm i -&gt; PermutationForm i -&gt; Bool
$c/= :: forall i. Eq i =&gt; PermutationForm i -&gt; PermutationForm i -&gt; Bool
/= :: PermutationForm i -&gt; PermutationForm i -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679387878"><span class="annot"><span class="annottext">PermutationForm i -&gt; N
(PermutationForm i -&gt; N) -&gt; LengthN (PermutationForm i)
forall i. PermutationForm i -&gt; N
forall x. (x -&gt; N) -&gt; LengthN x
$clengthN :: forall i. PermutationForm i -&gt; N
lengthN :: PermutationForm i -&gt; N
</span><a href="OAlg.Data.Number.html#LengthN"><span class="hs-identifier hs-var hs-var hs-var hs-var">LengthN</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679387393"><span id="local-6989586621679387890"><span id="local-6989586621679387895"><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679387393"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Sequence.Definition.html#Sequence"><span class="hs-identifier hs-type">Sequence</span></a></span><span> </span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#PermutationForm"><span class="hs-identifier hs-type">PermutationForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387393"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387393"><span class="hs-identifier hs-type">i</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-77"></span><span>  </span><span id="local-6989586621679387900"><span class="annot"><span class="annottext">list :: forall (p :: * -&gt; *). p i -&gt; PermutationForm i -&gt; [(i, i)]
</span><a href="#local-6989586621679387900"><span class="hs-identifier hs-var hs-var hs-var hs-var">list</span></a></span></span><span> </span><span id="local-6989586621679387902"><span class="annot"><span class="annottext">p i
</span><a href="#local-6989586621679387902"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#PermutationForm"><span class="hs-identifier hs-type">PermutationForm</span></a></span><span> </span><span id="local-6989586621679387903"><span class="annot"><span class="annottext">PSequence i i
</span><a href="#local-6989586621679387903"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">p i -&gt; PSequence i i -&gt; [(i, i)]
forall (p :: * -&gt; *). p i -&gt; PSequence i i -&gt; [(i, i)]
forall (s :: * -&gt; *) i x (p :: * -&gt; *).
Sequence s i x =&gt;
p i -&gt; s x -&gt; [(x, i)]
</span><a href="OAlg.Entity.Sequence.Definition.html#list"><span class="hs-identifier hs-var">list</span></a></span><span> </span><span class="annot"><span class="annottext">p i
</span><a href="#local-6989586621679387902"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">PSequence i i
</span><a href="#local-6989586621679387903"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-78"></span><span>  </span><span>
</span><span id="line-79"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-80"></span><span class="hs-comment">-- pmf -</span><span>
</span><span id="line-81"></span><span>
</span><span id="line-82"></span><span class="hs-comment">-- | the associated function @__i__@ to @__i__@ and is given by:</span><span>
</span><span id="line-83"></span><span class="hs-comment">--</span><span>
</span><span id="line-84"></span><span class="hs-comment">-- __Definition__ Let @p = 'PermutationForm' jis@ be in @'PermutationForm' __i__@</span><span>
</span><span id="line-85"></span><span class="hs-comment">-- then @'pmf' p i@ is defined by: If there exists an @(j,i')@ in @'psqxs' jis@ with</span><span>
</span><span id="line-86"></span><span class="hs-comment">-- @i' '==' i@ then @'pmf' p i = j@ else @'pmf' p i = i@.</span><span>
</span><span id="line-87"></span><span class="hs-comment">--</span><span>
</span><span id="line-88"></span><span class="hs-comment">-- __Note__</span><span>
</span><span id="line-89"></span><span class="hs-comment">--</span><span>
</span><span id="line-90"></span><span class="hs-comment">-- (1) If the partial sequence @ijs@ is 'valid', then for all @i@ in @__i__@ there exists</span><span>
</span><span id="line-91"></span><span class="hs-comment">-- at most one @(_,i')@ in @'psqxs' jis@ such that @i' '==' i@. As such, the function</span><span>
</span><span id="line-92"></span><span class="hs-comment">-- @'pmf' p@ is well defined.</span><span>
</span><span id="line-93"></span><span class="hs-comment">--</span><span>
</span><span id="line-94"></span><span class="hs-comment">-- (2) If the permutation form @p@ itself is 'valid' than @'pmf' p@ is a bijection</span><span>
</span><span id="line-95"></span><span class="hs-comment">-- and as such a permutation of @__i__@.</span><span>
</span><span id="line-96"></span><span class="hs-comment">--</span><span>
</span><span id="line-97"></span><span class="hs-comment">-- (3) The behavior of 'pmf' differs from '??' as its evaluation will not end up in a</span><span>
</span><span id="line-98"></span><span class="hs-comment">-- 'IndexOutOfSupport'-exception.</span><span>
</span><span id="line-99"></span><span id="local-6989586621679387397"><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#pmf"><span class="hs-identifier hs-type">pmf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679387397"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#PermutationForm"><span class="hs-identifier hs-type">PermutationForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387397"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679387397"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679387397"><span class="hs-identifier hs-type">i</span></a></span></span><span>
</span><span id="line-100"></span><span id="pmf"><span class="annot"><span class="annottext">pmf :: forall i. Ord i =&gt; PermutationForm i -&gt; i -&gt; i
</span><a href="OAlg.Entity.Sequence.Permutation.html#pmf"><span class="hs-identifier hs-var hs-var">pmf</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#PermutationForm"><span class="hs-identifier hs-type">PermutationForm</span></a></span><span> </span><span id="local-6989586621679387910"><span class="annot"><span class="annottext">PSequence i i
</span><a href="#local-6989586621679387910"><span class="hs-identifier hs-var">jis</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679387911"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679387911"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">PSequence i i
</span><a href="#local-6989586621679387910"><span class="hs-identifier hs-var">jis</span></a></span><span> </span><span class="annot"><span class="annottext">PSequence i i -&gt; i -&gt; Maybe i
forall (s :: * -&gt; *) i x. Sequence s i x =&gt; s x -&gt; i -&gt; Maybe x
</span><a href="OAlg.Entity.Sequence.Definition.html#%3F%3F"><span class="hs-operator hs-var">??</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679387911"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-101"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679387912"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679387912"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679387912"><span class="hs-identifier hs-var">j</span></a></span><span>
</span><span id="line-102"></span><span>  </span><span class="annot"><span class="annottext">Maybe i
</span><span class="hs-identifier">_</span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679387911"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-103"></span><span>
</span><span id="line-104"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-105"></span><span class="hs-comment">-- pmfMlt -</span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span class="hs-comment">-- | @'pmfMlt' p q@ is the composition of @p@ and @q@, which is given by the</span><span>
</span><span id="line-108"></span><span class="hs-comment">-- composition of there associated functions @'pmf' p '.' 'pmf' q@.</span><span>
</span><span id="line-109"></span><span id="local-6989586621679387399"><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#pmfMlt"><span class="hs-identifier hs-type">pmfMlt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679387399"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#PermutationForm"><span class="hs-identifier hs-type">PermutationForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387399"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#PermutationForm"><span class="hs-identifier hs-type">PermutationForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387399"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#PermutationForm"><span class="hs-identifier hs-type">PermutationForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387399"><span class="hs-identifier hs-type">i</span></a></span></span><span>
</span><span id="line-110"></span><span id="pmfMlt"><span class="annot"><span class="annottext">pmfMlt :: forall i.
Ord i =&gt;
PermutationForm i -&gt; PermutationForm i -&gt; PermutationForm i
</span><a href="OAlg.Entity.Sequence.Permutation.html#pmfMlt"><span class="hs-identifier hs-var hs-var">pmfMlt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#PermutationForm"><span class="hs-identifier hs-type">PermutationForm</span></a></span><span> </span><span id="local-6989586621679387922"><span class="annot"><span class="annottext">PSequence i i
</span><a href="#local-6989586621679387922"><span class="hs-identifier hs-var">kjs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#PermutationForm"><span class="hs-identifier hs-type">PermutationForm</span></a></span><span> </span><span id="local-6989586621679387923"><span class="annot"><span class="annottext">PSequence i i
</span><a href="#local-6989586621679387923"><span class="hs-identifier hs-var">jis</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PSequence i i -&gt; PermutationForm i
forall i. PSequence i i -&gt; PermutationForm i
</span><a href="OAlg.Entity.Sequence.Permutation.html#PermutationForm"><span class="hs-identifier hs-var">PermutationForm</span></a></span><span> </span><span class="annot"><span class="annottext">PSequence i i
</span><a href="#local-6989586621679387924"><span class="hs-identifier hs-var">kis</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-111"></span><span>  </span><span id="local-6989586621679387924"><span class="annot"><span class="annottext">kis :: PSequence i i
</span><a href="#local-6989586621679387924"><span class="hs-identifier hs-var hs-var">kis</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(i, i)] -&gt; PSequence i i
forall i x. [(x, i)] -&gt; PSequence i x
</span><a href="OAlg.Entity.Sequence.PSequence.html#PSequence"><span class="hs-identifier hs-var">PSequence</span></a></span><span> </span><span class="annot"><span class="annottext">([(i, i)] -&gt; PSequence i i) -&gt; [(i, i)] -&gt; PSequence i i
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><a href="OAlg.Category.Applicative.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[(i, i)] -&gt; [(i, i)]
forall b a. Ord b =&gt; [(a, b)] -&gt; [(a, b)]
</span><a href="OAlg.Data.Ord.html#sortSnd"><span class="hs-identifier hs-var">sortSnd</span></a></span><span> </span><span class="annot"><span class="annottext">([(i, i)] -&gt; [(i, i)]) -&gt; [(i, i)] -&gt; [(i, i)]
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><a href="OAlg.Category.Applicative.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PSequence i i -&gt; [(i, i)]
forall i x. PSequence i x -&gt; [(x, i)]
</span><a href="OAlg.Entity.Sequence.PSequence.html#psqxs"><span class="hs-identifier hs-var">psqxs</span></a></span><span> </span><span class="annot"><span class="annottext">PSequence i i
</span><a href="#local-6989586621679387922"><span class="hs-identifier hs-var">kjs</span></a></span><span> </span><span class="annot"><span class="annottext">[(i, i)] -&gt; [(i, i)] -&gt; [(i, i)]
forall {a}. Ord a =&gt; [(a, a)] -&gt; [(a, a)] -&gt; [(a, a)]
</span><a href="#local-6989586621679387928"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">[(i, i)] -&gt; [(i, i)]
forall a b. Ord a =&gt; [(a, b)] -&gt; [(a, b)]
</span><a href="OAlg.Data.Ord.html#sortFst"><span class="hs-identifier hs-var">sortFst</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PSequence i i -&gt; [(i, i)]
forall i x. PSequence i x -&gt; [(x, i)]
</span><a href="OAlg.Entity.Sequence.PSequence.html#psqxs"><span class="hs-identifier hs-var">psqxs</span></a></span><span> </span><span class="annot"><span class="annottext">PSequence i i
</span><a href="#local-6989586621679387923"><span class="hs-identifier hs-var">jis</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-112"></span><span>  </span><span>
</span><span id="line-113"></span><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621679387928"><span class="annot"><span class="annottext">* :: [(a, a)] -&gt; [(a, a)] -&gt; [(a, a)]
</span><a href="#local-6989586621679387928"><span class="hs-operator hs-var hs-var">*</span></a></span></span><span> </span><span id="local-6989586621679387935"><span class="annot"><span class="annottext">[(a, a)]
</span><a href="#local-6989586621679387935"><span class="hs-identifier hs-var">jis</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(a, a)]
</span><a href="#local-6989586621679387935"><span class="hs-identifier hs-var">jis</span></a></span><span>
</span><span id="line-114"></span><span>  </span><span id="local-6989586621679387936"><span class="annot"><span class="annottext">[(a, a)]
</span><a href="#local-6989586621679387936"><span class="hs-identifier hs-var">kjs</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621679387928"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(a, a)]
</span><a href="#local-6989586621679387936"><span class="hs-identifier hs-var">kjs</span></a></span><span>
</span><span id="line-115"></span><span>  </span><span id="local-6989586621679387937"><span class="annot"><span class="annottext">kjs :: [(a, a)]
</span><a href="#local-6989586621679387937"><span class="hs-identifier hs-var">kjs</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679387938"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679387938"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679387939"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679387939"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679387940"><span class="annot"><span class="annottext">[(a, a)]
</span><a href="#local-6989586621679387940"><span class="hs-identifier hs-var">kjs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679387928"><span class="hs-operator hs-var">*</span></a></span><span> </span><span id="local-6989586621679387941"><span class="annot"><span class="annottext">jis :: [(a, a)]
</span><a href="#local-6989586621679387941"><span class="hs-identifier hs-var">jis</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679387942"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679387942"><span class="hs-identifier hs-var">j'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679387943"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679387943"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679387944"><span class="annot"><span class="annottext">[(a, a)]
</span><a href="#local-6989586621679387944"><span class="hs-identifier hs-var">jis'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679387939"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-operator hs-var">`compare`</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679387942"><span class="hs-identifier hs-var">j'</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-116"></span><span>    </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">LT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679387938"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679387939"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">(a, a) -&gt; [(a, a)] -&gt; [(a, a)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(a, a)]
</span><a href="#local-6989586621679387940"><span class="hs-identifier hs-var">kjs'</span></a></span><span> </span><span class="annot"><span class="annottext">[(a, a)] -&gt; [(a, a)] -&gt; [(a, a)]
</span><a href="#local-6989586621679387928"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">[(a, a)]
</span><a href="#local-6989586621679387941"><span class="hs-identifier hs-var">jis</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-117"></span><span>    </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">EQ</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679387938"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679387943"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">(a, a) -&gt; [(a, a)] -&gt; [(a, a)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(a, a)]
</span><a href="#local-6989586621679387940"><span class="hs-identifier hs-var">kjs'</span></a></span><span> </span><span class="annot"><span class="annottext">[(a, a)] -&gt; [(a, a)] -&gt; [(a, a)]
</span><a href="#local-6989586621679387928"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">[(a, a)]
</span><a href="#local-6989586621679387944"><span class="hs-identifier hs-var">jis'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-118"></span><span>    </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">GT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679387942"><span class="hs-identifier hs-var">j'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679387943"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">(a, a) -&gt; [(a, a)] -&gt; [(a, a)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(a, a)]
</span><a href="#local-6989586621679387937"><span class="hs-identifier hs-var">kjs</span></a></span><span> </span><span class="annot"><span class="annottext">[(a, a)] -&gt; [(a, a)] -&gt; [(a, a)]
</span><a href="#local-6989586621679387928"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">[(a, a)]
</span><a href="#local-6989586621679387944"><span class="hs-identifier hs-var">jis'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-119"></span><span>
</span><span id="line-120"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-121"></span><span class="hs-comment">-- pmfOprPsq -</span><span>
</span><span id="line-122"></span><span>
</span><span id="line-123"></span><span class="hs-comment">-- | @'pmfOprPsq' xs p@ applies the permutation form @p@ - from right - to the partial</span><span>
</span><span id="line-124"></span><span class="hs-comment">-- sequence @xs@, which is given by the composition of there associated functions</span><span>
</span><span id="line-125"></span><span class="hs-comment">-- @('??') xs '.' 'pmf' p@.</span><span>
</span><span id="line-126"></span><span id="local-6989586621679387417"><span id="local-6989586621679387418"><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#pmfOprPsq"><span class="hs-identifier hs-type">pmfOprPsq</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679387417"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Sequence.PSequence.html#PSequence"><span class="hs-identifier hs-type">PSequence</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387417"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387418"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#PermutationForm"><span class="hs-identifier hs-type">PermutationForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387417"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Sequence.PSequence.html#PSequence"><span class="hs-identifier hs-type">PSequence</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387417"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387418"><span class="hs-identifier hs-type">x</span></a></span></span></span><span>
</span><span id="line-127"></span><span id="pmfOprPsq"><span class="annot"><span class="annottext">pmfOprPsq :: forall i x.
Ord i =&gt;
PSequence i x -&gt; PermutationForm i -&gt; PSequence i x
</span><a href="OAlg.Entity.Sequence.Permutation.html#pmfOprPsq"><span class="hs-identifier hs-var hs-var">pmfOprPsq</span></a></span></span><span> </span><span id="local-6989586621679387951"><span class="annot"><span class="annottext">PSequence i x
</span><a href="#local-6989586621679387951"><span class="hs-identifier hs-var">xjs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#PermutationForm"><span class="hs-identifier hs-type">PermutationForm</span></a></span><span> </span><span id="local-6989586621679387952"><span class="annot"><span class="annottext">PSequence i i
</span><a href="#local-6989586621679387952"><span class="hs-identifier hs-var">jis</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(x, i)] -&gt; PSequence i x
forall i x. [(x, i)] -&gt; PSequence i x
</span><a href="OAlg.Entity.Sequence.PSequence.html#PSequence"><span class="hs-identifier hs-var">PSequence</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(x, i)] -&gt; [(x, i)]
forall b a. Ord b =&gt; [(a, b)] -&gt; [(a, b)]
</span><a href="OAlg.Data.Ord.html#sortSnd"><span class="hs-identifier hs-var">sortSnd</span></a></span><span> </span><span class="annot"><span class="annottext">[(x, i)]
</span><a href="#local-6989586621679387953"><span class="hs-identifier hs-var">xis</span></a></span><span> </span><span class="annot"><span class="annottext">[(x, i)] -&gt; [(x, i)] -&gt; [(x, i)]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[(x, i)]
</span><a href="#local-6989586621679387954"><span class="hs-identifier hs-var">xis'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-128"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679387953"><span class="annot"><span class="annottext">[(x, i)]
</span><a href="#local-6989586621679387953"><span class="hs-identifier hs-var">xis</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679387954"><span class="annot"><span class="annottext">[(x, i)]
</span><a href="#local-6989586621679387954"><span class="hs-identifier hs-var">xis'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PSequence i x -&gt; [(x, i)]
forall i x. PSequence i x -&gt; [(x, i)]
</span><a href="OAlg.Entity.Sequence.PSequence.html#psqxs"><span class="hs-identifier hs-var">psqxs</span></a></span><span> </span><span class="annot"><span class="annottext">PSequence i x
</span><a href="#local-6989586621679387951"><span class="hs-identifier hs-var">xjs</span></a></span><span> </span><span class="annot"><span class="annottext">[(x, i)] -&gt; [(i, i)] -&gt; ([(x, i)], [(x, i)])
forall {b} {a}.
Ord b =&gt;
[(a, b)] -&gt; [(b, b)] -&gt; ([(a, b)], [(a, b)])
</span><a href="#local-6989586621679387955"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">[(i, i)] -&gt; [(i, i)]
forall a b. Ord a =&gt; [(a, b)] -&gt; [(a, b)]
</span><a href="OAlg.Data.Ord.html#sortFst"><span class="hs-identifier hs-var">sortFst</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PSequence i i -&gt; [(i, i)]
forall i x. PSequence i x -&gt; [(x, i)]
</span><a href="OAlg.Entity.Sequence.PSequence.html#psqxs"><span class="hs-identifier hs-var">psqxs</span></a></span><span> </span><span class="annot"><span class="annottext">PSequence i i
</span><a href="#local-6989586621679387952"><span class="hs-identifier hs-var">jis</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-129"></span><span>
</span><span id="line-130"></span><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621679387955"><span class="annot"><span class="annottext">* :: [(a, b)] -&gt; [(b, b)] -&gt; ([(a, b)], [(a, b)])
</span><a href="#local-6989586621679387955"><span class="hs-operator hs-var hs-var">*</span></a></span></span><span> </span><span class="annot"><span class="annottext">[(b, b)]
</span><span class="hs-identifier">_</span></span><span>                               </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-131"></span><span>  </span><span id="local-6989586621679387960"><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621679387960"><span class="hs-identifier hs-var">xjs</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621679387955"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>                             </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621679387960"><span class="hs-identifier hs-var">xjs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-132"></span><span>  </span><span id="local-6989586621679387961"><span class="annot"><span class="annottext">xjs :: [(a, b)]
</span><a href="#local-6989586621679387961"><span class="hs-identifier hs-var">xjs</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679387962"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679387962"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679387963"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679387963"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679387964"><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621679387964"><span class="hs-identifier hs-var">xjs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679387955"><span class="hs-operator hs-var">*</span></a></span><span> </span><span id="local-6989586621679387965"><span class="annot"><span class="annottext">jis :: [(b, b)]
</span><a href="#local-6989586621679387965"><span class="hs-identifier hs-var">jis</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679387966"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679387966"><span class="hs-identifier hs-var">j'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679387967"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679387967"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679387968"><span class="annot"><span class="annottext">[(b, b)]
</span><a href="#local-6989586621679387968"><span class="hs-identifier hs-var">jis'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679387963"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; b -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-operator hs-var">`compare`</span></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679387966"><span class="hs-identifier hs-var">j'</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-133"></span><span>    </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">LT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679387962"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679387963"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">(a, b) -&gt; [(a, b)] -&gt; [(a, b)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621679387969"><span class="hs-identifier hs-var">xis</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621679387970"><span class="hs-identifier hs-var">xis'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679387969"><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621679387969"><span class="hs-identifier hs-var">xis</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679387970"><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621679387970"><span class="hs-identifier hs-var">xis'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621679387964"><span class="hs-identifier hs-var">xjs'</span></a></span><span> </span><span class="annot"><span class="annottext">[(a, b)] -&gt; [(b, b)] -&gt; ([(a, b)], [(a, b)])
</span><a href="#local-6989586621679387955"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">[(b, b)]
</span><a href="#local-6989586621679387965"><span class="hs-identifier hs-var">jis</span></a></span><span>
</span><span id="line-134"></span><span>    </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">EQ</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679387962"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679387967"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">(a, b) -&gt; [(a, b)] -&gt; [(a, b)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621679387971"><span class="hs-identifier hs-var">xis</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621679387972"><span class="hs-identifier hs-var">xis'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679387971"><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621679387971"><span class="hs-identifier hs-var">xis</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679387972"><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621679387972"><span class="hs-identifier hs-var">xis'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621679387964"><span class="hs-identifier hs-var">xjs'</span></a></span><span> </span><span class="annot"><span class="annottext">[(a, b)] -&gt; [(b, b)] -&gt; ([(a, b)], [(a, b)])
</span><a href="#local-6989586621679387955"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">[(b, b)]
</span><a href="#local-6989586621679387968"><span class="hs-identifier hs-var">jis'</span></a></span><span>
</span><span id="line-135"></span><span>    </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">GT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621679387961"><span class="hs-identifier hs-var">xjs</span></a></span><span> </span><span class="annot"><span class="annottext">[(a, b)] -&gt; [(b, b)] -&gt; ([(a, b)], [(a, b)])
</span><a href="#local-6989586621679387955"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">[(b, b)]
</span><a href="#local-6989586621679387968"><span class="hs-identifier hs-var">jis'</span></a></span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-138"></span><span class="hs-comment">-- pmfOprLst -</span><span>
</span><span id="line-139"></span><span>
</span><span id="line-140"></span><span class="hs-comment">-- | @'pmfOprPsq' xs p@ applies the permutation form @p@ - from right - to the list</span><span>
</span><span id="line-141"></span><span class="hs-comment">-- @xs@, which is given by 'pmfOprPsq' applied to @'PSequence' (xs `'zip` [0..])@.</span><span>
</span><span id="line-142"></span><span class="hs-comment">--</span><span>
</span><span id="line-143"></span><span class="hs-comment">-- __Note__ If @'It' ('lengthN') '&lt;=' u@ - where @(_,u) = 'span' p@ - then no</span><span>
</span><span id="line-144"></span><span class="hs-comment">-- exception will be thrown, but the 'lengthN' of the resulting list may be smaller!</span><span>
</span><span id="line-145"></span><span id="local-6989586621679387424"><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#pmfOprLst"><span class="hs-identifier hs-type">pmfOprLst</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679387424"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#PermutationForm"><span class="hs-identifier hs-type">PermutationForm</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679387424"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-146"></span><span id="pmfOprLst"><span class="annot"><span class="annottext">pmfOprLst :: forall x. [x] -&gt; PermutationForm N -&gt; [x]
</span><a href="OAlg.Entity.Sequence.Permutation.html#pmfOprLst"><span class="hs-identifier hs-var hs-var">pmfOprLst</span></a></span></span><span> </span><span id="local-6989586621679387981"><span class="annot"><span class="annottext">[x]
</span><a href="#local-6989586621679387981"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621679387982"><span class="annot"><span class="annottext">PermutationForm N
</span><a href="#local-6989586621679387982"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PSequence N x -&gt; [x]
forall a b. Projectible a b =&gt; b -&gt; a
</span><a href="OAlg.Data.Canonical.html#prj"><span class="hs-identifier hs-var">prj</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PSequence N x
</span><a href="#local-6989586621679387984"><span class="hs-identifier hs-var">xs'</span></a></span><span> </span><span class="annot"><span class="annottext">PSequence N x -&gt; PermutationForm N -&gt; PSequence N x
forall i x.
Ord i =&gt;
PSequence i x -&gt; PermutationForm i -&gt; PSequence i x
</span><a href="OAlg.Entity.Sequence.Permutation.html#pmfOprPsq"><span class="hs-operator hs-var">`pmfOprPsq`</span></a></span><span> </span><span class="annot"><span class="annottext">PermutationForm N
</span><a href="#local-6989586621679387982"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-147"></span><span>  </span><span id="local-6989586621679387984"><span class="annot"><span class="annottext">xs' :: PSequence N x
</span><a href="#local-6989586621679387984"><span class="hs-identifier hs-var hs-var">xs'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679387985"><span class="annot"><span class="annottext">[x] -&gt; PSequence N x
forall {x}. [x] -&gt; PSequence N x
forall a b. Embeddable a b =&gt; a -&gt; b
</span><a href="OAlg.Data.Canonical.html#inj"><span class="hs-identifier hs-var">inj</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679387985"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Sequence.PSequence.html#PSequence"><span class="hs-identifier hs-type">PSequence</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387985"><span class="hs-identifier hs-type">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[x]
</span><a href="#local-6989586621679387981"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-148"></span><span>
</span><span id="line-149"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-150"></span><span class="hs-comment">-- pmfOprPsy -</span><span>
</span><span id="line-151"></span><span>
</span><span id="line-152"></span><span class="hs-keyword">type</span><span> </span><span id="I"><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#I"><span class="hs-identifier hs-var">I</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span>
</span><span id="line-153"></span><span class="hs-keyword">type</span><span> </span><span id="WordN"><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#WordN"><span class="hs-identifier hs-var">WordN</span></a></span></span><span> </span><span id="local-6989586621679387990"><span class="annot"><a href="#local-6989586621679387990"><span class="hs-identifier hs-type">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679387990"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">,</span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span class="annot"><span class="hs-comment">-- | permutes the product symbol by the given permeation form.</span></span><span>
</span><span id="line-156"></span><span id="local-6989586621679387435"><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#pmfOprPsy"><span class="hs-identifier hs-type">pmfOprPsy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.Entity.Definition.html#Entity"><span class="hs-identifier hs-type">Entity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387435"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Sequence.CSequence.html#CSequence"><span class="hs-identifier hs-type">CSequence</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387435"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#PermutationForm"><span class="hs-identifier hs-type">PermutationForm</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Sequence.CSequence.html#CSequence"><span class="hs-identifier hs-type">CSequence</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387435"><span class="hs-identifier hs-type">x</span></a></span></span><span>
</span><span id="line-157"></span><span id="pmfOprPsy"><span class="annot"><span class="annottext">pmfOprPsy :: forall x.
Entity x =&gt;
CSequence x -&gt; PermutationForm N -&gt; CSequence x
</span><a href="OAlg.Entity.Sequence.Permutation.html#pmfOprPsy"><span class="hs-identifier hs-var hs-var">pmfOprPsy</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Product.ProductSymbol.html#ProductSymbol"><span class="hs-identifier hs-type">ProductSymbol</span></a></span><span> </span><span id="local-6989586621679388012"><span class="annot"><span class="annottext">Product N (U x)
</span><a href="#local-6989586621679388012"><span class="hs-identifier hs-var">xjs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679388013"><span class="annot"><span class="annottext">PermutationForm N
</span><a href="#local-6989586621679388013"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CSequence x
</span><a href="#local-6989586621679388014"><span class="hs-identifier hs-var">xis</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-158"></span><span>  </span><span id="local-6989586621679388014"><span class="annot"><span class="annottext">xis :: CSequence x
</span><a href="#local-6989586621679388014"><span class="hs-identifier hs-var hs-var">xis</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Form (CSequence x) -&gt; CSequence x
ProductForm N (U x) -&gt; CSequence x
forall x. Constructable x =&gt; Form x -&gt; x
</span><a href="OAlg.Data.Constructable.html#make"><span class="hs-identifier hs-var">make</span></a></span><span> </span><span class="annot"><span class="annottext">(ProductForm N (U x) -&gt; CSequence x)
-&gt; ProductForm N (U x) -&gt; CSequence x
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><a href="OAlg.Category.Applicative.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Point (U x) -&gt; Word N (U x) -&gt; ProductForm N (U x)
forall r a. Semiring r =&gt; Point a -&gt; Word r a -&gt; ProductForm r a
</span><a href="OAlg.Entity.Product.Definition.html#wrdprf"><span class="hs-identifier hs-var">wrdprf</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Word N (U x) -&gt; ProductForm N (U x))
-&gt; Word N (U x) -&gt; ProductForm N (U x)
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><a href="OAlg.Category.Applicative.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[(U x, N)] -&gt; Word N (U x)
forall r a. [(a, r)] -&gt; Word r a
</span><a href="OAlg.Entity.Product.Definition.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="annot"><span class="annottext">([(U x, N)] -&gt; Word N (U x)) -&gt; [(U x, N)] -&gt; Word N (U x)
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><a href="OAlg.Category.Applicative.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Span N -&gt; N -&gt; [(U x, N)] -&gt; PermutationForm N -&gt; [(U x, N)]
forall u. Span N -&gt; N -&gt; WordN u -&gt; PermutationForm N -&gt; WordN u
</span><a href="#local-6989586621679388018"><span class="hs-identifier hs-var">opr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe N -&gt; PermutationForm N -&gt; Span N
forall (s :: * -&gt; *) i x (p :: * -&gt; *).
Sequence s i x =&gt;
p i -&gt; s x -&gt; Span i
</span><a href="OAlg.Entity.Sequence.Definition.html#span"><span class="hs-identifier hs-var">span</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">N -&gt; Maybe N
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span class="hs-glyph">::</span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PermutationForm N
</span><a href="#local-6989586621679388013"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word N (U x) -&gt; [(U x, N)]
forall r a. Word r a -&gt; [(a, r)]
</span><a href="OAlg.Entity.Product.Definition.html#fromWord"><span class="hs-identifier hs-var">fromWord</span></a></span><span> </span><span class="annot"><span class="annottext">(Word N (U x) -&gt; [(U x, N)]) -&gt; Word N (U x) -&gt; [(U x, N)]
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><a href="OAlg.Category.Applicative.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Product N (U x) -&gt; Word N (U x)
forall r a. (Integral r, Oriented a) =&gt; Product r a -&gt; Word r a
</span><a href="OAlg.Entity.Product.Definition.html#prwrd"><span class="hs-identifier hs-var">prwrd</span></a></span><span> </span><span class="annot"><span class="annottext">Product N (U x)
</span><a href="#local-6989586621679388012"><span class="hs-identifier hs-var">xjs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PermutationForm N
</span><a href="#local-6989586621679388013"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-159"></span><span>
</span><span id="line-160"></span><span>  </span><span id="local-6989586621679387468"><span class="annot"><a href="#local-6989586621679388021"><span class="hs-identifier hs-type">expand</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679387468"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">,</span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679387468"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">,</span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#I"><span class="hs-identifier hs-type">I</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-161"></span><span>  </span><span id="local-6989586621679388021"><span class="annot"><span class="annottext">expand :: forall u. N -&gt; (u, N) -&gt; [(u, N)]
</span><a href="#local-6989586621679388021"><span class="hs-identifier hs-var hs-var">expand</span></a></span></span><span> </span><span id="local-6989586621679388024"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679388024"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679388025"><span class="annot"><span class="annottext">u
</span><a href="#local-6989586621679388025"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679388026"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679388026"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">N -&gt; [u] -&gt; [u]
forall a. N -&gt; [a] -&gt; [a]
</span><a href="OAlg.Data.Number.html#takeN"><span class="hs-identifier hs-var">takeN</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679388026"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">([u] -&gt; [u]) -&gt; [u] -&gt; [u]
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><a href="OAlg.Category.Applicative.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">u -&gt; [u]
forall a. a -&gt; [a]
</span><span class="hs-identifier hs-var">repeat</span></span><span> </span><span class="annot"><span class="annottext">u
</span><a href="#local-6989586621679388025"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[u] -&gt; [N] -&gt; [(u, N)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-operator hs-var">`zip`</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679388024"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-glyph">..</span><span class="hs-special">]</span><span>
</span><span id="line-162"></span><span>
</span><span id="line-163"></span><span>  </span><span id="local-6989586621679387458"><span class="annot"><a href="#local-6989586621679388018"><span class="hs-identifier hs-type">opr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.Data.Ord.html#Span"><span class="hs-identifier hs-type">Span</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#WordN"><span class="hs-identifier hs-type">WordN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387458"><span class="hs-identifier hs-type">u</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#PermutationForm"><span class="hs-identifier hs-type">PermutationForm</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#WordN"><span class="hs-identifier hs-type">WordN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387458"><span class="hs-identifier hs-type">u</span></a></span></span><span>
</span><span id="line-164"></span><span>  </span><span id="local-6989586621679388018"><span class="annot"><span class="annottext">opr :: forall u. Span N -&gt; N -&gt; WordN u -&gt; PermutationForm N -&gt; WordN u
</span><a href="#local-6989586621679388018"><span class="hs-identifier hs-var hs-var">opr</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679388034"><span class="annot"><span class="annottext">Closer N
</span><a href="#local-6989586621679388034"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679388035"><span class="annot"><span class="annottext">Closer N
</span><a href="#local-6989586621679388035"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679388036"><span class="annot"><span class="annottext">WordN u
</span><a href="#local-6989586621679388036"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="annot"><span class="annottext">PermutationForm N
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Closer N
</span><a href="#local-6989586621679388035"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Closer N -&gt; Closer N -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Closer N
</span><a href="#local-6989586621679388034"><span class="hs-identifier hs-var">l</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WordN u
</span><a href="#local-6989586621679388036"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-comment">-- empty span</span><span>
</span><span id="line-165"></span><span>  </span><span class="annot"><a href="#local-6989586621679388018"><span class="hs-identifier hs-var">opr</span></a></span><span> </span><span class="annot"><span class="annottext">Span N
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">PermutationForm N
</span><span class="hs-identifier">_</span></span><span>                     </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-166"></span><span>  </span><span class="annot"><a href="#local-6989586621679388018"><span class="hs-identifier hs-var">opr</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679388037"><span class="annot"><span class="annottext">Closer N
</span><a href="#local-6989586621679388037"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679388038"><span class="annot"><span class="annottext">Closer N
</span><a href="#local-6989586621679388038"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679388039"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679388039"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679388040"><span class="annot"><span class="annottext">(u, N)
</span><a href="#local-6989586621679388040"><span class="hs-identifier hs-var">w</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679388041"><span class="annot"><span class="annottext">WordN u
</span><a href="#local-6989586621679388041"><span class="hs-identifier hs-var">ws</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679388042"><span class="annot"><span class="annottext">PermutationForm N
</span><a href="#local-6989586621679388042"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">N -&gt; Closer N
forall x. x -&gt; Closer x
</span><a href="OAlg.Data.Ord.html#It"><span class="hs-identifier hs-var">It</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679388043"><span class="hs-identifier hs-var">k'</span></a></span><span> </span><span class="annot"><span class="annottext">Closer N -&gt; Closer N -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Closer N
</span><a href="#local-6989586621679388037"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(u, N)
</span><a href="#local-6989586621679388040"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">(u, N) -&gt; WordN u -&gt; WordN u
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Span N -&gt; N -&gt; WordN u -&gt; PermutationForm N -&gt; WordN u
forall u. Span N -&gt; N -&gt; WordN u -&gt; PermutationForm N -&gt; WordN u
</span><a href="#local-6989586621679388018"><span class="hs-identifier hs-var">opr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Closer N
</span><a href="#local-6989586621679388037"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Closer N
</span><a href="#local-6989586621679388038"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679388043"><span class="hs-identifier hs-var">k'</span></a></span><span> </span><span class="annot"><span class="annottext">WordN u
</span><a href="#local-6989586621679388041"><span class="hs-identifier hs-var">ws</span></a></span><span> </span><span class="annot"><span class="annottext">PermutationForm N
</span><a href="#local-6989586621679388042"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-167"></span><span>                        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Closer N
</span><a href="#local-6989586621679388038"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Closer N -&gt; Closer N -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">N -&gt; Closer N
forall x. x -&gt; Closer x
</span><a href="OAlg.Data.Ord.html#It"><span class="hs-identifier hs-var">It</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679388043"><span class="hs-identifier hs-var">k'</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(u, N)
</span><a href="#local-6989586621679388040"><span class="hs-identifier hs-var">w</span></a></span><span class="annot"><span class="annottext">(u, N) -&gt; WordN u -&gt; WordN u
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">WordN u
</span><a href="#local-6989586621679388041"><span class="hs-identifier hs-var">ws</span></a></span><span> </span><span class="hs-comment">-- see the note below</span><span>
</span><span id="line-168"></span><span>                        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Closer N -&gt; N -&gt; WordN u -&gt; WordN u -&gt; PermutationForm N -&gt; WordN u
forall u.
Closer N
-&gt; N -&gt; [(u, N)] -&gt; [(u, N)] -&gt; PermutationForm N -&gt; [(u, N)]
</span><a href="#local-6989586621679388045"><span class="hs-identifier hs-var">opr'</span></a></span><span> </span><span class="annot"><span class="annottext">Closer N
</span><a href="#local-6989586621679388038"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679388039"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(u, N)
</span><a href="#local-6989586621679388040"><span class="hs-identifier hs-var">w</span></a></span><span class="annot"><span class="annottext">(u, N) -&gt; WordN u -&gt; WordN u
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">WordN u
</span><a href="#local-6989586621679388041"><span class="hs-identifier hs-var">ws</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PermutationForm N
</span><a href="#local-6989586621679388042"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-169"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679388043"><span class="annot"><span class="annottext">k' :: N
</span><a href="#local-6989586621679388043"><span class="hs-identifier hs-var hs-var">k'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679388039"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; N
forall a. Additive a =&gt; a -&gt; a -&gt; a
</span><a href="OAlg.Structure.Additive.Definition.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">(u, N) -&gt; N
forall a b. (a, b) -&gt; b
</span><a href="OAlg.Category.Definition.html#snd"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">(u, N)
</span><a href="#local-6989586621679388040"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-170"></span><span>    </span><span class="hs-comment">-- Note: the span of p is within the first word w, and as such, applying p</span><span>
</span><span id="line-171"></span><span>    </span><span class="hs-comment">-- will not alter w.</span><span>
</span><span id="line-172"></span><span>
</span><span id="line-173"></span><span>  </span><span id="local-6989586621679387479"><span class="annot"><a href="#local-6989586621679388045"><span class="hs-identifier hs-type">opr'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.Data.Ord.html#Closer"><span class="hs-identifier hs-type">Closer</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679387479"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">,</span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#I"><span class="hs-identifier hs-type">I</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#WordN"><span class="hs-identifier hs-type">WordN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387479"><span class="hs-identifier hs-type">u</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#PermutationForm"><span class="hs-identifier hs-type">PermutationForm</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#WordN"><span class="hs-identifier hs-type">WordN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387479"><span class="hs-identifier hs-type">u</span></a></span></span><span>
</span><span id="line-174"></span><span>  </span><span id="local-6989586621679388045"><span class="annot"><span class="annottext">opr' :: forall u.
Closer N
-&gt; N -&gt; [(u, N)] -&gt; [(u, N)] -&gt; PermutationForm N -&gt; [(u, N)]
</span><a href="#local-6989586621679388045"><span class="hs-identifier hs-var hs-var">opr'</span></a></span></span><span> </span><span class="annot"><span class="annottext">Closer N
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679388050"><span class="annot"><span class="annottext">[(u, N)]
</span><a href="#local-6989586621679388050"><span class="hs-identifier hs-var">uis</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621679388051"><span class="annot"><span class="annottext">PermutationForm N
</span><a href="#local-6989586621679388051"><span class="hs-identifier hs-var">p</span></a></span></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PSequence N u -&gt; PermutationForm N -&gt; [(u, N)]
forall u. PSequence N u -&gt; PermutationForm N -&gt; WordN u
</span><a href="#local-6989586621679388052"><span class="hs-identifier hs-var">opr''</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(u, N)] -&gt; PSequence N u
forall i x. [(x, i)] -&gt; PSequence i x
</span><a href="OAlg.Entity.Sequence.PSequence.html#PSequence"><span class="hs-identifier hs-var">PSequence</span></a></span><span> </span><span class="annot"><span class="annottext">[(u, N)]
</span><a href="#local-6989586621679388050"><span class="hs-identifier hs-var">uis</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PermutationForm N
</span><a href="#local-6989586621679388051"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-175"></span><span>  </span><span class="annot"><a href="#local-6989586621679388045"><span class="hs-identifier hs-var">opr'</span></a></span><span> </span><span id="local-6989586621679388053"><span class="annot"><span class="annottext">Closer N
</span><a href="#local-6989586621679388053"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621679388054"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679388054"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679388055"><span class="annot"><span class="annottext">[(u, N)]
</span><a href="#local-6989586621679388055"><span class="hs-identifier hs-var">uis</span></a></span></span><span> </span><span id="local-6989586621679388056"><span class="annot"><span class="annottext">[(u, N)]
</span><a href="#local-6989586621679388056"><span class="hs-identifier hs-var">ws</span></a></span></span><span> </span><span id="local-6989586621679388057"><span class="annot"><span class="annottext">PermutationForm N
</span><a href="#local-6989586621679388057"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Closer N
</span><a href="#local-6989586621679388053"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Closer N -&gt; Closer N -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">N -&gt; Closer N
forall x. x -&gt; Closer x
</span><a href="OAlg.Data.Ord.html#It"><span class="hs-identifier hs-var">It</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679388054"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PSequence N u -&gt; PermutationForm N -&gt; [(u, N)]
forall u. PSequence N u -&gt; PermutationForm N -&gt; WordN u
</span><a href="#local-6989586621679388052"><span class="hs-identifier hs-var">opr''</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(u, N)] -&gt; PSequence N u
forall i x. [(x, i)] -&gt; PSequence i x
</span><a href="OAlg.Entity.Sequence.PSequence.html#PSequence"><span class="hs-identifier hs-var">PSequence</span></a></span><span> </span><span class="annot"><span class="annottext">[(u, N)]
</span><a href="#local-6989586621679388055"><span class="hs-identifier hs-var">uis</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PermutationForm N
</span><a href="#local-6989586621679388057"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">[(u, N)] -&gt; [(u, N)] -&gt; [(u, N)]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[(u, N)]
</span><a href="#local-6989586621679388056"><span class="hs-identifier hs-var">ws</span></a></span><span>
</span><span id="line-176"></span><span>  </span><span class="annot"><a href="#local-6989586621679388045"><span class="hs-identifier hs-var">opr'</span></a></span><span> </span><span id="local-6989586621679388058"><span class="annot"><span class="annottext">Closer N
</span><a href="#local-6989586621679388058"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621679388059"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679388059"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679388060"><span class="annot"><span class="annottext">[(u, N)]
</span><a href="#local-6989586621679388060"><span class="hs-identifier hs-var">uis</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679388061"><span class="annot"><span class="annottext">(u, N)
</span><a href="#local-6989586621679388061"><span class="hs-identifier hs-var">w</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679388062"><span class="annot"><span class="annottext">[(u, N)]
</span><a href="#local-6989586621679388062"><span class="hs-identifier hs-var">ws</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679388063"><span class="annot"><span class="annottext">PermutationForm N
</span><a href="#local-6989586621679388063"><span class="hs-identifier hs-var">p</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Closer N
-&gt; N -&gt; [(u, N)] -&gt; [(u, N)] -&gt; PermutationForm N -&gt; [(u, N)]
forall u.
Closer N
-&gt; N -&gt; [(u, N)] -&gt; [(u, N)] -&gt; PermutationForm N -&gt; [(u, N)]
</span><a href="#local-6989586621679388045"><span class="hs-identifier hs-var">opr'</span></a></span><span> </span><span class="annot"><span class="annottext">Closer N
</span><a href="#local-6989586621679388058"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679388059"><span class="hs-identifier hs-var">k</span></a></span><span class="annot"><span class="annottext">N -&gt; N -&gt; N
forall a. Additive a =&gt; a -&gt; a -&gt; a
</span><a href="OAlg.Structure.Additive.Definition.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span class="annot"><span class="annottext">(u, N) -&gt; N
forall a b. (a, b) -&gt; b
</span><a href="OAlg.Category.Definition.html#snd"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">(u, N)
</span><a href="#local-6989586621679388061"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(u, N)]
</span><a href="#local-6989586621679388060"><span class="hs-identifier hs-var">uis</span></a></span><span> </span><span class="annot"><span class="annottext">[(u, N)] -&gt; [(u, N)] -&gt; [(u, N)]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">N -&gt; (u, N) -&gt; [(u, N)]
forall u. N -&gt; (u, N) -&gt; [(u, N)]
</span><a href="#local-6989586621679388021"><span class="hs-identifier hs-var">expand</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679388059"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">(u, N)
</span><a href="#local-6989586621679388061"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(u, N)]
</span><a href="#local-6989586621679388062"><span class="hs-identifier hs-var">ws</span></a></span><span> </span><span class="annot"><span class="annottext">PermutationForm N
</span><a href="#local-6989586621679388063"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-177"></span><span>
</span><span id="line-178"></span><span>  </span><span id="local-6989586621679387484"><span class="annot"><a href="#local-6989586621679388052"><span class="hs-identifier hs-type">opr''</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.Entity.Sequence.PSequence.html#PSequence"><span class="hs-identifier hs-type">PSequence</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387484"><span class="hs-identifier hs-type">u</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#PermutationForm"><span class="hs-identifier hs-type">PermutationForm</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#WordN"><span class="hs-identifier hs-type">WordN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387484"><span class="hs-identifier hs-type">u</span></a></span></span><span>
</span><span id="line-179"></span><span>  </span><span id="local-6989586621679388052"><span class="annot"><span class="annottext">opr'' :: forall u. PSequence N u -&gt; PermutationForm N -&gt; WordN u
</span><a href="#local-6989586621679388052"><span class="hs-identifier hs-var hs-var">opr''</span></a></span></span><span> </span><span id="local-6989586621679388068"><span class="annot"><span class="annottext">PSequence N u
</span><a href="#local-6989586621679388068"><span class="hs-identifier hs-var">uis</span></a></span></span><span> </span><span id="local-6989586621679388069"><span class="annot"><span class="annottext">PermutationForm N
</span><a href="#local-6989586621679388069"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((u, N) -&gt; (u, N)) -&gt; [(u, N)] -&gt; [(u, N)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679388070"><span class="annot"><span class="annottext">u
</span><a href="#local-6989586621679388070"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">N
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">u
</span><a href="#local-6989586621679388070"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">N
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(u, N)] -&gt; [(u, N)]) -&gt; [(u, N)] -&gt; [(u, N)]
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><a href="OAlg.Category.Applicative.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PSequence N u -&gt; [(u, N)]
forall i x. PSequence i x -&gt; [(x, i)]
</span><a href="OAlg.Entity.Sequence.PSequence.html#psqxs"><span class="hs-identifier hs-var">psqxs</span></a></span><span> </span><span class="annot"><span class="annottext">(PSequence N u -&gt; [(u, N)]) -&gt; PSequence N u -&gt; [(u, N)]
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><a href="OAlg.Category.Applicative.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PSequence N u
</span><a href="#local-6989586621679388068"><span class="hs-identifier hs-var">uis</span></a></span><span> </span><span class="annot"><span class="annottext">PSequence N u -&gt; PermutationForm N -&gt; PSequence N u
forall i x.
Ord i =&gt;
PSequence i x -&gt; PermutationForm i -&gt; PSequence i x
</span><a href="OAlg.Entity.Sequence.Permutation.html#pmfOprPsq"><span class="hs-operator hs-var">`pmfOprPsq`</span></a></span><span> </span><span class="annot"><span class="annottext">PermutationForm N
</span><a href="#local-6989586621679388069"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-180"></span><span>
</span><span id="line-181"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-182"></span><span class="hs-comment">-- pmfPsq -</span><span>
</span><span id="line-183"></span><span>
</span><span id="line-184"></span><span class="hs-comment">-- | orders the partial sequence according to the given ordering an delivers the resulting</span><span>
</span><span id="line-185"></span><span class="hs-comment">-- permutation form.</span><span>
</span><span id="line-186"></span><span id="local-6989586621679387488"><span id="local-6989586621679387489"><span id="local-6989586621679387490"><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#pmfPsq"><span class="hs-identifier hs-type">pmfPsq</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679387488"><span class="hs-identifier hs-type">i</span></a></span><span>
</span><span id="line-187"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679387489"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679387489"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ordering</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679387490"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679387489"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Sequence.PSequence.html#PSequence"><span class="hs-identifier hs-type">PSequence</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387488"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387490"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sequence.PSequence.html#PSequence"><span class="hs-identifier hs-type">PSequence</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387488"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387490"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">,</span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#PermutationForm"><span class="hs-identifier hs-type">PermutationForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387488"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-188"></span><span id="pmfPsq"><span class="annot"><span class="annottext">pmfPsq :: forall i w x.
Ord i =&gt;
(w -&gt; w -&gt; Ordering)
-&gt; (x -&gt; w) -&gt; PSequence i x -&gt; (PSequence i x, PermutationForm i)
</span><a href="OAlg.Entity.Sequence.Permutation.html#pmfPsq"><span class="hs-identifier hs-var hs-var">pmfPsq</span></a></span></span><span> </span><span id="local-6989586621679388077"><span class="annot"><span class="annottext">w -&gt; w -&gt; Ordering
</span><a href="#local-6989586621679388077"><span class="hs-identifier hs-var">wcmp</span></a></span></span><span> </span><span id="local-6989586621679388078"><span class="annot"><span class="annottext">x -&gt; w
</span><a href="#local-6989586621679388078"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sequence.PSequence.html#PSequence"><span class="hs-identifier hs-type">PSequence</span></a></span><span> </span><span id="local-6989586621679388079"><span class="annot"><span class="annottext">[(x, i)]
</span><a href="#local-6989586621679388079"><span class="hs-identifier hs-var">xjs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(x, i)] -&gt; PSequence i x
forall i x. [(x, i)] -&gt; PSequence i x
</span><a href="OAlg.Entity.Sequence.PSequence.html#PSequence"><span class="hs-identifier hs-var">PSequence</span></a></span><span> </span><span class="annot"><span class="annottext">[(x, i)]
</span><a href="#local-6989586621679388080"><span class="hs-identifier hs-var">xjs'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">PSequence i i -&gt; PermutationForm i
forall i. PSequence i i -&gt; PermutationForm i
</span><a href="OAlg.Entity.Sequence.Permutation.html#PermutationForm"><span class="hs-identifier hs-var">PermutationForm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(i, i)] -&gt; PSequence i i
forall i x. [(x, i)] -&gt; PSequence i x
</span><a href="OAlg.Entity.Sequence.PSequence.html#PSequence"><span class="hs-identifier hs-var">PSequence</span></a></span><span> </span><span class="annot"><span class="annottext">[(i, i)]
</span><a href="#local-6989586621679388081"><span class="hs-identifier hs-var">jis</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-189"></span><span>  </span><span id="local-6989586621679388082"><span class="annot"><span class="annottext">wjxs :: [((w, i), x)]
</span><a href="#local-6989586621679388082"><span class="hs-identifier hs-var hs-var">wjxs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((w, i) -&gt; (w, i) -&gt; Ordering) -&gt; [((w, i), x)] -&gt; [((w, i), x)]
forall a b. (a -&gt; a -&gt; Ordering) -&gt; [(a, b)] -&gt; [(a, b)]
</span><a href="OAlg.Data.Ord.html#sortFstBy"><span class="hs-identifier hs-var">sortFstBy</span></a></span><span> </span><span class="annot"><span class="annottext">(w, i) -&gt; (w, i) -&gt; Ordering
</span><a href="#local-6989586621679388084"><span class="hs-identifier hs-var">cmp</span></a></span><span> </span><span class="annot"><span class="annottext">([((w, i), x)] -&gt; [((w, i), x)]) -&gt; [((w, i), x)] -&gt; [((w, i), x)]
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><a href="OAlg.Category.Applicative.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">((x, i) -&gt; ((w, i), x)) -&gt; [(x, i)] -&gt; [((w, i), x)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679388085"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679388085"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679388086"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679388086"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">x -&gt; w
</span><a href="#local-6989586621679388078"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679388085"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679388086"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679388085"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(x, i)]
</span><a href="#local-6989586621679388079"><span class="hs-identifier hs-var">xjs</span></a></span><span>
</span><span id="line-190"></span><span>  </span><span id="local-6989586621679388087"><span class="annot"><span class="annottext">js :: [i]
</span><a href="#local-6989586621679388087"><span class="hs-identifier hs-var hs-var">js</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((x, i) -&gt; i) -&gt; [(x, i)] -&gt; [i]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(x, i) -&gt; i
forall a b. (a, b) -&gt; b
</span><a href="OAlg.Category.Definition.html#snd"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">[(x, i)]
</span><a href="#local-6989586621679388079"><span class="hs-identifier hs-var">xjs</span></a></span><span>
</span><span id="line-191"></span><span>  </span><span id="local-6989586621679388080"><span class="annot"><span class="annottext">xjs' :: [(x, i)]
</span><a href="#local-6989586621679388080"><span class="hs-identifier hs-var hs-var">xjs'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(((w, i), x) -&gt; x) -&gt; [((w, i), x)] -&gt; [x]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">((w, i), x) -&gt; x
forall a b. (a, b) -&gt; b
</span><a href="OAlg.Category.Definition.html#snd"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">[((w, i), x)]
</span><a href="#local-6989586621679388082"><span class="hs-identifier hs-var">wjxs</span></a></span><span> </span><span class="annot"><span class="annottext">[x] -&gt; [i] -&gt; [(x, i)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-operator hs-var">`zip`</span></span><span> </span><span class="annot"><span class="annottext">[i]
</span><a href="#local-6989586621679388087"><span class="hs-identifier hs-var">js</span></a></span><span>
</span><span id="line-192"></span><span>  </span><span id="local-6989586621679388081"><span class="annot"><span class="annottext">jis :: [(i, i)]
</span><a href="#local-6989586621679388081"><span class="hs-identifier hs-var hs-var">jis</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(((w, i), x) -&gt; i) -&gt; [((w, i), x)] -&gt; [i]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(w, i) -&gt; i
forall a b. (a, b) -&gt; b
</span><a href="OAlg.Category.Definition.html#snd"><span class="hs-identifier hs-var">snd</span></a></span><span class="annot"><span class="annottext">((w, i) -&gt; i) -&gt; (((w, i), x) -&gt; (w, i)) -&gt; ((w, i), x) -&gt; i
forall y z x. (y -&gt; z) -&gt; (x -&gt; y) -&gt; x -&gt; z
forall (c :: * -&gt; * -&gt; *) y z x.
Category c =&gt;
c y z -&gt; c x y -&gt; c x z
</span><a href="OAlg.Category.Definition.html#."><span class="hs-operator hs-var">.</span></a></span><span class="annot"><span class="annottext">((w, i), x) -&gt; (w, i)
forall a b. (a, b) -&gt; a
</span><a href="OAlg.Category.Definition.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[((w, i), x)]
</span><a href="#local-6989586621679388082"><span class="hs-identifier hs-var">wjxs</span></a></span><span> </span><span class="annot"><span class="annottext">[i] -&gt; [i] -&gt; [(i, i)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-operator hs-var">`zip`</span></span><span> </span><span class="annot"><span class="annottext">[i]
</span><a href="#local-6989586621679388087"><span class="hs-identifier hs-var">js</span></a></span><span>
</span><span id="line-193"></span><span>
</span><span id="line-194"></span><span>  </span><span id="local-6989586621679388084"><span class="annot"><span class="annottext">cmp :: (w, i) -&gt; (w, i) -&gt; Ordering
</span><a href="#local-6989586621679388084"><span class="hs-identifier hs-var hs-var">cmp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(w -&gt; w -&gt; Ordering)
-&gt; (i -&gt; i -&gt; Ordering) -&gt; (w, i) -&gt; (w, i) -&gt; Ordering
forall a b.
(a -&gt; a -&gt; Ordering)
-&gt; (b -&gt; b -&gt; Ordering) -&gt; (a, b) -&gt; (a, b) -&gt; Ordering
</span><a href="OAlg.Data.Ord.html#compare2"><span class="hs-identifier hs-var">compare2</span></a></span><span> </span><span class="annot"><span class="annottext">w -&gt; w -&gt; Ordering
</span><a href="#local-6989586621679388077"><span class="hs-identifier hs-var">wcmp</span></a></span><span> </span><span class="annot"><span class="annottext">i -&gt; i -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span>
</span><span id="line-195"></span><span>
</span><span id="line-196"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-197"></span><span class="hs-comment">-- pmfLst -</span><span>
</span><span id="line-198"></span><span>
</span><span id="line-199"></span><span class="hs-comment">-- | orders the list according to the given ordering an delivers the resulting</span><span>
</span><span id="line-200"></span><span class="hs-comment">-- permutation form.</span><span>
</span><span id="line-201"></span><span id="local-6989586621679387505"><span id="local-6989586621679387506"><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#pmfLst"><span class="hs-identifier hs-type">pmfLst</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679387505"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679387505"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ordering</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679387506"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679387505"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679387506"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679387506"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#PermutationForm"><span class="hs-identifier hs-type">PermutationForm</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-202"></span><span id="pmfLst"><span class="annot"><span class="annottext">pmfLst :: forall w x.
(w -&gt; w -&gt; Ordering) -&gt; (x -&gt; w) -&gt; [x] -&gt; ([x], PermutationForm N)
</span><a href="OAlg.Entity.Sequence.Permutation.html#pmfLst"><span class="hs-identifier hs-var hs-var">pmfLst</span></a></span></span><span> </span><span id="local-6989586621679388095"><span class="annot"><span class="annottext">w -&gt; w -&gt; Ordering
</span><a href="#local-6989586621679388095"><span class="hs-identifier hs-var">wcmp</span></a></span></span><span> </span><span id="local-6989586621679388096"><span class="annot"><span class="annottext">x -&gt; w
</span><a href="#local-6989586621679388096"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679388097"><span class="annot"><span class="annottext">[x]
</span><a href="#local-6989586621679388097"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((x, N) -&gt; x) -&gt; [(x, N)] -&gt; [x]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(x, N) -&gt; x
forall a b. (a, b) -&gt; a
</span><a href="OAlg.Category.Definition.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">([(x, N)] -&gt; [x]) -&gt; [(x, N)] -&gt; [x]
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><a href="OAlg.Category.Applicative.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PSequence N x -&gt; [(x, N)]
forall i x. PSequence i x -&gt; [(x, i)]
</span><a href="OAlg.Entity.Sequence.PSequence.html#psqxs"><span class="hs-identifier hs-var">psqxs</span></a></span><span> </span><span class="annot"><span class="annottext">(PSequence N x -&gt; [(x, N)]) -&gt; PSequence N x -&gt; [(x, N)]
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><a href="OAlg.Category.Applicative.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PSequence N x
</span><a href="#local-6989586621679388098"><span class="hs-identifier hs-var">xs'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">PermutationForm N
</span><a href="#local-6989586621679388099"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-203"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679388098"><span class="annot"><span class="annottext">PSequence N x
</span><a href="#local-6989586621679388098"><span class="hs-identifier hs-var">xs'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679388099"><span class="annot"><span class="annottext">PermutationForm N
</span><a href="#local-6989586621679388099"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(w -&gt; w -&gt; Ordering)
-&gt; (x -&gt; w) -&gt; PSequence N x -&gt; (PSequence N x, PermutationForm N)
forall i w x.
Ord i =&gt;
(w -&gt; w -&gt; Ordering)
-&gt; (x -&gt; w) -&gt; PSequence i x -&gt; (PSequence i x, PermutationForm i)
</span><a href="OAlg.Entity.Sequence.Permutation.html#pmfPsq"><span class="hs-identifier hs-var">pmfPsq</span></a></span><span> </span><span class="annot"><span class="annottext">w -&gt; w -&gt; Ordering
</span><a href="#local-6989586621679388095"><span class="hs-identifier hs-var">wcmp</span></a></span><span> </span><span class="annot"><span class="annottext">x -&gt; w
</span><a href="#local-6989586621679388096"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[x] -&gt; PSequence N x
forall a b. Embeddable a b =&gt; a -&gt; b
</span><a href="OAlg.Data.Canonical.html#inj"><span class="hs-identifier hs-var">inj</span></a></span><span> </span><span class="annot"><span class="annottext">[x]
</span><a href="#local-6989586621679388097"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-204"></span><span>
</span><span id="line-205"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-206"></span><span class="hs-comment">-- pmfPsy -</span><span>
</span><span id="line-207"></span><span>
</span><span id="line-208"></span><span class="hs-comment">-- | orders the product symbol according to the given ordering an delivers the resulting</span><span>
</span><span id="line-209"></span><span class="hs-comment">-- permutation form.</span><span>
</span><span id="line-210"></span><span id="local-6989586621679387509"><span id="local-6989586621679387510"><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#pmfPsy"><span class="hs-identifier hs-type">pmfPsy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.Entity.Definition.html#Entity"><span class="hs-identifier hs-type">Entity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387509"><span class="hs-identifier hs-type">x</span></a></span><span>
</span><span id="line-211"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679387510"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679387510"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ordering</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679387509"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679387510"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Sequence.CSequence.html#CSequence"><span class="hs-identifier hs-type">CSequence</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387509"><span class="hs-identifier hs-type">x</span></a></span><span>
</span><span id="line-212"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sequence.CSequence.html#CSequence"><span class="hs-identifier hs-type">CSequence</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387509"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">,</span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#PermutationForm"><span class="hs-identifier hs-type">PermutationForm</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-213"></span><span id="pmfPsy"><span class="annot"><span class="annottext">pmfPsy :: forall x w.
Entity x =&gt;
(w -&gt; w -&gt; Ordering)
-&gt; (x -&gt; w) -&gt; CSequence x -&gt; (CSequence x, PermutationForm N)
</span><a href="OAlg.Entity.Sequence.Permutation.html#pmfPsy"><span class="hs-identifier hs-var hs-var">pmfPsy</span></a></span></span><span> </span><span id="local-6989586621679388105"><span class="annot"><span class="annottext">w -&gt; w -&gt; Ordering
</span><a href="#local-6989586621679388105"><span class="hs-identifier hs-var">wcmp</span></a></span></span><span> </span><span id="local-6989586621679388106"><span class="annot"><span class="annottext">x -&gt; w
</span><a href="#local-6989586621679388106"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679388107"><span class="annot"><span class="annottext">CSequence x
</span><a href="#local-6989586621679388107"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[x] -&gt; CSequence x
forall x. Entity x =&gt; [x] -&gt; ProductSymbol x
</span><a href="OAlg.Entity.Product.ProductSymbol.html#productSymbol"><span class="hs-identifier hs-var">productSymbol</span></a></span><span> </span><span class="annot"><span class="annottext">[x]
</span><a href="#local-6989586621679388109"><span class="hs-identifier hs-var">xs'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">PermutationForm N
</span><a href="#local-6989586621679388110"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-214"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679388109"><span class="annot"><span class="annottext">[x]
</span><a href="#local-6989586621679388109"><span class="hs-identifier hs-var">xs'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679388110"><span class="annot"><span class="annottext">PermutationForm N
</span><a href="#local-6989586621679388110"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(w -&gt; w -&gt; Ordering) -&gt; (x -&gt; w) -&gt; [x] -&gt; ([x], PermutationForm N)
forall w x.
(w -&gt; w -&gt; Ordering) -&gt; (x -&gt; w) -&gt; [x] -&gt; ([x], PermutationForm N)
</span><a href="OAlg.Entity.Sequence.Permutation.html#pmfLst"><span class="hs-identifier hs-var">pmfLst</span></a></span><span> </span><span class="annot"><span class="annottext">w -&gt; w -&gt; Ordering
</span><a href="#local-6989586621679388105"><span class="hs-identifier hs-var">wcmp</span></a></span><span> </span><span class="annot"><span class="annottext">x -&gt; w
</span><a href="#local-6989586621679388106"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CSequence x -&gt; [x]
forall a. ProductSymbol a -&gt; [a]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">toList</span></span><span> </span><span class="annot"><span class="annottext">CSequence x
</span><a href="#local-6989586621679388107"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-215"></span><span>
</span><span id="line-216"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-217"></span><span class="hs-comment">-- PermuationForm - Entity -</span><span>
</span><span id="line-218"></span><span>  </span><span>
</span><span id="line-219"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679387520"><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Definition.html#Entity"><span class="hs-identifier hs-type">Entity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387520"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679387520"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.Validable.html#Validable"><span class="hs-identifier hs-type">Validable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#PermutationForm"><span class="hs-identifier hs-type">PermutationForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387520"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-220"></span><span>  </span><span id="local-6989586621679388129"><span class="annot"><span class="annottext">valid :: PermutationForm i -&gt; Statement
</span><a href="OAlg.Data.Validable.html#valid"><span class="hs-identifier hs-var hs-var hs-var hs-var">valid</span></a></span></span><span> </span><span id="local-6989586621679388130"><span class="annot"><span class="annottext">p :: PermutationForm i
</span><a href="#local-6989586621679388130"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#PermutationForm"><span class="hs-identifier hs-type">PermutationForm</span></a></span><span> </span><span id="local-6989586621679388131"><span class="annot"><span class="annottext">PSequence i i
</span><a href="#local-6989586621679388131"><span class="hs-identifier hs-var">jis</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Label
</span><a href="OAlg.Data.Statement.Definition.html#Label"><span class="hs-identifier hs-var">Label</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;PermutationForm&quot;</span></span><span> </span><span class="annot"><span class="annottext">Label -&gt; Statement -&gt; Statement
</span><a href="OAlg.Data.Statement.Definition.html#%3A%3C%3D%3E%3A"><span class="hs-operator hs-var">:&lt;=&gt;:</span></a></span><span>
</span><span id="line-221"></span><span>    </span><span class="annot"><span class="annottext">[Statement] -&gt; Statement
</span><a href="OAlg.Data.Statement.Definition.html#And"><span class="hs-identifier hs-var">And</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">PSequence i i -&gt; Statement
forall a. Validable a =&gt; a -&gt; Statement
</span><a href="OAlg.Data.Validable.html#valid"><span class="hs-identifier hs-var">valid</span></a></span><span> </span><span class="annot"><span class="annottext">PSequence i i
</span><a href="#local-6989586621679388131"><span class="hs-identifier hs-var">jis</span></a></span><span>
</span><span id="line-222"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Label
</span><a href="OAlg.Data.Statement.Definition.html#Label"><span class="hs-identifier hs-var">Label</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;1&quot;</span></span><span> </span><span class="annot"><span class="annottext">Label -&gt; Statement -&gt; Statement
</span><a href="OAlg.Data.Statement.Definition.html#%3A%3C%3D%3E%3A"><span class="hs-operator hs-var">:&lt;=&gt;:</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PSequence i i -&gt; PermutationForm i -&gt; Set i
forall (s :: * -&gt; *) i x (p :: * -&gt; *).
Sequence s i x =&gt;
p i -&gt; s x -&gt; Set i
</span><a href="OAlg.Entity.Sequence.Definition.html#support"><span class="hs-identifier hs-var">support</span></a></span><span> </span><span class="annot"><span class="annottext">PSequence i i
</span><a href="#local-6989586621679388131"><span class="hs-identifier hs-var">jis</span></a></span><span> </span><span class="annot"><span class="annottext">PermutationForm i
</span><a href="#local-6989586621679388130"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Set i -&gt; Set i -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">PSequence i i -&gt; PermutationForm i -&gt; Set i
forall (s :: * -&gt; *) i x (p :: * -&gt; *).
(Sequence s i x, Ord x) =&gt;
p i -&gt; s x -&gt; Set x
</span><a href="OAlg.Entity.Sequence.Definition.html#image"><span class="hs-identifier hs-var">image</span></a></span><span> </span><span class="annot"><span class="annottext">PSequence i i
</span><a href="#local-6989586621679388131"><span class="hs-identifier hs-var">jis</span></a></span><span> </span><span class="annot"><span class="annottext">PermutationForm i
</span><a href="#local-6989586621679388130"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Bool -&gt; Message -&gt; Statement
</span><a href="OAlg.Data.Statement.Definition.html#%3A%3F%3E"><span class="hs-operator hs-var">:?&gt;</span></a></span><span class="annot"><span class="annottext">[Parameter] -&gt; Message
</span><a href="OAlg.Data.Statement.Definition.html#Params"><span class="hs-identifier hs-var">Params</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;p&quot;</span></span><span class="annot"><span class="annottext">String -&gt; String -&gt; Parameter
</span><a href="OAlg.Data.Statement.Definition.html#%3A%3D"><span class="hs-operator hs-var">:=</span></a></span><span class="annot"><span class="annottext">PermutationForm i -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">PermutationForm i
</span><a href="#local-6989586621679388130"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-223"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-224"></span><span>
</span><span id="line-225"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679387538"><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Definition.html#Entity"><span class="hs-identifier hs-type">Entity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387538"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679387538"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Definition.html#Entity"><span class="hs-identifier hs-type">Entity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#PermutationForm"><span class="hs-identifier hs-type">PermutationForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387538"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-226"></span><span>
</span><span id="line-227"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-228"></span><span class="hs-comment">-- PermutationForm - Oriented -</span><span>
</span><span id="line-229"></span><span>
</span><span id="line-230"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679387542"><span id="local-6989586621679388165"><span id="local-6989586621679388169"><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Definition.html#Entity"><span class="hs-identifier hs-type">Entity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387542"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679387542"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#Oriented"><span class="hs-identifier hs-type">Oriented</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#PermutationForm"><span class="hs-identifier hs-type">PermutationForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387542"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-231"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Point"><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#Point"><span class="hs-identifier hs-var">Point</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#PermutationForm"><span class="hs-identifier hs-type">PermutationForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387542"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-232"></span><span>  </span><span id="local-6989586621679388173"><span class="annot"><span class="annottext">orientation :: PermutationForm i -&gt; Orientation (Point (PermutationForm i))
</span><a href="#local-6989586621679388173"><span class="hs-identifier hs-var hs-var hs-var hs-var">orientation</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Orientation () -&gt; PermutationForm i -&gt; Orientation ()
forall b a. b -&gt; a -&gt; b
</span><a href="OAlg.Category.Definition.html#const"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="annot"><span class="annottext">() -&gt; () -&gt; Orientation ()
forall p. p -&gt; p -&gt; Orientation p
</span><a href="OAlg.Structure.Oriented.Definition.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-233"></span><span>
</span><span id="line-234"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-235"></span><span class="hs-comment">-- PermutationForm - Reducible -</span><span>
</span><span id="line-236"></span><span>
</span><span id="line-237"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679387549"><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679387549"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.Reducible.html#Reducible"><span class="hs-identifier hs-type">Reducible</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#PermutationForm"><span class="hs-identifier hs-type">PermutationForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387549"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-238"></span><span>  </span><span id="local-6989586621679388182"><span class="annot"><span class="annottext">reduce :: PermutationForm i -&gt; PermutationForm i
</span><a href="#local-6989586621679388182"><span class="hs-identifier hs-var hs-var hs-var hs-var">reduce</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#PermutationForm"><span class="hs-identifier hs-type">PermutationForm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sequence.PSequence.html#PSequence"><span class="hs-identifier hs-type">PSequence</span></a></span><span> </span><span id="local-6989586621679388184"><span class="annot"><span class="annottext">[(i, i)]
</span><a href="#local-6989586621679388184"><span class="hs-identifier hs-var">jis</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PSequence i i -&gt; PermutationForm i
forall i. PSequence i i -&gt; PermutationForm i
</span><a href="OAlg.Entity.Sequence.Permutation.html#PermutationForm"><span class="hs-identifier hs-var">PermutationForm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(i, i)] -&gt; PSequence i i
forall i x. [(x, i)] -&gt; PSequence i x
</span><a href="OAlg.Entity.Sequence.PSequence.html#PSequence"><span class="hs-identifier hs-var">PSequence</span></a></span><span> </span><span class="annot"><span class="annottext">[(i, i)]
</span><a href="#local-6989586621679388185"><span class="hs-identifier hs-var">jis'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-239"></span><span>    </span><span id="local-6989586621679388185"><span class="annot"><span class="annottext">jis' :: [(i, i)]
</span><a href="#local-6989586621679388185"><span class="hs-identifier hs-var hs-var">jis'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((i, i) -&gt; Bool) -&gt; [(i, i)] -&gt; [(i, i)]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679388186"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679388186"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679388187"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679388187"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679388186"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">i -&gt; i -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679388187"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(i, i)]
</span><a href="#local-6989586621679388184"><span class="hs-identifier hs-var">jis</span></a></span><span>
</span><span id="line-240"></span><span>
</span><span id="line-241"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-242"></span><span class="hs-comment">-- Permutation -</span><span>
</span><span id="line-243"></span><span>
</span><span id="line-244"></span><span class="hs-comment">-- | permutation of a totally ordered index type @__i__@ which yield a /bijection/ 'pmt' on</span><span>
</span><span id="line-245"></span><span class="hs-comment">--  @__i__@. They are constructed using</span><span>
</span><span id="line-246"></span><span class="hs-comment">--</span><span>
</span><span id="line-247"></span><span class="hs-comment">-- * 'make' of a 'valid' 'PermutationForm', which defines also the validity for</span><span>
</span><span id="line-248"></span><span class="hs-comment">-- the constructed permutation.</span><span>
</span><span id="line-249"></span><span class="hs-comment">--</span><span>
</span><span id="line-250"></span><span class="hs-comment">-- * 'swap' and the 'Multiplicative' structure for permutations.</span><span>
</span><span id="line-251"></span><span class="hs-comment">--</span><span>
</span><span id="line-252"></span><span class="hs-comment">-- * 'permuteBy' for 'PermutableSequence'.</span><span>
</span><span id="line-253"></span><span class="hs-comment">--</span><span>
</span><span id="line-254"></span><span class="hs-comment">-- * 'xPermutation' to generate randomly permutations.</span><span>
</span><span id="line-255"></span><span class="hs-comment">--</span><span>
</span><span id="line-256"></span><span class="hs-comment">-- In the following the total right operation '&lt;*' of a permutation on several types of</span><span>
</span><span id="line-257"></span><span class="hs-comment">-- sequences will be defined to achieve the permutation of there items.</span><span>
</span><span id="line-258"></span><span class="hs-comment">--</span><span>
</span><span id="line-259"></span><span class="hs-comment">-- __Definitions__</span><span>
</span><span id="line-260"></span><span class="hs-comment">--</span><span>
</span><span id="line-261"></span><span class="hs-comment">-- [List] Let @xs@ be in @[__x__]@ with @'ConstructableSequence' [] __r__ [__x__]@ and @p@</span><span>
</span><span id="line-262"></span><span class="hs-comment">-- a permutation in @'Permutation' __r__@, then @xs '&lt;*' p@ is given by</span><span>
</span><span id="line-263"></span><span class="hs-comment">-- @'sqcIndexMap' is ('pmt' p) xs@, where @is@ is the image of the support of @xs@</span><span>
</span><span id="line-264"></span><span class="hs-comment">-- under the inverse of @p@.</span><span>
</span><span id="line-265"></span><span class="hs-comment">--</span><span>
</span><span id="line-266"></span><span class="hs-comment">-- [CSequence] Let @xs@ be in @'CSequence' __x__@ with</span><span>
</span><span id="line-267"></span><span class="hs-comment">-- @'ConstructableSequence' 'CSequence' 'N' __x__@ and @p@ a permutation in</span><span>
</span><span id="line-268"></span><span class="hs-comment">-- @'Permutation' 'N'@, then @xs '&lt;*' p@ is given by</span><span>
</span><span id="line-269"></span><span class="hs-comment">-- @'sqcIndexMap' is ('pmt' p) xs@, where @is@ is the image of the support of @xs@</span><span>
</span><span id="line-270"></span><span class="hs-comment">-- under the inverse of @p@.</span><span>
</span><span id="line-271"></span><span class="hs-comment">--</span><span>
</span><span id="line-272"></span><span class="hs-comment">-- [PSequence] Let @xs@ be in @'PSequence' __i__ __x__@ with</span><span>
</span><span id="line-273"></span><span class="hs-comment">-- @'ConstructableSequence' ('PSequence' __i__) __i__ __x__@ and @p@ a permutation in</span><span>
</span><span id="line-274"></span><span class="hs-comment">-- @'Permutation' __i__@, then @xs '&lt;*' p@ is given by</span><span>
</span><span id="line-275"></span><span class="hs-comment">-- @'sqcIndexMap' is ('pmt' p) xs@, where @is@ is the image of the support of @xs@</span><span>
</span><span id="line-276"></span><span class="hs-comment">-- under the inverse of @p@.</span><span>
</span><span id="line-277"></span><span class="hs-comment">--</span><span>
</span><span id="line-278"></span><span class="hs-comment">-- [Permutation] Let @xs@, @p@ be in @'Permutation' __i__@, then @xs '&lt;*' p@ is given</span><span>
</span><span id="line-279"></span><span class="hs-comment">-- by '*'.</span><span>
</span><span id="line-280"></span><span class="hs-comment">--</span><span>
</span><span id="line-281"></span><span class="hs-comment">-- __Note__ The given definitions are not very efficient and only terminate for finite</span><span>
</span><span id="line-282"></span><span class="hs-comment">-- sequences (in fact, a more efficient implementation has been chosen that also</span><span>
</span><span id="line-283"></span><span class="hs-comment">-- terminates for infinite sequences (see example below)). However, they serve on the one</span><span>
</span><span id="line-284"></span><span class="hs-comment">-- hand to define the semantic and to \'prove\' the properties for 'TotalOpr' and on the</span><span>
</span><span id="line-285"></span><span class="hs-comment">-- other hand to verify the chosen implementation for finite sequences (see</span><span>
</span><span id="line-286"></span><span class="hs-comment">-- 'prpOprPermutation').</span><span>
</span><span id="line-287"></span><span class="hs-comment">--</span><span>
</span><span id="line-288"></span><span class="hs-comment">-- __Examples__</span><span>
</span><span id="line-289"></span><span class="hs-comment">--</span><span>
</span><span id="line-290"></span><span class="hs-comment">-- &gt;&gt;&gt; &quot;abcdef&quot; &lt;* (swap 2 5 :: Permutation N)</span><span>
</span><span id="line-291"></span><span class="hs-comment">-- &quot;abfdec&quot;</span><span>
</span><span id="line-292"></span><span class="hs-comment">--</span><span>
</span><span id="line-293"></span><span class="hs-comment">-- the support of a sequence and the relevant image of a permutation may be disjoint which</span><span>
</span><span id="line-294"></span><span class="hs-comment">-- will leave the sequence untouched</span><span>
</span><span id="line-295"></span><span class="hs-comment">--</span><span>
</span><span id="line-296"></span><span class="hs-comment">-- &gt;&gt;&gt; &quot;abcdef&quot; &lt;* (swap 7 10 :: Permutation N)</span><span>
</span><span id="line-297"></span><span class="hs-comment">-- &quot;abcdef&quot;</span><span>
</span><span id="line-298"></span><span class="hs-comment">--</span><span>
</span><span id="line-299"></span><span class="hs-comment">-- the intersection of the support of a sequence with the relevant image of a permutation</span><span>
</span><span id="line-300"></span><span class="hs-comment">-- may be a non empty proper sub set</span><span>
</span><span id="line-301"></span><span class="hs-comment">--</span><span>
</span><span id="line-302"></span><span class="hs-comment">-- &gt;&gt;&gt; &quot;abcdef&quot; &lt;* swap 2 10 :: Permutation N)</span><span>
</span><span id="line-303"></span><span class="hs-comment">-- &quot;abdefc&quot;</span><span>
</span><span id="line-304"></span><span class="hs-comment">--</span><span>
</span><span id="line-305"></span><span class="hs-comment">-- the result can be interpreted as: first, put @c@ at position @10@ and 'Nothing'</span><span>
</span><span id="line-306"></span><span class="hs-comment">-- (which is the item at position @10@) at position @2@. Second, strip all nothings form it.</span><span>
</span><span id="line-307"></span><span class="hs-comment">--</span><span>
</span><span id="line-308"></span><span class="hs-comment">-- Although the given definition of the permutation of sequences dose not terminate for</span><span>
</span><span id="line-309"></span><span class="hs-comment">-- infinite sequences, its implementation will terminate</span><span>
</span><span id="line-310"></span><span class="hs-comment">--</span><span>
</span><span id="line-311"></span><span class="hs-comment">-- &gt;&gt;&gt; takeN 5 $ (([0..] :: [N]) &lt;* (swap 1 2 :: Permutation N)</span><span>
</span><span id="line-312"></span><span class="hs-comment">-- [0,2,1,3,4]</span><span>
</span><span id="line-313"></span><span class="hs-keyword">newtype</span><span> </span><span id="Permutation"><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#Permutation"><span class="hs-identifier hs-var">Permutation</span></a></span></span><span> </span><span id="local-6989586621679387567"><span class="annot"><a href="#local-6989586621679387567"><span class="hs-identifier hs-type">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Permutation"><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#Permutation"><span class="hs-identifier hs-var">Permutation</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#PermutationForm"><span class="hs-identifier hs-type">PermutationForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387567"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-314"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679388196"><span id="local-6989586621679388200"><span id="local-6989586621679388204"><span class="annot"><span class="annottext">Int -&gt; Permutation i -&gt; ShowS
[Permutation i] -&gt; ShowS
Permutation i -&gt; String
(Int -&gt; Permutation i -&gt; ShowS)
-&gt; (Permutation i -&gt; String)
-&gt; ([Permutation i] -&gt; ShowS)
-&gt; Show (Permutation i)
forall i. Show i =&gt; Int -&gt; Permutation i -&gt; ShowS
forall i. Show i =&gt; [Permutation i] -&gt; ShowS
forall i. Show i =&gt; Permutation i -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: forall i. Show i =&gt; Int -&gt; Permutation i -&gt; ShowS
showsPrec :: Int -&gt; Permutation i -&gt; ShowS
$cshow :: forall i. Show i =&gt; Permutation i -&gt; String
show :: Permutation i -&gt; String
$cshowList :: forall i. Show i =&gt; [Permutation i] -&gt; ShowS
showList :: [Permutation i] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679388208"><span id="local-6989586621679388212"><span class="annot"><span class="annottext">Permutation i -&gt; Permutation i -&gt; Bool
(Permutation i -&gt; Permutation i -&gt; Bool)
-&gt; (Permutation i -&gt; Permutation i -&gt; Bool) -&gt; Eq (Permutation i)
forall i. Eq i =&gt; Permutation i -&gt; Permutation i -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: forall i. Eq i =&gt; Permutation i -&gt; Permutation i -&gt; Bool
== :: Permutation i -&gt; Permutation i -&gt; Bool
$c/= :: forall i. Eq i =&gt; Permutation i -&gt; Permutation i -&gt; Bool
/= :: Permutation i -&gt; Permutation i -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679388219"><span class="annot"><span class="annottext">Permutation i -&gt; Statement
(Permutation i -&gt; Statement) -&gt; Validable (Permutation i)
forall i. (Entity i, Ord i) =&gt; Permutation i -&gt; Statement
forall a. (a -&gt; Statement) -&gt; Validable a
$cvalid :: forall i. (Entity i, Ord i) =&gt; Permutation i -&gt; Statement
valid :: Permutation i -&gt; Statement
</span><a href="OAlg.Data.Validable.html#Validable"><span class="hs-identifier hs-var hs-var hs-var hs-var">Validable</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Eq (Permutation i)
Show (Permutation i)
Typeable (Permutation i)
Validable (Permutation i)
Show (Permutation i)
-&gt; Eq (Permutation i)
-&gt; Validable (Permutation i)
-&gt; Typeable (Permutation i)
-&gt; Entity (Permutation i)
forall a. Show a -&gt; Eq a -&gt; Validable a -&gt; Typeable a -&gt; Entity a
forall {i}. (Entity i, Ord i) =&gt; Eq (Permutation i)
forall {i}. (Entity i, Ord i) =&gt; Show (Permutation i)
forall {i}. (Entity i, Ord i) =&gt; Typeable (Permutation i)
forall i. (Entity i, Ord i) =&gt; Validable (Permutation i)
</span><a href="OAlg.Entity.Definition.html#Entity"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Entity</span></a></span><span class="hs-special">,</span><span id="local-6989586621679388239"><span class="annot"><span class="annottext">Permutation i -&gt; N
(Permutation i -&gt; N) -&gt; LengthN (Permutation i)
forall i. Permutation i -&gt; N
forall x. (x -&gt; N) -&gt; LengthN x
$clengthN :: forall i. Permutation i -&gt; N
lengthN :: Permutation i -&gt; N
</span><a href="OAlg.Data.Number.html#LengthN"><span class="hs-identifier hs-var hs-var hs-var hs-var">LengthN</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-315"></span><span>
</span><span id="line-316"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679387564"><span class="annot"><a href="OAlg.Data.Constructable.html#Exposable"><span class="hs-identifier hs-type">Exposable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#Permutation"><span class="hs-identifier hs-type">Permutation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387564"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-317"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Form"><span class="annot"><a href="OAlg.Data.Constructable.html#Form"><span class="hs-identifier hs-var">Form</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#Permutation"><span class="hs-identifier hs-type">Permutation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387564"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#PermutationForm"><span class="hs-identifier hs-type">PermutationForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387564"><span class="hs-identifier hs-type">i</span></a></span><span>
</span><span id="line-318"></span><span>  </span><span id="local-6989586621679388246"><span class="annot"><span class="annottext">form :: Permutation i -&gt; Form (Permutation i)
</span><a href="#local-6989586621679388246"><span class="hs-identifier hs-var hs-var hs-var hs-var">form</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#Permutation"><span class="hs-identifier hs-type">Permutation</span></a></span><span> </span><span id="local-6989586621679388248"><span class="annot"><span class="annottext">PermutationForm i
</span><a href="#local-6989586621679388248"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Form (Permutation i)
PermutationForm i
</span><a href="#local-6989586621679388248"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-319"></span><span>
</span><span id="line-320"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679387566"><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679387566"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.Constructable.html#Constructable"><span class="hs-identifier hs-type">Constructable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#Permutation"><span class="hs-identifier hs-type">Permutation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387566"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-321"></span><span>  </span><span id="local-6989586621679388257"><span class="annot"><span class="annottext">make :: Form (Permutation i) -&gt; Permutation i
</span><a href="OAlg.Data.Constructable.html#make"><span class="hs-identifier hs-var hs-var hs-var hs-var">make</span></a></span></span><span> </span><span id="local-6989586621679388258"><span class="annot"><span class="annottext">Form (Permutation i)
</span><a href="#local-6989586621679388258"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PermutationForm i -&gt; Permutation i
forall i. PermutationForm i -&gt; Permutation i
</span><a href="OAlg.Entity.Sequence.Permutation.html#Permutation"><span class="hs-identifier hs-var">Permutation</span></a></span><span> </span><span class="annot"><span class="annottext">(PermutationForm i -&gt; Permutation i)
-&gt; PermutationForm i -&gt; Permutation i
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><a href="OAlg.Category.Applicative.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PermutationForm i -&gt; PermutationForm i
forall e. Reducible e =&gt; e -&gt; e
</span><a href="OAlg.Data.Reducible.html#reduce"><span class="hs-identifier hs-var">reduce</span></a></span><span> </span><span class="annot"><span class="annottext">Form (Permutation i)
PermutationForm i
</span><a href="#local-6989586621679388258"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-322"></span><span>
</span><span id="line-323"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679387569"><span id="local-6989586621679388265"><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679387569"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Sequence.Definition.html#Sequence"><span class="hs-identifier hs-type">Sequence</span></a></span><span> </span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#Permutation"><span class="hs-identifier hs-type">Permutation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387569"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387569"><span class="hs-identifier hs-type">i</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-324"></span><span>  </span><span id="local-6989586621679388271"><span class="annot"><span class="annottext">list :: forall (p :: * -&gt; *). p i -&gt; Permutation i -&gt; [(i, i)]
</span><a href="OAlg.Entity.Sequence.Definition.html#list"><span class="hs-identifier hs-var hs-var hs-var hs-var">list</span></a></span></span><span> </span><span id="local-6989586621679388272"><span class="annot"><span class="annottext">p i
</span><a href="#local-6989586621679388272"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#Permutation"><span class="hs-identifier hs-type">Permutation</span></a></span><span> </span><span id="local-6989586621679388273"><span class="annot"><span class="annottext">PermutationForm i
</span><a href="#local-6989586621679388273"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">p i -&gt; PermutationForm i -&gt; [(i, i)]
forall (p :: * -&gt; *). p i -&gt; PermutationForm i -&gt; [(i, i)]
forall (s :: * -&gt; *) i x (p :: * -&gt; *).
Sequence s i x =&gt;
p i -&gt; s x -&gt; [(x, i)]
</span><a href="OAlg.Entity.Sequence.Definition.html#list"><span class="hs-identifier hs-var">list</span></a></span><span> </span><span class="annot"><span class="annottext">p i
</span><a href="#local-6989586621679388272"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">PermutationForm i
</span><a href="#local-6989586621679388273"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-325"></span><span>  </span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#Permutation"><span class="hs-identifier hs-type">Permutation</span></a></span><span> </span><span id="local-6989586621679388275"><span class="annot"><span class="annottext">PermutationForm i
</span><a href="#local-6989586621679388275"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679388276"><span class="annot"><span class="annottext">?? :: Permutation i -&gt; i -&gt; Maybe i
</span><a href="OAlg.Entity.Sequence.Definition.html#%3F%3F"><span class="hs-operator hs-var hs-var hs-var hs-var">??</span></a></span></span><span> </span><span id="local-6989586621679388277"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679388277"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PermutationForm i
</span><a href="#local-6989586621679388275"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">PermutationForm i -&gt; i -&gt; Maybe i
forall (s :: * -&gt; *) i x. Sequence s i x =&gt; s x -&gt; i -&gt; Maybe x
</span><a href="OAlg.Entity.Sequence.Definition.html#%3F%3F"><span class="hs-operator hs-var">??</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679388277"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-326"></span><span>
</span><span id="line-327"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-328"></span><span class="hs-comment">-- pmt -</span><span>
</span><span id="line-329"></span><span>
</span><span id="line-330"></span><span class="hs-comment">-- | the bijection on @__i__@ for a given permutation and is defined via</span><span>
</span><span id="line-331"></span><span class="hs-comment">--   @'restrict' 'pmf'@.</span><span>
</span><span id="line-332"></span><span id="local-6989586621679387571"><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#pmt"><span class="hs-identifier hs-type">pmt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679387571"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#Permutation"><span class="hs-identifier hs-type">Permutation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387571"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679387571"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679387571"><span class="hs-identifier hs-type">i</span></a></span></span><span>
</span><span id="line-333"></span><span id="pmt"><span class="annot"><span class="annottext">pmt :: forall i. Ord i =&gt; Permutation i -&gt; i -&gt; i
</span><a href="OAlg.Entity.Sequence.Permutation.html#pmt"><span class="hs-identifier hs-var hs-var">pmt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Form (Permutation i) -&gt; i -&gt; i) -&gt; Permutation i -&gt; i -&gt; i
forall x y. Exposable x =&gt; (Form x -&gt; y) -&gt; x -&gt; y
</span><a href="OAlg.Data.Constructable.html#restrict"><span class="hs-identifier hs-var">restrict</span></a></span><span> </span><span class="annot"><span class="annottext">Form (Permutation i) -&gt; i -&gt; i
PermutationForm i -&gt; i -&gt; i
forall i. Ord i =&gt; PermutationForm i -&gt; i -&gt; i
</span><a href="OAlg.Entity.Sequence.Permutation.html#pmf"><span class="hs-identifier hs-var">pmf</span></a></span><span>
</span><span id="line-334"></span><span>
</span><span id="line-335"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-336"></span><span class="hs-comment">-- Permutation - Cayleyan -</span><span>
</span><span id="line-337"></span><span>
</span><span id="line-338"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679387576"><span id="local-6989586621679388291"><span id="local-6989586621679388295"><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Definition.html#Entity"><span class="hs-identifier hs-type">Entity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387576"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679387576"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#Oriented"><span class="hs-identifier hs-type">Oriented</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#Permutation"><span class="hs-identifier hs-type">Permutation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387576"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-339"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Point"><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#Point"><span class="hs-identifier hs-var">Point</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#Permutation"><span class="hs-identifier hs-type">Permutation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387576"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-340"></span><span>  </span><span id="local-6989586621679388299"><span class="annot"><span class="annottext">orientation :: Permutation i -&gt; Orientation (Point (Permutation i))
</span><a href="OAlg.Structure.Oriented.Definition.html#orientation"><span class="hs-identifier hs-var hs-var hs-var hs-var">orientation</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Form (Permutation i) -&gt; Orientation ())
-&gt; Permutation i -&gt; Orientation ()
forall x y. Exposable x =&gt; (Form x -&gt; y) -&gt; x -&gt; y
</span><a href="OAlg.Data.Constructable.html#restrict"><span class="hs-identifier hs-var">restrict</span></a></span><span> </span><span class="annot"><span class="annottext">Form (Permutation i) -&gt; Orientation ()
PermutationForm i -&gt; Orientation (Point (PermutationForm i))
forall q. Oriented q =&gt; q -&gt; Orientation (Point q)
</span><a href="OAlg.Structure.Oriented.Definition.html#orientation"><span class="hs-identifier hs-var">orientation</span></a></span><span>
</span><span id="line-341"></span><span>
</span><span id="line-342"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679387362"><span id="local-6989586621679388307"><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Definition.html#Entity"><span class="hs-identifier hs-type">Entity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387362"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679387362"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Structure.Multiplicative.Definition.html#Multiplicative"><span class="hs-identifier hs-type">Multiplicative</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#Permutation"><span class="hs-identifier hs-type">Permutation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387362"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-343"></span><span>  </span><span id="local-6989586621679388312"><span class="annot"><span class="annottext">one :: Point (Permutation i) -&gt; Permutation i
</span><a href="#local-6989586621679388312"><span class="hs-identifier hs-var hs-var hs-var hs-var">one</span></a></span></span><span> </span><span class="annot"><span class="annottext">Point (Permutation i)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Form (Permutation i) -&gt; Permutation i
forall x. Constructable x =&gt; Form x -&gt; x
</span><a href="OAlg.Data.Constructable.html#make"><span class="hs-identifier hs-var">make</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PSequence i i -&gt; PermutationForm i
forall i. PSequence i i -&gt; PermutationForm i
</span><a href="OAlg.Entity.Sequence.Permutation.html#PermutationForm"><span class="hs-identifier hs-var">PermutationForm</span></a></span><span> </span><span class="annot"><span class="annottext">PSequence i i
forall i x. PSequence i x
</span><a href="OAlg.Entity.Sequence.PSequence.html#psqEmpty"><span class="hs-identifier hs-var">psqEmpty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-344"></span><span>  </span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#Permutation"><span class="hs-identifier hs-type">Permutation</span></a></span><span> </span><span id="local-6989586621679388317"><span class="annot"><span class="annottext">PermutationForm i
</span><a href="#local-6989586621679388317"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679388318"><span class="annot"><span class="annottext">* :: Permutation i -&gt; Permutation i -&gt; Permutation i
</span><a href="OAlg.Structure.Multiplicative.Definition.html#%2A"><span class="hs-operator hs-var hs-var hs-var hs-var">*</span></a></span></span><span> </span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#Permutation"><span class="hs-identifier hs-type">Permutation</span></a></span><span> </span><span id="local-6989586621679388319"><span class="annot"><span class="annottext">PermutationForm i
</span><a href="#local-6989586621679388319"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Form (Permutation i) -&gt; Permutation i
forall x. Constructable x =&gt; Form x -&gt; x
</span><a href="OAlg.Data.Constructable.html#make"><span class="hs-identifier hs-var">make</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PermutationForm i
</span><a href="#local-6989586621679388317"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">PermutationForm i -&gt; PermutationForm i -&gt; PermutationForm i
forall i.
Ord i =&gt;
PermutationForm i -&gt; PermutationForm i -&gt; PermutationForm i
</span><a href="OAlg.Entity.Sequence.Permutation.html#pmfMlt"><span class="hs-operator hs-var">`pmfMlt`</span></a></span><span> </span><span class="annot"><span class="annottext">PermutationForm i
</span><a href="#local-6989586621679388319"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-345"></span><span>
</span><span id="line-346"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679387584"><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#Total"><span class="hs-identifier hs-type">Total</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#Permutation"><span class="hs-identifier hs-type">Permutation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387584"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-347"></span><span>
</span><span id="line-348"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679387590"><span id="local-6989586621679388332"><span id="local-6989586621679388336"><span id="local-6989586621679388339"><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Definition.html#Entity"><span class="hs-identifier hs-type">Entity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387590"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679387590"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Structure.Multiplicative.Definition.html#Invertible"><span class="hs-identifier hs-type">Invertible</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#Permutation"><span class="hs-identifier hs-type">Permutation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387590"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-349"></span><span>  </span><span id="local-6989586621679388346"><span class="annot"><span class="annottext">tryToInvert :: Permutation i -&gt; Solver (Permutation i)
</span><a href="#local-6989586621679388346"><span class="hs-identifier hs-var hs-var hs-var hs-var">tryToInvert</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#Permutation"><span class="hs-identifier hs-type">Permutation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#PermutationForm"><span class="hs-identifier hs-type">PermutationForm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sequence.PSequence.html#PSequence"><span class="hs-identifier hs-type">PSequence</span></a></span><span> </span><span id="local-6989586621679388348"><span class="annot"><span class="annottext">[(i, i)]
</span><a href="#local-6989586621679388348"><span class="hs-identifier hs-var">jis</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-350"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Permutation i -&gt; Solver (Permutation i)
forall a. a -&gt; Solver a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PermutationForm i -&gt; Permutation i
forall i. PermutationForm i -&gt; Permutation i
</span><a href="OAlg.Entity.Sequence.Permutation.html#Permutation"><span class="hs-identifier hs-var">Permutation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PSequence i i -&gt; PermutationForm i
forall i. PSequence i i -&gt; PermutationForm i
</span><a href="OAlg.Entity.Sequence.Permutation.html#PermutationForm"><span class="hs-identifier hs-var">PermutationForm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(i, i)] -&gt; PSequence i i
forall i x. [(x, i)] -&gt; PSequence i x
</span><a href="OAlg.Entity.Sequence.PSequence.html#PSequence"><span class="hs-identifier hs-var">PSequence</span></a></span><span> </span><span class="annot"><span class="annottext">[(i, i)]
</span><a href="#local-6989586621679388349"><span class="hs-identifier hs-var">ijs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-351"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679388349"><span class="annot"><span class="annottext">ijs :: [(i, i)]
</span><a href="#local-6989586621679388349"><span class="hs-identifier hs-var hs-var">ijs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(i, i)] -&gt; [(i, i)]
forall b a. Ord b =&gt; [(a, b)] -&gt; [(a, b)]
</span><a href="OAlg.Data.Ord.html#sortSnd"><span class="hs-identifier hs-var">sortSnd</span></a></span><span> </span><span class="annot"><span class="annottext">([(i, i)] -&gt; [(i, i)]) -&gt; [(i, i)] -&gt; [(i, i)]
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><a href="OAlg.Category.Applicative.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">((i, i) -&gt; (i, i)) -&gt; [(i, i)] -&gt; [(i, i)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679388350"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679388350"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679388351"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679388351"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679388351"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679388350"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(i, i)]
</span><a href="#local-6989586621679388348"><span class="hs-identifier hs-var">jis</span></a></span><span>
</span><span id="line-352"></span><span>
</span><span id="line-353"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679387596"><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Definition.html#Entity"><span class="hs-identifier hs-type">Entity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387596"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679387596"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Structure.Multiplicative.Definition.html#Cayleyan"><span class="hs-identifier hs-type">Cayleyan</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#Permutation"><span class="hs-identifier hs-type">Permutation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387596"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-354"></span><span>
</span><span id="line-355"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679387602"><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Definition.html#Entity"><span class="hs-identifier hs-type">Entity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387602"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679387602"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Structure.Exponential.html#Exponential"><span class="hs-identifier hs-type">Exponential</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#Permutation"><span class="hs-identifier hs-type">Permutation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387602"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-356"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Exponent"><span class="annot"><a href="OAlg.Structure.Exponential.html#Exponent"><span class="hs-identifier hs-var">Exponent</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#Permutation"><span class="hs-identifier hs-type">Permutation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387602"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#Z"><span class="hs-identifier hs-type">Z</span></a></span><span>
</span><span id="line-357"></span><span>  </span><span id="local-6989586621679388370"><span class="annot"><span class="annottext">^ :: Permutation i -&gt; Exponent (Permutation i) -&gt; Permutation i
</span><a href="#local-6989586621679388370"><span class="hs-operator hs-var hs-var hs-var hs-var">(^)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Permutation i -&gt; Z -&gt; Permutation i
Permutation i -&gt; Exponent (Permutation i) -&gt; Permutation i
forall c. Invertible c =&gt; c -&gt; Z -&gt; c
</span><a href="OAlg.Structure.Multiplicative.Definition.html#zpower"><span class="hs-identifier hs-var">zpower</span></a></span><span>
</span><span id="line-358"></span><span>
</span><span id="line-359"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-360"></span><span class="hs-comment">-- swap -</span><span>
</span><span id="line-361"></span><span>
</span><span id="line-362"></span><span class="hs-comment">-- | swapping.</span><span>
</span><span id="line-363"></span><span class="hs-comment">--</span><span>
</span><span id="line-364"></span><span class="hs-comment">-- __Property__ Let @p = 'swap' n (i,j)@, then holds:</span><span>
</span><span id="line-365"></span><span class="hs-comment">-- If @i,j '&lt;' n@ then @p@ is the permutation given by swapping @i@ with @j@, otherwise a</span><span>
</span><span id="line-366"></span><span class="hs-comment">-- exception will be thrown.</span><span>
</span><span id="line-367"></span><span id="local-6989586621679387603"><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#swap"><span class="hs-identifier hs-type">swap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Definition.html#Entity"><span class="hs-identifier hs-type">Entity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387603"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679387603"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679387603"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679387603"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#Permutation"><span class="hs-identifier hs-type">Permutation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387603"><span class="hs-identifier hs-type">i</span></a></span></span><span>
</span><span id="line-368"></span><span id="swap"><span class="annot"><span class="annottext">swap :: forall i. (Entity i, Ord i) =&gt; i -&gt; i -&gt; Permutation i
</span><a href="OAlg.Entity.Sequence.Permutation.html#swap"><span class="hs-identifier hs-var hs-var">swap</span></a></span></span><span> </span><span id="local-6989586621679388381"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679388381"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679388382"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679388382"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679388381"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">i -&gt; i -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-operator hs-var">`compare`</span></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679388382"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-369"></span><span>  </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">LT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Form (Permutation i) -&gt; Permutation i
forall x. Constructable x =&gt; Form x -&gt; x
</span><a href="OAlg.Data.Constructable.html#make"><span class="hs-identifier hs-var">make</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PSequence i i -&gt; PermutationForm i
forall i. PSequence i i -&gt; PermutationForm i
</span><a href="OAlg.Entity.Sequence.Permutation.html#PermutationForm"><span class="hs-identifier hs-var">PermutationForm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(i, i)] -&gt; PSequence i i
forall i x. [(x, i)] -&gt; PSequence i x
</span><a href="OAlg.Entity.Sequence.PSequence.html#PSequence"><span class="hs-identifier hs-var">PSequence</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679388382"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679388381"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679388381"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679388382"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-370"></span><span>  </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">EQ</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Point (Permutation i) -&gt; Permutation i
forall c. Multiplicative c =&gt; Point c -&gt; c
</span><a href="OAlg.Structure.Multiplicative.Definition.html#one"><span class="hs-identifier hs-var">one</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-371"></span><span>  </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">GT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">i -&gt; i -&gt; Permutation i
forall i. (Entity i, Ord i) =&gt; i -&gt; i -&gt; Permutation i
</span><a href="OAlg.Entity.Sequence.Permutation.html#swap"><span class="hs-identifier hs-var">swap</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679388382"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679388381"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-372"></span><span>
</span><span id="line-373"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-374"></span><span class="hs-comment">-- PermutableSequence -</span><span>
</span><span id="line-375"></span><span>
</span><span id="line-376"></span><span class="hs-comment">-- | total right operations of permutations on sequences, admitting the following</span><span>
</span><span id="line-377"></span><span class="hs-comment">--   properties:</span><span>
</span><span id="line-378"></span><span class="hs-comment">--</span><span>
</span><span id="line-379"></span><span class="hs-comment">--  __Property__ Let @__s__@, @__i__@, @__x__@ be an instance of</span><span>
</span><span id="line-380"></span><span class="hs-comment">--  @'PermutableSequence'  __s__ __i__ __x__@, then holds:</span><span>
</span><span id="line-381"></span><span class="hs-comment">--</span><span>
</span><span id="line-382"></span><span class="hs-comment">--  (1) Let @xs@ be in @__s__ __x__@, @p@ in @'Permutation' __i__@ with</span><span>
</span><span id="line-383"></span><span class="hs-comment">--  @'image' z p '&lt;&lt;=' 'support' z xs@ for some @z@ in @__z__ __i__@, then holds:</span><span>
</span><span id="line-384"></span><span class="hs-comment">--  @(xs '&lt;*' p) '??' i '==' ((xs '??') '.' 'pmt' p) i@ for all @i@ in @'support' z xs@.</span><span>
</span><span id="line-385"></span><span class="hs-comment">--</span><span>
</span><span id="line-386"></span><span class="hs-comment">--  (2) Let @xs@ be in @__s__ __x__@, @w@ in @__x__ -&gt; __w__@,</span><span>
</span><span id="line-387"></span><span class="hs-comment">--  @c@ in @__w__ -&gt; __w__ -&gt; 'Ordering'@ and @z@ in @__z__ __i__@, then holds:</span><span>
</span><span id="line-388"></span><span class="hs-comment">--  Let @(xs',p) = 'permuteBy' z c w xs@ in</span><span>
</span><span id="line-389"></span><span class="hs-comment">--</span><span>
</span><span id="line-390"></span><span class="hs-comment">--      (1) @xs' '==' xs '&lt;*' p@.</span><span>
</span><span id="line-391"></span><span class="hs-comment">--</span><span>
</span><span id="line-392"></span><span class="hs-comment">--      (2) @xs'@ is ordered according to @c@ by applying @w@ to its items.</span><span>
</span><span id="line-393"></span><span class="hs-comment">--</span><span>
</span><span id="line-394"></span><span class="hs-comment">--      (3) @'image' z p '&lt;&lt;=' 'support' z xs@.</span><span>
</span><span id="line-395"></span><span class="hs-comment">--</span><span>
</span><span id="line-396"></span><span class="hs-comment">-- __Examples__</span><span>
</span><span id="line-397"></span><span class="hs-comment">--</span><span>
</span><span id="line-398"></span><span class="hs-comment">-- &gt;&gt;&gt; fst $ permuteBy nProxy compare isUpper &quot;abCd1eFgH&quot;</span><span>
</span><span id="line-399"></span><span class="hs-comment">-- &quot;abd1egCFH&quot;</span><span>
</span><span id="line-400"></span><span class="hs-comment">--</span><span>
</span><span id="line-401"></span><span class="hs-comment">-- as @'False' '&lt;' 'True'@</span><span>
</span><span id="line-402"></span><span class="hs-comment">--</span><span>
</span><span id="line-403"></span><span class="hs-comment">-- &gt;&gt;&gt; fst $ permuteBy nProxy (coCompare compare) isUpper &quot;abCd1eFgH&quot;</span><span>
</span><span id="line-404"></span><span class="hs-comment">-- &quot;CFHabd1eg&quot;</span><span>
</span><span id="line-405"></span><span class="hs-comment">--</span><span>
</span><span id="line-406"></span><span class="hs-comment">-- which orders it in the reverse ordering.</span><span>
</span><span id="line-407"></span><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sequence.Definition.html#Sequence"><span class="hs-identifier hs-type">Sequence</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387605"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387606"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387607"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Operational.html#TotalOpr"><span class="hs-identifier hs-type">TotalOpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#Permutation"><span class="hs-identifier hs-type">Permutation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387606"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679387605"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387607"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-408"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span id="PermutableSequence"><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#PermutableSequence"><span class="hs-identifier hs-var">PermutableSequence</span></a></span></span><span> </span><span id="local-6989586621679387605"><span class="annot"><a href="#local-6989586621679387605"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679387606"><span class="annot"><a href="#local-6989586621679387606"><span class="hs-identifier hs-type">i</span></a></span></span><span> </span><span id="local-6989586621679387607"><span class="annot"><a href="#local-6989586621679387607"><span class="hs-identifier hs-type">x</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-409"></span><span>  </span><span class="hs-comment">-- | a resulting permuation.</span><span>
</span><span id="line-410"></span><span>  </span><span id="permuteBy"><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#permuteBy"><span class="hs-identifier hs-type">permuteBy</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679387615"><span id="local-6989586621679387616"><span class="annot"><a href="#local-6989586621679387615"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387606"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679387616"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679387616"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ordering</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679387607"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679387616"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679387605"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387607"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679387605"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387607"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">,</span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#Permutation"><span class="hs-identifier hs-type">Permutation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387606"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-411"></span><span>
</span><span id="line-412"></span><span>
</span><span id="line-413"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-414"></span><span class="hs-comment">-- permuteByN -</span><span>
</span><span id="line-415"></span><span>
</span><span id="line-416"></span><span class="hs-comment">-- | orders the permutable sequence according to the given ordering an delivers the resulting</span><span>
</span><span id="line-417"></span><span class="hs-comment">-- permutation form.</span><span>
</span><span id="line-418"></span><span id="local-6989586621679387609"><span id="local-6989586621679387610"><span id="local-6989586621679387611"><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#permuteByN"><span class="hs-identifier hs-type">permuteByN</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#PermutableSequence"><span class="hs-identifier hs-type">PermutableSequence</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387609"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387610"><span class="hs-identifier hs-type">x</span></a></span><span>
</span><span id="line-419"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679387611"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679387611"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ordering</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679387610"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679387611"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679387609"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387610"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679387609"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387610"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">,</span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#Permutation"><span class="hs-identifier hs-type">Permutation</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-420"></span><span id="permuteByN"><span class="annot"><span class="annottext">permuteByN :: forall (s :: * -&gt; *) x w.
PermutableSequence s N x =&gt;
(w -&gt; w -&gt; Ordering) -&gt; (x -&gt; w) -&gt; s x -&gt; (s x, Permutation N)
</span><a href="OAlg.Entity.Sequence.Permutation.html#permuteByN"><span class="hs-identifier hs-var hs-var">permuteByN</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe N
-&gt; (w -&gt; w -&gt; Ordering) -&gt; (x -&gt; w) -&gt; s x -&gt; (s x, Permutation N)
forall (p :: * -&gt; *) w.
p N
-&gt; (w -&gt; w -&gt; Ordering) -&gt; (x -&gt; w) -&gt; s x -&gt; (s x, Permutation N)
forall (s :: * -&gt; *) i x (p :: * -&gt; *) w.
PermutableSequence s i x =&gt;
p i
-&gt; (w -&gt; w -&gt; Ordering) -&gt; (x -&gt; w) -&gt; s x -&gt; (s x, Permutation i)
</span><a href="OAlg.Entity.Sequence.Permutation.html#permuteBy"><span class="hs-identifier hs-var">permuteBy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">N -&gt; Maybe N
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-421"></span><span>
</span><span id="line-422"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-423"></span><span class="hs-comment">-- PSequence N - PermutableSequence -</span><span>
</span><span id="line-424"></span><span>
</span><span id="line-425"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679387622"><span id="local-6989586621679387623"><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679387622"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Structure.Operational.html#Opr"><span class="hs-identifier hs-type">Opr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#Permutation"><span class="hs-identifier hs-type">Permutation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387622"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sequence.PSequence.html#PSequence"><span class="hs-identifier hs-type">PSequence</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387622"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387623"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-426"></span><span>  </span><span id="local-6989586621679388395"><span class="annot"><span class="annottext">PSequence i x
</span><a href="#local-6989586621679388395"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621679388396"><span class="annot"><span class="annottext">&lt;* :: PSequence i x -&gt; Permutation i -&gt; PSequence i x
</span><a href="OAlg.Structure.Operational.html#%3C%2A"><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;*</span></a></span></span><span> </span><span id="local-6989586621679388397"><span class="annot"><span class="annottext">Permutation i
</span><a href="#local-6989586621679388397"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PSequence i x -&gt; PermutationForm i -&gt; PSequence i x
forall i x.
Ord i =&gt;
PSequence i x -&gt; PermutationForm i -&gt; PSequence i x
</span><a href="OAlg.Entity.Sequence.Permutation.html#pmfOprPsq"><span class="hs-identifier hs-var">pmfOprPsq</span></a></span><span> </span><span class="annot"><span class="annottext">PSequence i x
</span><a href="#local-6989586621679388395"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Permutation i -&gt; Form (Permutation i)
forall x. Exposable x =&gt; x -&gt; Form x
</span><a href="OAlg.Data.Constructable.html#form"><span class="hs-identifier hs-var">form</span></a></span><span> </span><span class="annot"><span class="annottext">Permutation i
</span><a href="#local-6989586621679388397"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-427"></span><span>
</span><span id="line-428"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679387630"><span id="local-6989586621679387631"><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Definition.html#Entity"><span class="hs-identifier hs-type">Entity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387630"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679387630"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Definition.html#Entity"><span class="hs-identifier hs-type">Entity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387631"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Structure.Operational.html#TotalOpr"><span class="hs-identifier hs-type">TotalOpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#Permutation"><span class="hs-identifier hs-type">Permutation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387630"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sequence.PSequence.html#PSequence"><span class="hs-identifier hs-type">PSequence</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387630"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387631"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-429"></span><span>
</span><span id="line-430"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679387365"><span id="local-6989586621679387366"><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Definition.html#Entity"><span class="hs-identifier hs-type">Entity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387365"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Definition.html#Entity"><span class="hs-identifier hs-type">Entity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387366"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679387366"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#PermutableSequence"><span class="hs-identifier hs-type">PermutableSequence</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sequence.PSequence.html#PSequence"><span class="hs-identifier hs-type">PSequence</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387366"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679387366"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387365"><span class="hs-identifier hs-type">x</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-431"></span><span>  </span><span id="local-6989586621679388424"><span class="annot"><span class="annottext">permuteBy :: forall (p :: * -&gt; *) w.
p i
-&gt; (w -&gt; w -&gt; Ordering)
-&gt; (x -&gt; w)
-&gt; PSequence i x
-&gt; (PSequence i x, Permutation i)
</span><a href="OAlg.Entity.Sequence.Permutation.html#permuteBy"><span class="hs-identifier hs-var hs-var hs-var hs-var">permuteBy</span></a></span></span><span> </span><span class="annot"><span class="annottext">p i
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679388425"><span class="annot"><span class="annottext">w -&gt; w -&gt; Ordering
</span><a href="#local-6989586621679388425"><span class="hs-identifier hs-var">cmp</span></a></span></span><span> </span><span id="local-6989586621679388426"><span class="annot"><span class="annottext">x -&gt; w
</span><a href="#local-6989586621679388426"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679388427"><span class="annot"><span class="annottext">PSequence i x
</span><a href="#local-6989586621679388427"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PSequence i x
</span><a href="#local-6989586621679388428"><span class="hs-identifier hs-var">xs'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Form (Permutation i) -&gt; Permutation i
forall x. Constructable x =&gt; Form x -&gt; x
</span><a href="OAlg.Data.Constructable.html#make"><span class="hs-identifier hs-var">make</span></a></span><span> </span><span class="annot"><span class="annottext">Form (Permutation i)
PermutationForm i
</span><a href="#local-6989586621679388429"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679388428"><span class="annot"><span class="annottext">PSequence i x
</span><a href="#local-6989586621679388428"><span class="hs-identifier hs-var">xs'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679388429"><span class="annot"><span class="annottext">PermutationForm i
</span><a href="#local-6989586621679388429"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(w -&gt; w -&gt; Ordering)
-&gt; (x -&gt; w) -&gt; PSequence i x -&gt; (PSequence i x, PermutationForm i)
forall i w x.
Ord i =&gt;
(w -&gt; w -&gt; Ordering)
-&gt; (x -&gt; w) -&gt; PSequence i x -&gt; (PSequence i x, PermutationForm i)
</span><a href="OAlg.Entity.Sequence.Permutation.html#pmfPsq"><span class="hs-identifier hs-var">pmfPsq</span></a></span><span> </span><span class="annot"><span class="annottext">w -&gt; w -&gt; Ordering
</span><a href="#local-6989586621679388425"><span class="hs-identifier hs-var">cmp</span></a></span><span> </span><span class="annot"><span class="annottext">x -&gt; w
</span><a href="#local-6989586621679388426"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">PSequence i x
</span><a href="#local-6989586621679388427"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-432"></span><span>
</span><span id="line-433"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-434"></span><span class="hs-comment">-- [x] - PermutableSequence -</span><span>
</span><span id="line-435"></span><span>
</span><span id="line-436"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679387637"><span class="annot"><a href="OAlg.Structure.Operational.html#Opr"><span class="hs-identifier hs-type">Opr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#Permutation"><span class="hs-identifier hs-type">Permutation</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679387637"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">]</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-437"></span><span>  </span><span id="local-6989586621679388433"><span class="annot"><span class="annottext">[x]
</span><a href="#local-6989586621679388433"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621679388434"><span class="annot"><span class="annottext">&lt;* :: [x] -&gt; Permutation N -&gt; [x]
</span><a href="OAlg.Structure.Operational.html#%3C%2A"><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;*</span></a></span></span><span> </span><span id="local-6989586621679388435"><span class="annot"><span class="annottext">Permutation N
</span><a href="#local-6989586621679388435"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[x] -&gt; PermutationForm N -&gt; [x]
forall x. [x] -&gt; PermutationForm N -&gt; [x]
</span><a href="OAlg.Entity.Sequence.Permutation.html#pmfOprLst"><span class="hs-identifier hs-var">pmfOprLst</span></a></span><span> </span><span class="annot"><span class="annottext">[x]
</span><a href="#local-6989586621679388433"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Permutation N -&gt; Form (Permutation N)
forall x. Exposable x =&gt; x -&gt; Form x
</span><a href="OAlg.Data.Constructable.html#form"><span class="hs-identifier hs-var">form</span></a></span><span> </span><span class="annot"><span class="annottext">Permutation N
</span><a href="#local-6989586621679388435"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-438"></span><span>
</span><span id="line-439"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679387639"><span class="annot"><a href="OAlg.Entity.Definition.html#Entity"><span class="hs-identifier hs-type">Entity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387639"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Structure.Operational.html#TotalOpr"><span class="hs-identifier hs-type">TotalOpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#Permutation"><span class="hs-identifier hs-type">Permutation</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679387639"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-440"></span><span>
</span><span id="line-441"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679387364"><span class="annot"><a href="OAlg.Entity.Definition.html#Entity"><span class="hs-identifier hs-type">Entity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387364"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#PermutableSequence"><span class="hs-identifier hs-type">PermutableSequence</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387364"><span class="hs-identifier hs-type">x</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-442"></span><span>  </span><span id="local-6989586621679388456"><span class="annot"><span class="annottext">permuteBy :: forall (p :: * -&gt; *) w.
p N
-&gt; (w -&gt; w -&gt; Ordering) -&gt; (x -&gt; w) -&gt; [x] -&gt; ([x], Permutation N)
</span><a href="OAlg.Entity.Sequence.Permutation.html#permuteBy"><span class="hs-identifier hs-var hs-var hs-var hs-var">permuteBy</span></a></span></span><span> </span><span class="annot"><span class="annottext">p N
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679388457"><span class="annot"><span class="annottext">w -&gt; w -&gt; Ordering
</span><a href="#local-6989586621679388457"><span class="hs-identifier hs-var">wcmp</span></a></span></span><span> </span><span id="local-6989586621679388458"><span class="annot"><span class="annottext">x -&gt; w
</span><a href="#local-6989586621679388458"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679388459"><span class="annot"><span class="annottext">[x]
</span><a href="#local-6989586621679388459"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[x]
</span><a href="#local-6989586621679388460"><span class="hs-identifier hs-var">xs'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Form (Permutation N) -&gt; Permutation N
forall x. Constructable x =&gt; Form x -&gt; x
</span><a href="OAlg.Data.Constructable.html#make"><span class="hs-identifier hs-var">make</span></a></span><span> </span><span class="annot"><span class="annottext">Form (Permutation N)
PermutationForm N
</span><a href="#local-6989586621679388461"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679388460"><span class="annot"><span class="annottext">[x]
</span><a href="#local-6989586621679388460"><span class="hs-identifier hs-var">xs'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679388461"><span class="annot"><span class="annottext">PermutationForm N
</span><a href="#local-6989586621679388461"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(w -&gt; w -&gt; Ordering) -&gt; (x -&gt; w) -&gt; [x] -&gt; ([x], PermutationForm N)
forall w x.
(w -&gt; w -&gt; Ordering) -&gt; (x -&gt; w) -&gt; [x] -&gt; ([x], PermutationForm N)
</span><a href="OAlg.Entity.Sequence.Permutation.html#pmfLst"><span class="hs-identifier hs-var">pmfLst</span></a></span><span> </span><span class="annot"><span class="annottext">w -&gt; w -&gt; Ordering
</span><a href="#local-6989586621679388457"><span class="hs-identifier hs-var">wcmp</span></a></span><span> </span><span class="annot"><span class="annottext">x -&gt; w
</span><a href="#local-6989586621679388458"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">[x]
</span><a href="#local-6989586621679388459"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-443"></span><span>
</span><span id="line-444"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-445"></span><span class="hs-comment">-- CSequence - PermutableSequence -</span><span>
</span><span id="line-446"></span><span>
</span><span id="line-447"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679387646"><span class="annot"><a href="OAlg.Entity.Definition.html#Entity"><span class="hs-identifier hs-type">Entity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387646"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Structure.Operational.html#Opr"><span class="hs-identifier hs-type">Opr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#Permutation"><span class="hs-identifier hs-type">Permutation</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sequence.CSequence.html#CSequence"><span class="hs-identifier hs-type">CSequence</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387646"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-448"></span><span>  </span><span id="local-6989586621679388467"><span class="annot"><span class="annottext">CSequence x
</span><a href="#local-6989586621679388467"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621679388468"><span class="annot"><span class="annottext">&lt;* :: CSequence x -&gt; Permutation N -&gt; CSequence x
</span><a href="OAlg.Structure.Operational.html#%3C%2A"><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;*</span></a></span></span><span> </span><span id="local-6989586621679388469"><span class="annot"><span class="annottext">Permutation N
</span><a href="#local-6989586621679388469"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CSequence x -&gt; PermutationForm N -&gt; CSequence x
forall x.
Entity x =&gt;
CSequence x -&gt; PermutationForm N -&gt; CSequence x
</span><a href="OAlg.Entity.Sequence.Permutation.html#pmfOprPsy"><span class="hs-identifier hs-var">pmfOprPsy</span></a></span><span> </span><span class="annot"><span class="annottext">CSequence x
</span><a href="#local-6989586621679388467"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Permutation N -&gt; Form (Permutation N)
forall x. Exposable x =&gt; x -&gt; Form x
</span><a href="OAlg.Data.Constructable.html#form"><span class="hs-identifier hs-var">form</span></a></span><span> </span><span class="annot"><span class="annottext">Permutation N
</span><a href="#local-6989586621679388469"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-449"></span><span>
</span><span id="line-450"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679387648"><span class="annot"><a href="OAlg.Entity.Definition.html#Entity"><span class="hs-identifier hs-type">Entity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387648"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Structure.Operational.html#TotalOpr"><span class="hs-identifier hs-type">TotalOpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#Permutation"><span class="hs-identifier hs-type">Permutation</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sequence.CSequence.html#CSequence"><span class="hs-identifier hs-type">CSequence</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387648"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-451"></span><span>
</span><span id="line-452"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679387363"><span class="annot"><a href="OAlg.Entity.Definition.html#Entity"><span class="hs-identifier hs-type">Entity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387363"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#PermutableSequence"><span class="hs-identifier hs-type">PermutableSequence</span></a></span><span> </span><span class="annot"><a href="OAlg.Entity.Sequence.CSequence.html#CSequence"><span class="hs-identifier hs-type">CSequence</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387363"><span class="hs-identifier hs-type">x</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-453"></span><span>  </span><span id="local-6989586621679388490"><span class="annot"><span class="annottext">permuteBy :: forall (p :: * -&gt; *) w.
p N
-&gt; (w -&gt; w -&gt; Ordering)
-&gt; (x -&gt; w)
-&gt; CSequence x
-&gt; (CSequence x, Permutation N)
</span><a href="OAlg.Entity.Sequence.Permutation.html#permuteBy"><span class="hs-identifier hs-var hs-var hs-var hs-var">permuteBy</span></a></span></span><span> </span><span class="annot"><span class="annottext">p N
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679388491"><span class="annot"><span class="annottext">w -&gt; w -&gt; Ordering
</span><a href="#local-6989586621679388491"><span class="hs-identifier hs-var">wcmp</span></a></span></span><span> </span><span id="local-6989586621679388492"><span class="annot"><span class="annottext">x -&gt; w
</span><a href="#local-6989586621679388492"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679388493"><span class="annot"><span class="annottext">CSequence x
</span><a href="#local-6989586621679388493"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CSequence x
</span><a href="#local-6989586621679388494"><span class="hs-identifier hs-var">xs'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Form (Permutation N) -&gt; Permutation N
forall x. Constructable x =&gt; Form x -&gt; x
</span><a href="OAlg.Data.Constructable.html#make"><span class="hs-identifier hs-var">make</span></a></span><span> </span><span class="annot"><span class="annottext">Form (Permutation N)
PermutationForm N
</span><a href="#local-6989586621679388495"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679388494"><span class="annot"><span class="annottext">CSequence x
</span><a href="#local-6989586621679388494"><span class="hs-identifier hs-var">xs'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679388495"><span class="annot"><span class="annottext">PermutationForm N
</span><a href="#local-6989586621679388495"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(w -&gt; w -&gt; Ordering)
-&gt; (x -&gt; w) -&gt; CSequence x -&gt; (CSequence x, PermutationForm N)
forall x w.
Entity x =&gt;
(w -&gt; w -&gt; Ordering)
-&gt; (x -&gt; w) -&gt; CSequence x -&gt; (CSequence x, PermutationForm N)
</span><a href="OAlg.Entity.Sequence.Permutation.html#pmfPsy"><span class="hs-identifier hs-var">pmfPsy</span></a></span><span> </span><span class="annot"><span class="annottext">w -&gt; w -&gt; Ordering
</span><a href="#local-6989586621679388491"><span class="hs-identifier hs-var">wcmp</span></a></span><span> </span><span class="annot"><span class="annottext">x -&gt; w
</span><a href="#local-6989586621679388492"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">CSequence x
</span><a href="#local-6989586621679388493"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-454"></span><span>
</span><span id="line-455"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-456"></span><span class="hs-comment">-- Permutation - PermutableSequence -</span><span>
</span><span id="line-457"></span><span>
</span><span id="line-458"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679387654"><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Definition.html#Entity"><span class="hs-identifier hs-type">Entity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387654"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679387654"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Structure.Operational.html#Opr"><span class="hs-identifier hs-type">Opr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#Permutation"><span class="hs-identifier hs-type">Permutation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387654"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#Permutation"><span class="hs-identifier hs-type">Permutation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387654"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-459"></span><span>  </span><span id="local-6989586621679388501"><span class="annot"><span class="annottext">&lt;* :: Permutation i -&gt; Permutation i -&gt; Permutation i
</span><a href="OAlg.Structure.Operational.html#%3C%2A"><span class="hs-operator hs-var hs-var hs-var hs-var">(&lt;*)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Permutation i -&gt; Permutation i -&gt; Permutation i
forall c. Multiplicative c =&gt; c -&gt; c -&gt; c
</span><a href="OAlg.Structure.Multiplicative.Definition.html#%2A"><span class="hs-operator hs-var">(*)</span></a></span><span>
</span><span id="line-460"></span><span>
</span><span id="line-461"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679387656"><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Definition.html#Entity"><span class="hs-identifier hs-type">Entity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387656"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679387656"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Structure.Operational.html#TotalOpr"><span class="hs-identifier hs-type">TotalOpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#Permutation"><span class="hs-identifier hs-type">Permutation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387656"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#Permutation"><span class="hs-identifier hs-type">Permutation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387656"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-462"></span><span>
</span><span id="line-463"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679387658"><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Definition.html#Entity"><span class="hs-identifier hs-type">Entity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387658"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679387658"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#PermutableSequence"><span class="hs-identifier hs-type">PermutableSequence</span></a></span><span> </span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#Permutation"><span class="hs-identifier hs-type">Permutation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387658"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387658"><span class="hs-identifier hs-type">i</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-464"></span><span>  </span><span id="local-6989586621679388524"><span class="annot"><span class="annottext">permuteBy :: forall (p :: * -&gt; *) w.
p i
-&gt; (w -&gt; w -&gt; Ordering)
-&gt; (i -&gt; w)
-&gt; Permutation i
-&gt; (Permutation i, Permutation i)
</span><a href="OAlg.Entity.Sequence.Permutation.html#permuteBy"><span class="hs-identifier hs-var hs-var hs-var hs-var">permuteBy</span></a></span></span><span> </span><span id="local-6989586621679388525"><span class="annot"><span class="annottext">p i
</span><a href="#local-6989586621679388525"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679388526"><span class="annot"><span class="annottext">w -&gt; w -&gt; Ordering
</span><a href="#local-6989586621679388526"><span class="hs-identifier hs-var">wcmp</span></a></span></span><span> </span><span id="local-6989586621679388527"><span class="annot"><span class="annottext">i -&gt; w
</span><a href="#local-6989586621679388527"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#Permutation"><span class="hs-identifier hs-type">Permutation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#PermutationForm"><span class="hs-identifier hs-type">PermutationForm</span></a></span><span> </span><span id="local-6989586621679388528"><span class="annot"><span class="annottext">PSequence i i
</span><a href="#local-6989586621679388528"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-465"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Form (Permutation i) -&gt; Permutation i
forall x. Constructable x =&gt; Form x -&gt; x
</span><a href="OAlg.Data.Constructable.html#make"><span class="hs-identifier hs-var">make</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PSequence i i -&gt; PermutationForm i
forall i. PSequence i i -&gt; PermutationForm i
</span><a href="OAlg.Entity.Sequence.Permutation.html#PermutationForm"><span class="hs-identifier hs-var">PermutationForm</span></a></span><span> </span><span class="annot"><span class="annottext">PSequence i i
</span><a href="#local-6989586621679388529"><span class="hs-identifier hs-var">p'</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Permutation i
</span><a href="#local-6989586621679388530"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679388529"><span class="annot"><span class="annottext">PSequence i i
</span><a href="#local-6989586621679388529"><span class="hs-identifier hs-var">p'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679388530"><span class="annot"><span class="annottext">Permutation i
</span><a href="#local-6989586621679388530"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">p i
-&gt; (w -&gt; w -&gt; Ordering)
-&gt; (i -&gt; w)
-&gt; PSequence i i
-&gt; (PSequence i i, Permutation i)
forall (p :: * -&gt; *) w.
p i
-&gt; (w -&gt; w -&gt; Ordering)
-&gt; (i -&gt; w)
-&gt; PSequence i i
-&gt; (PSequence i i, Permutation i)
forall (s :: * -&gt; *) i x (p :: * -&gt; *) w.
PermutableSequence s i x =&gt;
p i
-&gt; (w -&gt; w -&gt; Ordering) -&gt; (x -&gt; w) -&gt; s x -&gt; (s x, Permutation i)
</span><a href="OAlg.Entity.Sequence.Permutation.html#permuteBy"><span class="hs-identifier hs-var">permuteBy</span></a></span><span> </span><span class="annot"><span class="annottext">p i
</span><a href="#local-6989586621679388525"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">w -&gt; w -&gt; Ordering
</span><a href="#local-6989586621679388526"><span class="hs-identifier hs-var">wcmp</span></a></span><span> </span><span class="annot"><span class="annottext">i -&gt; w
</span><a href="#local-6989586621679388527"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">PSequence i i
</span><a href="#local-6989586621679388528"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-466"></span><span>
</span><span id="line-467"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-468"></span><span class="hs-comment">-- xPermutation -</span><span>
</span><span id="line-469"></span><span>
</span><span id="line-470"></span><span class="annot"><span class="hs-comment">-- | random variable of permutations.</span></span><span>
</span><span id="line-471"></span><span id="local-6989586621679387661"><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#xPermutation"><span class="hs-identifier hs-type">xPermutation</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Definition.html#Entity"><span class="hs-identifier hs-type">Entity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387661"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679387661"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-472"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ maximal number of swappings.</span></span><span>
</span><span id="line-473"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.X.html#X"><span class="hs-identifier hs-type">X</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387661"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ span of the swappings.</span></span><span>
</span><span id="line-474"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.X.html#X"><span class="hs-identifier hs-type">X</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#Permutation"><span class="hs-identifier hs-type">Permutation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387661"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-475"></span><span id="xPermutation"><span class="annot"><span class="annottext">xPermutation :: forall i. (Entity i, Ord i) =&gt; N -&gt; X i -&gt; X (Permutation i)
</span><a href="OAlg.Entity.Sequence.Permutation.html#xPermutation"><span class="hs-identifier hs-var hs-var">xPermutation</span></a></span></span><span> </span><span id="local-6989586621679388544"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679388544"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679388545"><span class="annot"><span class="annottext">X i
</span><a href="#local-6989586621679388545"><span class="hs-identifier hs-var">xi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; X N
</span><a href="OAlg.Data.X.html#xNB"><span class="hs-identifier hs-var">xNB</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679388544"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">X N -&gt; (N -&gt; X (Permutation i)) -&gt; X (Permutation i)
forall a b. X a -&gt; (a -&gt; X b) -&gt; X b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">N -&gt; Permutation i -&gt; N -&gt; X (Permutation i)
</span><a href="#local-6989586621679388547"><span class="hs-identifier hs-var">pmt</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point (Permutation i) -&gt; Permutation i
forall c. Multiplicative c =&gt; Point c -&gt; c
</span><a href="OAlg.Structure.Multiplicative.Definition.html#one"><span class="hs-identifier hs-var">one</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-476"></span><span>  </span><span id="local-6989586621679388547"><span class="annot"><span class="annottext">pmt :: N -&gt; Permutation i -&gt; N -&gt; X (Permutation i)
</span><a href="#local-6989586621679388547"><span class="hs-identifier hs-var hs-var">pmt</span></a></span></span><span> </span><span id="local-6989586621679388548"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679388548"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679388549"><span class="annot"><span class="annottext">Permutation i
</span><a href="#local-6989586621679388549"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679388550"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679388550"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679388550"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679388548"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Permutation i -&gt; X (Permutation i)
forall a. a -&gt; X a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Permutation i
</span><a href="#local-6989586621679388549"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-477"></span><span>  </span><span class="annot"><a href="#local-6989586621679388547"><span class="hs-identifier hs-var">pmt</span></a></span><span> </span><span id="local-6989586621679388551"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679388551"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679388552"><span class="annot"><span class="annottext">Permutation i
</span><a href="#local-6989586621679388552"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679388553"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679388553"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-478"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679388554"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679388554"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679388555"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679388555"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">X i -&gt; X i -&gt; X (i, i)
forall a b. X a -&gt; X b -&gt; X (a, b)
</span><a href="OAlg.Data.X.html#xTupple2"><span class="hs-identifier hs-var">xTupple2</span></a></span><span> </span><span class="annot"><span class="annottext">X i
</span><a href="#local-6989586621679388545"><span class="hs-identifier hs-var">xi</span></a></span><span> </span><span class="annot"><span class="annottext">X i
</span><a href="#local-6989586621679388545"><span class="hs-identifier hs-var">xi</span></a></span><span>
</span><span id="line-479"></span><span>    </span><span class="annot"><span class="annottext">N -&gt; Permutation i -&gt; N -&gt; X (Permutation i)
</span><a href="#local-6989586621679388547"><span class="hs-identifier hs-var">pmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">N -&gt; N
forall a. Enum a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">succ</span></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679388551"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Permutation i
</span><a href="#local-6989586621679388552"><span class="hs-identifier hs-var">p</span></a></span><span class="annot"><span class="annottext">Permutation i -&gt; Permutation i -&gt; Permutation i
forall c. Multiplicative c =&gt; c -&gt; c -&gt; c
</span><a href="OAlg.Structure.Multiplicative.Definition.html#%2A"><span class="hs-operator hs-var">*</span></a></span><span class="annot"><span class="annottext">i -&gt; i -&gt; Permutation i
forall i. (Entity i, Ord i) =&gt; i -&gt; i -&gt; Permutation i
</span><a href="OAlg.Entity.Sequence.Permutation.html#swap"><span class="hs-identifier hs-var">swap</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679388554"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679388555"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679388553"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-480"></span><span>
</span><span id="line-481"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-482"></span><span class="hs-comment">-- xPermutationB -</span><span>
</span><span id="line-483"></span><span>
</span><span id="line-484"></span><span class="annot"><span class="hs-comment">-- | random variable of permutations within the given bounds.</span></span><span>
</span><span id="line-485"></span><span id="local-6989586621679387668"><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#xPermutationB"><span class="hs-identifier hs-type">xPermutationB</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679387668"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Enum</span></span><span> </span><span class="annot"><a href="#local-6989586621679387668"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679387668"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679387668"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.X.html#X"><span class="hs-identifier hs-type">X</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#Permutation"><span class="hs-identifier hs-type">Permutation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387668"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-486"></span><span id="xPermutationB"><span class="annot"><span class="annottext">xPermutationB :: forall i. (Ord i, Enum i) =&gt; i -&gt; i -&gt; X (Permutation i)
</span><a href="OAlg.Entity.Sequence.Permutation.html#xPermutationB"><span class="hs-identifier hs-var hs-var">xPermutationB</span></a></span></span><span> </span><span id="local-6989586621679388571"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679388571"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679388572"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679388572"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-487"></span><span>  </span><span id="local-6989586621679388573"><span class="annot"><span class="annottext">[i]
</span><a href="#local-6989586621679388573"><span class="hs-identifier hs-var">is'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [i] -&gt; X [i]
forall {a}. Int -&gt; [a] -&gt; X [a]
</span><a href="#local-6989586621679388574"><span class="hs-identifier hs-var">xp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[i] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[i]
</span><a href="#local-6989586621679388576"><span class="hs-identifier hs-var">is</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[i]
</span><a href="#local-6989586621679388576"><span class="hs-identifier hs-var">is</span></a></span><span>
</span><span id="line-488"></span><span>  </span><span class="annot"><span class="annottext">Permutation i -&gt; X (Permutation i)
forall a. a -&gt; X a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Permutation i -&gt; X (Permutation i))
-&gt; Permutation i -&gt; X (Permutation i)
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><a href="OAlg.Category.Applicative.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Form (Permutation i) -&gt; Permutation i
PermutationForm i -&gt; Permutation i
forall x. Constructable x =&gt; Form x -&gt; x
</span><a href="OAlg.Data.Constructable.html#make"><span class="hs-identifier hs-var">make</span></a></span><span> </span><span class="annot"><span class="annottext">(PermutationForm i -&gt; Permutation i)
-&gt; PermutationForm i -&gt; Permutation i
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><a href="OAlg.Category.Applicative.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PSequence i i -&gt; PermutationForm i
forall i. PSequence i i -&gt; PermutationForm i
</span><a href="OAlg.Entity.Sequence.Permutation.html#PermutationForm"><span class="hs-identifier hs-var">PermutationForm</span></a></span><span> </span><span class="annot"><span class="annottext">(PSequence i i -&gt; PermutationForm i)
-&gt; PSequence i i -&gt; PermutationForm i
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><a href="OAlg.Category.Applicative.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[(i, i)] -&gt; PSequence i i
forall i x. [(x, i)] -&gt; PSequence i x
</span><a href="OAlg.Entity.Sequence.PSequence.html#PSequence"><span class="hs-identifier hs-var">PSequence</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[i]
</span><a href="#local-6989586621679388573"><span class="hs-identifier hs-var">is'</span></a></span><span> </span><span class="annot"><span class="annottext">[i] -&gt; [i] -&gt; [(i, i)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-operator hs-var">`zip`</span></span><span> </span><span class="annot"><span class="annottext">[i]
</span><a href="#local-6989586621679388576"><span class="hs-identifier hs-var">is</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-489"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-490"></span><span>    </span><span id="local-6989586621679388576"><span class="annot"><span class="annottext">is :: [i]
</span><a href="#local-6989586621679388576"><span class="hs-identifier hs-var hs-var">is</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">i -&gt; i -&gt; [i]
forall i. (Ord i, Enum i) =&gt; i -&gt; i -&gt; [i]
</span><a href="OAlg.Data.Number.html#enum"><span class="hs-identifier hs-var">enum</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679388571"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679388572"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-491"></span><span>    </span><span id="local-6989586621679388574"><span class="annot"><span class="annottext">xp :: Int -&gt; [a] -&gt; X [a]
</span><a href="#local-6989586621679388574"><span class="hs-identifier hs-var hs-var">xp</span></a></span></span><span> </span><span id="local-6989586621679388594"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679388594"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679388595"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679388595"><span class="hs-identifier hs-var">is</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679388594"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; X [a]
forall a. a -&gt; X a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679388595"><span class="hs-identifier hs-var">is</span></a></span><span>
</span><span id="line-492"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-493"></span><span>      </span><span id="local-6989586621679388596"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679388596"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; X Int
</span><a href="OAlg.Data.X.html#xIntB"><span class="hs-identifier hs-var">xIntB</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679388594"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-494"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679388596"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679388594"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-495"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; X [a]
forall a. a -&gt; X a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679388595"><span class="hs-identifier hs-var">is</span></a></span><span>
</span><span id="line-496"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679388598"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679388598"><span class="hs-identifier hs-var">is'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679388599"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679388599"><span class="hs-identifier hs-var">is''</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [a] -&gt; ([a], [a])
forall a. Int -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">splitAt</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679388596"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679388595"><span class="hs-identifier hs-var">is</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-497"></span><span>          </span><span id="local-6989586621679388600"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679388600"><span class="hs-identifier hs-var">is'''</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [a] -&gt; X [a]
</span><a href="#local-6989586621679388574"><span class="hs-identifier hs-var">xp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int
forall a. Enum a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">pred</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679388594"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679388598"><span class="hs-identifier hs-var">is'</span></a></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a] -&gt; [a]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a]
forall a. HasCallStack =&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">tail</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679388599"><span class="hs-identifier hs-var">is''</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-498"></span><span>          </span><span class="annot"><span class="annottext">[a] -&gt; X [a]
forall a. a -&gt; X a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a] -&gt; a
forall a. HasCallStack =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679388599"><span class="hs-identifier hs-var">is''</span></a></span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679388600"><span class="hs-identifier hs-var">is'''</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-499"></span><span>
</span><span id="line-500"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-501"></span><span class="hs-comment">-- xPermutationN -</span><span>
</span><span id="line-502"></span><span>
</span><span id="line-503"></span><span class="annot"><span class="hs-comment">-- | random variable of permutations of the index set @[0..prd n]@. </span></span><span>
</span><span id="line-504"></span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#xPermutationN"><span class="hs-identifier hs-type">xPermutationN</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.X.html#X"><span class="hs-identifier hs-type">X</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#Permutation"><span class="hs-identifier hs-type">Permutation</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-505"></span><span id="xPermutationN"><span class="annot"><span class="annottext">xPermutationN :: N -&gt; X (Permutation N)
</span><a href="OAlg.Entity.Sequence.Permutation.html#xPermutationN"><span class="hs-identifier hs-var hs-var">xPermutationN</span></a></span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Permutation N -&gt; X (Permutation N)
forall a. a -&gt; X a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point (Permutation N) -&gt; Permutation N
forall c. Multiplicative c =&gt; Point c -&gt; c
</span><a href="OAlg.Structure.Multiplicative.Definition.html#one"><span class="hs-identifier hs-var">one</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-506"></span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#xPermutationN"><span class="hs-identifier hs-var">xPermutationN</span></a></span><span> </span><span id="local-6989586621679388602"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679388602"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; X (Permutation N)
forall i. (Ord i, Enum i) =&gt; i -&gt; i -&gt; X (Permutation i)
</span><a href="OAlg.Entity.Sequence.Permutation.html#xPermutationB"><span class="hs-identifier hs-var">xPermutationB</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">N -&gt; N
forall a. Enum a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">pred</span></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679388602"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-507"></span><span>
</span><span id="line-508"></span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#dd"><span class="hs-identifier hs-type">dd</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.X.html#X"><span class="hs-identifier hs-type">X</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#Permutation"><span class="hs-identifier hs-type">Permutation</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-509"></span><span id="dd"><span class="annot"><span class="annottext">dd :: Int -&gt; X (Permutation N) -&gt; IO ()
</span><a href="OAlg.Entity.Sequence.Permutation.html#dd"><span class="hs-identifier hs-var hs-var">dd</span></a></span></span><span> </span><span id="local-6989586621679388604"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679388604"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679388605"><span class="annot"><span class="annottext">X (Permutation N)
</span><a href="#local-6989586621679388605"><span class="hs-identifier hs-var">xp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO Omega
</span><a href="OAlg.Data.X.html#getOmega"><span class="hs-identifier hs-var">getOmega</span></a></span><span> </span><span class="annot"><span class="annottext">IO Omega -&gt; (Omega -&gt; IO ()) -&gt; IO ()
forall a b. IO a -&gt; (a -&gt; IO b) -&gt; IO b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; X N -&gt; Omega -&gt; IO ()
forall x. (Show x, Ord x) =&gt; Int -&gt; X x -&gt; Omega -&gt; IO ()
</span><a href="OAlg.Data.X.html#putDistribution"><span class="hs-identifier hs-var">putDistribution</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679388604"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Permutation N -&gt; N) -&gt; X (Permutation N) -&gt; X N
forall a b. (a -&gt; b) -&gt; X a -&gt; X b
forall (h :: * -&gt; * -&gt; *) (f :: * -&gt; *) a b.
Applicative1 h f =&gt;
h a b -&gt; f a -&gt; f b
</span><a href="OAlg.Category.Applicative.html#amap1"><span class="hs-identifier hs-var">amap1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Permutation N -&gt; N -&gt; N
forall i. Ord i =&gt; Permutation i -&gt; i -&gt; i
</span><a href="OAlg.Entity.Sequence.Permutation.html#pmt"><span class="hs-operator hs-var">`pmt`</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span class="hs-glyph">::</span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">X (Permutation N)
</span><a href="#local-6989586621679388605"><span class="hs-identifier hs-var">xp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-510"></span><span>
</span><span id="line-511"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-512"></span><span class="hs-comment">-- xMltPermutation -</span><span>
</span><span id="line-513"></span><span>
</span><span id="line-514"></span><span class="annot"><span class="hs-comment">-- | random variable for validating the 'Multiplicative' structure.</span></span><span>
</span><span id="line-515"></span><span id="local-6989586621679387683"><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#xMltPermutation"><span class="hs-identifier hs-type">xMltPermutation</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Definition.html#Entity"><span class="hs-identifier hs-type">Entity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387683"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679387683"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.X.html#X"><span class="hs-identifier hs-type">X</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387683"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Structure.Multiplicative.Proposition.html#XMlt"><span class="hs-identifier hs-type">XMlt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#Permutation"><span class="hs-identifier hs-type">Permutation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387683"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-516"></span><span id="xMltPermutation"><span class="annot"><span class="annottext">xMltPermutation :: forall i. (Entity i, Ord i) =&gt; N -&gt; X i -&gt; XMlt (Permutation i)
</span><a href="OAlg.Entity.Sequence.Permutation.html#xMltPermutation"><span class="hs-identifier hs-var hs-var">xMltPermutation</span></a></span></span><span> </span><span id="local-6989586621679388617"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679388617"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679388618"><span class="annot"><span class="annottext">X i
</span><a href="#local-6989586621679388618"><span class="hs-identifier hs-var">xi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">X N -&gt; X (Permutation i) -&gt; XMlt (Permutation i)
forall c. Singleton (Point c) =&gt; X N -&gt; X c -&gt; XMlt c
</span><a href="OAlg.Structure.Multiplicative.Proposition.html#xMltTtl"><span class="hs-identifier hs-var">xMltTtl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">N -&gt; N -&gt; X N
</span><a href="OAlg.Data.X.html#xNB"><span class="hs-identifier hs-var">xNB</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">10</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">N -&gt; X i -&gt; X (Permutation i)
forall i. (Entity i, Ord i) =&gt; N -&gt; X i -&gt; X (Permutation i)
</span><a href="OAlg.Entity.Sequence.Permutation.html#xPermutation"><span class="hs-identifier hs-var">xPermutation</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679388617"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">X i
</span><a href="#local-6989586621679388618"><span class="hs-identifier hs-var">xi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-517"></span><span>
</span><span id="line-518"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-519"></span><span class="hs-comment">-- relOprPermutation -</span><span>
</span><span id="line-520"></span><span>
</span><span id="line-521"></span><span id="local-6989586621679387687"><span id="local-6989586621679387688"><span id="local-6989586621679387689"><span id="local-6989586621679387691"><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#relOprPermutation"><span class="hs-identifier hs-type">relOprPermutation</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Structure.Operational.html#TotalOpr"><span class="hs-identifier hs-type">TotalOpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#Permutation"><span class="hs-identifier hs-type">Permutation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387687"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679387688"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387689"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Sequence.Definition.html#ConstructableSequence"><span class="hs-identifier hs-type">ConstructableSequence</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387688"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387687"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387689"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-522"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679387691"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387687"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679387688"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387689"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#Permutation"><span class="hs-identifier hs-type">Permutation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387687"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.Statement.Definition.html#Statement"><span class="hs-identifier hs-type">Statement</span></a></span></span></span></span></span><span>
</span><span id="line-523"></span><span id="relOprPermutation"><span class="annot"><span class="annottext">relOprPermutation :: forall i (s :: * -&gt; *) x (p :: * -&gt; *).
(TotalOpr (Permutation i) (s x), ConstructableSequence s i x) =&gt;
p i -&gt; s x -&gt; Permutation i -&gt; Statement
</span><a href="OAlg.Entity.Sequence.Permutation.html#relOprPermutation"><span class="hs-identifier hs-var hs-var">relOprPermutation</span></a></span></span><span> </span><span id="local-6989586621679388654"><span class="annot"><span class="annottext">p i
</span><a href="#local-6989586621679388654"><span class="hs-identifier hs-var">pi</span></a></span></span><span> </span><span id="local-6989586621679388655"><span class="annot"><span class="annottext">s x
</span><a href="#local-6989586621679388655"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621679388656"><span class="annot"><span class="annottext">Permutation i
</span><a href="#local-6989586621679388656"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">s x
</span><a href="#local-6989586621679388655"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">s x -&gt; Permutation i -&gt; s x
forall f x. Opr f x =&gt; x -&gt; f -&gt; x
</span><a href="OAlg.Structure.Operational.html#%3C%2A"><span class="hs-operator hs-var">&lt;*</span></a></span><span> </span><span class="annot"><span class="annottext">Permutation i
</span><a href="#local-6989586621679388656"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">s x -&gt; s x -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Set i -&gt; (i -&gt; i) -&gt; s x -&gt; s x
forall (s :: * -&gt; *) i x j.
(ConstructableSequence s i x, Sequence s j x) =&gt;
Set i -&gt; (i -&gt; j) -&gt; s x -&gt; s x
</span><a href="OAlg.Entity.Sequence.Definition.html#sqcIndexMap"><span class="hs-identifier hs-var">sqcIndexMap</span></a></span><span> </span><span class="annot"><span class="annottext">Set i
</span><a href="#local-6989586621679388657"><span class="hs-identifier hs-var">is</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Permutation i -&gt; i -&gt; i
forall i. Ord i =&gt; Permutation i -&gt; i -&gt; i
</span><a href="OAlg.Entity.Sequence.Permutation.html#pmt"><span class="hs-identifier hs-var">pmt</span></a></span><span> </span><span class="annot"><span class="annottext">Permutation i
</span><a href="#local-6989586621679388656"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">s x
</span><a href="#local-6989586621679388655"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-524"></span><span>                </span><span class="annot"><span class="annottext">Bool -&gt; Message -&gt; Statement
</span><a href="OAlg.Data.Statement.Definition.html#%3A%3F%3E"><span class="hs-operator hs-var">:?&gt;</span></a></span><span class="annot"><span class="annottext">[Parameter] -&gt; Message
</span><a href="OAlg.Data.Statement.Definition.html#Params"><span class="hs-identifier hs-var">Params</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;xs&quot;</span></span><span class="annot"><span class="annottext">String -&gt; String -&gt; Parameter
</span><a href="OAlg.Data.Statement.Definition.html#%3A%3D"><span class="hs-operator hs-var">:=</span></a></span><span class="annot"><span class="annottext">s x -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">s x
</span><a href="#local-6989586621679388655"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;p&quot;</span></span><span class="annot"><span class="annottext">String -&gt; String -&gt; Parameter
</span><a href="OAlg.Data.Statement.Definition.html#%3A%3D"><span class="hs-operator hs-var">:=</span></a></span><span class="annot"><span class="annottext">Permutation i -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Permutation i
</span><a href="#local-6989586621679388656"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-525"></span><span>  </span><span id="local-6989586621679388657"><span class="annot"><span class="annottext">is :: Set i
</span><a href="#local-6989586621679388657"><span class="hs-identifier hs-var hs-var">is</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(i -&gt; i) -&gt; Set i -&gt; Set i
forall y x. Ord y =&gt; (x -&gt; y) -&gt; Set x -&gt; Set y
</span><a href="OAlg.Entity.Sequence.Set.html#setMap"><span class="hs-identifier hs-var">setMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Permutation i -&gt; i -&gt; i
forall i. Ord i =&gt; Permutation i -&gt; i -&gt; i
</span><a href="OAlg.Entity.Sequence.Permutation.html#pmt"><span class="hs-identifier hs-var">pmt</span></a></span><span> </span><span class="annot"><span class="annottext">Permutation i
</span><a href="#local-6989586621679388659"><span class="hs-identifier hs-var">p'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Set i -&gt; Set i) -&gt; Set i -&gt; Set i
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><a href="OAlg.Category.Applicative.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">p i -&gt; s x -&gt; Set i
forall (s :: * -&gt; *) i x (p :: * -&gt; *).
Sequence s i x =&gt;
p i -&gt; s x -&gt; Set i
</span><a href="OAlg.Entity.Sequence.Definition.html#support"><span class="hs-identifier hs-var">support</span></a></span><span> </span><span class="annot"><span class="annottext">p i
</span><a href="#local-6989586621679388654"><span class="hs-identifier hs-var">pi</span></a></span><span> </span><span class="annot"><span class="annottext">s x
</span><a href="#local-6989586621679388655"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-526"></span><span>  </span><span id="local-6989586621679388659"><span class="annot"><span class="annottext">p' :: Permutation i
</span><a href="#local-6989586621679388659"><span class="hs-identifier hs-var hs-var">p'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Permutation i -&gt; Permutation i
forall c. Invertible c =&gt; c -&gt; c
</span><a href="OAlg.Structure.Multiplicative.Definition.html#invert"><span class="hs-identifier hs-var">invert</span></a></span><span> </span><span class="annot"><span class="annottext">Permutation i
</span><a href="#local-6989586621679388656"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-527"></span><span>
</span><span id="line-528"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-529"></span><span class="hs-comment">-- relOprPermutationLst -</span><span>
</span><span id="line-530"></span><span>
</span><span id="line-531"></span><span id="local-6989586621679387705"><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#relOprPermutationLst"><span class="hs-identifier hs-type">relOprPermutationLst</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.Entity.Definition.html#Entity"><span class="hs-identifier hs-type">Entity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387705"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.X.html#X"><span class="hs-identifier hs-type">X</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679387705"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.X.html#X"><span class="hs-identifier hs-type">X</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#Permutation"><span class="hs-identifier hs-type">Permutation</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.Statement.Definition.html#Statement"><span class="hs-identifier hs-type">Statement</span></a></span></span><span>
</span><span id="line-532"></span><span id="relOprPermutationLst"><span class="annot"><span class="annottext">relOprPermutationLst :: forall x. Entity x =&gt; X [x] -&gt; X (Permutation N) -&gt; Statement
</span><a href="OAlg.Entity.Sequence.Permutation.html#relOprPermutationLst"><span class="hs-identifier hs-var hs-var">relOprPermutationLst</span></a></span></span><span> </span><span id="local-6989586621679388667"><span class="annot"><span class="annottext">X [x]
</span><a href="#local-6989586621679388667"><span class="hs-identifier hs-var">xxs</span></a></span></span><span> </span><span id="local-6989586621679388668"><span class="annot"><span class="annottext">X (Permutation N)
</span><a href="#local-6989586621679388668"><span class="hs-identifier hs-var">xp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Label
</span><a href="OAlg.Data.Statement.Definition.html#Label"><span class="hs-identifier hs-var">Label</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;[]&quot;</span></span><span>
</span><span id="line-533"></span><span>  </span><span class="annot"><span class="annottext">Label -&gt; Statement -&gt; Statement
</span><a href="OAlg.Data.Statement.Definition.html#%3A%3C%3D%3E%3A"><span class="hs-operator hs-var">:&lt;=&gt;:</span></a></span><span> </span><span class="annot"><span class="annottext">X ([x], Permutation N)
-&gt; (([x], Permutation N) -&gt; Statement) -&gt; Statement
forall x. X x -&gt; (x -&gt; Statement) -&gt; Statement
</span><a href="OAlg.Data.Statement.Definition.html#Forall"><span class="hs-identifier hs-var">Forall</span></a></span><span>  </span><span class="annot"><span class="annottext">X ([x], Permutation N)
</span><a href="#local-6989586621679388670"><span class="hs-identifier hs-var">xxsp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([x] -&gt; Permutation N -&gt; Statement)
-&gt; ([x], Permutation N) -&gt; Statement
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><a href="OAlg.Category.Definition.html#uncurry"><span class="hs-identifier hs-var">uncurry</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy N -&gt; [x] -&gt; Permutation N -&gt; Statement
forall i (s :: * -&gt; *) x (p :: * -&gt; *).
(TotalOpr (Permutation i) (s x), ConstructableSequence s i x) =&gt;
p i -&gt; s x -&gt; Permutation i -&gt; Statement
</span><a href="OAlg.Entity.Sequence.Permutation.html#relOprPermutation"><span class="hs-identifier hs-var">relOprPermutation</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy N
</span><a href="OAlg.Entity.Product.ProductSymbol.html#nProxy"><span class="hs-identifier hs-var">nProxy</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-534"></span><span>  </span><span id="local-6989586621679388670"><span class="annot"><span class="annottext">xxsp :: X ([x], Permutation N)
</span><a href="#local-6989586621679388670"><span class="hs-identifier hs-var hs-var">xxsp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">X [x] -&gt; X (Permutation N) -&gt; X ([x], Permutation N)
forall a b. X a -&gt; X b -&gt; X (a, b)
</span><a href="OAlg.Data.X.html#xTupple2"><span class="hs-identifier hs-var">xTupple2</span></a></span><span> </span><span class="annot"><span class="annottext">X [x]
</span><a href="#local-6989586621679388667"><span class="hs-identifier hs-var">xxs</span></a></span><span> </span><span class="annot"><span class="annottext">X (Permutation N)
</span><a href="#local-6989586621679388668"><span class="hs-identifier hs-var">xp</span></a></span><span>
</span><span id="line-535"></span><span>
</span><span id="line-536"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-537"></span><span class="hs-comment">-- relOprPermutationPsq -</span><span>
</span><span id="line-538"></span><span>
</span><span id="line-539"></span><span class="hs-comment">-- | validity of the right operation of permutations on partial sequences according</span><span>
</span><span id="line-540"></span><span class="hs-comment">--   to its definition.</span><span>
</span><span id="line-541"></span><span id="local-6989586621679387714"><span id="local-6989586621679387715"><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#relOprPermutationPsq"><span class="hs-identifier hs-type">relOprPermutationPsq</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Definition.html#Entity"><span class="hs-identifier hs-type">Entity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387714"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Definition.html#Entity"><span class="hs-identifier hs-type">Entity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387715"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679387715"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-542"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.X.html#X"><span class="hs-identifier hs-type">X</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sequence.PSequence.html#PSequence"><span class="hs-identifier hs-type">PSequence</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387715"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387714"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.X.html#X"><span class="hs-identifier hs-type">X</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#Permutation"><span class="hs-identifier hs-type">Permutation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387715"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.Statement.Definition.html#Statement"><span class="hs-identifier hs-type">Statement</span></a></span></span></span><span>
</span><span id="line-543"></span><span id="relOprPermutationPsq"><span class="annot"><span class="annottext">relOprPermutationPsq :: forall x i.
(Entity x, Entity i, Ord i) =&gt;
X (PSequence i x) -&gt; X (Permutation i) -&gt; Statement
</span><a href="OAlg.Entity.Sequence.Permutation.html#relOprPermutationPsq"><span class="hs-identifier hs-var hs-var">relOprPermutationPsq</span></a></span></span><span> </span><span id="local-6989586621679388680"><span class="annot"><span class="annottext">X (PSequence i x)
</span><a href="#local-6989586621679388680"><span class="hs-identifier hs-var">xxs</span></a></span></span><span> </span><span id="local-6989586621679388681"><span class="annot"><span class="annottext">X (Permutation i)
</span><a href="#local-6989586621679388681"><span class="hs-identifier hs-var">xp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Label
</span><a href="OAlg.Data.Statement.Definition.html#Label"><span class="hs-identifier hs-var">Label</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;PSequence&quot;</span></span><span>
</span><span id="line-544"></span><span>  </span><span class="annot"><span class="annottext">Label -&gt; Statement -&gt; Statement
</span><a href="OAlg.Data.Statement.Definition.html#%3A%3C%3D%3E%3A"><span class="hs-operator hs-var">:&lt;=&gt;:</span></a></span><span> </span><span class="annot"><span class="annottext">X (PSequence i x, Permutation i)
-&gt; ((PSequence i x, Permutation i) -&gt; Statement) -&gt; Statement
forall x. X x -&gt; (x -&gt; Statement) -&gt; Statement
</span><a href="OAlg.Data.Statement.Definition.html#Forall"><span class="hs-identifier hs-var">Forall</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">X (PSequence i x)
-&gt; X (Permutation i) -&gt; X (PSequence i x, Permutation i)
forall a b. X a -&gt; X b -&gt; X (a, b)
</span><a href="OAlg.Data.X.html#xTupple2"><span class="hs-identifier hs-var">xTupple2</span></a></span><span> </span><span class="annot"><span class="annottext">X (PSequence i x)
</span><a href="#local-6989586621679388680"><span class="hs-identifier hs-var">xxs</span></a></span><span> </span><span class="annot"><span class="annottext">X (Permutation i)
</span><a href="#local-6989586621679388681"><span class="hs-identifier hs-var">xp</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(PSequence i x -&gt; Permutation i -&gt; Statement)
-&gt; (PSequence i x, Permutation i) -&gt; Statement
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><a href="OAlg.Category.Definition.html#uncurry"><span class="hs-identifier hs-var">uncurry</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy i -&gt; PSequence i x -&gt; Permutation i -&gt; Statement
forall i (s :: * -&gt; *) x (p :: * -&gt; *).
(TotalOpr (Permutation i) (s x), ConstructableSequence s i x) =&gt;
p i -&gt; s x -&gt; Permutation i -&gt; Statement
</span><a href="OAlg.Entity.Sequence.Permutation.html#relOprPermutation"><span class="hs-identifier hs-var">relOprPermutation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">X (PSequence i x) -&gt; Proxy i
forall i x. X (PSequence i x) -&gt; Proxy i
</span><a href="#local-6989586621679388682"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">X (PSequence i x)
</span><a href="#local-6989586621679388680"><span class="hs-identifier hs-var">xxs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-545"></span><span>  </span><span id="local-6989586621679387720"><span id="local-6989586621679387721"><span class="annot"><a href="#local-6989586621679388682"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.Data.X.html#X"><span class="hs-identifier hs-type">X</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sequence.PSequence.html#PSequence"><span class="hs-identifier hs-type">PSequence</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387720"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387721"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="#local-6989586621679387720"><span class="hs-identifier hs-type">i</span></a></span></span></span><span>
</span><span id="line-546"></span><span>  </span><span id="local-6989586621679388682"><span class="annot"><span class="annottext">p :: forall i x. X (PSequence i x) -&gt; Proxy i
</span><a href="#local-6989586621679388682"><span class="hs-identifier hs-var hs-var">p</span></a></span></span><span> </span><span class="annot"><span class="annottext">X (PSequence i x)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy i
forall {k} (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span>
</span><span id="line-547"></span><span>    </span><span>
</span><span id="line-548"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-549"></span><span class="hs-comment">-- relOprPermutationPsy -</span><span>
</span><span id="line-550"></span><span>
</span><span id="line-551"></span><span id="local-6989586621679387726"><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#relOprPermutationPsy"><span class="hs-identifier hs-type">relOprPermutationPsy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.Entity.Definition.html#Entity"><span class="hs-identifier hs-type">Entity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387726"><span class="hs-identifier hs-type">x</span></a></span><span>
</span><span id="line-552"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.X.html#X"><span class="hs-identifier hs-type">X</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sequence.CSequence.html#CSequence"><span class="hs-identifier hs-type">CSequence</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387726"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.X.html#X"><span class="hs-identifier hs-type">X</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#Permutation"><span class="hs-identifier hs-type">Permutation</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.Statement.Definition.html#Statement"><span class="hs-identifier hs-type">Statement</span></a></span></span><span>
</span><span id="line-553"></span><span id="relOprPermutationPsy"><span class="annot"><span class="annottext">relOprPermutationPsy :: forall x.
Entity x =&gt;
X (CSequence x) -&gt; X (Permutation N) -&gt; Statement
</span><a href="OAlg.Entity.Sequence.Permutation.html#relOprPermutationPsy"><span class="hs-identifier hs-var hs-var">relOprPermutationPsy</span></a></span></span><span> </span><span id="local-6989586621679388689"><span class="annot"><span class="annottext">X (ProductSymbol x)
</span><a href="#local-6989586621679388689"><span class="hs-identifier hs-var">xxs</span></a></span></span><span> </span><span id="local-6989586621679388690"><span class="annot"><span class="annottext">X (Permutation N)
</span><a href="#local-6989586621679388690"><span class="hs-identifier hs-var">xp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Label
</span><a href="OAlg.Data.Statement.Definition.html#Label"><span class="hs-identifier hs-var">Label</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;CSequence&quot;</span></span><span>
</span><span id="line-554"></span><span>  </span><span class="annot"><span class="annottext">Label -&gt; Statement -&gt; Statement
</span><a href="OAlg.Data.Statement.Definition.html#%3A%3C%3D%3E%3A"><span class="hs-operator hs-var">:&lt;=&gt;:</span></a></span><span> </span><span class="annot"><span class="annottext">X (ProductSymbol x, Permutation N)
-&gt; ((ProductSymbol x, Permutation N) -&gt; Statement) -&gt; Statement
forall x. X x -&gt; (x -&gt; Statement) -&gt; Statement
</span><a href="OAlg.Data.Statement.Definition.html#Forall"><span class="hs-identifier hs-var">Forall</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">X (ProductSymbol x)
-&gt; X (Permutation N) -&gt; X (ProductSymbol x, Permutation N)
forall a b. X a -&gt; X b -&gt; X (a, b)
</span><a href="OAlg.Data.X.html#xTupple2"><span class="hs-identifier hs-var">xTupple2</span></a></span><span> </span><span class="annot"><span class="annottext">X (ProductSymbol x)
</span><a href="#local-6989586621679388689"><span class="hs-identifier hs-var">xxs</span></a></span><span> </span><span class="annot"><span class="annottext">X (Permutation N)
</span><a href="#local-6989586621679388690"><span class="hs-identifier hs-var">xp</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ProductSymbol x -&gt; Permutation N -&gt; Statement)
-&gt; (ProductSymbol x, Permutation N) -&gt; Statement
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><a href="OAlg.Category.Definition.html#uncurry"><span class="hs-identifier hs-var">uncurry</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy N -&gt; ProductSymbol x -&gt; Permutation N -&gt; Statement
forall i (s :: * -&gt; *) x (p :: * -&gt; *).
(TotalOpr (Permutation i) (s x), ConstructableSequence s i x) =&gt;
p i -&gt; s x -&gt; Permutation i -&gt; Statement
</span><a href="OAlg.Entity.Sequence.Permutation.html#relOprPermutation"><span class="hs-identifier hs-var">relOprPermutation</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy N
</span><a href="OAlg.Entity.Product.ProductSymbol.html#nProxy"><span class="hs-identifier hs-var">nProxy</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-555"></span><span>
</span><span id="line-556"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-557"></span><span class="hs-comment">-- prpOprPermutaiton -</span><span>
</span><span id="line-558"></span><span>
</span><span id="line-559"></span><span class="annot"><span class="hs-comment">-- | validity of the total right operation '&lt;*' of permutations on sequences.</span></span><span>
</span><span id="line-560"></span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#prpOprPermutation"><span class="hs-identifier hs-type">prpOprPermutation</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.Data.Statement.Definition.html#Statement"><span class="hs-identifier hs-type">Statement</span></a></span><span>
</span><span id="line-561"></span><span id="prpOprPermutation"><span class="annot"><span class="annottext">prpOprPermutation :: Statement
</span><a href="OAlg.Entity.Sequence.Permutation.html#prpOprPermutation"><span class="hs-identifier hs-var hs-var">prpOprPermutation</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Label
</span><a href="OAlg.Data.Statement.Definition.html#Prp"><span class="hs-identifier hs-var">Prp</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;OprPermutation&quot;</span></span><span>
</span><span id="line-562"></span><span>  </span><span class="annot"><span class="annottext">Label -&gt; Statement -&gt; Statement
</span><a href="OAlg.Data.Statement.Definition.html#%3A%3C%3D%3E%3A"><span class="hs-operator hs-var">:&lt;=&gt;:</span></a></span><span> </span><span class="annot"><span class="annottext">[Statement] -&gt; Statement
</span><a href="OAlg.Data.Statement.Definition.html#And"><span class="hs-identifier hs-var">And</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Statement
</span><a href="#local-6989586621679388692"><span class="hs-identifier hs-var">prpLst</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Statement
</span><a href="#local-6989586621679388693"><span class="hs-identifier hs-var">prpPsy</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Statement
</span><a href="#local-6989586621679388694"><span class="hs-identifier hs-var">prpPsq</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-563"></span><span>  </span><span id="local-6989586621679388698"><span class="annot"><span class="annottext">xp :: N -&gt; N -&gt; X (Permutation N)
</span><a href="#local-6989586621679388698"><span class="hs-identifier hs-var hs-var">xp</span></a></span></span><span> </span><span id="local-6989586621679388699"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679388699"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679388700"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679388700"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">N -&gt; X N -&gt; X (Permutation N)
forall i. (Entity i, Ord i) =&gt; N -&gt; X i -&gt; X (Permutation i)
</span><a href="OAlg.Entity.Sequence.Permutation.html#xPermutation"><span class="hs-identifier hs-var">xPermutation</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679388699"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">N -&gt; N -&gt; X N
</span><a href="OAlg.Data.X.html#xNB"><span class="hs-identifier hs-var">xNB</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679388700"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-564"></span><span>
</span><span id="line-565"></span><span>  </span><span id="local-6989586621679388692"><span class="annot"><span class="annottext">prpLst :: Statement
</span><a href="#local-6989586621679388692"><span class="hs-identifier hs-var hs-var">prpLst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">X [Symbol] -&gt; X (Permutation N) -&gt; Statement
forall x. Entity x =&gt; X [x] -&gt; X (Permutation N) -&gt; Statement
</span><a href="OAlg.Entity.Sequence.Permutation.html#relOprPermutationLst"><span class="hs-identifier hs-var">relOprPermutationLst</span></a></span><span> </span><span class="annot"><span class="annottext">X [Symbol]
</span><a href="#local-6989586621679388704"><span class="hs-identifier hs-var">xxs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">N -&gt; N -&gt; X (Permutation N)
</span><a href="#local-6989586621679388698"><span class="hs-identifier hs-var">xp</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">40</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">100</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-566"></span><span>    </span><span id="local-6989586621679388704"><span class="annot"><span class="annottext">xxs :: X [Symbol]
</span><a href="#local-6989586621679388704"><span class="hs-identifier hs-var hs-var">xxs</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; X N
</span><a href="OAlg.Data.X.html#xNB"><span class="hs-identifier hs-var">xNB</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">20</span></span><span> </span><span class="annot"><span class="annottext">X N -&gt; (N -&gt; X [Symbol]) -&gt; X [Symbol]
forall a b. X a -&gt; (a -&gt; X b) -&gt; X b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679388710"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679388710"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">N -&gt; X Symbol -&gt; X [Symbol]
forall x. N -&gt; X x -&gt; X [x]
</span><a href="OAlg.Data.X.html#xTakeN"><span class="hs-identifier hs-var">xTakeN</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679388710"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">X Symbol
forall x. XStandard x =&gt; X x
</span><a href="OAlg.Data.Validable.html#xStandard"><span class="hs-identifier hs-var">xStandard</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.Data.X.html#X"><span class="hs-identifier hs-type">X</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Symbol.html#Symbol"><span class="hs-identifier hs-type">Symbol</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-567"></span><span>
</span><span id="line-568"></span><span>  </span><span id="local-6989586621679388693"><span class="annot"><span class="annottext">prpPsy :: Statement
</span><a href="#local-6989586621679388693"><span class="hs-identifier hs-var hs-var">prpPsy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">X (CSequence Symbol) -&gt; X (Permutation N) -&gt; Statement
forall x.
Entity x =&gt;
X (CSequence x) -&gt; X (Permutation N) -&gt; Statement
</span><a href="OAlg.Entity.Sequence.Permutation.html#relOprPermutationPsy"><span class="hs-identifier hs-var">relOprPermutationPsy</span></a></span><span> </span><span class="annot"><span class="annottext">X (CSequence Symbol)
</span><a href="#local-6989586621679388716"><span class="hs-identifier hs-var">xxs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">N -&gt; N -&gt; X (Permutation N)
</span><a href="#local-6989586621679388698"><span class="hs-identifier hs-var">xp</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">40</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">100</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-569"></span><span>    </span><span id="local-6989586621679388716"><span class="annot"><span class="annottext">xxs :: X (CSequence Symbol)
</span><a href="#local-6989586621679388716"><span class="hs-identifier hs-var hs-var">xxs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">N -&gt; X Symbol -&gt; X (CSequence Symbol)
forall x. Entity x =&gt; N -&gt; X x -&gt; X (CSequence x)
</span><a href="OAlg.Entity.Sequence.CSequence.html#xCSequence"><span class="hs-identifier hs-var">xCSequence</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">20</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">X Symbol
forall x. XStandard x =&gt; X x
</span><a href="OAlg.Data.Validable.html#xStandard"><span class="hs-identifier hs-var">xStandard</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.Data.X.html#X"><span class="hs-identifier hs-type">X</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Symbol.html#Symbol"><span class="hs-identifier hs-type">Symbol</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-570"></span><span>    </span><span>
</span><span id="line-571"></span><span>  </span><span id="local-6989586621679388694"><span class="annot"><span class="annottext">prpPsq :: Statement
</span><a href="#local-6989586621679388694"><span class="hs-identifier hs-var hs-var">prpPsq</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">X (PSequence N Symbol) -&gt; X (Permutation N) -&gt; Statement
forall x i.
(Entity x, Entity i, Ord i) =&gt;
X (PSequence i x) -&gt; X (Permutation i) -&gt; Statement
</span><a href="OAlg.Entity.Sequence.Permutation.html#relOprPermutationPsq"><span class="hs-identifier hs-var">relOprPermutationPsq</span></a></span><span> </span><span class="annot"><span class="annottext">X (PSequence N Symbol)
</span><a href="#local-6989586621679388726"><span class="hs-identifier hs-var">xxs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">N -&gt; N -&gt; X (Permutation N)
</span><a href="#local-6989586621679388698"><span class="hs-identifier hs-var">xp</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">40</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">300</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-572"></span><span>    </span><span id="local-6989586621679388726"><span class="annot"><span class="annottext">xxs :: X (PSequence N Symbol)
</span><a href="#local-6989586621679388726"><span class="hs-identifier hs-var hs-var">xxs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; X Symbol -&gt; X N -&gt; X (PSequence N Symbol)
forall i x. Ord i =&gt; N -&gt; N -&gt; X x -&gt; X i -&gt; X (PSequence i x)
</span><a href="OAlg.Entity.Sequence.PSequence.html#xPSequence"><span class="hs-identifier hs-var">xPSequence</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">20</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">40</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">X Symbol
forall x. XStandard x =&gt; X x
</span><a href="OAlg.Data.Validable.html#xStandard"><span class="hs-identifier hs-var">xStandard</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.Data.X.html#X"><span class="hs-identifier hs-type">X</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Symbol.html#Symbol"><span class="hs-identifier hs-type">Symbol</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">N -&gt; N -&gt; X N
</span><a href="OAlg.Data.X.html#xNB"><span class="hs-identifier hs-var">xNB</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">200</span></span><span class="hs-special">)</span><span>
</span><span id="line-573"></span><span>
</span><span id="line-574"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-575"></span><span class="hs-comment">-- relPmtSqc1 -</span><span>
</span><span id="line-576"></span><span>
</span><span id="line-577"></span><span id="local-6989586621679387735"><span id="local-6989586621679387736"><span id="local-6989586621679387737"><span id="local-6989586621679387738"><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#relPmtSqc1"><span class="hs-identifier hs-type">relPmtSqc1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#PermutableSequence"><span class="hs-identifier hs-type">PermutableSequence</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387735"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387736"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387737"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Definition.html#Entity"><span class="hs-identifier hs-type">Entity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387737"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Definition.html#Entity"><span class="hs-identifier hs-type">Entity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387736"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-578"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679387738"><span class="hs-identifier hs-type">z</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387736"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679387735"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387737"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.Statement.Definition.html#Statement"><span class="hs-identifier hs-type">Statement</span></a></span></span></span></span></span><span>
</span><span id="line-579"></span><span id="relPmtSqc1"><span class="annot"><span class="annottext">relPmtSqc1 :: forall (s :: * -&gt; *) i x (z :: * -&gt; *).
(PermutableSequence s i x, Entity x, Entity i) =&gt;
N -&gt; z i -&gt; s x -&gt; Statement
</span><a href="OAlg.Entity.Sequence.Permutation.html#relPmtSqc1"><span class="hs-identifier hs-var hs-var">relPmtSqc1</span></a></span></span><span> </span><span id="local-6989586621679388763"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679388763"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679388764"><span class="annot"><span class="annottext">z i
</span><a href="#local-6989586621679388764"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span id="local-6989586621679388765"><span class="annot"><span class="annottext">s x
</span><a href="#local-6989586621679388765"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[i]
</span><a href="#local-6989586621679388766"><span class="hs-identifier hs-var">is</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-580"></span><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Statement
</span><a href="OAlg.Data.Statement.Definition.html#SValid"><span class="hs-identifier hs-var">SValid</span></a></span><span> </span><span class="hs-comment">-- with out this match, there will be denied permisses</span><span>
</span><span id="line-581"></span><span>  </span><span class="annot"><span class="annottext">[i]
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">X (Permutation i, i)
-&gt; ((Permutation i, i) -&gt; Statement) -&gt; Statement
forall x. X x -&gt; (x -&gt; Statement) -&gt; Statement
</span><a href="OAlg.Data.Statement.Definition.html#Forall"><span class="hs-identifier hs-var">Forall</span></a></span><span> </span><span class="annot"><span class="annottext">X (Permutation i, i)
</span><a href="#local-6989586621679388768"><span class="hs-identifier hs-var">xpi</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679388769"><span class="annot"><span class="annottext">Permutation i
</span><a href="#local-6989586621679388769"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679388770"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679388770"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-582"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">s x
</span><a href="#local-6989586621679388765"><span class="hs-identifier hs-var">xs</span></a></span><span class="annot"><span class="annottext">s x -&gt; Permutation i -&gt; s x
forall f x. Opr f x =&gt; x -&gt; f -&gt; x
</span><a href="OAlg.Structure.Operational.html#%3C%2A"><span class="hs-operator hs-var">&lt;*</span></a></span><span class="annot"><span class="annottext">Permutation i
</span><a href="#local-6989586621679388769"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">s x -&gt; i -&gt; Maybe x
forall (s :: * -&gt; *) i x. Sequence s i x =&gt; s x -&gt; i -&gt; Maybe x
</span><a href="OAlg.Entity.Sequence.Definition.html#%3F%3F"><span class="hs-operator hs-var">??</span></a></span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679388770"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe x -&gt; Maybe x -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">s x
</span><a href="#local-6989586621679388765"><span class="hs-identifier hs-var">xs</span></a></span><span class="annot"><span class="annottext">s x -&gt; i -&gt; Maybe x
forall (s :: * -&gt; *) i x. Sequence s i x =&gt; s x -&gt; i -&gt; Maybe x
</span><a href="OAlg.Entity.Sequence.Definition.html#%3F%3F"><span class="hs-operator hs-var">??</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(i -&gt; Maybe x) -&gt; (i -&gt; i) -&gt; i -&gt; Maybe x
forall y z x. (y -&gt; z) -&gt; (x -&gt; y) -&gt; x -&gt; z
forall (c :: * -&gt; * -&gt; *) y z x.
Category c =&gt;
c y z -&gt; c x y -&gt; c x z
</span><a href="OAlg.Category.Definition.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Permutation i -&gt; i -&gt; i
forall i. Ord i =&gt; Permutation i -&gt; i -&gt; i
</span><a href="OAlg.Entity.Sequence.Permutation.html#pmt"><span class="hs-identifier hs-var">pmt</span></a></span><span> </span><span class="annot"><span class="annottext">Permutation i
</span><a href="#local-6989586621679388769"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679388770"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-583"></span><span>                         </span><span class="annot"><span class="annottext">Bool -&gt; Message -&gt; Statement
</span><a href="OAlg.Data.Statement.Definition.html#%3A%3F%3E"><span class="hs-operator hs-var">:?&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[Parameter] -&gt; Message
</span><a href="OAlg.Data.Statement.Definition.html#Params"><span class="hs-identifier hs-var">Params</span></a></span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;xs&quot;</span></span><span class="annot"><span class="annottext">String -&gt; String -&gt; Parameter
</span><a href="OAlg.Data.Statement.Definition.html#%3A%3D"><span class="hs-operator hs-var">:=</span></a></span><span class="annot"><span class="annottext">s x -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">s x
</span><a href="#local-6989586621679388765"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;p&quot;</span></span><span class="annot"><span class="annottext">String -&gt; String -&gt; Parameter
</span><a href="OAlg.Data.Statement.Definition.html#%3A%3D"><span class="hs-operator hs-var">:=</span></a></span><span class="annot"><span class="annottext">Permutation i -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Permutation i
</span><a href="#local-6989586621679388769"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;i&quot;</span></span><span class="annot"><span class="annottext">String -&gt; String -&gt; Parameter
</span><a href="OAlg.Data.Statement.Definition.html#%3A%3D"><span class="hs-operator hs-var">:=</span></a></span><span class="annot"><span class="annottext">i -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679388770"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-584"></span><span>                   </span><span class="hs-special">)</span><span>
</span><span id="line-585"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-586"></span><span>    </span><span class="annot"><a href="OAlg.Entity.Sequence.Set.html#Set"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span id="local-6989586621679388766"><span class="annot"><span class="annottext">[i]
</span><a href="#local-6989586621679388766"><span class="hs-identifier hs-var">is</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">z i -&gt; s x -&gt; Set i
forall (s :: * -&gt; *) i x (p :: * -&gt; *).
Sequence s i x =&gt;
p i -&gt; s x -&gt; Set i
</span><a href="OAlg.Entity.Sequence.Definition.html#support"><span class="hs-identifier hs-var">support</span></a></span><span> </span><span class="annot"><span class="annottext">z i
</span><a href="#local-6989586621679388764"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">s x
</span><a href="#local-6989586621679388765"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-587"></span><span>    </span><span id="local-6989586621679388772"><span class="annot"><span class="annottext">xi :: X i
</span><a href="#local-6989586621679388772"><span class="hs-identifier hs-var hs-var">xi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[i] -&gt; X i
forall a. [a] -&gt; X a
</span><a href="OAlg.Data.X.html#xOneOf"><span class="hs-identifier hs-var">xOneOf</span></a></span><span> </span><span class="annot"><span class="annottext">[i]
</span><a href="#local-6989586621679388766"><span class="hs-identifier hs-var">is</span></a></span><span>
</span><span id="line-588"></span><span>    </span><span id="local-6989586621679388774"><span class="annot"><span class="annottext">xp :: X (Permutation i)
</span><a href="#local-6989586621679388774"><span class="hs-identifier hs-var hs-var">xp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">N -&gt; X i -&gt; X (Permutation i)
forall i. (Entity i, Ord i) =&gt; N -&gt; X i -&gt; X (Permutation i)
</span><a href="OAlg.Entity.Sequence.Permutation.html#xPermutation"><span class="hs-identifier hs-var">xPermutation</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679388763"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">X i
</span><a href="#local-6989586621679388772"><span class="hs-identifier hs-var">xi</span></a></span><span>
</span><span id="line-589"></span><span>    </span><span id="local-6989586621679388768"><span class="annot"><span class="annottext">xpi :: X (Permutation i, i)
</span><a href="#local-6989586621679388768"><span class="hs-identifier hs-var hs-var">xpi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">X (Permutation i) -&gt; X i -&gt; X (Permutation i, i)
forall a b. X a -&gt; X b -&gt; X (a, b)
</span><a href="OAlg.Data.X.html#xTupple2"><span class="hs-identifier hs-var">xTupple2</span></a></span><span> </span><span class="annot"><span class="annottext">X (Permutation i)
</span><a href="#local-6989586621679388774"><span class="hs-identifier hs-var">xp</span></a></span><span> </span><span class="annot"><span class="annottext">X i
</span><a href="#local-6989586621679388772"><span class="hs-identifier hs-var">xi</span></a></span><span> </span><span>
</span><span id="line-590"></span><span>
</span><span id="line-591"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-592"></span><span class="hs-comment">-- relPmtSqc2 -</span><span>
</span><span id="line-593"></span><span>
</span><span id="line-594"></span><span id="local-6989586621679387745"><span id="local-6989586621679387746"><span id="local-6989586621679387747"><span id="local-6989586621679387748"><span id="local-6989586621679387749"><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#relPmtSqc2"><span class="hs-identifier hs-type">relPmtSqc2</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#PermutableSequence"><span class="hs-identifier hs-type">PermutableSequence</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387745"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387746"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387747"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679387748"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-595"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679387749"><span class="hs-identifier hs-type">z</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387746"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679387748"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679387748"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ordering</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679387747"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679387748"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679387745"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387747"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.Statement.Definition.html#Statement"><span class="hs-identifier hs-type">Statement</span></a></span></span></span></span></span></span><span>
</span><span id="line-596"></span><span id="relPmtSqc2"><span class="annot"><span class="annottext">relPmtSqc2 :: forall (s :: * -&gt; *) i x w (z :: * -&gt; *).
(PermutableSequence s i x, Show w) =&gt;
z i -&gt; (w -&gt; w -&gt; Ordering) -&gt; (x -&gt; w) -&gt; s x -&gt; Statement
</span><a href="OAlg.Entity.Sequence.Permutation.html#relPmtSqc2"><span class="hs-identifier hs-var hs-var">relPmtSqc2</span></a></span></span><span> </span><span id="local-6989586621679388808"><span class="annot"><span class="annottext">z i
</span><a href="#local-6989586621679388808"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span id="local-6989586621679388809"><span class="annot"><span class="annottext">w -&gt; w -&gt; Ordering
</span><a href="#local-6989586621679388809"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679388810"><span class="annot"><span class="annottext">x -&gt; w
</span><a href="#local-6989586621679388810"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679388811"><span class="annot"><span class="annottext">s x
</span><a href="#local-6989586621679388811"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679388812"><span class="annot"><span class="annottext">s x
</span><a href="#local-6989586621679388812"><span class="hs-identifier hs-var">xs'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679388813"><span class="annot"><span class="annottext">Permutation i
</span><a href="#local-6989586621679388813"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">z i
-&gt; (w -&gt; w -&gt; Ordering) -&gt; (x -&gt; w) -&gt; s x -&gt; (s x, Permutation i)
forall (p :: * -&gt; *) w.
p i
-&gt; (w -&gt; w -&gt; Ordering) -&gt; (x -&gt; w) -&gt; s x -&gt; (s x, Permutation i)
forall (s :: * -&gt; *) i x (p :: * -&gt; *) w.
PermutableSequence s i x =&gt;
p i
-&gt; (w -&gt; w -&gt; Ordering) -&gt; (x -&gt; w) -&gt; s x -&gt; (s x, Permutation i)
</span><a href="OAlg.Entity.Sequence.Permutation.html#permuteBy"><span class="hs-identifier hs-var">permuteBy</span></a></span><span> </span><span class="annot"><span class="annottext">z i
</span><a href="#local-6989586621679388808"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">w -&gt; w -&gt; Ordering
</span><a href="#local-6989586621679388809"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">x -&gt; w
</span><a href="#local-6989586621679388810"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">s x
</span><a href="#local-6989586621679388811"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-597"></span><span>  </span><span class="annot"><span class="annottext">[Statement] -&gt; Statement
</span><a href="OAlg.Data.Statement.Definition.html#And"><span class="hs-identifier hs-var">And</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String -&gt; Label
</span><a href="OAlg.Data.Statement.Definition.html#Label"><span class="hs-identifier hs-var">Label</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;1&quot;</span></span><span> </span><span class="annot"><span class="annottext">Label -&gt; Statement -&gt; Statement
</span><a href="OAlg.Data.Statement.Definition.html#%3A%3C%3D%3E%3A"><span class="hs-operator hs-var">:&lt;=&gt;:</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">s x
</span><a href="#local-6989586621679388812"><span class="hs-identifier hs-var">xs'</span></a></span><span> </span><span class="annot"><span class="annottext">s x -&gt; s x -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">s x
</span><a href="#local-6989586621679388811"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">s x -&gt; Permutation i -&gt; s x
forall f x. Opr f x =&gt; x -&gt; f -&gt; x
</span><a href="OAlg.Structure.Operational.html#%3C%2A"><span class="hs-operator hs-var">&lt;*</span></a></span><span> </span><span class="annot"><span class="annottext">Permutation i
</span><a href="#local-6989586621679388813"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Message -&gt; Statement
</span><a href="OAlg.Data.Statement.Definition.html#%3A%3F%3E"><span class="hs-operator hs-var">:?&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[Parameter] -&gt; Message
</span><a href="OAlg.Data.Statement.Definition.html#Params"><span class="hs-identifier hs-var">Params</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;xs&quot;</span></span><span class="annot"><span class="annottext">String -&gt; String -&gt; Parameter
</span><a href="OAlg.Data.Statement.Definition.html#%3A%3D"><span class="hs-operator hs-var">:=</span></a></span><span class="annot"><span class="annottext">s x -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">s x
</span><a href="#local-6989586621679388811"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;p&quot;</span></span><span class="annot"><span class="annottext">String -&gt; String -&gt; Parameter
</span><a href="OAlg.Data.Statement.Definition.html#%3A%3D"><span class="hs-operator hs-var">:=</span></a></span><span class="annot"><span class="annottext">Permutation i -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Permutation i
</span><a href="#local-6989586621679388813"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-598"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Label
</span><a href="OAlg.Data.Statement.Definition.html#Label"><span class="hs-identifier hs-var">Label</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;2&quot;</span></span><span> </span><span class="annot"><span class="annottext">Label -&gt; Statement -&gt; Statement
</span><a href="OAlg.Data.Statement.Definition.html#%3A%3C%3D%3E%3A"><span class="hs-operator hs-var">:&lt;=&gt;:</span></a></span><span> </span><span class="annot"><span class="annottext">[x] -&gt; Statement
</span><a href="#local-6989586621679388814"><span class="hs-identifier hs-var">increasing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((x, i) -&gt; x) -&gt; [(x, i)] -&gt; [x]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(x, i) -&gt; x
forall a b. (a, b) -&gt; a
</span><a href="OAlg.Category.Definition.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">([(x, i)] -&gt; [x]) -&gt; [(x, i)] -&gt; [x]
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><a href="OAlg.Category.Applicative.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">z i -&gt; s x -&gt; [(x, i)]
forall (p :: * -&gt; *). p i -&gt; s x -&gt; [(x, i)]
forall (s :: * -&gt; *) i x (p :: * -&gt; *).
Sequence s i x =&gt;
p i -&gt; s x -&gt; [(x, i)]
</span><a href="OAlg.Entity.Sequence.Definition.html#list"><span class="hs-identifier hs-var">list</span></a></span><span> </span><span class="annot"><span class="annottext">z i
</span><a href="#local-6989586621679388808"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">s x
</span><a href="#local-6989586621679388812"><span class="hs-identifier hs-var">xs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-599"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Label
</span><a href="OAlg.Data.Statement.Definition.html#Label"><span class="hs-identifier hs-var">Label</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;3&quot;</span></span><span> </span><span class="annot"><span class="annottext">Label -&gt; Statement -&gt; Statement
</span><a href="OAlg.Data.Statement.Definition.html#%3A%3C%3D%3E%3A"><span class="hs-operator hs-var">:&lt;=&gt;:</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">z i -&gt; Permutation i -&gt; Set i
forall (s :: * -&gt; *) i x (p :: * -&gt; *).
(Sequence s i x, Ord x) =&gt;
p i -&gt; s x -&gt; Set x
</span><a href="OAlg.Entity.Sequence.Definition.html#image"><span class="hs-identifier hs-var">image</span></a></span><span> </span><span class="annot"><span class="annottext">z i
</span><a href="#local-6989586621679388808"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">Permutation i
</span><a href="#local-6989586621679388813"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Set i -&gt; Set i -&gt; Bool
forall a. POrd a =&gt; a -&gt; a -&gt; Bool
</span><a href="OAlg.Data.Ord.html#%3C%3C%3D"><span class="hs-operator hs-var">&lt;&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">z i -&gt; s x -&gt; Set i
forall (s :: * -&gt; *) i x (p :: * -&gt; *).
Sequence s i x =&gt;
p i -&gt; s x -&gt; Set i
</span><a href="OAlg.Entity.Sequence.Definition.html#support"><span class="hs-identifier hs-var">support</span></a></span><span> </span><span class="annot"><span class="annottext">z i
</span><a href="#local-6989586621679388808"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">s x
</span><a href="#local-6989586621679388811"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Message -&gt; Statement
</span><a href="OAlg.Data.Statement.Definition.html#%3A%3F%3E"><span class="hs-operator hs-var">:?&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[Parameter] -&gt; Message
</span><a href="OAlg.Data.Statement.Definition.html#Params"><span class="hs-identifier hs-var">Params</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;xs&quot;</span></span><span class="annot"><span class="annottext">String -&gt; String -&gt; Parameter
</span><a href="OAlg.Data.Statement.Definition.html#%3A%3D"><span class="hs-operator hs-var">:=</span></a></span><span class="annot"><span class="annottext">s x -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">s x
</span><a href="#local-6989586621679388811"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;p&quot;</span></span><span class="annot"><span class="annottext">String -&gt; String -&gt; Parameter
</span><a href="OAlg.Data.Statement.Definition.html#%3A%3D"><span class="hs-operator hs-var">:=</span></a></span><span class="annot"><span class="annottext">Permutation i -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Permutation i
</span><a href="#local-6989586621679388813"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-600"></span><span>      </span><span class="hs-special">]</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-601"></span><span>
</span><span id="line-602"></span><span>  </span><span id="local-6989586621679388815"><span class="annot"><span class="annottext">w
</span><a href="#local-6989586621679388815"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679388816"><span class="annot"><span class="annottext">&lt;= :: w -&gt; w -&gt; Bool
</span><a href="#local-6989586621679388816"><span class="hs-operator hs-var hs-var">&lt;=</span></a></span></span><span> </span><span id="local-6989586621679388817"><span class="annot"><span class="annottext">w
</span><a href="#local-6989586621679388817"><span class="hs-identifier hs-var">w'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">w -&gt; w -&gt; Ordering
</span><a href="#local-6989586621679388809"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">w
</span><a href="#local-6989586621679388815"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">w
</span><a href="#local-6989586621679388817"><span class="hs-identifier hs-var">w'</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-603"></span><span>    </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">GT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-604"></span><span>    </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-605"></span><span>    </span><span>
</span><span id="line-606"></span><span>  </span><span id="local-6989586621679388814"><span class="annot"><span class="annottext">increasing :: [x] -&gt; Statement
</span><a href="#local-6989586621679388814"><span class="hs-identifier hs-var hs-var">increasing</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Statement
</span><a href="OAlg.Data.Statement.Definition.html#SValid"><span class="hs-identifier hs-var">SValid</span></a></span><span>
</span><span id="line-607"></span><span>  </span><span class="annot"><a href="#local-6989586621679388814"><span class="hs-identifier hs-var">increasing</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679388818"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679388818"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679388819"><span class="annot"><span class="annottext">[x]
</span><a href="#local-6989586621679388819"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">N -&gt; w -&gt; [x] -&gt; Statement
</span><a href="#local-6989586621679388820"><span class="hs-identifier hs-var">inc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span class="hs-glyph">::</span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">x -&gt; w
</span><a href="#local-6989586621679388810"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679388818"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[x]
</span><a href="#local-6989586621679388819"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-608"></span><span>    </span><span id="local-6989586621679388820"><span class="annot"><span class="annottext">inc :: N -&gt; w -&gt; [x] -&gt; Statement
</span><a href="#local-6989586621679388820"><span class="hs-identifier hs-var hs-var">inc</span></a></span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">w
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Statement
</span><a href="OAlg.Data.Statement.Definition.html#SValid"><span class="hs-identifier hs-var">SValid</span></a></span><span>
</span><span id="line-609"></span><span>    </span><span class="annot"><a href="#local-6989586621679388820"><span class="hs-identifier hs-var">inc</span></a></span><span> </span><span id="local-6989586621679388821"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679388821"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679388822"><span class="annot"><span class="annottext">w
</span><a href="#local-6989586621679388822"><span class="hs-identifier hs-var">wx</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679388823"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679388823"><span class="hs-identifier hs-var">y</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679388824"><span class="annot"><span class="annottext">[x]
</span><a href="#local-6989586621679388824"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679388825"><span class="annot"><span class="annottext">wy :: w
</span><a href="#local-6989586621679388825"><span class="hs-identifier hs-var hs-var">wy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">x -&gt; w
</span><a href="#local-6989586621679388810"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679388823"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-610"></span><span>      </span><span class="annot"><span class="annottext">[Statement] -&gt; Statement
</span><a href="OAlg.Data.Statement.Definition.html#And"><span class="hs-identifier hs-var">And</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">w
</span><a href="#local-6989586621679388822"><span class="hs-identifier hs-var">wx</span></a></span><span> </span><span class="annot"><span class="annottext">w -&gt; w -&gt; Bool
</span><a href="#local-6989586621679388816"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">w
</span><a href="#local-6989586621679388825"><span class="hs-identifier hs-var">wy</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Message -&gt; Statement
</span><a href="OAlg.Data.Statement.Definition.html#%3A%3F%3E"><span class="hs-operator hs-var">:?&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[Parameter] -&gt; Message
</span><a href="OAlg.Data.Statement.Definition.html#Params"><span class="hs-identifier hs-var">Params</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;i&quot;</span></span><span class="annot"><span class="annottext">String -&gt; String -&gt; Parameter
</span><a href="OAlg.Data.Statement.Definition.html#%3A%3D"><span class="hs-operator hs-var">:=</span></a></span><span class="annot"><span class="annottext">N -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679388821"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;(wx,wy)&quot;</span></span><span class="annot"><span class="annottext">String -&gt; String -&gt; Parameter
</span><a href="OAlg.Data.Statement.Definition.html#%3A%3D"><span class="hs-operator hs-var">:=</span></a></span><span class="annot"><span class="annottext">(w, w) -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">w
</span><a href="#local-6989586621679388822"><span class="hs-identifier hs-var">wx</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">w
</span><a href="#local-6989586621679388825"><span class="hs-identifier hs-var">wy</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-611"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">N -&gt; w -&gt; [x] -&gt; Statement
</span><a href="#local-6989586621679388820"><span class="hs-identifier hs-var">inc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">N -&gt; N
forall a. Enum a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">succ</span></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679388821"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">w
</span><a href="#local-6989586621679388825"><span class="hs-identifier hs-var">wy</span></a></span><span> </span><span class="annot"><span class="annottext">[x]
</span><a href="#local-6989586621679388824"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-612"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-613"></span><span>  </span><span>
</span><span id="line-614"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-615"></span><span class="hs-comment">-- prpPermutableSequence -</span><span>
</span><span id="line-616"></span><span>
</span><span id="line-617"></span><span class="annot"><span class="hs-comment">-- | validity for 'PermutableSequence'.</span></span><span>
</span><span id="line-618"></span><span id="local-6989586621679387760"><span id="local-6989586621679387761"><span id="local-6989586621679387762"><span id="local-6989586621679387763"><span id="local-6989586621679387764"><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#prpPermutableSequence"><span class="hs-identifier hs-type">prpPermutableSequence</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#PermutableSequence"><span class="hs-identifier hs-type">PermutableSequence</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387760"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387761"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387762"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Definition.html#Entity"><span class="hs-identifier hs-type">Entity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387762"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Definition.html#Entity"><span class="hs-identifier hs-type">Entity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387761"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679387763"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-619"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679387764"><span class="hs-identifier hs-type">z</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387761"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679387763"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679387763"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ordering</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679387762"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679387763"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.X.html#X"><span class="hs-identifier hs-type">X</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679387760"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679387762"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.Statement.Definition.html#Statement"><span class="hs-identifier hs-type">Statement</span></a></span></span></span></span></span></span><span>
</span><span id="line-620"></span><span id="prpPermutableSequence"><span class="annot"><span class="annottext">prpPermutableSequence :: forall (s :: * -&gt; *) i x w (z :: * -&gt; *).
(PermutableSequence s i x, Entity x, Entity i, Show w) =&gt;
N
-&gt; z i -&gt; (w -&gt; w -&gt; Ordering) -&gt; (x -&gt; w) -&gt; X (s x) -&gt; Statement
</span><a href="OAlg.Entity.Sequence.Permutation.html#prpPermutableSequence"><span class="hs-identifier hs-var hs-var">prpPermutableSequence</span></a></span></span><span> </span><span id="local-6989586621679388835"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679388835"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679388836"><span class="annot"><span class="annottext">z i
</span><a href="#local-6989586621679388836"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span id="local-6989586621679388837"><span class="annot"><span class="annottext">w -&gt; w -&gt; Ordering
</span><a href="#local-6989586621679388837"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679388838"><span class="annot"><span class="annottext">x -&gt; w
</span><a href="#local-6989586621679388838"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679388839"><span class="annot"><span class="annottext">X (s x)
</span><a href="#local-6989586621679388839"><span class="hs-identifier hs-var">xxs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Label
</span><a href="OAlg.Data.Statement.Definition.html#Prp"><span class="hs-identifier hs-var">Prp</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;PermutableSequence&quot;</span></span><span> </span><span class="annot"><span class="annottext">Label -&gt; Statement -&gt; Statement
</span><a href="OAlg.Data.Statement.Definition.html#%3A%3C%3D%3E%3A"><span class="hs-operator hs-var">:&lt;=&gt;:</span></a></span><span>
</span><span id="line-621"></span><span>  </span><span class="annot"><span class="annottext">[Statement] -&gt; Statement
</span><a href="OAlg.Data.Statement.Definition.html#And"><span class="hs-identifier hs-var">And</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String -&gt; Label
</span><a href="OAlg.Data.Statement.Definition.html#Label"><span class="hs-identifier hs-var">Label</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;1&quot;</span></span><span> </span><span class="annot"><span class="annottext">Label -&gt; Statement -&gt; Statement
</span><a href="OAlg.Data.Statement.Definition.html#%3A%3C%3D%3E%3A"><span class="hs-operator hs-var">:&lt;=&gt;:</span></a></span><span> </span><span class="annot"><span class="annottext">X (s x) -&gt; (s x -&gt; Statement) -&gt; Statement
forall x. X x -&gt; (x -&gt; Statement) -&gt; Statement
</span><a href="OAlg.Data.Statement.Definition.html#Forall"><span class="hs-identifier hs-var">Forall</span></a></span><span> </span><span class="annot"><span class="annottext">X (s x)
</span><a href="#local-6989586621679388839"><span class="hs-identifier hs-var">xxs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">N -&gt; z i -&gt; s x -&gt; Statement
forall (s :: * -&gt; *) i x (z :: * -&gt; *).
(PermutableSequence s i x, Entity x, Entity i) =&gt;
N -&gt; z i -&gt; s x -&gt; Statement
</span><a href="OAlg.Entity.Sequence.Permutation.html#relPmtSqc1"><span class="hs-identifier hs-var">relPmtSqc1</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679388835"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">z i
</span><a href="#local-6989586621679388836"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-622"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Label
</span><a href="OAlg.Data.Statement.Definition.html#Label"><span class="hs-identifier hs-var">Label</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;2&quot;</span></span><span> </span><span class="annot"><span class="annottext">Label -&gt; Statement -&gt; Statement
</span><a href="OAlg.Data.Statement.Definition.html#%3A%3C%3D%3E%3A"><span class="hs-operator hs-var">:&lt;=&gt;:</span></a></span><span> </span><span class="annot"><span class="annottext">X (s x) -&gt; (s x -&gt; Statement) -&gt; Statement
forall x. X x -&gt; (x -&gt; Statement) -&gt; Statement
</span><a href="OAlg.Data.Statement.Definition.html#Forall"><span class="hs-identifier hs-var">Forall</span></a></span><span> </span><span class="annot"><span class="annottext">X (s x)
</span><a href="#local-6989586621679388839"><span class="hs-identifier hs-var">xxs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">z i -&gt; (w -&gt; w -&gt; Ordering) -&gt; (x -&gt; w) -&gt; s x -&gt; Statement
forall (s :: * -&gt; *) i x w (z :: * -&gt; *).
(PermutableSequence s i x, Show w) =&gt;
z i -&gt; (w -&gt; w -&gt; Ordering) -&gt; (x -&gt; w) -&gt; s x -&gt; Statement
</span><a href="OAlg.Entity.Sequence.Permutation.html#relPmtSqc2"><span class="hs-identifier hs-var">relPmtSqc2</span></a></span><span> </span><span class="annot"><span class="annottext">z i
</span><a href="#local-6989586621679388836"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">w -&gt; w -&gt; Ordering
</span><a href="#local-6989586621679388837"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">x -&gt; w
</span><a href="#local-6989586621679388838"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-623"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-624"></span><span>
</span><span id="line-625"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-626"></span><span class="hs-comment">-- prpPermutation -</span><span>
</span><span id="line-627"></span><span>
</span><span id="line-628"></span><span class="annot"><span class="hs-comment">-- | validity of the functionality of the module &quot;Permutation&quot;.</span></span><span>
</span><span id="line-629"></span><span class="annot"><a href="OAlg.Entity.Sequence.Permutation.html#prpPermutation"><span class="hs-identifier hs-type">prpPermutation</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.Data.Statement.Definition.html#Statement"><span class="hs-identifier hs-type">Statement</span></a></span><span>
</span><span id="line-630"></span><span id="prpPermutation"><span class="annot"><span class="annottext">prpPermutation :: Statement
</span><a href="OAlg.Entity.Sequence.Permutation.html#prpPermutation"><span class="hs-identifier hs-var hs-var">prpPermutation</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Label
</span><a href="OAlg.Data.Statement.Definition.html#Prp"><span class="hs-identifier hs-var">Prp</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Permutation&quot;</span></span><span> </span><span class="annot"><span class="annottext">Label -&gt; Statement -&gt; Statement
</span><a href="OAlg.Data.Statement.Definition.html#%3A%3C%3D%3E%3A"><span class="hs-operator hs-var">:&lt;=&gt;:</span></a></span><span>
</span><span id="line-631"></span><span>  </span><span class="annot"><span class="annottext">[Statement] -&gt; Statement
</span><a href="OAlg.Data.Statement.Definition.html#And"><span class="hs-identifier hs-var">And</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">XMlt (Permutation N) -&gt; Statement
forall c. Multiplicative c =&gt; XMlt c -&gt; Statement
</span><a href="OAlg.Structure.Multiplicative.Proposition.html#prpMlt"><span class="hs-identifier hs-var">prpMlt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">N -&gt; X N -&gt; XMlt (Permutation N)
forall i. (Entity i, Ord i) =&gt; N -&gt; X i -&gt; XMlt (Permutation i)
</span><a href="OAlg.Entity.Sequence.Permutation.html#xMltPermutation"><span class="hs-identifier hs-var">xMltPermutation</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">20</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">N -&gt; N -&gt; X N
</span><a href="OAlg.Data.X.html#xNB"><span class="hs-identifier hs-var">xNB</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">50</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-632"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Statement
</span><a href="OAlg.Entity.Sequence.Permutation.html#prpOprPermutation"><span class="hs-identifier hs-var">prpOprPermutation</span></a></span><span>
</span><span id="line-633"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">N
-&gt; Proxy N
-&gt; (N -&gt; N -&gt; Ordering)
-&gt; (N -&gt; N)
-&gt; X [N]
-&gt; Statement
forall (s :: * -&gt; *) i x w (z :: * -&gt; *).
(PermutableSequence s i x, Entity x, Entity i, Show w) =&gt;
N
-&gt; z i -&gt; (w -&gt; w -&gt; Ordering) -&gt; (x -&gt; w) -&gt; X (s x) -&gt; Statement
</span><a href="OAlg.Entity.Sequence.Permutation.html#prpPermutableSequence"><span class="hs-identifier hs-var">prpPermutableSequence</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="annottext">Proxy N
</span><a href="OAlg.Entity.Product.ProductSymbol.html#nProxy"><span class="hs-identifier hs-var">nProxy</span></a></span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><span class="annottext">N -&gt; N
forall x. x -&gt; x
</span><a href="OAlg.Category.Definition.html#id"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">X [N]
</span><a href="#local-6989586621679388842"><span class="hs-identifier hs-var">xxs</span></a></span><span>
</span><span id="line-634"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">N
-&gt; Proxy N
-&gt; (Symbol -&gt; Symbol -&gt; Ordering)
-&gt; (Symbol -&gt; Symbol)
-&gt; X (PSequence N Symbol)
-&gt; Statement
forall (s :: * -&gt; *) i x w (z :: * -&gt; *).
(PermutableSequence s i x, Entity x, Entity i, Show w) =&gt;
N
-&gt; z i -&gt; (w -&gt; w -&gt; Ordering) -&gt; (x -&gt; w) -&gt; X (s x) -&gt; Statement
</span><a href="OAlg.Entity.Sequence.Permutation.html#prpPermutableSequence"><span class="hs-identifier hs-var">prpPermutableSequence</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">15</span></span><span> </span><span class="annot"><span class="annottext">Proxy N
</span><a href="OAlg.Entity.Product.ProductSymbol.html#nProxy"><span class="hs-identifier hs-var">nProxy</span></a></span><span> </span><span class="annot"><span class="annottext">Symbol -&gt; Symbol -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><span class="annottext">Symbol -&gt; Symbol
forall x. x -&gt; x
</span><a href="OAlg.Category.Definition.html#id"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">X (PSequence N Symbol)
</span><a href="#local-6989586621679388843"><span class="hs-identifier hs-var">xpxs</span></a></span><span>
</span><span id="line-635"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">N
-&gt; Proxy N
-&gt; (Symbol -&gt; Symbol -&gt; Ordering)
-&gt; (Symbol -&gt; Symbol)
-&gt; X (CSequence Symbol)
-&gt; Statement
forall (s :: * -&gt; *) i x w (z :: * -&gt; *).
(PermutableSequence s i x, Entity x, Entity i, Show w) =&gt;
N
-&gt; z i -&gt; (w -&gt; w -&gt; Ordering) -&gt; (x -&gt; w) -&gt; X (s x) -&gt; Statement
</span><a href="OAlg.Entity.Sequence.Permutation.html#prpPermutableSequence"><span class="hs-identifier hs-var">prpPermutableSequence</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="annottext">Proxy N
</span><a href="OAlg.Entity.Product.ProductSymbol.html#nProxy"><span class="hs-identifier hs-var">nProxy</span></a></span><span> </span><span class="annot"><span class="annottext">Symbol -&gt; Symbol -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><span class="annottext">Symbol -&gt; Symbol
forall x. x -&gt; x
</span><a href="OAlg.Category.Definition.html#id"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">X (CSequence Symbol)
</span><a href="#local-6989586621679388844"><span class="hs-identifier hs-var">xpsy</span></a></span><span>
</span><span id="line-636"></span><span>      </span><span class="hs-special">]</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-637"></span><span>  </span><span id="local-6989586621679388842"><span class="annot"><span class="annottext">xxs :: X [N]
</span><a href="#local-6989586621679388842"><span class="hs-identifier hs-var hs-var">xxs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; X N
</span><a href="OAlg.Data.X.html#xNB"><span class="hs-identifier hs-var">xNB</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="annottext">X N -&gt; (N -&gt; X [N]) -&gt; X [N]
forall a b. X a -&gt; (a -&gt; X b) -&gt; X b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679388850"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679388850"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">N -&gt; X N -&gt; X [N]
forall x. N -&gt; X x -&gt; X [x]
</span><a href="OAlg.Data.X.html#xTakeN"><span class="hs-identifier hs-var">xTakeN</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679388850"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">N -&gt; N -&gt; X N
</span><a href="OAlg.Data.X.html#xNB"><span class="hs-identifier hs-var">xNB</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">20</span></span><span class="hs-special">)</span><span>
</span><span id="line-638"></span><span>  </span><span id="local-6989586621679388843"><span class="annot"><span class="annottext">xpxs :: X (PSequence N Symbol)
</span><a href="#local-6989586621679388843"><span class="hs-identifier hs-var hs-var">xpxs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; X Symbol -&gt; X N -&gt; X (PSequence N Symbol)
forall i x. Ord i =&gt; N -&gt; N -&gt; X x -&gt; X i -&gt; X (PSequence i x)
</span><a href="OAlg.Entity.Sequence.PSequence.html#xPSequence"><span class="hs-identifier hs-var">xPSequence</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">20</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">40</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">X Symbol
forall x. XStandard x =&gt; X x
</span><a href="OAlg.Data.Validable.html#xStandard"><span class="hs-identifier hs-var">xStandard</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.Data.X.html#X"><span class="hs-identifier hs-type">X</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Symbol.html#Symbol"><span class="hs-identifier hs-type">Symbol</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">N -&gt; N -&gt; X N
</span><a href="OAlg.Data.X.html#xNB"><span class="hs-identifier hs-var">xNB</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">200</span></span><span class="hs-special">)</span><span>
</span><span id="line-639"></span><span>  </span><span id="local-6989586621679388844"><span class="annot"><span class="annottext">xpsy :: X (CSequence Symbol)
</span><a href="#local-6989586621679388844"><span class="hs-identifier hs-var hs-var">xpsy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">N -&gt; X Symbol -&gt; X (CSequence Symbol)
forall x. Entity x =&gt; N -&gt; X x -&gt; X (CSequence x)
</span><a href="OAlg.Entity.Sequence.CSequence.html#xCSequence"><span class="hs-identifier hs-var">xCSequence</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">20</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">X Symbol
forall x. XStandard x =&gt; X x
</span><a href="OAlg.Data.Validable.html#xStandard"><span class="hs-identifier hs-var">xStandard</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.Data.X.html#X"><span class="hs-identifier hs-type">X</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Symbol.html#Symbol"><span class="hs-identifier hs-type">Symbol</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-640"></span><span>
</span><span id="line-641"></span><span>
</span><span id="line-642"></span></pre></body></html>