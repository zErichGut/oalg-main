<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE NoImplicitPrelude #-}</span><span>
</span><span id="line-3"></span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE TypeOperators #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE DataKinds #-}</span><span>
</span><span id="line-10"></span><span>
</span><span id="line-11"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- Module      : OAlg.Entity.Product.Proposition</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- Description : propositions on products over oriented symbols</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- Copyright   : (c) Erich Gut</span><span>
</span><span id="line-15"></span><span class="hs-comment">-- License     : BSD3</span><span>
</span><span id="line-16"></span><span class="hs-comment">-- Maintainer  : zerich.gut@gmail.com</span><span>
</span><span id="line-17"></span><span class="hs-comment">--</span><span>
</span><span id="line-18"></span><span class="hs-comment">-- propositions on free products over 'Oriented' symbols with exponents in a 'Number'.</span><span>
</span><span id="line-19"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">OAlg.Entity.Product.Proposition</span><span>
</span><span id="line-20"></span><span>  </span><span class="hs-special">(</span><span>
</span><span id="line-21"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Proposition</span></span><span>
</span><span id="line-22"></span><span>    </span><span class="annot"><a href="OAlg.Entity.Product.Proposition.html#prpProduct"><span class="hs-identifier">prpProduct</span></a></span><span>
</span><span id="line-23"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Proposition.html#prpOrtProductNOrntSymbol"><span class="hs-identifier">prpOrtProductNOrntSymbol</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Proposition.html#prpOrtProductZOrntSymbol"><span class="hs-identifier">prpOrtProductZOrntSymbol</span></a></span><span>
</span><span id="line-24"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Proposition.html#prpMltProductNOrntSymbol"><span class="hs-identifier">prpMltProductNOrntSymbol</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Proposition.html#prpMltProductZOrntSymbol"><span class="hs-identifier">prpMltProductZOrntSymbol</span></a></span><span>
</span><span id="line-25"></span><span>  </span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Random Variables</span></span><span>
</span><span id="line-28"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Proposition.html#xStartProduct"><span class="hs-identifier">xStartProduct</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Proposition.html#xStartProductForm"><span class="hs-identifier">xStartProductForm</span></a></span><span>
</span><span id="line-29"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Proposition.html#xPrdSymStart"><span class="hs-identifier">xPrdSymStart</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Proposition.html#xPrdSymMlt"><span class="hs-identifier">xPrdSymMlt</span></a></span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Example</span></span><span>
</span><span id="line-32"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Proposition.html#xT"><span class="hs-identifier">xT</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Proposition.html#dstT"><span class="hs-identifier">dstT</span></a></span><span>
</span><span id="line-33"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>
</span><span id="line-37"></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="OAlg.Prelude.html"><span class="hs-identifier">OAlg.Prelude</span></a></span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="OAlg.Data.Symbol.html"><span class="hs-identifier">OAlg.Data.Symbol</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Data.Symbol.html#P"><span class="hs-identifier">P</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="OAlg.Data.Canonical.html"><span class="hs-identifier">OAlg.Data.Canonical</span></a></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="OAlg.Data.Constructable.html"><span class="hs-identifier">OAlg.Data.Constructable</span></a></span><span>
</span><span id="line-43"></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="OAlg.Structure.Oriented.html"><span class="hs-identifier">OAlg.Structure.Oriented</span></a></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="OAlg.Structure.Multiplicative.html"><span class="hs-identifier">OAlg.Structure.Multiplicative</span></a></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="OAlg.Structure.Additive.html"><span class="hs-identifier">OAlg.Structure.Additive</span></a></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="OAlg.Structure.Ring.html"><span class="hs-identifier">OAlg.Structure.Ring</span></a></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="OAlg.Structure.Number.html"><span class="hs-identifier">OAlg.Structure.Number</span></a></span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html"><span class="hs-identifier">OAlg.Entity.Product.Definition</span></a></span><span>
</span><span id="line-51"></span><span>
</span><span id="line-52"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-53"></span><span class="hs-comment">-- xStartProductForm -</span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span class="hs-comment">-- | random variable of product forms with maximal /depth/ @d@ (a ':^' constructor</span><span>
</span><span id="line-56"></span><span class="hs-comment">-- dose not increases the depth).</span><span>
</span><span id="line-57"></span><span id="local-6989586621679385484"><span id="local-6989586621679385485"><span class="annot"><a href="OAlg.Entity.Product.Proposition.html#xStartProductForm"><span class="hs-identifier hs-type">xStartProductForm</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#Oriented"><span class="hs-identifier hs-type">Oriented</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679385484"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Number"><span class="hs-identifier hs-type">Number</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679385485"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#XOrtSite"><span class="hs-identifier hs-type">XOrtSite</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Dualisable.html#From"><span class="hs-identifier hs-type">From</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679385484"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.X.html#X"><span class="hs-identifier hs-type">X</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679385485"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#XOrtSite"><span class="hs-identifier hs-type">XOrtSite</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Dualisable.html#From"><span class="hs-identifier hs-type">From</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#ProductForm"><span class="hs-identifier hs-type">ProductForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679385485"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679385484"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-59"></span><span id="xStartProductForm"><span class="annot"><span class="annottext">xStartProductForm :: forall a r.
(Oriented a, Number r) =&gt;
XOrtSite 'From a -&gt; X r -&gt; N -&gt; XOrtSite 'From (ProductForm r a)
</span><a href="OAlg.Entity.Product.Proposition.html#xStartProductForm"><span class="hs-identifier hs-var hs-var">xStartProductForm</span></a></span></span><span> </span><span id="local-6989586621679385759"><span class="annot"><span class="annottext">xs :: XOrtSite 'From a
</span><a href="#local-6989586621679385759"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#XStart"><span class="hs-identifier hs-type">XStart</span></a></span><span> </span><span id="local-6989586621679385764"><span class="annot"><span class="annottext">X (Point a)
</span><a href="#local-6989586621679385764"><span class="hs-identifier hs-var">xp</span></a></span></span><span> </span><span class="annot"><span class="annottext">Point a -&gt; X a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679385765"><span class="annot"><span class="annottext">X r
</span><a href="#local-6989586621679385765"><span class="hs-identifier hs-var">xr</span></a></span></span><span> </span><span id="local-6989586621679385766"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679385766"><span class="hs-identifier hs-var">d</span></a></span></span><span>
</span><span id="line-60"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">X (Point (ProductForm r a))
-&gt; (Point (ProductForm r a) -&gt; X (ProductForm r a))
-&gt; XOrtSite 'From (ProductForm r a)
forall q. X (Point q) -&gt; (Point q -&gt; X q) -&gt; XOrtSite 'From q
</span><a href="OAlg.Structure.Oriented.Definition.html#XStart"><span class="hs-identifier hs-var">XStart</span></a></span><span> </span><span class="annot"><span class="annottext">X (Point a)
X (Point (ProductForm r a))
</span><a href="#local-6989586621679385764"><span class="hs-identifier hs-var">xp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">N -&gt; XOrtSite 'From a -&gt; X r -&gt; Point a -&gt; X (ProductForm r a)
forall {r} {a}.
(Number r, Oriented a) =&gt;
N -&gt; XOrtSite 'From a -&gt; X r -&gt; Point a -&gt; X (ProductForm r a)
</span><a href="#local-6989586621679385767"><span class="hs-identifier hs-var">xPrdFrm'</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679385766"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">XOrtSite 'From a
</span><a href="#local-6989586621679385759"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">X r
</span><a href="#local-6989586621679385765"><span class="hs-identifier hs-var">xr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-61"></span><span>
</span><span id="line-62"></span><span>  </span><span id="local-6989586621679385767"><span class="annot"><span class="annottext">xPrdFrm' :: N -&gt; XOrtSite 'From a -&gt; X r -&gt; Point a -&gt; X (ProductForm r a)
</span><a href="#local-6989586621679385767"><span class="hs-identifier hs-var hs-var">xPrdFrm'</span></a></span></span><span> </span><span id="local-6989586621679385925"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679385925"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679385926"><span class="annot"><span class="annottext">XOrtSite 'From a
</span><a href="#local-6989586621679385926"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621679385927"><span class="annot"><span class="annottext">X r
</span><a href="#local-6989586621679385927"><span class="hs-identifier hs-var">xr</span></a></span></span><span> </span><span id="local-6989586621679385928"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679385928"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-63"></span><span>    </span><span id="local-6989586621679385929"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679385929"><span class="hs-identifier hs-var">d'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; X N
</span><a href="OAlg.Data.X.html#xNB"><span class="hs-identifier hs-var">xNB</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679385925"><span class="hs-identifier hs-var">d</span></a></span><span class="annot"><span class="annottext">N -&gt; N -&gt; N
forall a. Additive a =&gt; a -&gt; a -&gt; a
</span><a href="OAlg.Structure.Additive.Definition.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span class="annot"><span class="annottext">N
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span>    </span><span class="annot"><span class="annottext">N
-&gt; XOrtSite 'From a
-&gt; X r
-&gt; Point (ProductForm r a)
-&gt; X (ProductForm r a)
forall a r f.
(Oriented a, Number r, f ~ ProductForm r a) =&gt;
N -&gt; XOrtSite 'From a -&gt; X r -&gt; Point f -&gt; X f
</span><a href="#local-6989586621679385932"><span class="hs-identifier hs-var">xPrdFrm</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679385929"><span class="hs-identifier hs-var">d'</span></a></span><span> </span><span class="annot"><span class="annottext">XOrtSite 'From a
</span><a href="#local-6989586621679385926"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">X r
</span><a href="#local-6989586621679385927"><span class="hs-identifier hs-var">xr</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
Point (ProductForm r a)
</span><a href="#local-6989586621679385928"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-65"></span><span>  </span><span>
</span><span id="line-66"></span><span>  </span><span id="local-6989586621679385936"><span class="annot"><span class="annottext">xBoolExp :: X Bool
</span><a href="#local-6989586621679385936"><span class="hs-identifier hs-var hs-var">xBoolExp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Q, Bool)] -&gt; X Bool
forall a. [(Q, a)] -&gt; X a
</span><a href="OAlg.Data.X.html#xOneOfW"><span class="hs-identifier hs-var">xOneOfW</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Q
</span><span class="hs-number">10</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Q
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span>  </span><span class="hs-comment">-- random variable of 1 and -1 - if -1 exists.</span><span>
</span><span id="line-69"></span><span>  </span><span id="local-6989586621679385524"><span class="annot"><a href="#local-6989586621679385938"><span class="hs-identifier hs-type">xOneMinusOne</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Number"><span class="hs-identifier hs-type">Number</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679385524"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.X.html#X"><span class="hs-identifier hs-type">X</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679385524"><span class="hs-identifier hs-type">r</span></a></span></span><span>
</span><span id="line-70"></span><span>  </span><span id="local-6989586621679385938"><span class="annot"><span class="annottext">xOneMinusOne :: forall r. Number r =&gt; X r
</span><a href="#local-6989586621679385938"><span class="hs-identifier hs-var hs-var">xOneMinusOne</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe r
forall r. Number r =&gt; Maybe r
</span><a href="OAlg.Structure.Number.Definition.html#minusOne"><span class="hs-identifier hs-var">minusOne</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-71"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679385946"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679385946"><span class="hs-identifier hs-var">e</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[r] -&gt; X r
forall a. [a] -&gt; X a
</span><a href="OAlg.Data.X.html#xOneOf"><span class="hs-identifier hs-var">xOneOf</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">r
forall r. Semiring r =&gt; r
</span><a href="OAlg.Structure.Ring.Definition.html#rOne"><span class="hs-identifier hs-var">rOne</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679385946"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-72"></span><span>    </span><span class="annot"><span class="annottext">Maybe r
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">r -&gt; X r
forall a. a -&gt; X a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">r
forall r. Semiring r =&gt; r
</span><a href="OAlg.Structure.Ring.Definition.html#rOne"><span class="hs-identifier hs-var">rOne</span></a></span><span> </span><span>
</span><span id="line-73"></span><span>  </span><span>
</span><span id="line-74"></span><span>  </span><span class="hs-comment">-- xExp True enriches the product form by a randomly picked exponent, but</span><span>
</span><span id="line-75"></span><span>  </span><span class="hs-comment">-- lets the orientation unchanged.</span><span>
</span><span id="line-76"></span><span>  </span><span id="local-6989586621679385530"><span id="local-6989586621679385531"><span class="annot"><a href="#local-6989586621679385949"><span class="hs-identifier hs-type">xExp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#Oriented"><span class="hs-identifier hs-type">Oriented</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679385530"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Number"><span class="hs-identifier hs-type">Number</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679385531"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.X.html#X"><span class="hs-identifier hs-type">X</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679385531"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#ProductForm"><span class="hs-identifier hs-type">ProductForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679385531"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679385530"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.X.html#X"><span class="hs-identifier hs-type">X</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#ProductForm"><span class="hs-identifier hs-type">ProductForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679385531"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679385530"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-77"></span><span>  </span><span id="local-6989586621679385949"><span class="annot"><span class="annottext">xExp :: forall a r.
(Oriented a, Number r) =&gt;
Bool -&gt; X r -&gt; ProductForm r a -&gt; X (ProductForm r a)
</span><a href="#local-6989586621679385949"><span class="hs-identifier hs-var hs-var">xExp</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">X r
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679385971"><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679385971"><span class="hs-identifier hs-var">pf</span></a></span></span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProductForm r a -&gt; X (ProductForm r a)
forall a. a -&gt; X a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679385971"><span class="hs-identifier hs-var">pf</span></a></span><span>
</span><span id="line-78"></span><span>  </span><span class="annot"><a href="#local-6989586621679385949"><span class="hs-identifier hs-var">xExp</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span id="local-6989586621679385972"><span class="annot"><span class="annottext">X r
</span><a href="#local-6989586621679385972"><span class="hs-identifier hs-var">xr</span></a></span></span><span> </span><span id="local-6989586621679385973"><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679385973"><span class="hs-identifier hs-var">pf</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ProductForm r a -&gt; Bool
forall q. Oriented q =&gt; q -&gt; Bool
</span><a href="OAlg.Structure.Oriented.Definition.html#isEndo"><span class="hs-identifier hs-var">isEndo</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679385973"><span class="hs-identifier hs-var">pf</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">X r
</span><a href="#local-6989586621679385972"><span class="hs-identifier hs-var">xr</span></a></span><span> </span><span class="annot"><span class="annottext">X r -&gt; (r -&gt; X (ProductForm r a)) -&gt; X (ProductForm r a)
forall a b. X a -&gt; (a -&gt; X b) -&gt; X b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">ProductForm r a -&gt; X (ProductForm r a)
forall a. a -&gt; X a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(ProductForm r a -&gt; X (ProductForm r a))
-&gt; (r -&gt; ProductForm r a) -&gt; r -&gt; X (ProductForm r a)
forall y z x. (y -&gt; z) -&gt; (x -&gt; y) -&gt; x -&gt; z
forall (c :: * -&gt; * -&gt; *) y z x.
Category c =&gt;
c y z -&gt; c x y -&gt; c x z
</span><a href="OAlg.Category.Definition.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679385973"><span class="hs-identifier hs-var">pf</span></a></span><span class="annot"><span class="annottext">ProductForm r a -&gt; r -&gt; ProductForm r a
forall r a. ProductForm r a -&gt; r -&gt; ProductForm r a
</span><a href="OAlg.Entity.Product.Definition.html#%3A%5E"><span class="hs-operator hs-var">:^</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-80"></span><span>    </span><span id="local-6989586621679385976"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679385976"><span class="hs-identifier hs-var">r</span></a></span></span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">X r
forall r. Number r =&gt; X r
</span><a href="#local-6989586621679385938"><span class="hs-identifier hs-var">xOneMinusOne</span></a></span><span>
</span><span id="line-81"></span><span>    </span><span id="local-6989586621679385977"><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679385977"><span class="hs-identifier hs-var">pf'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ProductForm r a -&gt; X (ProductForm r a)
forall a. a -&gt; X a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(ProductForm r a -&gt; X (ProductForm r a))
-&gt; ProductForm r a -&gt; X (ProductForm r a)
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><a href="OAlg.Category.Applicative.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679385976"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">r
forall r. Semiring r =&gt; r
</span><a href="OAlg.Structure.Ring.Definition.html#rZero"><span class="hs-identifier hs-var">rZero</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">ProductForm r a -&gt; ProductForm r a
forall r a. Number r =&gt; ProductForm r a -&gt; ProductForm r a
</span><a href="OAlg.Entity.Product.Definition.html#prfInverse"><span class="hs-identifier hs-var">prfInverse</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679385973"><span class="hs-identifier hs-var">pf</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679385973"><span class="hs-identifier hs-var">pf</span></a></span><span>
</span><span id="line-82"></span><span>    </span><span class="annot"><span class="annottext">ProductForm r a -&gt; X (ProductForm r a)
forall a. a -&gt; X a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679385977"><span class="hs-identifier hs-var">pf'</span></a></span><span class="annot"><span class="annottext">ProductForm r a -&gt; r -&gt; ProductForm r a
forall r a. ProductForm r a -&gt; r -&gt; ProductForm r a
</span><a href="OAlg.Entity.Product.Definition.html#%3A%5E"><span class="hs-operator hs-var">:^</span></a></span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679385976"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span>  </span><span id="local-6989586621679385519"><span id="local-6989586621679385520"><span id="local-6989586621679385521"><span class="annot"><a href="#local-6989586621679385932"><span class="hs-identifier hs-type">xPrdFrm</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#Oriented"><span class="hs-identifier hs-type">Oriented</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679385519"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Number"><span class="hs-identifier hs-type">Number</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679385520"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679385521"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#ProductForm"><span class="hs-identifier hs-type">ProductForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679385520"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679385519"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#XOrtSite"><span class="hs-identifier hs-type">XOrtSite</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Dualisable.html#From"><span class="hs-identifier hs-type">From</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679385519"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.X.html#X"><span class="hs-identifier hs-type">X</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679385520"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679385521"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.X.html#X"><span class="hs-identifier hs-type">X</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679385521"><span class="hs-identifier hs-type">f</span></a></span></span></span></span><span>
</span><span id="line-86"></span><span>  </span><span id="local-6989586621679385932"><span class="annot"><span class="annottext">xPrdFrm :: forall a r f.
(Oriented a, Number r, f ~ ProductForm r a) =&gt;
N -&gt; XOrtSite 'From a -&gt; X r -&gt; Point f -&gt; X f
</span><a href="#local-6989586621679385932"><span class="hs-identifier hs-var hs-var">xPrdFrm</span></a></span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">XOrtSite 'From a
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679386037"><span class="annot"><span class="annottext">X r
</span><a href="#local-6989586621679386037"><span class="hs-identifier hs-var">xr</span></a></span></span><span> </span><span id="local-6989586621679386038"><span class="annot"><span class="annottext">Point f
</span><a href="#local-6989586621679386038"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-87"></span><span>    </span><span id="local-6989586621679386039"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679386039"><span class="hs-identifier hs-var">b</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">X Bool
</span><a href="#local-6989586621679385936"><span class="hs-identifier hs-var">xBoolExp</span></a></span><span>
</span><span id="line-88"></span><span>    </span><span id="local-6989586621679386040"><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679386040"><span class="hs-identifier hs-var">pf</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; X r -&gt; ProductForm r a -&gt; X (ProductForm r a)
forall a r.
(Oriented a, Number r) =&gt;
Bool -&gt; X r -&gt; ProductForm r a -&gt; X (ProductForm r a)
</span><a href="#local-6989586621679385949"><span class="hs-identifier hs-var">xExp</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679386039"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">X r
</span><a href="#local-6989586621679386037"><span class="hs-identifier hs-var">xr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point a -&gt; ProductForm r a
forall r a. Point a -&gt; ProductForm r a
</span><a href="OAlg.Entity.Product.Definition.html#One"><span class="hs-identifier hs-var">One</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
Point f
</span><a href="#local-6989586621679386038"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span>    </span><span class="annot"><span class="annottext">f -&gt; X f
forall a. a -&gt; X a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">f
ProductForm r a
</span><a href="#local-6989586621679386040"><span class="hs-identifier hs-var">pf</span></a></span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span>  </span><span class="annot"><a href="#local-6989586621679385932"><span class="hs-identifier hs-var">xPrdFrm</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">1</span></span><span> </span><span id="local-6989586621679386042"><span class="annot"><span class="annottext">XOrtSite 'From a
</span><a href="#local-6989586621679386042"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621679386043"><span class="annot"><span class="annottext">X r
</span><a href="#local-6989586621679386043"><span class="hs-identifier hs-var">xr</span></a></span></span><span> </span><span id="local-6989586621679386044"><span class="annot"><span class="annottext">Point f
</span><a href="#local-6989586621679386044"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-92"></span><span>    </span><span id="local-6989586621679386045"><span class="annot"><span class="annottext">Path a
</span><a href="#local-6989586621679386045"><span class="hs-identifier hs-var">pth</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">XOrtSite 'From a -&gt; N -&gt; Point a -&gt; X (Path a)
forall q (s :: Site).
Oriented q =&gt;
XOrtSite s q -&gt; N -&gt; Point q -&gt; X (Path q)
</span><a href="OAlg.Structure.Oriented.Definition.html#xosPathMaxAt"><span class="hs-identifier hs-var">xosPathMaxAt</span></a></span><span> </span><span class="annot"><span class="annottext">XOrtSite 'From a
</span><a href="#local-6989586621679386042"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Point a
Point f
</span><a href="#local-6989586621679386044"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-93"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Path a
</span><a href="#local-6989586621679386045"><span class="hs-identifier hs-var">pth</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-94"></span><span>      </span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">N -&gt; XOrtSite 'From a -&gt; X r -&gt; Point f -&gt; X f
forall a r f.
(Oriented a, Number r, f ~ ProductForm r a) =&gt;
N -&gt; XOrtSite 'From a -&gt; X r -&gt; Point f -&gt; X f
</span><a href="#local-6989586621679385932"><span class="hs-identifier hs-var">xPrdFrm</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">XOrtSite 'From a
</span><a href="#local-6989586621679386042"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">X r
</span><a href="#local-6989586621679386043"><span class="hs-identifier hs-var">xr</span></a></span><span> </span><span class="annot"><span class="annottext">Point f
</span><a href="#local-6989586621679386044"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-95"></span><span>      </span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679386048"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679386048"><span class="hs-identifier hs-var">a</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[a]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-96"></span><span>        </span><span id="local-6989586621679386049"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679386049"><span class="hs-identifier hs-var">b</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">X Bool
</span><a href="#local-6989586621679385936"><span class="hs-identifier hs-var">xBoolExp</span></a></span><span>
</span><span id="line-97"></span><span>        </span><span id="local-6989586621679386050"><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679386050"><span class="hs-identifier hs-var">pf</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; X r -&gt; ProductForm r a -&gt; X (ProductForm r a)
forall a r.
(Oriented a, Number r) =&gt;
Bool -&gt; X r -&gt; ProductForm r a -&gt; X (ProductForm r a)
</span><a href="#local-6989586621679385949"><span class="hs-identifier hs-var">xExp</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679386049"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">X r
</span><a href="#local-6989586621679386043"><span class="hs-identifier hs-var">xr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; ProductForm r a
forall r a. a -&gt; ProductForm r a
</span><a href="OAlg.Entity.Product.Definition.html#P"><span class="hs-identifier hs-var">P</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679386048"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-98"></span><span>        </span><span class="annot"><span class="annottext">f -&gt; X f
forall a. a -&gt; X a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">f
ProductForm r a
</span><a href="#local-6989586621679386050"><span class="hs-identifier hs-var">pf</span></a></span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span>  </span><span class="annot"><a href="#local-6989586621679385932"><span class="hs-identifier hs-var">xPrdFrm</span></a></span><span> </span><span id="local-6989586621679386052"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679386052"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679386053"><span class="annot"><span class="annottext">XOrtSite 'From a
</span><a href="#local-6989586621679386053"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621679386054"><span class="annot"><span class="annottext">X r
</span><a href="#local-6989586621679386054"><span class="hs-identifier hs-var">xr</span></a></span></span><span> </span><span id="local-6989586621679386055"><span class="annot"><span class="annottext">Point f
</span><a href="#local-6989586621679386055"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-101"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679386056"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679386056"><span class="hs-identifier hs-var">df</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679386057"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679386057"><span class="hs-identifier hs-var">dg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">X N -&gt; X N -&gt; X (N, N)
forall a b. X a -&gt; X b -&gt; X (a, b)
</span><a href="OAlg.Data.X.html#xTupple2"><span class="hs-identifier hs-var">xTupple2</span></a></span><span> </span><span class="annot"><span class="annottext">X N
</span><a href="#local-6989586621679386059"><span class="hs-identifier hs-var">xd</span></a></span><span> </span><span class="annot"><span class="annottext">X N
</span><a href="#local-6989586621679386059"><span class="hs-identifier hs-var">xd</span></a></span><span>
</span><span id="line-102"></span><span>    </span><span id="local-6989586621679386060"><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679386060"><span class="hs-identifier hs-var">g</span></a></span></span><span>       </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">N
-&gt; XOrtSite 'From a
-&gt; X r
-&gt; Point (ProductForm r a)
-&gt; X (ProductForm r a)
forall a r f.
(Oriented a, Number r, f ~ ProductForm r a) =&gt;
N -&gt; XOrtSite 'From a -&gt; X r -&gt; Point f -&gt; X f
</span><a href="#local-6989586621679385932"><span class="hs-identifier hs-var">xPrdFrm</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679386056"><span class="hs-identifier hs-var">df</span></a></span><span> </span><span class="annot"><span class="annottext">XOrtSite 'From a
</span><a href="#local-6989586621679386053"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">X r
</span><a href="#local-6989586621679386054"><span class="hs-identifier hs-var">xr</span></a></span><span> </span><span class="annot"><span class="annottext">Point f
Point (ProductForm r a)
</span><a href="#local-6989586621679386055"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-103"></span><span>    </span><span id="local-6989586621679386061"><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679386061"><span class="hs-identifier hs-var">f</span></a></span></span><span>       </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">N
-&gt; XOrtSite 'From a
-&gt; X r
-&gt; Point (ProductForm r a)
-&gt; X (ProductForm r a)
forall a r f.
(Oriented a, Number r, f ~ ProductForm r a) =&gt;
N -&gt; XOrtSite 'From a -&gt; X r -&gt; Point f -&gt; X f
</span><a href="#local-6989586621679385932"><span class="hs-identifier hs-var">xPrdFrm</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679386057"><span class="hs-identifier hs-var">dg</span></a></span><span> </span><span class="annot"><span class="annottext">XOrtSite 'From a
</span><a href="#local-6989586621679386053"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">X r
</span><a href="#local-6989586621679386054"><span class="hs-identifier hs-var">xr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProductForm r a -&gt; Point (ProductForm r a)
forall q. Oriented q =&gt; q -&gt; Point q
</span><a href="OAlg.Structure.Oriented.Definition.html#end"><span class="hs-identifier hs-var">end</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679386060"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-104"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679386063"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679386063"><span class="hs-identifier hs-var">bf</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679386064"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679386064"><span class="hs-identifier hs-var">bg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">X Bool -&gt; X Bool -&gt; X (Bool, Bool)
forall a b. X a -&gt; X b -&gt; X (a, b)
</span><a href="OAlg.Data.X.html#xTupple2"><span class="hs-identifier hs-var">xTupple2</span></a></span><span> </span><span class="annot"><span class="annottext">X Bool
</span><a href="#local-6989586621679385936"><span class="hs-identifier hs-var">xBoolExp</span></a></span><span> </span><span class="annot"><span class="annottext">X Bool
</span><a href="#local-6989586621679385936"><span class="hs-identifier hs-var">xBoolExp</span></a></span><span>
</span><span id="line-105"></span><span>    </span><span id="local-6989586621679386065"><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679386065"><span class="hs-identifier hs-var">g'</span></a></span></span><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; X r -&gt; ProductForm r a -&gt; X (ProductForm r a)
forall a r.
(Oriented a, Number r) =&gt;
Bool -&gt; X r -&gt; ProductForm r a -&gt; X (ProductForm r a)
</span><a href="#local-6989586621679385949"><span class="hs-identifier hs-var">xExp</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679386064"><span class="hs-identifier hs-var">bg</span></a></span><span> </span><span class="annot"><span class="annottext">X r
</span><a href="#local-6989586621679386054"><span class="hs-identifier hs-var">xr</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679386060"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-106"></span><span>    </span><span id="local-6989586621679386066"><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679386066"><span class="hs-identifier hs-var">f'</span></a></span></span><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; X r -&gt; ProductForm r a -&gt; X (ProductForm r a)
forall a r.
(Oriented a, Number r) =&gt;
Bool -&gt; X r -&gt; ProductForm r a -&gt; X (ProductForm r a)
</span><a href="#local-6989586621679385949"><span class="hs-identifier hs-var">xExp</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679386063"><span class="hs-identifier hs-var">bf</span></a></span><span> </span><span class="annot"><span class="annottext">X r
</span><a href="#local-6989586621679386054"><span class="hs-identifier hs-var">xr</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679386061"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-107"></span><span>    </span><span id="local-6989586621679386067"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679386067"><span class="hs-identifier hs-var">b</span></a></span></span><span>       </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">X Bool
</span><a href="#local-6989586621679385936"><span class="hs-identifier hs-var">xBoolExp</span></a></span><span>
</span><span id="line-108"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; X r -&gt; ProductForm r a -&gt; X (ProductForm r a)
forall a r.
(Oriented a, Number r) =&gt;
Bool -&gt; X r -&gt; ProductForm r a -&gt; X (ProductForm r a)
</span><a href="#local-6989586621679385949"><span class="hs-identifier hs-var">xExp</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679386067"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">X r
</span><a href="#local-6989586621679386054"><span class="hs-identifier hs-var">xr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679386066"><span class="hs-identifier hs-var">f'</span></a></span><span class="annot"><span class="annottext">ProductForm r a -&gt; ProductForm r a -&gt; ProductForm r a
forall r a. ProductForm r a -&gt; ProductForm r a -&gt; ProductForm r a
</span><a href="OAlg.Entity.Product.Definition.html#%3A%2A"><span class="hs-operator hs-var">:*</span></a></span><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679386065"><span class="hs-identifier hs-var">g'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679386059"><span class="annot"><span class="annottext">xd :: X N
</span><a href="#local-6989586621679386059"><span class="hs-identifier hs-var hs-var">xd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">X (X N) -&gt; X N
forall (m :: * -&gt; *) a. Monad m =&gt; m (m a) -&gt; m a
</span><span class="hs-identifier hs-var">join</span></span><span> </span><span class="annot"><span class="annottext">(X (X N) -&gt; X N) -&gt; X (X N) -&gt; X N
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><a href="OAlg.Category.Applicative.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[(Q, X N)] -&gt; X (X N)
forall a. [(Q, a)] -&gt; X a
</span><a href="OAlg.Data.X.html#xOneOfW"><span class="hs-identifier hs-var">xOneOfW</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Q
</span><span class="hs-number">10</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">N -&gt; N -&gt; X N
</span><a href="OAlg.Data.X.html#xNB"><span class="hs-identifier hs-var">xNB</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679386052"><span class="hs-identifier hs-var">d</span></a></span><span class="annot"><span class="annottext">N -&gt; N -&gt; N
</span><a href="OAlg.Data.Number.html#%3E-"><span class="hs-operator hs-var">&gt;-</span></a></span><span class="annot"><span class="annottext">N
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Q
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">N -&gt; X N
forall a. a -&gt; X a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-110"></span><span>
</span><span id="line-111"></span><span>
</span><span id="line-112"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-113"></span><span class="hs-comment">-- xEndProductForm -</span><span>
</span><span id="line-114"></span><span>
</span><span id="line-115"></span><span class="annot"><span class="hs-comment">-- | the induced random variable.</span></span><span>
</span><span id="line-116"></span><span id="local-6989586621679385562"><span id="local-6989586621679385563"><span class="annot"><a href="OAlg.Entity.Product.Proposition.html#xEndProductForm"><span class="hs-identifier hs-type">xEndProductForm</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#Oriented"><span class="hs-identifier hs-type">Oriented</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679385562"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Number"><span class="hs-identifier hs-type">Number</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679385563"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-117"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#XOrtSite"><span class="hs-identifier hs-type">XOrtSite</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Dualisable.html#To"><span class="hs-identifier hs-type">To</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679385562"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.X.html#X"><span class="hs-identifier hs-type">X</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679385563"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#XOrtSite"><span class="hs-identifier hs-type">XOrtSite</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Dualisable.html#To"><span class="hs-identifier hs-type">To</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#ProductForm"><span class="hs-identifier hs-type">ProductForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679385563"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679385562"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-118"></span><span id="xEndProductForm"><span class="annot"><span class="annottext">xEndProductForm :: forall a r.
(Oriented a, Number r) =&gt;
XOrtSite 'To a -&gt; X r -&gt; N -&gt; XOrtSite 'To (ProductForm r a)
</span><a href="OAlg.Entity.Product.Proposition.html#xEndProductForm"><span class="hs-identifier hs-var hs-var">xEndProductForm</span></a></span></span><span> </span><span id="local-6989586621679386079"><span class="annot"><span class="annottext">XOrtSite 'To a
</span><a href="#local-6989586621679386079"><span class="hs-identifier hs-var">xEnd</span></a></span></span><span> </span><span id="local-6989586621679386080"><span class="annot"><span class="annottext">X r
</span><a href="#local-6989586621679386080"><span class="hs-identifier hs-var">xr</span></a></span></span><span> </span><span id="local-6989586621679386081"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679386081"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XOrtSite 'From (ProductForm r (Op a))
-&gt; XOrtSite 'To (ProductForm r a)
forall r a.
XOrtSite 'From (ProductForm r (Op a))
-&gt; XOrtSite 'To (ProductForm r a)
</span><a href="#local-6989586621679386082"><span class="hs-identifier hs-var">fDual</span></a></span><span> </span><span class="annot"><span class="annottext">(XOrtSite 'From (ProductForm r (Op a))
 -&gt; XOrtSite 'To (ProductForm r a))
-&gt; XOrtSite 'From (ProductForm r (Op a))
-&gt; XOrtSite 'To (ProductForm r a)
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><a href="OAlg.Category.Applicative.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">XOrtSite 'From (Op a)
-&gt; X r -&gt; N -&gt; XOrtSite 'From (ProductForm r (Op a))
forall a r.
(Oriented a, Number r) =&gt;
XOrtSite 'From a -&gt; X r -&gt; N -&gt; XOrtSite 'From (ProductForm r a)
</span><a href="OAlg.Entity.Product.Proposition.html#xStartProductForm"><span class="hs-identifier hs-var">xStartProductForm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XOrtSite 'To a -&gt; Dual (XOrtSite 'To a)
forall x. Dualisable x =&gt; x -&gt; Dual x
</span><a href="OAlg.Data.Dualisable.html#toDual"><span class="hs-identifier hs-var">toDual</span></a></span><span> </span><span class="annot"><span class="annottext">XOrtSite 'To a
</span><a href="#local-6989586621679386079"><span class="hs-identifier hs-var">xEnd</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">X r
</span><a href="#local-6989586621679386080"><span class="hs-identifier hs-var">xr</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679386081"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-119"></span><span>  </span><span id="local-6989586621679385571"><span id="local-6989586621679385572"><span class="annot"><a href="#local-6989586621679386082"><span class="hs-identifier hs-type">fDual</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#XOrtSite"><span class="hs-identifier hs-type">XOrtSite</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Dualisable.html#From"><span class="hs-identifier hs-type">From</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#ProductForm"><span class="hs-identifier hs-type">ProductForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679385571"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Data.Opposite.html#Op"><span class="hs-identifier hs-type">Op</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679385572"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#XOrtSite"><span class="hs-identifier hs-type">XOrtSite</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Dualisable.html#To"><span class="hs-identifier hs-type">To</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#ProductForm"><span class="hs-identifier hs-type">ProductForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679385571"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679385572"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-120"></span><span>  </span><span id="local-6989586621679386082"><span class="annot"><span class="annottext">fDual :: forall r a.
XOrtSite 'From (ProductForm r (Op a))
-&gt; XOrtSite 'To (ProductForm r a)
</span><a href="#local-6989586621679386082"><span class="hs-identifier hs-var hs-var">fDual</span></a></span></span><span> </span><span id="local-6989586621679386085"><span class="annot"><span class="annottext">XOrtSite 'From (ProductForm r (Op a))
</span><a href="#local-6989586621679386085"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dual (XOrtSite 'To (ProductForm r a))
-&gt; XOrtSite 'To (ProductForm r a)
forall x. Dualisable x =&gt; Dual x -&gt; x
</span><a href="OAlg.Data.Dualisable.html#fromDual"><span class="hs-identifier hs-var">fromDual</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XOrtSite 'From (ProductForm r (Op a))
-&gt; XOrtSite 'From (Op (ProductForm r a))
forall r a.
XOrtSite 'From (ProductForm r (Op a))
-&gt; XOrtSite 'From (Op (ProductForm r a))
</span><a href="#local-6989586621679386087"><span class="hs-identifier hs-var">hh</span></a></span><span> </span><span class="annot"><span class="annottext">XOrtSite 'From (ProductForm r (Op a))
</span><a href="#local-6989586621679386085"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-121"></span><span>
</span><span id="line-122"></span><span>  </span><span id="local-6989586621679385577"><span id="local-6989586621679385578"><span class="annot"><a href="#local-6989586621679386087"><span class="hs-identifier hs-type">hh</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#XOrtSite"><span class="hs-identifier hs-type">XOrtSite</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Dualisable.html#From"><span class="hs-identifier hs-type">From</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#ProductForm"><span class="hs-identifier hs-type">ProductForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679385577"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Data.Opposite.html#Op"><span class="hs-identifier hs-type">Op</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679385578"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#XOrtSite"><span class="hs-identifier hs-type">XOrtSite</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Dualisable.html#From"><span class="hs-identifier hs-type">From</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Data.Opposite.html#Op"><span class="hs-identifier hs-type">Op</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#ProductForm"><span class="hs-identifier hs-type">ProductForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679385577"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679385578"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-123"></span><span>  </span><span id="local-6989586621679386087"><span class="annot"><span class="annottext">hh :: forall r a.
XOrtSite 'From (ProductForm r (Op a))
-&gt; XOrtSite 'From (Op (ProductForm r a))
</span><a href="#local-6989586621679386087"><span class="hs-identifier hs-var hs-var">hh</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#XStart"><span class="hs-identifier hs-type">XStart</span></a></span><span> </span><span id="local-6989586621679386089"><span class="annot"><span class="annottext">X (Point (ProductForm r (Op a)))
</span><a href="#local-6989586621679386089"><span class="hs-identifier hs-var">xp</span></a></span></span><span> </span><span id="local-6989586621679386090"><span class="annot"><span class="annottext">Point (ProductForm r (Op a)) -&gt; X (ProductForm r (Op a))
</span><a href="#local-6989586621679386090"><span class="hs-identifier hs-var">xof</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">X (Point (Op (ProductForm r a)))
-&gt; (Point (Op (ProductForm r a)) -&gt; X (Op (ProductForm r a)))
-&gt; XOrtSite 'From (Op (ProductForm r a))
forall q. X (Point q) -&gt; (Point q -&gt; X q) -&gt; XOrtSite 'From q
</span><a href="OAlg.Structure.Oriented.Definition.html#XStart"><span class="hs-identifier hs-var">XStart</span></a></span><span> </span><span class="annot"><span class="annottext">X (Point (Op (ProductForm r a)))
X (Point (ProductForm r (Op a)))
</span><a href="#local-6989586621679386089"><span class="hs-identifier hs-var">xp</span></a></span><span> </span><span class="annot"><span class="annottext">Point a -&gt; X (Op (ProductForm r a))
Point (Op (ProductForm r a)) -&gt; X (Op (ProductForm r a))
</span><a href="#local-6989586621679386091"><span class="hs-identifier hs-var">xof'</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-124"></span><span>    </span><span id="local-6989586621679386091"><span class="annot"><span class="annottext">xof' :: Point a -&gt; X (Op (ProductForm r a))
</span><a href="#local-6989586621679386091"><span class="hs-identifier hs-var hs-var">xof'</span></a></span></span><span> </span><span id="local-6989586621679386092"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679386092"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">X (ProductForm r (Op a)) -&gt; X (Op (ProductForm r a))
forall r a. X (ProductForm r (Op a)) -&gt; X (Op (ProductForm r a))
</span><a href="#local-6989586621679386093"><span class="hs-identifier hs-var">ff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point (ProductForm r (Op a)) -&gt; X (ProductForm r (Op a))
</span><a href="#local-6989586621679386090"><span class="hs-identifier hs-var">xof</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
Point (ProductForm r (Op a))
</span><a href="#local-6989586621679386092"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-125"></span><span>
</span><span id="line-126"></span><span>  </span><span id="local-6989586621679385581"><span id="local-6989586621679385582"><span class="annot"><a href="#local-6989586621679386093"><span class="hs-identifier hs-type">ff</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.Data.X.html#X"><span class="hs-identifier hs-type">X</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#ProductForm"><span class="hs-identifier hs-type">ProductForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679385581"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Data.Opposite.html#Op"><span class="hs-identifier hs-type">Op</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679385582"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.X.html#X"><span class="hs-identifier hs-type">X</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Data.Opposite.html#Op"><span class="hs-identifier hs-type">Op</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#ProductForm"><span class="hs-identifier hs-type">ProductForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679385581"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679385582"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-127"></span><span>  </span><span id="local-6989586621679386093"><span class="annot"><span class="annottext">ff :: forall r a. X (ProductForm r (Op a)) -&gt; X (Op (ProductForm r a))
</span><a href="#local-6989586621679386093"><span class="hs-identifier hs-var hs-var">ff</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ProductForm r (Op a) -&gt; Op (ProductForm r a))
-&gt; X (ProductForm r (Op a)) -&gt; X (Op (ProductForm r a))
forall a b. (a -&gt; b) -&gt; X a -&gt; X b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProductForm r a -&gt; Op (ProductForm r a)
forall x. x -&gt; Op x
</span><a href="OAlg.Data.Opposite.html#Op"><span class="hs-identifier hs-var">Op</span></a></span><span> </span><span class="annot"><span class="annottext">(ProductForm r a -&gt; Op (ProductForm r a))
-&gt; (ProductForm r (Op a) -&gt; ProductForm r a)
-&gt; ProductForm r (Op a)
-&gt; Op (ProductForm r a)
forall y z x. (y -&gt; z) -&gt; (x -&gt; y) -&gt; x -&gt; z
forall (c :: * -&gt; * -&gt; *) y z x.
Category c =&gt;
c y z -&gt; c x y -&gt; c x z
</span><a href="OAlg.Category.Definition.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r (Op a) -&gt; ProductForm r a
forall r a. ProductForm r (Op a) -&gt; ProductForm r a
</span><a href="OAlg.Entity.Product.Definition.html#prfFromOp"><span class="hs-identifier hs-var">prfFromOp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-128"></span><span>
</span><span id="line-129"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-130"></span><span class="hs-comment">-- dstXStartProductFrom -</span><span>
</span><span id="line-131"></span><span>
</span><span id="line-132"></span><span class="annot"><a href="OAlg.Entity.Product.Proposition.html#dstXStartProductForm"><span class="hs-identifier hs-type">dstXStartProductForm</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-133"></span><span id="dstXStartProductForm"><span class="annot"><span class="annottext">dstXStartProductForm :: Int -&gt; N -&gt; IO ()
</span><a href="OAlg.Entity.Product.Proposition.html#dstXStartProductForm"><span class="hs-identifier hs-var hs-var">dstXStartProductForm</span></a></span></span><span> </span><span id="local-6989586621679386099"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679386099"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679386100"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679386100"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO Omega
</span><a href="OAlg.Data.X.html#getOmega"><span class="hs-identifier hs-var">getOmega</span></a></span><span> </span><span class="annot"><span class="annottext">IO Omega -&gt; (Omega -&gt; IO ()) -&gt; IO ()
forall a b. IO a -&gt; (a -&gt; IO b) -&gt; IO b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; X (N, N) -&gt; Omega -&gt; IO ()
forall x. (Show x, Ord x) =&gt; Int -&gt; X x -&gt; Omega -&gt; IO ()
</span><a href="OAlg.Data.X.html#putDistribution"><span class="hs-identifier hs-var">putDistribution</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679386099"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ProductForm Z (Orientation Symbol) -&gt; (N, N))
-&gt; X (ProductForm Z (Orientation Symbol)) -&gt; X (N, N)
forall a b. (a -&gt; b) -&gt; X a -&gt; X b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">ProductForm Z (Orientation Symbol) -&gt; (N, N)
forall {r} {a}. ProductForm r a -&gt; (N, N)
</span><a href="#local-6989586621679386103"><span class="hs-identifier hs-var">asps</span></a></span><span> </span><span class="annot"><span class="annottext">X (ProductForm Z (Orientation Symbol))
</span><a href="#local-6989586621679386104"><span class="hs-identifier hs-var">xpf</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-134"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-135"></span><span>    </span><span class="hs-comment">-- asps pf = (dpth pf,skew pf,exp pf)</span><span>
</span><span id="line-136"></span><span>    </span><span class="hs-comment">-- asps pf = start pf == E &amp;&amp; validate' (valid pf)</span><span>
</span><span id="line-137"></span><span>    </span><span id="local-6989586621679386103"><span class="annot"><span class="annottext">asps :: ProductForm r a -&gt; (N, N)
</span><a href="#local-6989586621679386103"><span class="hs-identifier hs-var hs-var">asps</span></a></span></span><span> </span><span id="local-6989586621679386105"><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679386105"><span class="hs-identifier hs-var">pf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProductForm r a -&gt; N
forall r a. ProductForm r a -&gt; N
</span><a href="OAlg.Entity.Product.Proposition.html#dpth"><span class="hs-identifier hs-var">dpth</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679386105"><span class="hs-identifier hs-var">pf</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">ProductForm r a -&gt; N
forall r a. ProductForm r a -&gt; N
</span><a href="OAlg.Entity.Product.Proposition.html#exp"><span class="hs-identifier hs-var">exp</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679386105"><span class="hs-identifier hs-var">pf</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-138"></span><span>    </span><span class="hs-comment">-- asps pf = exp pf</span><span>
</span><span id="line-139"></span><span>    </span><span class="hs-comment">-- asps pf = (dpth pf,endos pf,exp pf)</span><span>
</span><span id="line-140"></span><span>    </span><span class="hs-comment">-- asps pf = dpth pf</span><span>
</span><span id="line-141"></span><span>  </span><span>
</span><span id="line-142"></span><span>    </span><span id="local-6989586621679386104"><span class="annot"><span class="annottext">xpf :: X (ProductForm Z (Orientation Symbol))
</span><a href="#local-6989586621679386104"><span class="hs-identifier hs-var hs-var">xpf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XOrtSite 'From (ProductForm Z (Orientation Symbol))
-&gt; Point (ProductForm Z (Orientation Symbol))
-&gt; X (ProductForm Z (Orientation Symbol))
forall q. XOrtSite 'From q -&gt; Point q -&gt; X q
</span><a href="OAlg.Structure.Oriented.Definition.html#xosStart"><span class="hs-identifier hs-var">xosStart</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XOrtSite 'From (Orientation Symbol)
-&gt; X Z -&gt; N -&gt; XOrtSite 'From (ProductForm Z (Orientation Symbol))
forall a r.
(Oriented a, Number r) =&gt;
XOrtSite 'From a -&gt; X r -&gt; N -&gt; XOrtSite 'From (ProductForm r a)
</span><a href="OAlg.Entity.Product.Proposition.html#xStartProductForm"><span class="hs-identifier hs-var">xStartProductForm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">X Symbol -&gt; XOrtSite 'From (Orientation Symbol)
forall p. X p -&gt; XOrtSite 'From (Orientation p)
</span><a href="OAlg.Structure.Oriented.Definition.html#xStartOrnt"><span class="hs-identifier hs-var">xStartOrnt</span></a></span><span> </span><span class="annot"><span class="annottext">X Symbol
</span><a href="OAlg.Data.Symbol.html#xSymbol"><span class="hs-identifier hs-var">xSymbol</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">X Z
</span><a href="#local-6989586621679386111"><span class="hs-identifier hs-var">xr</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679386100"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Symbol
Point (ProductForm Z (Orientation Symbol))
</span><a href="OAlg.Data.Symbol.html#E"><span class="hs-identifier hs-var">E</span></a></span><span>
</span><span id="line-143"></span><span>  </span><span>
</span><span id="line-144"></span><span>    </span><span id="local-6989586621679386111"><span class="annot"><span class="annottext">xr :: X Z
</span><a href="#local-6989586621679386111"><span class="hs-identifier hs-var hs-var">xr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Z -&gt; Z -&gt; X Z
</span><a href="OAlg.Data.X.html#xZB"><span class="hs-identifier hs-var">xZB</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Z
</span><span class="hs-number">10</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Z
</span><span class="hs-number">10</span></span><span>
</span><span id="line-145"></span><span>
</span><span id="line-146"></span><span id="local-6989586621679385595"><span id="local-6989586621679385596"><span class="annot"><a href="OAlg.Entity.Product.Proposition.html#dpth"><span class="hs-identifier hs-type">dpth</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#ProductForm"><span class="hs-identifier hs-type">ProductForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679385595"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679385596"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span></span></span><span>
</span><span id="line-147"></span><span id="dpth"><span class="annot"><span class="annottext">dpth :: forall r a. ProductForm r a -&gt; N
</span><a href="OAlg.Entity.Product.Proposition.html#dpth"><span class="hs-identifier hs-var hs-var">dpth</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#One"><span class="hs-identifier hs-type">One</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span>
</span><span id="line-148"></span><span class="annot"><a href="OAlg.Entity.Product.Proposition.html#dpth"><span class="hs-identifier hs-var">dpth</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">1</span></span><span>
</span><span id="line-149"></span><span class="annot"><a href="OAlg.Entity.Product.Proposition.html#dpth"><span class="hs-identifier hs-var">dpth</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679386123"><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679386123"><span class="hs-identifier hs-var">f</span></a></span></span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#%3A%5E"><span class="hs-operator hs-type">:^</span></a></span><span class="annot"><span class="annottext">r
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProductForm r a -&gt; N
forall r a. ProductForm r a -&gt; N
</span><a href="OAlg.Entity.Product.Proposition.html#dpth"><span class="hs-identifier hs-var">dpth</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679386123"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-150"></span><span class="annot"><a href="OAlg.Entity.Product.Proposition.html#dpth"><span class="hs-identifier hs-var">dpth</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679386124"><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679386124"><span class="hs-identifier hs-var">f</span></a></span></span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#%3A%2A"><span class="hs-operator hs-type">:*</span></a></span><span id="local-6989586621679386125"><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679386125"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; N
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProductForm r a -&gt; N
forall r a. ProductForm r a -&gt; N
</span><a href="OAlg.Entity.Product.Proposition.html#dpth"><span class="hs-identifier hs-var">dpth</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679386124"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProductForm r a -&gt; N
forall r a. ProductForm r a -&gt; N
</span><a href="OAlg.Entity.Product.Proposition.html#dpth"><span class="hs-identifier hs-var">dpth</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679386125"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; N
forall a. Additive a =&gt; a -&gt; a -&gt; a
</span><a href="OAlg.Structure.Additive.Definition.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">1</span></span><span>
</span><span id="line-151"></span><span>  </span><span>
</span><span id="line-152"></span><span id="local-6989586621679385601"><span id="local-6989586621679385602"><span class="annot"><a href="OAlg.Entity.Product.Proposition.html#skew"><span class="hs-identifier hs-type">skew</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#ProductForm"><span class="hs-identifier hs-type">ProductForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679385601"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679385602"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#Z"><span class="hs-identifier hs-type">Z</span></a></span></span></span><span>
</span><span id="line-153"></span><span id="skew"><span class="annot"><span class="annottext">skew :: forall r a. ProductForm r a -&gt; Z
</span><a href="OAlg.Entity.Product.Proposition.html#skew"><span class="hs-identifier hs-var hs-var">skew</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#One"><span class="hs-identifier hs-type">One</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Z
</span><span class="hs-number">0</span></span><span>
</span><span id="line-154"></span><span class="annot"><a href="OAlg.Entity.Product.Proposition.html#skew"><span class="hs-identifier hs-var">skew</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Z
</span><span class="hs-number">1</span></span><span>
</span><span id="line-155"></span><span class="annot"><a href="OAlg.Entity.Product.Proposition.html#skew"><span class="hs-identifier hs-var">skew</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679386132"><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679386132"><span class="hs-identifier hs-var">f</span></a></span></span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#%3A%5E"><span class="hs-operator hs-type">:^</span></a></span><span class="annot"><span class="annottext">r
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProductForm r a -&gt; Z
forall r a. ProductForm r a -&gt; Z
</span><a href="OAlg.Entity.Product.Proposition.html#skew"><span class="hs-identifier hs-var">skew</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679386132"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-156"></span><span class="annot"><a href="OAlg.Entity.Product.Proposition.html#skew"><span class="hs-identifier hs-var">skew</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679386133"><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679386133"><span class="hs-identifier hs-var">f</span></a></span></span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#%3A%2A"><span class="hs-operator hs-type">:*</span></a></span><span id="local-6989586621679386134"><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679386134"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProductForm r a -&gt; Z
forall r a. ProductForm r a -&gt; Z
</span><a href="OAlg.Entity.Product.Proposition.html#skew"><span class="hs-identifier hs-var">skew</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679386134"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Z -&gt; Z -&gt; Z
forall a. Abelian a =&gt; a -&gt; a -&gt; a
</span><a href="OAlg.Structure.Additive.Definition.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r a -&gt; Z
forall r a. ProductForm r a -&gt; Z
</span><a href="OAlg.Entity.Product.Proposition.html#skew"><span class="hs-identifier hs-var">skew</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679386133"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-157"></span><span>  </span><span>
</span><span id="line-158"></span><span id="local-6989586621679386136"><span id="local-6989586621679386137"><span class="annot"><a href="OAlg.Entity.Product.Proposition.html#exp"><span class="hs-identifier hs-type">exp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#ProductForm"><span class="hs-identifier hs-type">ProductForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679386136"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679386137"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span></span></span><span>
</span><span id="line-159"></span><span id="exp"><span class="annot"><span class="annottext">exp :: forall r a. ProductForm r a -&gt; N
</span><a href="OAlg.Entity.Product.Proposition.html#exp"><span class="hs-identifier hs-var hs-var">exp</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679386142"><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679386142"><span class="hs-identifier hs-var">f</span></a></span></span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#%3A%5E"><span class="hs-operator hs-type">:^</span></a></span><span class="annot"><span class="annottext">r
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProductForm r a -&gt; N
forall r a. ProductForm r a -&gt; N
</span><a href="OAlg.Entity.Product.Proposition.html#exp"><span class="hs-identifier hs-var">exp</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679386142"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; N
forall a. Additive a =&gt; a -&gt; a -&gt; a
</span><a href="OAlg.Structure.Additive.Definition.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">1</span></span><span>
</span><span id="line-160"></span><span class="annot"><a href="OAlg.Entity.Product.Proposition.html#exp"><span class="hs-identifier hs-var">exp</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679386143"><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679386143"><span class="hs-identifier hs-var">f</span></a></span></span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#%3A%2A"><span class="hs-operator hs-type">:*</span></a></span><span id="local-6989586621679386144"><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679386144"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProductForm r a -&gt; N
forall r a. ProductForm r a -&gt; N
</span><a href="OAlg.Entity.Product.Proposition.html#exp"><span class="hs-identifier hs-var">exp</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679386143"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; N
forall a. Additive a =&gt; a -&gt; a -&gt; a
</span><a href="OAlg.Structure.Additive.Definition.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r a -&gt; N
forall r a. ProductForm r a -&gt; N
</span><a href="OAlg.Entity.Product.Proposition.html#exp"><span class="hs-identifier hs-var">exp</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679386144"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-161"></span><span class="annot"><a href="OAlg.Entity.Product.Proposition.html#exp"><span class="hs-identifier hs-var">exp</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r a
</span><span class="hs-identifier">_</span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span>
</span><span id="line-162"></span><span class="hs-comment">{-
true1 True = 1
true1 _    = 0

endos :: (Oriented a, Number r) =&gt; ProductForm r a -&gt; N
endos (One _) = 1
endos (P a)   = true1 $ isEndo a
endos (f:^_)  = endos f
endos (f:*g)  = endos f + endos g + true1 (isEndo (f:*g))
-}</span><span>
</span><span id="line-172"></span><span>
</span><span id="line-173"></span><span>
</span><span id="line-174"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-175"></span><span class="hs-comment">-- xStartProduct -</span><span>
</span><span id="line-176"></span><span>
</span><span id="line-177"></span><span class="hs-comment">-- | random variable of products generated from product forms with a maximal given /depth/</span><span>
</span><span id="line-178"></span><span class="hs-comment">-- (':^' dose not increases the depth).</span><span>
</span><span id="line-179"></span><span id="local-6989586621679385609"><span id="local-6989586621679385610"><span class="annot"><a href="OAlg.Entity.Product.Proposition.html#xStartProduct"><span class="hs-identifier hs-type">xStartProduct</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#Oriented"><span class="hs-identifier hs-type">Oriented</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679385609"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Integral"><span class="hs-identifier hs-type">Integral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679385610"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#XOrtSite"><span class="hs-identifier hs-type">XOrtSite</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Dualisable.html#From"><span class="hs-identifier hs-type">From</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679385609"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.X.html#X"><span class="hs-identifier hs-type">X</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679385610"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-180"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#XOrtSite"><span class="hs-identifier hs-type">XOrtSite</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Dualisable.html#From"><span class="hs-identifier hs-type">From</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#Product"><span class="hs-identifier hs-type">Product</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679385610"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679385609"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-181"></span><span id="xStartProduct"><span class="annot"><span class="annottext">xStartProduct :: forall a r.
(Oriented a, Integral r) =&gt;
XOrtSite 'From a -&gt; X r -&gt; N -&gt; XOrtSite 'From (Product r a)
</span><a href="OAlg.Entity.Product.Proposition.html#xStartProduct"><span class="hs-identifier hs-var hs-var">xStartProduct</span></a></span></span><span> </span><span id="local-6989586621679386155"><span class="annot"><span class="annottext">XOrtSite 'From a
</span><a href="#local-6989586621679386155"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621679386156"><span class="annot"><span class="annottext">X r
</span><a href="#local-6989586621679386156"><span class="hs-identifier hs-var">xr</span></a></span></span><span> </span><span id="local-6989586621679386157"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679386157"><span class="hs-identifier hs-var">d</span></a></span></span><span>
</span><span id="line-182"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">X (Point (Product r a))
-&gt; (Point (Product r a) -&gt; X (Product r a))
-&gt; XOrtSite 'From (Product r a)
forall q. X (Point q) -&gt; (Point q -&gt; X q) -&gt; XOrtSite 'From q
</span><a href="OAlg.Structure.Oriented.Definition.html#XStart"><span class="hs-identifier hs-var">XStart</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XOrtSite 'From a -&gt; X (Point a)
forall (s :: Site) q. XOrtSite s q -&gt; X (Point q)
</span><a href="OAlg.Structure.Oriented.Proposition.html#xosPoint"><span class="hs-identifier hs-var">xosPoint</span></a></span><span> </span><span class="annot"><span class="annottext">XOrtSite 'From a
</span><a href="#local-6989586621679386155"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Point a -&gt; X (ProductForm r a)) -&gt; Point a -&gt; X (Product r a)
forall a r.
(Oriented a, Integral r) =&gt;
(Point a -&gt; X (ProductForm r a)) -&gt; Point a -&gt; X (Product r a)
</span><a href="#local-6989586621679386159"><span class="hs-identifier hs-var">xPrd</span></a></span><span> </span><span class="annot"><span class="annottext">((Point a -&gt; X (ProductForm r a)) -&gt; Point a -&gt; X (Product r a))
-&gt; (Point a -&gt; X (ProductForm r a)) -&gt; Point a -&gt; X (Product r a)
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><a href="OAlg.Category.Applicative.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">XOrtSite 'From (ProductForm r a) -&gt; Point a -&gt; X (ProductForm r a)
XOrtSite 'From (ProductForm r a)
-&gt; Point (ProductForm r a) -&gt; X (ProductForm r a)
forall q. XOrtSite 'From q -&gt; Point q -&gt; X q
</span><a href="OAlg.Structure.Oriented.Definition.html#xosStart"><span class="hs-identifier hs-var">xosStart</span></a></span><span> </span><span class="annot"><span class="annottext">(XOrtSite 'From (ProductForm r a)
 -&gt; Point a -&gt; X (ProductForm r a))
-&gt; XOrtSite 'From (ProductForm r a)
-&gt; Point a
-&gt; X (ProductForm r a)
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><a href="OAlg.Category.Applicative.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">XOrtSite 'From a -&gt; X r -&gt; N -&gt; XOrtSite 'From (ProductForm r a)
forall a r.
(Oriented a, Number r) =&gt;
XOrtSite 'From a -&gt; X r -&gt; N -&gt; XOrtSite 'From (ProductForm r a)
</span><a href="OAlg.Entity.Product.Proposition.html#xStartProductForm"><span class="hs-identifier hs-var">xStartProductForm</span></a></span><span> </span><span class="annot"><span class="annottext">XOrtSite 'From a
</span><a href="#local-6989586621679386155"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">X r
</span><a href="#local-6989586621679386156"><span class="hs-identifier hs-var">xr</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679386157"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-183"></span><span>    </span><span id="local-6989586621679385616"><span id="local-6989586621679385617"><span class="annot"><a href="#local-6989586621679386159"><span class="hs-identifier hs-type">xPrd</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#Oriented"><span class="hs-identifier hs-type">Oriented</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679385616"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Integral"><span class="hs-identifier hs-type">Integral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679385617"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-184"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679385616"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.X.html#X"><span class="hs-identifier hs-type">X</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#ProductForm"><span class="hs-identifier hs-type">ProductForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679385617"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679385616"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-185"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679385616"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.X.html#X"><span class="hs-identifier hs-type">X</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#Product"><span class="hs-identifier hs-type">Product</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679385617"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679385616"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-186"></span><span>    </span><span id="local-6989586621679386159"><span class="annot"><span class="annottext">xPrd :: forall a r.
(Oriented a, Integral r) =&gt;
(Point a -&gt; X (ProductForm r a)) -&gt; Point a -&gt; X (Product r a)
</span><a href="#local-6989586621679386159"><span class="hs-identifier hs-var hs-var">xPrd</span></a></span></span><span> </span><span id="local-6989586621679386166"><span class="annot"><span class="annottext">Point a -&gt; X (ProductForm r a)
</span><a href="#local-6989586621679386166"><span class="hs-identifier hs-var">ixpf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ProductForm r a -&gt; Product r a)
-&gt; X (ProductForm r a) -&gt; X (Product r a)
forall a b. (a -&gt; b) -&gt; X a -&gt; X b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Form (Product r a) -&gt; Product r a
ProductForm r a -&gt; Product r a
forall x. Constructable x =&gt; Form x -&gt; x
</span><a href="OAlg.Data.Constructable.html#make"><span class="hs-identifier hs-var">make</span></a></span><span> </span><span class="annot"><span class="annottext">(X (ProductForm r a) -&gt; X (Product r a))
-&gt; (Point a -&gt; X (ProductForm r a)) -&gt; Point a -&gt; X (Product r a)
forall y z x. (y -&gt; z) -&gt; (x -&gt; y) -&gt; x -&gt; z
forall (c :: * -&gt; * -&gt; *) y z x.
Category c =&gt;
c y z -&gt; c x y -&gt; c x z
</span><a href="OAlg.Category.Definition.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Point a -&gt; X (ProductForm r a)
</span><a href="#local-6989586621679386166"><span class="hs-identifier hs-var">ixpf</span></a></span><span>
</span><span id="line-187"></span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-190"></span><span class="hs-comment">-- xEndProduct -</span><span>
</span><span id="line-191"></span><span>
</span><span id="line-192"></span><span class="hs-comment">-- | random variable of products generated from product forms with a maximal given /depth/</span><span>
</span><span id="line-193"></span><span class="hs-comment">-- (':^' dose not increases the depth).</span><span>
</span><span id="line-194"></span><span id="local-6989586621679385624"><span id="local-6989586621679385625"><span class="annot"><a href="OAlg.Entity.Product.Proposition.html#xEndProduct"><span class="hs-identifier hs-type">xEndProduct</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#Oriented"><span class="hs-identifier hs-type">Oriented</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679385624"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Integral"><span class="hs-identifier hs-type">Integral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679385625"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#XOrtSite"><span class="hs-identifier hs-type">XOrtSite</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Dualisable.html#To"><span class="hs-identifier hs-type">To</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679385624"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.X.html#X"><span class="hs-identifier hs-type">X</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679385625"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-195"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#XOrtSite"><span class="hs-identifier hs-type">XOrtSite</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Dualisable.html#To"><span class="hs-identifier hs-type">To</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#Product"><span class="hs-identifier hs-type">Product</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679385625"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679385624"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-196"></span><span id="xEndProduct"><span class="annot"><span class="annottext">xEndProduct :: forall a r.
(Oriented a, Integral r) =&gt;
XOrtSite 'To a -&gt; X r -&gt; N -&gt; XOrtSite 'To (Product r a)
</span><a href="OAlg.Entity.Product.Proposition.html#xEndProduct"><span class="hs-identifier hs-var hs-var">xEndProduct</span></a></span></span><span> </span><span id="local-6989586621679386178"><span class="annot"><span class="annottext">XOrtSite 'To a
</span><a href="#local-6989586621679386178"><span class="hs-identifier hs-var">xe</span></a></span></span><span> </span><span id="local-6989586621679386179"><span class="annot"><span class="annottext">X r
</span><a href="#local-6989586621679386179"><span class="hs-identifier hs-var">xr</span></a></span></span><span> </span><span id="local-6989586621679386180"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679386180"><span class="hs-identifier hs-var">d</span></a></span></span><span>
</span><span id="line-197"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">X (Point (Product r a))
-&gt; (Point (Product r a) -&gt; X (Product r a))
-&gt; XOrtSite 'To (Product r a)
forall q. X (Point q) -&gt; (Point q -&gt; X q) -&gt; XOrtSite 'To q
</span><a href="OAlg.Structure.Oriented.Definition.html#XEnd"><span class="hs-identifier hs-var">XEnd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XOrtSite 'To a -&gt; X (Point a)
forall (s :: Site) q. XOrtSite s q -&gt; X (Point q)
</span><a href="OAlg.Structure.Oriented.Proposition.html#xosPoint"><span class="hs-identifier hs-var">xosPoint</span></a></span><span> </span><span class="annot"><span class="annottext">XOrtSite 'To a
</span><a href="#local-6989586621679386178"><span class="hs-identifier hs-var">xe</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Point a -&gt; X (ProductForm r a)) -&gt; Point a -&gt; X (Product r a)
forall a r.
(Oriented a, Integral r) =&gt;
(Point a -&gt; X (ProductForm r a)) -&gt; Point a -&gt; X (Product r a)
</span><a href="#local-6989586621679386182"><span class="hs-identifier hs-var">xPrd</span></a></span><span> </span><span class="annot"><span class="annottext">((Point a -&gt; X (ProductForm r a)) -&gt; Point a -&gt; X (Product r a))
-&gt; (Point a -&gt; X (ProductForm r a)) -&gt; Point a -&gt; X (Product r a)
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><a href="OAlg.Category.Applicative.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">XOrtSite 'To (ProductForm r a) -&gt; Point a -&gt; X (ProductForm r a)
XOrtSite 'To (ProductForm r a)
-&gt; Point (ProductForm r a) -&gt; X (ProductForm r a)
forall q. XOrtSite 'To q -&gt; Point q -&gt; X q
</span><a href="OAlg.Structure.Oriented.Definition.html#xosEnd"><span class="hs-identifier hs-var">xosEnd</span></a></span><span> </span><span class="annot"><span class="annottext">(XOrtSite 'To (ProductForm r a) -&gt; Point a -&gt; X (ProductForm r a))
-&gt; XOrtSite 'To (ProductForm r a) -&gt; Point a -&gt; X (ProductForm r a)
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><a href="OAlg.Category.Applicative.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">XOrtSite 'To a -&gt; X r -&gt; N -&gt; XOrtSite 'To (ProductForm r a)
forall a r.
(Oriented a, Number r) =&gt;
XOrtSite 'To a -&gt; X r -&gt; N -&gt; XOrtSite 'To (ProductForm r a)
</span><a href="OAlg.Entity.Product.Proposition.html#xEndProductForm"><span class="hs-identifier hs-var">xEndProductForm</span></a></span><span> </span><span class="annot"><span class="annottext">XOrtSite 'To a
</span><a href="#local-6989586621679386178"><span class="hs-identifier hs-var">xe</span></a></span><span> </span><span class="annot"><span class="annottext">X r
</span><a href="#local-6989586621679386179"><span class="hs-identifier hs-var">xr</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679386180"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-198"></span><span>    </span><span id="local-6989586621679386184"><span id="local-6989586621679386185"><span class="annot"><a href="#local-6989586621679386182"><span class="hs-identifier hs-type">xPrd</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#Oriented"><span class="hs-identifier hs-type">Oriented</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679386184"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Integral"><span class="hs-identifier hs-type">Integral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679386185"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-199"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679386184"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.X.html#X"><span class="hs-identifier hs-type">X</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#ProductForm"><span class="hs-identifier hs-type">ProductForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679386185"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679386184"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-200"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679386184"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.X.html#X"><span class="hs-identifier hs-type">X</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#Product"><span class="hs-identifier hs-type">Product</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679386185"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679386184"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-201"></span><span>    </span><span id="local-6989586621679386182"><span class="annot"><span class="annottext">xPrd :: forall a r.
(Oriented a, Integral r) =&gt;
(Point a -&gt; X (ProductForm r a)) -&gt; Point a -&gt; X (Product r a)
</span><a href="#local-6989586621679386182"><span class="hs-identifier hs-var hs-var">xPrd</span></a></span></span><span> </span><span id="local-6989586621679386191"><span class="annot"><span class="annottext">Point a -&gt; X (ProductForm r a)
</span><a href="#local-6989586621679386191"><span class="hs-identifier hs-var">ixpf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ProductForm r a -&gt; Product r a)
-&gt; X (ProductForm r a) -&gt; X (Product r a)
forall a b. (a -&gt; b) -&gt; X a -&gt; X b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Form (Product r a) -&gt; Product r a
ProductForm r a -&gt; Product r a
forall x. Constructable x =&gt; Form x -&gt; x
</span><a href="OAlg.Data.Constructable.html#make"><span class="hs-identifier hs-var">make</span></a></span><span> </span><span class="annot"><span class="annottext">(X (ProductForm r a) -&gt; X (Product r a))
-&gt; (Point a -&gt; X (ProductForm r a)) -&gt; Point a -&gt; X (Product r a)
forall y z x. (y -&gt; z) -&gt; (x -&gt; y) -&gt; x -&gt; z
forall (c :: * -&gt; * -&gt; *) y z x.
Category c =&gt;
c y z -&gt; c x y -&gt; c x z
</span><a href="OAlg.Category.Definition.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Point a -&gt; X (ProductForm r a)
</span><a href="#local-6989586621679386191"><span class="hs-identifier hs-var">ixpf</span></a></span><span>
</span><span id="line-202"></span><span>
</span><span id="line-203"></span><span>
</span><span id="line-204"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-205"></span><span class="hs-comment">-- dstXStartProduct -</span><span>
</span><span id="line-206"></span><span>
</span><span id="line-207"></span><span class="annot"><a href="OAlg.Entity.Product.Proposition.html#dstXStartProduct"><span class="hs-identifier hs-type">dstXStartProduct</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-208"></span><span id="dstXStartProduct"><span class="annot"><span class="annottext">dstXStartProduct :: Int -&gt; N -&gt; IO ()
</span><a href="OAlg.Entity.Product.Proposition.html#dstXStartProduct"><span class="hs-identifier hs-var hs-var">dstXStartProduct</span></a></span></span><span> </span><span id="local-6989586621679386193"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679386193"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679386194"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679386194"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO Omega
</span><a href="OAlg.Data.X.html#getOmega"><span class="hs-identifier hs-var">getOmega</span></a></span><span> </span><span class="annot"><span class="annottext">IO Omega -&gt; (Omega -&gt; IO ()) -&gt; IO ()
forall a b. IO a -&gt; (a -&gt; IO b) -&gt; IO b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; X (N, N) -&gt; Omega -&gt; IO ()
forall x. (Show x, Ord x) =&gt; Int -&gt; X x -&gt; Omega -&gt; IO ()
</span><a href="OAlg.Data.X.html#putDistribution"><span class="hs-identifier hs-var">putDistribution</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679386193"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Product Z (Orientation Symbol) -&gt; (N, N))
-&gt; X (Product Z (Orientation Symbol)) -&gt; X (N, N)
forall a b. (a -&gt; b) -&gt; X a -&gt; X b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Product Z (Orientation Symbol) -&gt; (N, N)
forall {x} {r} {a}.
(Form x ~ ProductForm r a, Exposable x) =&gt;
x -&gt; (N, N)
</span><a href="#local-6989586621679386195"><span class="hs-identifier hs-var">asps</span></a></span><span> </span><span class="annot"><span class="annottext">X (Product Z (Orientation Symbol))
</span><a href="#local-6989586621679386196"><span class="hs-identifier hs-var">xprd</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-209"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-210"></span><span>    </span><span class="hs-comment">-- asps pf = (dpth pf,skew pf,exp pf)</span><span>
</span><span id="line-211"></span><span>    </span><span class="hs-comment">-- asps pf = </span><span>
</span><span id="line-212"></span><span>    </span><span class="hs-comment">-- asps pf = (dpth pf,exp pf)</span><span>
</span><span id="line-213"></span><span>    </span><span class="hs-comment">-- asps pf = exp pf</span><span>
</span><span id="line-214"></span><span>    </span><span>
</span><span id="line-215"></span><span>    </span><span class="hs-comment">-- asps (Just p) = start p == 'e' &amp;&amp; validate' (valid p)</span><span>
</span><span id="line-216"></span><span>    </span><span id="local-6989586621679386195"><span class="annot"><span class="annottext">asps :: x -&gt; (N, N)
</span><a href="#local-6989586621679386195"><span class="hs-identifier hs-var hs-var">asps</span></a></span></span><span> </span><span id="local-6989586621679386202"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679386202"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Form x -&gt; N) -&gt; x -&gt; N
forall x y. Exposable x =&gt; (Form x -&gt; y) -&gt; x -&gt; y
</span><a href="OAlg.Data.Constructable.html#restrict"><span class="hs-identifier hs-var">restrict</span></a></span><span> </span><span class="annot"><span class="annottext">Form x -&gt; N
ProductForm r a -&gt; N
forall r a. ProductForm r a -&gt; N
</span><a href="OAlg.Entity.Product.Proposition.html#dpth"><span class="hs-identifier hs-var">dpth</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679386202"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">(Form x -&gt; N) -&gt; x -&gt; N
forall x y. Exposable x =&gt; (Form x -&gt; y) -&gt; x -&gt; y
</span><a href="OAlg.Data.Constructable.html#restrict"><span class="hs-identifier hs-var">restrict</span></a></span><span> </span><span class="annot"><span class="annottext">Form x -&gt; N
ProductForm r a -&gt; N
forall r a. ProductForm r a -&gt; N
</span><a href="OAlg.Entity.Product.Proposition.html#exp"><span class="hs-identifier hs-var">exp</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679386202"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-217"></span><span>    </span><span>
</span><span id="line-218"></span><span>    </span><span id="local-6989586621679386196"><span class="annot"><span class="annottext">xprd :: X (Product Z (Orientation Symbol))
</span><a href="#local-6989586621679386196"><span class="hs-identifier hs-var hs-var">xprd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XOrtSite 'From (Product Z (Orientation Symbol))
-&gt; Point (Product Z (Orientation Symbol))
-&gt; X (Product Z (Orientation Symbol))
forall q. XOrtSite 'From q -&gt; Point q -&gt; X q
</span><a href="OAlg.Structure.Oriented.Definition.html#xosStart"><span class="hs-identifier hs-var">xosStart</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XOrtSite 'From (Orientation Symbol)
-&gt; X Z -&gt; N -&gt; XOrtSite 'From (Product Z (Orientation Symbol))
forall a r.
(Oriented a, Integral r) =&gt;
XOrtSite 'From a -&gt; X r -&gt; N -&gt; XOrtSite 'From (Product r a)
</span><a href="OAlg.Entity.Product.Proposition.html#xStartProduct"><span class="hs-identifier hs-var">xStartProduct</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">X Symbol -&gt; XOrtSite 'From (Orientation Symbol)
forall p. X p -&gt; XOrtSite 'From (Orientation p)
</span><a href="OAlg.Structure.Oriented.Definition.html#xStartOrnt"><span class="hs-identifier hs-var">xStartOrnt</span></a></span><span> </span><span class="annot"><span class="annottext">X Symbol
</span><a href="OAlg.Data.Symbol.html#xSymbol"><span class="hs-identifier hs-var">xSymbol</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">X Z
</span><a href="#local-6989586621679386204"><span class="hs-identifier hs-var">xr</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679386194"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Symbol
Point (Product Z (Orientation Symbol))
</span><a href="OAlg.Data.Symbol.html#E"><span class="hs-identifier hs-var">E</span></a></span><span>
</span><span id="line-219"></span><span>    </span><span class="hs-comment">-- xprd = xStartProduct (XStart xPthChar) xr d</span><span>
</span><span id="line-220"></span><span>  </span><span>
</span><span id="line-221"></span><span>    </span><span id="local-6989586621679386204"><span class="annot"><span class="annottext">xr :: X Z
</span><a href="#local-6989586621679386204"><span class="hs-identifier hs-var hs-var">xr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Z -&gt; Z -&gt; X Z
</span><a href="OAlg.Data.X.html#xZB"><span class="hs-identifier hs-var">xZB</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Z
</span><span class="hs-number">10</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Z
</span><span class="hs-number">10</span></span><span>
</span><span id="line-222"></span><span>
</span><span id="line-223"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-224"></span><span class="hs-comment">-- dstXEndProduct -</span><span>
</span><span id="line-225"></span><span>
</span><span id="line-226"></span><span class="annot"><a href="OAlg.Entity.Product.Proposition.html#dstXEndProduct"><span class="hs-identifier hs-type">dstXEndProduct</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-227"></span><span id="dstXEndProduct"><span class="annot"><span class="annottext">dstXEndProduct :: Int -&gt; N -&gt; IO ()
</span><a href="OAlg.Entity.Product.Proposition.html#dstXEndProduct"><span class="hs-identifier hs-var hs-var">dstXEndProduct</span></a></span></span><span> </span><span id="local-6989586621679386209"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679386209"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679386210"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679386210"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO Omega
</span><a href="OAlg.Data.X.html#getOmega"><span class="hs-identifier hs-var">getOmega</span></a></span><span> </span><span class="annot"><span class="annottext">IO Omega -&gt; (Omega -&gt; IO ()) -&gt; IO ()
forall a b. IO a -&gt; (a -&gt; IO b) -&gt; IO b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; X (N, N, Bool) -&gt; Omega -&gt; IO ()
forall x. (Show x, Ord x) =&gt; Int -&gt; X x -&gt; Omega -&gt; IO ()
</span><a href="OAlg.Data.X.html#putDistribution"><span class="hs-identifier hs-var">putDistribution</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679386209"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Product Z (Orientation Symbol) -&gt; (N, N, Bool))
-&gt; X (Product Z (Orientation Symbol)) -&gt; X (N, N, Bool)
forall a b. (a -&gt; b) -&gt; X a -&gt; X b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Product Z (Orientation Symbol) -&gt; (N, N, Bool)
forall {a} {r} {a}.
(Form a ~ ProductForm r a, Exposable a, Validable a) =&gt;
a -&gt; (N, N, Bool)
</span><a href="#local-6989586621679386211"><span class="hs-identifier hs-var">asps</span></a></span><span> </span><span class="annot"><span class="annottext">X (Product Z (Orientation Symbol))
</span><a href="#local-6989586621679386212"><span class="hs-identifier hs-var">xprd</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-228"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-229"></span><span>    </span><span class="hs-comment">-- asps pf = (dpth pf,skew pf,exp pf)</span><span>
</span><span id="line-230"></span><span>    </span><span class="hs-comment">-- asps pf = </span><span>
</span><span id="line-231"></span><span>    </span><span class="hs-comment">-- asps pf = (dpth pf,exp pf)</span><span>
</span><span id="line-232"></span><span>    </span><span class="hs-comment">-- asps pf = exp pf</span><span>
</span><span id="line-233"></span><span>    </span><span>
</span><span id="line-234"></span><span>    </span><span class="hs-comment">-- asps (Just p) = start p == 'e' &amp;&amp; validate' (valid p)</span><span>
</span><span id="line-235"></span><span>    </span><span id="local-6989586621679386211"><span class="annot"><span class="annottext">asps :: a -&gt; (N, N, Bool)
</span><a href="#local-6989586621679386211"><span class="hs-identifier hs-var hs-var">asps</span></a></span></span><span> </span><span id="local-6989586621679386220"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679386220"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Form a -&gt; N) -&gt; a -&gt; N
forall x y. Exposable x =&gt; (Form x -&gt; y) -&gt; x -&gt; y
</span><a href="OAlg.Data.Constructable.html#restrict"><span class="hs-identifier hs-var">restrict</span></a></span><span> </span><span class="annot"><span class="annottext">Form a -&gt; N
ProductForm r a -&gt; N
forall r a. ProductForm r a -&gt; N
</span><a href="OAlg.Entity.Product.Proposition.html#dpth"><span class="hs-identifier hs-var">dpth</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679386220"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">(Form a -&gt; N) -&gt; a -&gt; N
forall x y. Exposable x =&gt; (Form x -&gt; y) -&gt; x -&gt; y
</span><a href="OAlg.Data.Constructable.html#restrict"><span class="hs-identifier hs-var">restrict</span></a></span><span> </span><span class="annot"><span class="annottext">Form a -&gt; N
ProductForm r a -&gt; N
forall r a. ProductForm r a -&gt; N
</span><a href="OAlg.Entity.Product.Proposition.html#exp"><span class="hs-identifier hs-var">exp</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679386220"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Statement -&gt; Bool
</span><a href="OAlg.Control.Validate.html#validate%27"><span class="hs-identifier hs-var">validate'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Statement
forall a. Validable a =&gt; a -&gt; Statement
</span><a href="OAlg.Data.Validable.html#valid"><span class="hs-identifier hs-var">valid</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679386220"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-236"></span><span>    </span><span>
</span><span id="line-237"></span><span>    </span><span id="local-6989586621679386212"><span class="annot"><span class="annottext">xprd :: X (Product Z (Orientation Symbol))
</span><a href="#local-6989586621679386212"><span class="hs-identifier hs-var hs-var">xprd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XOrtSite 'To (Product Z (Orientation Symbol))
-&gt; Point (Product Z (Orientation Symbol))
-&gt; X (Product Z (Orientation Symbol))
forall q. XOrtSite 'To q -&gt; Point q -&gt; X q
</span><a href="OAlg.Structure.Oriented.Definition.html#xosEnd"><span class="hs-identifier hs-var">xosEnd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XOrtSite 'To (Orientation Symbol)
-&gt; X Z -&gt; N -&gt; XOrtSite 'To (Product Z (Orientation Symbol))
forall a r.
(Oriented a, Integral r) =&gt;
XOrtSite 'To a -&gt; X r -&gt; N -&gt; XOrtSite 'To (Product r a)
</span><a href="OAlg.Entity.Product.Proposition.html#xEndProduct"><span class="hs-identifier hs-var">xEndProduct</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">X Symbol -&gt; XOrtSite 'To (Orientation Symbol)
forall p. X p -&gt; XOrtSite 'To (Orientation p)
</span><a href="OAlg.Structure.Oriented.Definition.html#xEndOrnt"><span class="hs-identifier hs-var">xEndOrnt</span></a></span><span> </span><span class="annot"><span class="annottext">X Symbol
</span><a href="OAlg.Data.Symbol.html#xSymbol"><span class="hs-identifier hs-var">xSymbol</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">X Z
</span><a href="#local-6989586621679386224"><span class="hs-identifier hs-var">xr</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679386210"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Symbol
Point (Product Z (Orientation Symbol))
</span><a href="OAlg.Data.Symbol.html#E"><span class="hs-identifier hs-var">E</span></a></span><span>
</span><span id="line-238"></span><span>    </span><span class="hs-comment">-- xprd = xEndProduct (XEnd xPthChar) xr d</span><span>
</span><span id="line-239"></span><span>  </span><span>
</span><span id="line-240"></span><span>    </span><span id="local-6989586621679386224"><span class="annot"><span class="annottext">xr :: X Z
</span><a href="#local-6989586621679386224"><span class="hs-identifier hs-var hs-var">xr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Z -&gt; Z -&gt; X Z
</span><a href="OAlg.Data.X.html#xZB"><span class="hs-identifier hs-var">xZB</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Z
</span><span class="hs-number">10</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Z
</span><span class="hs-number">10</span></span><span>
</span><span id="line-241"></span><span>
</span><span id="line-242"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-243"></span><span class="hs-comment">-- xStartProductSymbol -</span><span>
</span><span id="line-244"></span><span>
</span><span id="line-245"></span><span class="annot"><span class="hs-comment">-- | the induced random variable on @'Orientation' 'Symbol')@.</span></span><span>
</span><span id="line-246"></span><span id="local-6989586621679385642"><span class="annot"><a href="OAlg.Entity.Product.Proposition.html#xPrdSymStart"><span class="hs-identifier hs-type">xPrdSymStart</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Integral"><span class="hs-identifier hs-type">Integral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679385642"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.X.html#X"><span class="hs-identifier hs-type">X</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679385642"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#XOrtSite"><span class="hs-identifier hs-type">XOrtSite</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Dualisable.html#From"><span class="hs-identifier hs-type">From</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#Product"><span class="hs-identifier hs-type">Product</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679385642"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#Orientation"><span class="hs-identifier hs-type">Orientation</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Symbol.html#Symbol"><span class="hs-identifier hs-type">Symbol</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-247"></span><span id="xPrdSymStart"><span class="annot"><span class="annottext">xPrdSymStart :: forall r.
Integral r =&gt;
N -&gt; X r -&gt; XOrtSite 'From (Product r (Orientation Symbol))
</span><a href="OAlg.Entity.Product.Proposition.html#xPrdSymStart"><span class="hs-identifier hs-var hs-var">xPrdSymStart</span></a></span></span><span> </span><span id="local-6989586621679386231"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679386231"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679386232"><span class="annot"><span class="annottext">X r
</span><a href="#local-6989586621679386232"><span class="hs-identifier hs-var">xr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XOrtSite 'From (Orientation Symbol)
-&gt; X r -&gt; N -&gt; XOrtSite 'From (Product r (Orientation Symbol))
forall a r.
(Oriented a, Integral r) =&gt;
XOrtSite 'From a -&gt; X r -&gt; N -&gt; XOrtSite 'From (Product r a)
</span><a href="OAlg.Entity.Product.Proposition.html#xStartProduct"><span class="hs-identifier hs-var">xStartProduct</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">X Symbol -&gt; XOrtSite 'From (Orientation Symbol)
forall p. X p -&gt; XOrtSite 'From (Orientation p)
</span><a href="OAlg.Structure.Oriented.Definition.html#xStartOrnt"><span class="hs-identifier hs-var">xStartOrnt</span></a></span><span> </span><span class="annot"><span class="annottext">X Symbol
</span><a href="OAlg.Data.Symbol.html#xSymbol"><span class="hs-identifier hs-var">xSymbol</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">X r
</span><a href="#local-6989586621679386232"><span class="hs-identifier hs-var">xr</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679386231"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-248"></span><span>
</span><span id="line-249"></span><span id="local-6989586621679385644"><span id="local-6989586621679385645"><span id="local-6989586621679385646"><span class="annot"><a href="OAlg.Entity.Product.Proposition.html#xPrdSymEndo"><span class="hs-identifier hs-type">xPrdSymEndo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Definition.html#Entity"><span class="hs-identifier hs-type">Entity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679385644"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Integral"><span class="hs-identifier hs-type">Integral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679385645"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679385646"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#Product"><span class="hs-identifier hs-type">Product</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679385645"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#Orientation"><span class="hs-identifier hs-type">Orientation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679385644"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-250"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.X.html#X"><span class="hs-identifier hs-type">X</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679385646"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.X.html#X"><span class="hs-identifier hs-type">X</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Structure.Multiplicative.Proposition.html#Endo"><span class="hs-identifier hs-type">Endo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679385646"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-251"></span><span id="xPrdSymEndo"><span class="annot"><span class="annottext">xPrdSymEndo :: forall p r m.
(Entity p, Integral r, m ~ Product r (Orientation p)) =&gt;
X m -&gt; X (Endo m)
</span><a href="OAlg.Entity.Product.Proposition.html#xPrdSymEndo"><span class="hs-identifier hs-var hs-var">xPrdSymEndo</span></a></span></span><span> </span><span id="local-6989586621679386252"><span class="annot"><span class="annottext">X m
</span><a href="#local-6989586621679386252"><span class="hs-identifier hs-var">xpr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-252"></span><span>  </span><span id="local-6989586621679386253"><span class="annot"><span class="annottext">m
</span><a href="#local-6989586621679386253"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">X m
</span><a href="#local-6989586621679386252"><span class="hs-identifier hs-var">xpr</span></a></span><span>
</span><span id="line-253"></span><span>  </span><span class="annot"><span class="annottext">Endo (Product r (Orientation p)) -&gt; X (Endo m)
Endo (Product r (Orientation p))
-&gt; X (Endo (Product r (Orientation p)))
forall a. a -&gt; X a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Endo (Product r (Orientation p)) -&gt; X (Endo m))
-&gt; Endo (Product r (Orientation p)) -&gt; X (Endo m)
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><a href="OAlg.Category.Applicative.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">m -&gt; Endo (Product r (Orientation p))
Product r (Orientation p) -&gt; Endo (Product r (Orientation p))
forall q. q -&gt; Endo q
</span><a href="OAlg.Structure.Multiplicative.Proposition.html#Endo"><span class="hs-identifier hs-var">Endo</span></a></span><span> </span><span class="annot"><span class="annottext">(m -&gt; Endo (Product r (Orientation p)))
-&gt; m -&gt; Endo (Product r (Orientation p))
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><a href="OAlg.Category.Applicative.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">m -&gt; Bool
forall q. Oriented q =&gt; q -&gt; Bool
</span><a href="OAlg.Structure.Oriented.Definition.html#isEndo"><span class="hs-identifier hs-var">isEndo</span></a></span><span> </span><span class="annot"><span class="annottext">m
</span><a href="#local-6989586621679386253"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">m
</span><a href="#local-6989586621679386253"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Orientation p -&gt; m
forall a b. Embeddable a b =&gt; a -&gt; b
</span><a href="OAlg.Data.Canonical.html#inj"><span class="hs-identifier hs-var">inj</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">m -&gt; Point m
forall q. Oriented q =&gt; q -&gt; Point q
</span><a href="OAlg.Structure.Oriented.Definition.html#end"><span class="hs-identifier hs-var">end</span></a></span><span> </span><span class="annot"><span class="annottext">m
</span><a href="#local-6989586621679386253"><span class="hs-identifier hs-var">p</span></a></span><span class="annot"><span class="annottext">p -&gt; p -&gt; Orientation p
forall p. p -&gt; p -&gt; Orientation p
</span><a href="OAlg.Structure.Oriented.Definition.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span class="annot"><span class="annottext">m -&gt; Point m
forall q. Oriented q =&gt; q -&gt; Point q
</span><a href="OAlg.Structure.Oriented.Definition.html#start"><span class="hs-identifier hs-var">start</span></a></span><span> </span><span class="annot"><span class="annottext">m
</span><a href="#local-6989586621679386253"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">m -&gt; m -&gt; m
forall c. Multiplicative c =&gt; c -&gt; c -&gt; c
</span><a href="OAlg.Structure.Multiplicative.Definition.html#%2A"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">m
</span><a href="#local-6989586621679386253"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-254"></span><span>
</span><span id="line-255"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-256"></span><span class="hs-comment">-- xPrdSymMlt -</span><span>
</span><span id="line-257"></span><span>
</span><span id="line-258"></span><span class="annot"><span class="hs-comment">-- | the induced random variable for validating 'Multiplicative' structures.</span></span><span>
</span><span id="line-259"></span><span id="local-6989586621679385659"><span class="annot"><a href="OAlg.Entity.Product.Proposition.html#xPrdSymMlt"><span class="hs-identifier hs-type">xPrdSymMlt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Integral"><span class="hs-identifier hs-type">Integral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679385659"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.X.html#X"><span class="hs-identifier hs-type">X</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679385659"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Structure.Multiplicative.Proposition.html#XMlt"><span class="hs-identifier hs-type">XMlt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#Product"><span class="hs-identifier hs-type">Product</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679385659"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#Orientation"><span class="hs-identifier hs-type">Orientation</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Symbol.html#Symbol"><span class="hs-identifier hs-type">Symbol</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-260"></span><span id="xPrdSymMlt"><span class="annot"><span class="annottext">xPrdSymMlt :: forall r.
Integral r =&gt;
N -&gt; X r -&gt; XMlt (Product r (Orientation Symbol))
</span><a href="OAlg.Entity.Product.Proposition.html#xPrdSymMlt"><span class="hs-identifier hs-var hs-var">xPrdSymMlt</span></a></span></span><span> </span><span id="local-6989586621679386267"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679386267"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679386268"><span class="annot"><span class="annottext">X r
</span><a href="#local-6989586621679386268"><span class="hs-identifier hs-var">xr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XOrtSite 'From (Product r (Orientation Symbol))
-&gt; X N
-&gt; X (Endo (Product r (Orientation Symbol)))
-&gt; XMlt (Product r (Orientation Symbol))
forall c (d :: Site).
Multiplicative c =&gt;
XOrtSite d c -&gt; X N -&gt; X (Endo c) -&gt; XMlt c
</span><a href="OAlg.Structure.Multiplicative.Proposition.html#xMlt"><span class="hs-identifier hs-var">xMlt</span></a></span><span> </span><span class="annot"><span class="annottext">XOrtSite 'From (Product r (Orientation Symbol))
</span><a href="#local-6989586621679386270"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">X N
</span><a href="#local-6989586621679386271"><span class="hs-identifier hs-var">xn</span></a></span><span> </span><span class="annot"><span class="annottext">X (Endo (Product r (Orientation Symbol)))
</span><a href="#local-6989586621679386272"><span class="hs-identifier hs-var">xe</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-261"></span><span>  </span><span id="local-6989586621679386271"><span class="annot"><span class="annottext">xn :: X N
</span><a href="#local-6989586621679386271"><span class="hs-identifier hs-var hs-var">xn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; X N
</span><a href="OAlg.Data.X.html#xNB"><span class="hs-identifier hs-var">xNB</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">10</span></span><span>
</span><span id="line-262"></span><span>  </span><span id="local-6989586621679386270"><span class="annot"><span class="annottext">xs :: XOrtSite 'From (Product r (Orientation Symbol))
</span><a href="#local-6989586621679386270"><span class="hs-identifier hs-var hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">N -&gt; X r -&gt; XOrtSite 'From (Product r (Orientation Symbol))
forall r.
Integral r =&gt;
N -&gt; X r -&gt; XOrtSite 'From (Product r (Orientation Symbol))
</span><a href="OAlg.Entity.Product.Proposition.html#xPrdSymStart"><span class="hs-identifier hs-var">xPrdSymStart</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679386267"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">X r
</span><a href="#local-6989586621679386268"><span class="hs-identifier hs-var">xr</span></a></span><span>
</span><span id="line-263"></span><span>  </span><span id="local-6989586621679386272"><span class="annot"><span class="annottext">xe :: X (Endo (Product r (Orientation Symbol)))
</span><a href="#local-6989586621679386272"><span class="hs-identifier hs-var hs-var">xe</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">X (Product r (Orientation Symbol))
-&gt; X (Endo (Product r (Orientation Symbol)))
forall p r m.
(Entity p, Integral r, m ~ Product r (Orientation p)) =&gt;
X m -&gt; X (Endo m)
</span><a href="OAlg.Entity.Product.Proposition.html#xPrdSymEndo"><span class="hs-identifier hs-var">xPrdSymEndo</span></a></span><span> </span><span class="annot"><span class="annottext">(X (Product r (Orientation Symbol))
 -&gt; X (Endo (Product r (Orientation Symbol))))
-&gt; X (Product r (Orientation Symbol))
-&gt; X (Endo (Product r (Orientation Symbol)))
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><a href="OAlg.Category.Applicative.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">XOrtSite 'From (Product r (Orientation Symbol))
-&gt; X (Product r (Orientation Symbol))
forall q (s :: Site). Oriented q =&gt; XOrtSite s q -&gt; XOrt q
</span><a href="OAlg.Structure.Oriented.Proposition.html#xosOrt"><span class="hs-identifier hs-var">xosOrt</span></a></span><span> </span><span class="annot"><span class="annottext">XOrtSite 'From (Product r (Orientation Symbol))
</span><a href="#local-6989586621679386270"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-264"></span><span>
</span><span id="line-265"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-266"></span><span class="hs-comment">-- prpOrtProductNOrntSymbol -</span><span>
</span><span id="line-267"></span><span>
</span><span id="line-268"></span><span class="annot"><span class="hs-comment">-- | validity of @'Product' t'N' ('Orientation' 'Symbol')@ being 'Oriented'.</span></span><span>
</span><span id="line-269"></span><span class="annot"><a href="OAlg.Entity.Product.Proposition.html#prpOrtProductNOrntSymbol"><span class="hs-identifier hs-type">prpOrtProductNOrntSymbol</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.Data.Statement.Definition.html#Statement"><span class="hs-identifier hs-type">Statement</span></a></span><span>
</span><span id="line-270"></span><span id="prpOrtProductNOrntSymbol"><span class="annot"><span class="annottext">prpOrtProductNOrntSymbol :: Statement
</span><a href="OAlg.Entity.Product.Proposition.html#prpOrtProductNOrntSymbol"><span class="hs-identifier hs-var hs-var">prpOrtProductNOrntSymbol</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Label
</span><a href="OAlg.Data.Statement.Definition.html#Prp"><span class="hs-identifier hs-var">Prp</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;OrtProductNOrntSymbol&quot;</span></span><span>
</span><span id="line-271"></span><span>  </span><span class="annot"><span class="annottext">Label -&gt; Statement -&gt; Statement
</span><a href="OAlg.Data.Statement.Definition.html#%3A%3C%3D%3E%3A"><span class="hs-operator hs-var">:&lt;=&gt;:</span></a></span><span> </span><span class="annot"><span class="annottext">XOrt (Product N (Orientation Symbol)) -&gt; Statement
forall q. Oriented q =&gt; XOrt q -&gt; Statement
</span><a href="OAlg.Structure.Oriented.Proposition.html#prpOrt"><span class="hs-identifier hs-var">prpOrt</span></a></span><span> </span><span class="annot"><span class="annottext">XOrt (Product N (Orientation Symbol))
</span><a href="#local-6989586621679386280"><span class="hs-identifier hs-var">xprd</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-272"></span><span>    </span><span id="local-6989586621679386283"><span class="annot"><span class="annottext">xr :: X N
</span><a href="#local-6989586621679386283"><span class="hs-identifier hs-var hs-var">xr</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; X N
</span><a href="OAlg.Data.X.html#xNB"><span class="hs-identifier hs-var">xNB</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">3</span></span><span>
</span><span id="line-273"></span><span>    </span><span id="local-6989586621679386280"><span class="annot"><span class="annottext">xprd :: XOrt (Product N (Orientation Symbol))
</span><a href="#local-6989586621679386280"><span class="hs-identifier hs-var hs-var">xprd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XOrtSite 'From (Product N (Orientation Symbol))
-&gt; XOrt (Product N (Orientation Symbol))
forall q (s :: Site). Oriented q =&gt; XOrtSite s q -&gt; XOrt q
</span><a href="OAlg.Structure.Oriented.Proposition.html#xosOrt"><span class="hs-identifier hs-var">xosOrt</span></a></span><span> </span><span class="annot"><span class="annottext">(XOrtSite 'From (Product N (Orientation Symbol))
 -&gt; XOrt (Product N (Orientation Symbol)))
-&gt; XOrtSite 'From (Product N (Orientation Symbol))
-&gt; XOrt (Product N (Orientation Symbol))
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><a href="OAlg.Category.Applicative.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">N -&gt; X N -&gt; XOrtSite 'From (Product N (Orientation Symbol))
forall r.
Integral r =&gt;
N -&gt; X r -&gt; XOrtSite 'From (Product r (Orientation Symbol))
</span><a href="OAlg.Entity.Product.Proposition.html#xPrdSymStart"><span class="hs-identifier hs-var">xPrdSymStart</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">7</span></span><span> </span><span class="annot"><span class="annottext">X N
</span><a href="#local-6989586621679386283"><span class="hs-identifier hs-var">xr</span></a></span><span>
</span><span id="line-274"></span><span>
</span><span id="line-275"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-276"></span><span class="hs-comment">-- prpOrtProductZOrntSymbol -</span><span>
</span><span id="line-277"></span><span>
</span><span id="line-278"></span><span class="annot"><span class="hs-comment">-- | validity of @'Product' t'Z' ('Orientation' 'Symbol')@ being 'Oriented'.</span></span><span>
</span><span id="line-279"></span><span class="annot"><a href="OAlg.Entity.Product.Proposition.html#prpOrtProductZOrntSymbol"><span class="hs-identifier hs-type">prpOrtProductZOrntSymbol</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.Data.Statement.Definition.html#Statement"><span class="hs-identifier hs-type">Statement</span></a></span><span>
</span><span id="line-280"></span><span id="prpOrtProductZOrntSymbol"><span class="annot"><span class="annottext">prpOrtProductZOrntSymbol :: Statement
</span><a href="OAlg.Entity.Product.Proposition.html#prpOrtProductZOrntSymbol"><span class="hs-identifier hs-var hs-var">prpOrtProductZOrntSymbol</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Label
</span><a href="OAlg.Data.Statement.Definition.html#Prp"><span class="hs-identifier hs-var">Prp</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;OrtProductZOrntSymbol&quot;</span></span><span>
</span><span id="line-281"></span><span>  </span><span class="annot"><span class="annottext">Label -&gt; Statement -&gt; Statement
</span><a href="OAlg.Data.Statement.Definition.html#%3A%3C%3D%3E%3A"><span class="hs-operator hs-var">:&lt;=&gt;:</span></a></span><span> </span><span class="annot"><span class="annottext">X (Product Z (Orientation Symbol)) -&gt; Statement
forall q. Oriented q =&gt; XOrt q -&gt; Statement
</span><a href="OAlg.Structure.Oriented.Proposition.html#prpOrt"><span class="hs-identifier hs-var">prpOrt</span></a></span><span> </span><span class="annot"><span class="annottext">X (Product Z (Orientation Symbol))
</span><a href="#local-6989586621679386292"><span class="hs-identifier hs-var">xprd</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-282"></span><span>    </span><span id="local-6989586621679386296"><span class="annot"><span class="annottext">xr :: X Z
</span><a href="#local-6989586621679386296"><span class="hs-identifier hs-var hs-var">xr</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Z -&gt; Z -&gt; X Z
</span><a href="OAlg.Data.X.html#xZB"><span class="hs-identifier hs-var">xZB</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Z
</span><span class="hs-number">5</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Z
</span><span class="hs-number">5</span></span><span>
</span><span id="line-283"></span><span>    </span><span id="local-6989586621679386292"><span class="annot"><span class="annottext">xprd :: X (Product Z (Orientation Symbol))
</span><a href="#local-6989586621679386292"><span class="hs-identifier hs-var hs-var">xprd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XOrtSite 'From (Product Z (Orientation Symbol))
-&gt; X (Product Z (Orientation Symbol))
forall q (s :: Site). Oriented q =&gt; XOrtSite s q -&gt; XOrt q
</span><a href="OAlg.Structure.Oriented.Proposition.html#xosOrt"><span class="hs-identifier hs-var">xosOrt</span></a></span><span> </span><span class="annot"><span class="annottext">(XOrtSite 'From (Product Z (Orientation Symbol))
 -&gt; X (Product Z (Orientation Symbol)))
-&gt; XOrtSite 'From (Product Z (Orientation Symbol))
-&gt; X (Product Z (Orientation Symbol))
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><a href="OAlg.Category.Applicative.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">N -&gt; X Z -&gt; XOrtSite 'From (Product Z (Orientation Symbol))
forall r.
Integral r =&gt;
N -&gt; X r -&gt; XOrtSite 'From (Product r (Orientation Symbol))
</span><a href="OAlg.Entity.Product.Proposition.html#xPrdSymStart"><span class="hs-identifier hs-var">xPrdSymStart</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">11</span></span><span> </span><span class="annot"><span class="annottext">X Z
</span><a href="#local-6989586621679386296"><span class="hs-identifier hs-var">xr</span></a></span><span> </span><span>
</span><span id="line-284"></span><span>
</span><span id="line-285"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-286"></span><span class="hs-comment">-- prpMltProductNOrntSymbol -</span><span>
</span><span id="line-287"></span><span>
</span><span id="line-288"></span><span class="annot"><span class="hs-comment">-- | validity of @'Product' t'N' ('Orientation' 'Symbol')@ being 'Multiplicative'.</span></span><span>
</span><span id="line-289"></span><span class="annot"><a href="OAlg.Entity.Product.Proposition.html#prpMltProductNOrntSymbol"><span class="hs-identifier hs-type">prpMltProductNOrntSymbol</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.Data.Statement.Definition.html#Statement"><span class="hs-identifier hs-type">Statement</span></a></span><span>
</span><span id="line-290"></span><span id="prpMltProductNOrntSymbol"><span class="annot"><span class="annottext">prpMltProductNOrntSymbol :: Statement
</span><a href="OAlg.Entity.Product.Proposition.html#prpMltProductNOrntSymbol"><span class="hs-identifier hs-var hs-var">prpMltProductNOrntSymbol</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Label
</span><a href="OAlg.Data.Statement.Definition.html#Prp"><span class="hs-identifier hs-var">Prp</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;MltProductNOrntSymbol&quot;</span></span><span>
</span><span id="line-291"></span><span>  </span><span class="annot"><span class="annottext">Label -&gt; Statement -&gt; Statement
</span><a href="OAlg.Data.Statement.Definition.html#%3A%3C%3D%3E%3A"><span class="hs-operator hs-var">:&lt;=&gt;:</span></a></span><span> </span><span class="annot"><span class="annottext">XMlt (Product N (Orientation Symbol)) -&gt; Statement
forall c. Multiplicative c =&gt; XMlt c -&gt; Statement
</span><a href="OAlg.Structure.Multiplicative.Proposition.html#prpMlt"><span class="hs-identifier hs-var">prpMlt</span></a></span><span> </span><span class="annot"><span class="annottext">XMlt (Product N (Orientation Symbol))
</span><a href="#local-6989586621679386305"><span class="hs-identifier hs-var">xprd</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-292"></span><span>    </span><span id="local-6989586621679386308"><span class="annot"><span class="annottext">xr :: X N
</span><a href="#local-6989586621679386308"><span class="hs-identifier hs-var hs-var">xr</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; X N
</span><a href="OAlg.Data.X.html#xNB"><span class="hs-identifier hs-var">xNB</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">7</span></span><span>
</span><span id="line-293"></span><span>    </span><span id="local-6989586621679386305"><span class="annot"><span class="annottext">xprd :: XMlt (Product N (Orientation Symbol))
</span><a href="#local-6989586621679386305"><span class="hs-identifier hs-var hs-var">xprd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">N -&gt; X N -&gt; XMlt (Product N (Orientation Symbol))
forall r.
Integral r =&gt;
N -&gt; X r -&gt; XMlt (Product r (Orientation Symbol))
</span><a href="OAlg.Entity.Product.Proposition.html#xPrdSymMlt"><span class="hs-identifier hs-var">xPrdSymMlt</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">7</span></span><span> </span><span class="annot"><span class="annottext">X N
</span><a href="#local-6989586621679386308"><span class="hs-identifier hs-var">xr</span></a></span><span>
</span><span id="line-294"></span><span>
</span><span id="line-295"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-296"></span><span class="hs-comment">-- prpMltProductZOrntSymbol -</span><span>
</span><span id="line-297"></span><span>
</span><span id="line-298"></span><span class="annot"><span class="hs-comment">-- | validity of @'Product' t'Z' ('Orientation' 'Symbol')@ being 'Multiplicative'.</span></span><span>
</span><span id="line-299"></span><span class="annot"><a href="OAlg.Entity.Product.Proposition.html#prpMltProductZOrntSymbol"><span class="hs-identifier hs-type">prpMltProductZOrntSymbol</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.Data.Statement.Definition.html#Statement"><span class="hs-identifier hs-type">Statement</span></a></span><span>
</span><span id="line-300"></span><span id="prpMltProductZOrntSymbol"><span class="annot"><span class="annottext">prpMltProductZOrntSymbol :: Statement
</span><a href="OAlg.Entity.Product.Proposition.html#prpMltProductZOrntSymbol"><span class="hs-identifier hs-var hs-var">prpMltProductZOrntSymbol</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Label
</span><a href="OAlg.Data.Statement.Definition.html#Prp"><span class="hs-identifier hs-var">Prp</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;MltProductZOrntSymbol&quot;</span></span><span>
</span><span id="line-301"></span><span>  </span><span class="annot"><span class="annottext">Label -&gt; Statement -&gt; Statement
</span><a href="OAlg.Data.Statement.Definition.html#%3A%3C%3D%3E%3A"><span class="hs-operator hs-var">:&lt;=&gt;:</span></a></span><span> </span><span class="annot"><span class="annottext">XMlt (Product Z (Orientation Symbol)) -&gt; Statement
forall c. Multiplicative c =&gt; XMlt c -&gt; Statement
</span><a href="OAlg.Structure.Multiplicative.Proposition.html#prpMlt"><span class="hs-identifier hs-var">prpMlt</span></a></span><span> </span><span class="annot"><span class="annottext">XMlt (Product Z (Orientation Symbol))
</span><a href="#local-6989586621679386311"><span class="hs-identifier hs-var">xprd</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-302"></span><span>    </span><span id="local-6989586621679386315"><span class="annot"><span class="annottext">xr :: X Z
</span><a href="#local-6989586621679386315"><span class="hs-identifier hs-var hs-var">xr</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Z -&gt; Z -&gt; X Z
</span><a href="OAlg.Data.X.html#xZB"><span class="hs-identifier hs-var">xZB</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Z
</span><span class="hs-number">7</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Z
</span><span class="hs-number">7</span></span><span>
</span><span id="line-303"></span><span>    </span><span id="local-6989586621679386311"><span class="annot"><span class="annottext">xprd :: XMlt (Product Z (Orientation Symbol))
</span><a href="#local-6989586621679386311"><span class="hs-identifier hs-var hs-var">xprd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">N -&gt; X Z -&gt; XMlt (Product Z (Orientation Symbol))
forall r.
Integral r =&gt;
N -&gt; X r -&gt; XMlt (Product r (Orientation Symbol))
</span><a href="OAlg.Entity.Product.Proposition.html#xPrdSymMlt"><span class="hs-identifier hs-var">xPrdSymMlt</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">7</span></span><span> </span><span class="annot"><span class="annottext">X Z
</span><a href="#local-6989586621679386315"><span class="hs-identifier hs-var">xr</span></a></span><span>
</span><span id="line-304"></span><span>
</span><span id="line-305"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-306"></span><span class="hs-comment">-- prpProduct -</span><span>
</span><span id="line-307"></span><span>
</span><span id="line-308"></span><span class="hs-comment">-- | validity of @'Product' __r__ ('Orientation' 'Symbol')@ for @__r__@ equal to t'N' and t'Z'</span><span>
</span><span id="line-309"></span><span class="hs-comment">-- respectively</span><span>
</span><span id="line-310"></span><span class="annot"><a href="OAlg.Entity.Product.Proposition.html#prpProduct"><span class="hs-identifier hs-type">prpProduct</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.Data.Statement.Definition.html#Statement"><span class="hs-identifier hs-type">Statement</span></a></span><span>
</span><span id="line-311"></span><span id="prpProduct"><span class="annot"><span class="annottext">prpProduct :: Statement
</span><a href="OAlg.Entity.Product.Proposition.html#prpProduct"><span class="hs-identifier hs-var hs-var">prpProduct</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Label
</span><a href="OAlg.Data.Statement.Definition.html#Prp"><span class="hs-identifier hs-var">Prp</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Product&quot;</span></span><span>
</span><span id="line-312"></span><span>  </span><span class="annot"><span class="annottext">Label -&gt; Statement -&gt; Statement
</span><a href="OAlg.Data.Statement.Definition.html#%3A%3C%3D%3E%3A"><span class="hs-operator hs-var">:&lt;=&gt;:</span></a></span><span> </span><span class="annot"><span class="annottext">[Statement] -&gt; Statement
</span><a href="OAlg.Data.Statement.Definition.html#And"><span class="hs-identifier hs-var">And</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Statement
</span><a href="OAlg.Entity.Product.Proposition.html#prpOrtProductNOrntSymbol"><span class="hs-identifier hs-var">prpOrtProductNOrntSymbol</span></a></span><span>
</span><span id="line-313"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Statement
</span><a href="OAlg.Entity.Product.Proposition.html#prpOrtProductZOrntSymbol"><span class="hs-identifier hs-var">prpOrtProductZOrntSymbol</span></a></span><span>
</span><span id="line-314"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Statement
</span><a href="OAlg.Entity.Product.Proposition.html#prpMltProductNOrntSymbol"><span class="hs-identifier hs-var">prpMltProductNOrntSymbol</span></a></span><span>
</span><span id="line-315"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Statement
</span><a href="OAlg.Entity.Product.Proposition.html#prpMltProductZOrntSymbol"><span class="hs-identifier hs-var">prpMltProductZOrntSymbol</span></a></span><span>
</span><span id="line-316"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-317"></span><span>
</span><span id="line-318"></span><span>
</span><span id="line-319"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-320"></span><span class="hs-comment">-- Example -</span><span>
</span><span id="line-321"></span><span>
</span><span id="line-322"></span><span class="hs-comment">-- | example of a 'XStart' for the quiver having two points \'a\' and \'b\' and two</span><span>
</span><span id="line-323"></span><span class="hs-comment">--   arrows @\'a\':&gt;\'a\'@ and @\'a\':&gt;\'b\'@.</span><span>
</span><span id="line-324"></span><span class="annot"><a href="OAlg.Entity.Product.Proposition.html#xT"><span class="hs-identifier hs-type">xT</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#XOrtSite"><span class="hs-identifier hs-type">XOrtSite</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Dualisable.html#From"><span class="hs-identifier hs-type">From</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#Orientation"><span class="hs-identifier hs-type">Orientation</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span class="hs-special">)</span><span>
</span><span id="line-325"></span><span id="xT"><span class="annot"><span class="annottext">xT :: XOrtSite 'From (Orientation Char)
</span><a href="OAlg.Entity.Product.Proposition.html#xT"><span class="hs-identifier hs-var hs-var">xT</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">X (Point (Orientation Char))
-&gt; (Point (Orientation Char) -&gt; X (Orientation Char))
-&gt; XOrtSite 'From (Orientation Char)
forall q. X (Point q) -&gt; (Point q -&gt; X q) -&gt; XOrtSite 'From q
</span><a href="OAlg.Structure.Oriented.Definition.html#XStart"><span class="hs-identifier hs-var">XStart</span></a></span><span> </span><span class="annot"><span class="annottext">X Char
X (Point (Orientation Char))
</span><a href="#local-6989586621679386319"><span class="hs-identifier hs-var">xp</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; X (Orientation Char)
Point (Orientation Char) -&gt; X (Orientation Char)
</span><a href="#local-6989586621679386320"><span class="hs-identifier hs-var">mxs</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-326"></span><span>  </span><span id="local-6989586621679386319"><span class="annot"><span class="annottext">xp :: X Char
</span><a href="#local-6989586621679386319"><span class="hs-identifier hs-var hs-var">xp</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Q, Char)] -&gt; X Char
forall a. [(Q, a)] -&gt; X a
</span><a href="OAlg.Data.X.html#xOneOfW"><span class="hs-identifier hs-var">xOneOfW</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Q
</span><span class="hs-number">10</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'a'</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Q
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'b'</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-327"></span><span>  </span><span id="local-6989586621679386320"><span class="annot"><span class="annottext">mxs :: Char -&gt; X (Orientation Char)
</span><a href="#local-6989586621679386320"><span class="hs-identifier hs-var hs-var">mxs</span></a></span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'a'</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Q, Orientation Char)] -&gt; X (Orientation Char)
forall a. [(Q, a)] -&gt; X a
</span><a href="OAlg.Data.X.html#xOneOfW"><span class="hs-identifier hs-var">xOneOfW</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Q
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'a'</span></span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Orientation Char
forall p. p -&gt; p -&gt; Orientation p
</span><a href="OAlg.Structure.Oriented.Definition.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'a'</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Q
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'a'</span></span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Orientation Char
forall p. p -&gt; p -&gt; Orientation p
</span><a href="OAlg.Structure.Oriented.Definition.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'b'</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-328"></span><span>  </span><span class="annot"><a href="#local-6989586621679386320"><span class="hs-identifier hs-var">mxs</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">X (Orientation Char)
forall x. X x
</span><a href="OAlg.Data.X.html#XEmpty"><span class="hs-identifier hs-var">XEmpty</span></a></span><span>
</span><span id="line-329"></span><span>
</span><span id="line-330"></span><span class="annot"><span class="hs-comment">-- | its distribution</span></span><span>
</span><span id="line-331"></span><span class="annot"><a href="OAlg.Entity.Product.Proposition.html#dstT"><span class="hs-identifier hs-type">dstT</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-332"></span><span id="dstT"><span class="annot"><span class="annottext">dstT :: Int -&gt; N -&gt; IO ()
</span><a href="OAlg.Entity.Product.Proposition.html#dstT"><span class="hs-identifier hs-var hs-var">dstT</span></a></span></span><span> </span><span id="local-6989586621679386326"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679386326"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679386327"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679386327"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO Omega
</span><a href="OAlg.Data.X.html#getOmega"><span class="hs-identifier hs-var">getOmega</span></a></span><span> </span><span class="annot"><span class="annottext">IO Omega -&gt; (Omega -&gt; IO ()) -&gt; IO ()
forall a b. IO a -&gt; (a -&gt; IO b) -&gt; IO b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; X String -&gt; Omega -&gt; IO ()
forall x. (Show x, Ord x) =&gt; Int -&gt; X x -&gt; Omega -&gt; IO ()
</span><a href="OAlg.Data.X.html#putDistribution"><span class="hs-identifier hs-var">putDistribution</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679386326"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Product N (Orientation Char) -&gt; String)
-&gt; X (Product N (Orientation Char)) -&gt; X String
forall a b. (a -&gt; b) -&gt; X a -&gt; X b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Product N (Orientation Char) -&gt; String
</span><a href="#local-6989586621679386328"><span class="hs-identifier hs-var">asps</span></a></span><span> </span><span class="annot"><span class="annottext">X (Product N (Orientation Char))
</span><a href="#local-6989586621679386329"><span class="hs-identifier hs-var">xprd</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-333"></span><span>  </span><span id="local-6989586621679386328"><span class="annot"><span class="annottext">asps :: Product N (Orientation Char) -&gt; String
</span><a href="#local-6989586621679386328"><span class="hs-identifier hs-var hs-var">asps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Product N (Orientation Char) -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span>
</span><span id="line-334"></span><span>  </span><span id="local-6989586621679386329"><span class="annot"><span class="annottext">xprd :: X (Product N (Orientation Char))
</span><a href="#local-6989586621679386329"><span class="hs-identifier hs-var hs-var">xprd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XOrtSite 'From (Product N (Orientation Char))
-&gt; Point (Product N (Orientation Char))
-&gt; X (Product N (Orientation Char))
forall q. XOrtSite 'From q -&gt; Point q -&gt; X q
</span><a href="OAlg.Structure.Oriented.Definition.html#xosStart"><span class="hs-identifier hs-var">xosStart</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XOrtSite 'From (Orientation Char)
-&gt; X N -&gt; N -&gt; XOrtSite 'From (Product N (Orientation Char))
forall a r.
(Oriented a, Integral r) =&gt;
XOrtSite 'From a -&gt; X r -&gt; N -&gt; XOrtSite 'From (Product r a)
</span><a href="OAlg.Entity.Product.Proposition.html#xStartProduct"><span class="hs-identifier hs-var">xStartProduct</span></a></span><span> </span><span class="annot"><span class="annottext">XOrtSite 'From (Orientation Char)
</span><a href="OAlg.Entity.Product.Proposition.html#xT"><span class="hs-identifier hs-var">xT</span></a></span><span> </span><span class="annot"><span class="annottext">X N
</span><a href="#local-6989586621679386335"><span class="hs-identifier hs-var">xn</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679386327"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Char
Point (Product N (Orientation Char))
</span><span class="hs-char">'a'</span></span><span>
</span><span id="line-335"></span><span>  </span><span id="local-6989586621679386335"><span class="annot"><span class="annottext">xn :: X N
</span><a href="#local-6989586621679386335"><span class="hs-identifier hs-var hs-var">xn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; X N
</span><a href="OAlg.Data.X.html#xNB"><span class="hs-identifier hs-var">xNB</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">10</span></span><span>
</span><span id="line-336"></span><span>
</span><span id="line-337"></span><span>  </span><span>
</span><span id="line-338"></span><span>
</span><span id="line-339"></span></pre></body></html>