<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE NoImplicitPrelude #-}</span><span>
</span><span id="line-3"></span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE TypeOperators #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE GADTs #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE StandaloneDeriving #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE GeneralizedNewtypeDeriving #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# LANGUAGE DataKinds #-}</span><span>
</span><span id="line-13"></span><span>
</span><span id="line-14"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-15"></span><span class="hs-comment">-- Module      : OAlg.Entity.Product.Definition</span><span>
</span><span id="line-16"></span><span class="hs-comment">-- Description : definition of free products over oriented symbols</span><span>
</span><span id="line-17"></span><span class="hs-comment">-- Copyright   : (c) Erich Gut</span><span>
</span><span id="line-18"></span><span class="hs-comment">-- License     : BSD3</span><span>
</span><span id="line-19"></span><span class="hs-comment">-- Maintainer  : zerich.gut@gmail.com</span><span>
</span><span id="line-20"></span><span class="hs-comment">--</span><span>
</span><span id="line-21"></span><span class="hs-comment">-- defintion of free products over 'Oriented' symbols with exponents in a 'Number'.</span><span>
</span><span id="line-22"></span><span class="hs-comment">--</span><span>
</span><span id="line-23"></span><span class="hs-comment">-- __Note__ On 'Oriented' structures the canonical injection 'inj' and projection</span><span>
</span><span id="line-24"></span><span class="hs-comment">-- 'prj' are bijections between the 'valid' entities of 'Path' and @'Product' 'N'@.</span><span>
</span><span id="line-25"></span><span class="hs-comment">-- This is not true betwenn 'Path' and @'ProductForm' 'N'@ as</span><span>
</span><span id="line-26"></span><span class="hs-comment">--</span><span>
</span><span id="line-27"></span><span class="hs-comment">-- &gt;&gt;&gt; prj (P 3 :^ 2 :: ProductForm N Q) :: Path Q</span><span>
</span><span id="line-28"></span><span class="hs-comment">-- Path () [3,3]</span><span>
</span><span id="line-29"></span><span class="hs-comment">--</span><span>
</span><span id="line-30"></span><span class="hs-comment">-- and</span><span>
</span><span id="line-31"></span><span class="hs-comment">--</span><span>
</span><span id="line-32"></span><span class="hs-comment">-- &gt;&gt;&gt; prj (P 3 :* P 3 :: ProductForm N Q) :: Path Q</span><span>
</span><span id="line-33"></span><span class="hs-comment">-- Path () [3,3]</span><span>
</span><span id="line-34"></span><span class="hs-comment">--</span><span>
</span><span id="line-35"></span><span class="hs-comment">-- both map to the same 'Path'! But</span><span>
</span><span id="line-36"></span><span class="hs-comment">--</span><span>
</span><span id="line-37"></span><span class="hs-comment">-- &gt;&gt;&gt; let p = make (P 3) :: Product N Q in p * p == p ^ 2</span><span>
</span><span id="line-38"></span><span class="hs-comment">-- True</span><span>
</span><span id="line-39"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">OAlg.Entity.Product.Definition</span><span>
</span><span id="line-40"></span><span>  </span><span class="hs-special">(</span><span>
</span><span id="line-41"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Product</span></span><span>
</span><span id="line-42"></span><span>    </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#Product"><span class="hs-identifier">Product</span></a></span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#prLength"><span class="hs-identifier">prLength</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#prFactor"><span class="hs-identifier">prFactor</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#prFactors"><span class="hs-identifier">prFactors</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#prwrd"><span class="hs-identifier">prwrd</span></a></span><span>
</span><span id="line-43"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#nProduct"><span class="hs-identifier">nProduct</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#zProduct"><span class="hs-identifier">zProduct</span></a></span><span>
</span><span id="line-44"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#prdMapTotal"><span class="hs-identifier">prdMapTotal</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#prFromOp"><span class="hs-identifier">prFromOp</span></a></span><span>
</span><span id="line-45"></span><span>  </span><span>
</span><span id="line-46"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Word</span></span><span>
</span><span id="line-47"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#Word"><span class="hs-identifier">Word</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#fromWord"><span class="hs-identifier">fromWord</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#prfwrd"><span class="hs-identifier">prfwrd</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#wrdprf"><span class="hs-identifier">wrdprf</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#wrdPrfGroup"><span class="hs-identifier">wrdPrfGroup</span></a></span><span>
</span><span id="line-48"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#nFactorize"><span class="hs-identifier">nFactorize</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#nFactorize%27"><span class="hs-identifier">nFactorize'</span></a></span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Form</span></span><span>
</span><span id="line-51"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#ProductForm"><span class="hs-identifier">ProductForm</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#prfLength"><span class="hs-identifier">prfLength</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#prfDepth"><span class="hs-identifier">prfDepth</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#prfFactors"><span class="hs-identifier">prfFactors</span></a></span><span>
</span><span id="line-52"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#nProductForm"><span class="hs-identifier">nProductForm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#zProductForm"><span class="hs-identifier">zProductForm</span></a></span><span>
</span><span id="line-53"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#prfInverse"><span class="hs-identifier">prfInverse</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#prfFromOp"><span class="hs-identifier">prfFromOp</span></a></span><span>
</span><span id="line-54"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#prfMapTotal"><span class="hs-identifier">prfMapTotal</span></a></span><span>
</span><span id="line-55"></span><span>
</span><span id="line-56"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Reduction</span></span><span>
</span><span id="line-57"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#prfReduce"><span class="hs-identifier">prfReduce</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#prfReduceWith"><span class="hs-identifier">prfReduceWith</span></a></span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Operations</span></span><span>
</span><span id="line-60"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#prfopr"><span class="hs-identifier">prfopr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#prfopr%27"><span class="hs-identifier">prfopr'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#prfopl"><span class="hs-identifier">prfopl</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#prfopl%27"><span class="hs-identifier">prfopl'</span></a></span><span>
</span><span id="line-61"></span><span>
</span><span id="line-62"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span>
</span><span id="line-64"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-65"></span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Exception</span></span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(++)</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">repeat</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">map</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">groupBy</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">zip</span></span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Foldable</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">product</span></span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Monoid</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Product</span></span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="OAlg.Prelude.html"><span class="hs-identifier">OAlg.Prelude</span></a></span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="OAlg.Data.Reducible.html"><span class="hs-identifier">OAlg.Data.Reducible</span></a></span><span>
</span><span id="line-77"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="OAlg.Data.Constructable.html"><span class="hs-identifier">OAlg.Data.Constructable</span></a></span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="OAlg.Data.Canonical.html"><span class="hs-identifier">OAlg.Data.Canonical</span></a></span><span>
</span><span id="line-79"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="OAlg.Data.Singleton.html"><span class="hs-identifier">OAlg.Data.Singleton</span></a></span><span>
</span><span id="line-80"></span><span>
</span><span id="line-81"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="OAlg.Structure.Exception.html"><span class="hs-identifier">OAlg.Structure.Exception</span></a></span><span>
</span><span id="line-82"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="OAlg.Structure.Oriented.html"><span class="hs-identifier">OAlg.Structure.Oriented</span></a></span><span>
</span><span id="line-83"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="OAlg.Structure.Multiplicative.html"><span class="hs-identifier">OAlg.Structure.Multiplicative</span></a></span><span>
</span><span id="line-84"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="OAlg.Structure.Additive.html"><span class="hs-identifier">OAlg.Structure.Additive</span></a></span><span>
</span><span id="line-85"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="OAlg.Structure.Ring.html"><span class="hs-identifier">OAlg.Structure.Ring</span></a></span><span>
</span><span id="line-86"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="OAlg.Structure.Number.html"><span class="hs-identifier">OAlg.Structure.Number</span></a></span><span>
</span><span id="line-87"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="OAlg.Structure.Exponential.html"><span class="hs-identifier">OAlg.Structure.Exponential</span></a></span><span>
</span><span id="line-88"></span><span>
</span><span id="line-89"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="OAlg.Hom.html"><span class="hs-identifier">OAlg.Hom</span></a></span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="OAlg.Entity.Sequence.Definition.html"><span class="hs-identifier">OAlg.Entity.Sequence.Definition</span></a></span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span class="hs-keyword">infixr</span><span> </span><span class="hs-number">7</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#%3A%2A"><span class="hs-operator hs-type">:*</span></a></span><span>
</span><span id="line-94"></span><span class="hs-keyword">infixl</span><span> </span><span class="hs-number">9</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#%3A%5E"><span class="hs-operator hs-type">:^</span></a></span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-97"></span><span class="hs-comment">-- ProductForm -</span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span class="hs-comment">-- | form for a free product over 'Oriented' symbols in @__a__@ with exponents in @__r__@.</span><span>
</span><span id="line-100"></span><span class="hs-comment">--</span><span>
</span><span id="line-101"></span><span class="hs-comment">--   __Definition__ Let @__r__@ be a 'Number'. A 'ProductForm' @pf@ is 'valid'</span><span>
</span><span id="line-102"></span><span class="hs-comment">--  if and only if @'orientation' pf@ is 'valid' (see definition below) and all</span><span>
</span><span id="line-103"></span><span class="hs-comment">--  its symbols @x@ - where @'P' x@ occurs in @pf@ - are 'valid'.</span><span>
</span><span id="line-104"></span><span class="hs-comment">--</span><span>
</span><span id="line-105"></span><span class="hs-comment">--  The 'orientation' of @pf@ is defined according:</span><span>
</span><span id="line-106"></span><span class="hs-comment">--</span><span>
</span><span id="line-107"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-108"></span><span class="hs-comment">--  orientation pf = case pf of</span><span>
</span><span id="line-109"></span><span class="hs-comment">--    One p    -&gt; one p</span><span>
</span><span id="line-110"></span><span class="hs-comment">--    P a      -&gt; orientation a</span><span>
</span><span id="line-111"></span><span class="hs-comment">--    f :^ r   -&gt; orientation f ^ r where (^) = power</span><span>
</span><span id="line-112"></span><span class="hs-comment">--    f :* g   -&gt; orientation f * orientation g</span><span>
</span><span id="line-113"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-114"></span><span class="hs-comment">--</span><span>
</span><span id="line-115"></span><span class="hs-comment">--  __Note__ 'Number' is required for @-1@, @0@ and @1@ are not degenerated as in @Z/2@ or</span><span>
</span><span id="line-116"></span><span class="hs-comment">--  @Z/1@.</span><span>
</span><span id="line-117"></span><span class="hs-keyword">data</span><span> </span><span id="ProductForm"><span class="annot"><a href="OAlg.Entity.Product.Definition.html#ProductForm"><span class="hs-identifier hs-var">ProductForm</span></a></span></span><span> </span><span id="local-6989586621679382458"><span class="annot"><a href="#local-6989586621679382458"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span id="local-6989586621679382457"><span class="annot"><a href="#local-6989586621679382457"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-118"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="One"><span class="annot"><a href="OAlg.Entity.Product.Definition.html#One"><span class="hs-identifier hs-var">One</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382457"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-119"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="P"><span class="annot"><a href="OAlg.Entity.Product.Definition.html#P"><span class="hs-identifier hs-var">P</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621679382457"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-120"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#ProductForm"><span class="hs-identifier hs-type">ProductForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382458"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382457"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span id="%3A%5E"><span class="annot"><a href="OAlg.Entity.Product.Definition.html#%3A%5E"><span class="hs-operator hs-var">:^</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621679382458"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-121"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#ProductForm"><span class="hs-identifier hs-type">ProductForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382458"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382457"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span id="%3A%2A"><span class="annot"><a href="OAlg.Entity.Product.Definition.html#%3A%2A"><span class="hs-operator hs-var">:*</span></a></span></span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#ProductForm"><span class="hs-identifier hs-type">ProductForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382458"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382457"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-122"></span><span>
</span><span id="line-123"></span><span id="local-6989586621679382410"><span id="local-6989586621679382411"><span id="local-6989586621679383027"><span id="local-6989586621679383044"><span id="local-6989586621679383047"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#Oriented"><span class="hs-identifier hs-type">Oriented</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382410"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Definition.html#Entity"><span class="hs-identifier hs-type">Entity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382411"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#ProductForm"><span class="hs-identifier hs-type">ProductForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382411"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382410"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-124"></span><span id="local-6989586621679382415"><span id="local-6989586621679382416"><span id="local-6989586621679383058"><span id="local-6989586621679383070"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#Oriented"><span class="hs-identifier hs-type">Oriented</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382415"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Definition.html#Entity"><span class="hs-identifier hs-type">Entity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382416"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#ProductForm"><span class="hs-identifier hs-type">ProductForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382416"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382415"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-125"></span><span id="local-6989586621679382422"><span id="local-6989586621679382423"><span id="local-6989586621679383084"><span id="local-6989586621679383094"><span id="local-6989586621679383097"><span id="local-6989586621679383100"><span id="local-6989586621679383103"><span id="local-6989586621679383106"><span id="local-6989586621679383109"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#Oriented"><span class="hs-identifier hs-type">Oriented</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382422"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Entity.Definition.html#Entity"><span class="hs-identifier hs-type">Entity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382423"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-126"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679382422"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#OrdPoint"><span class="hs-identifier hs-type">OrdPoint</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382422"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679382423"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-127"></span><span>                  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#ProductForm"><span class="hs-identifier hs-type">ProductForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382423"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382422"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-128"></span><span>
</span><span id="line-129"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-130"></span><span class="hs-comment">-- ProductForm - Entity -</span><span>
</span><span id="line-131"></span><span>
</span><span id="line-132"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679382430"><span id="local-6989586621679382431"><span class="hs-special">(</span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#Oriented"><span class="hs-identifier hs-type">Oriented</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382430"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Number"><span class="hs-identifier hs-type">Number</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382431"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.Validable.html#Validable"><span class="hs-identifier hs-type">Validable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#ProductForm"><span class="hs-identifier hs-type">ProductForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382431"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382430"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-133"></span><span>  </span><span id="local-6989586621679383140"><span class="annot"><span class="annottext">valid :: ProductForm r a -&gt; Statement
</span><a href="OAlg.Data.Validable.html#valid"><span class="hs-identifier hs-var hs-var hs-var hs-var">valid</span></a></span></span><span> </span><span id="local-6989586621679383141"><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679383141"><span class="hs-identifier hs-var">pf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Statement] -&gt; Statement
</span><a href="OAlg.Data.Statement.Definition.html#And"><span class="hs-identifier hs-var">And</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String -&gt; Label
</span><a href="OAlg.Data.Statement.Definition.html#Label"><span class="hs-identifier hs-var">Label</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;orientation&quot;</span></span><span> </span><span class="annot"><span class="annottext">Label -&gt; Statement -&gt; Statement
</span><a href="OAlg.Data.Statement.Definition.html#%3A%3C%3D%3E%3A"><span class="hs-operator hs-var">:&lt;=&gt;:</span></a></span><span> </span><span class="annot"><span class="annottext">Orientation (Point a) -&gt; Statement
forall a. Validable a =&gt; a -&gt; Statement
</span><a href="OAlg.Data.Validable.html#valid"><span class="hs-identifier hs-var">valid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProductForm r a -&gt; Orientation (Point (ProductForm r a))
forall q. Oriented q =&gt; q -&gt; Orientation (Point q)
</span><a href="OAlg.Structure.Oriented.Definition.html#orientation"><span class="hs-identifier hs-var">orientation</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679383141"><span class="hs-identifier hs-var">pf</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-134"></span><span>                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Label
</span><a href="OAlg.Data.Statement.Definition.html#Label"><span class="hs-identifier hs-var">Label</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;symbols&quot;</span></span><span> </span><span class="annot"><span class="annottext">Label -&gt; Statement -&gt; Statement
</span><a href="OAlg.Data.Statement.Definition.html#%3A%3C%3D%3E%3A"><span class="hs-operator hs-var">:&lt;=&gt;:</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r a -&gt; Statement
forall {a} {a}.
(Validable a, Validable a, Validable (Point a)) =&gt;
ProductForm a a -&gt; Statement
</span><a href="#local-6989586621679383145"><span class="hs-identifier hs-var">vld</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679383141"><span class="hs-identifier hs-var">pf</span></a></span><span>
</span><span id="line-135"></span><span>                 </span><span class="hs-special">]</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span>    </span><span id="local-6989586621679383145"><span class="annot"><span class="annottext">vld :: ProductForm a a -&gt; Statement
</span><a href="#local-6989586621679383145"><span class="hs-identifier hs-var hs-var">vld</span></a></span></span><span> </span><span id="local-6989586621679383155"><span class="annot"><span class="annottext">ProductForm a a
</span><a href="#local-6989586621679383155"><span class="hs-identifier hs-var">pf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ProductForm a a
</span><a href="#local-6989586621679383155"><span class="hs-identifier hs-var">pf</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-138"></span><span>      </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#One"><span class="hs-identifier hs-type">One</span></a></span><span> </span><span id="local-6989586621679383156"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679383156"><span class="hs-identifier hs-var">e</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Point a -&gt; Statement
forall a. Validable a =&gt; a -&gt; Statement
</span><a href="OAlg.Data.Validable.html#valid"><span class="hs-identifier hs-var">valid</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679383156"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-139"></span><span>      </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span id="local-6989586621679383157"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679383157"><span class="hs-identifier hs-var">a</span></a></span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; Statement
forall a. Validable a =&gt; a -&gt; Statement
</span><a href="OAlg.Data.Validable.html#valid"><span class="hs-identifier hs-var">valid</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679383157"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-140"></span><span>      </span><span id="local-6989586621679383158"><span class="annot"><span class="annottext">ProductForm a a
</span><a href="#local-6989586621679383158"><span class="hs-identifier hs-var">pf</span></a></span></span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#%3A%5E"><span class="hs-operator hs-type">:^</span></a></span><span> </span><span id="local-6989586621679383159"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679383159"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ProductForm a a -&gt; Statement
</span><a href="#local-6989586621679383145"><span class="hs-identifier hs-var">vld</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm a a
</span><a href="#local-6989586621679383158"><span class="hs-identifier hs-var">pf</span></a></span><span> </span><span class="annot"><span class="annottext">Statement -&gt; Statement -&gt; Statement
forall b. Boolean b =&gt; b -&gt; b -&gt; b
</span><a href="OAlg.Data.Boolean.Definition.html#%26%26"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Statement
forall a. Validable a =&gt; a -&gt; Statement
</span><a href="OAlg.Data.Validable.html#valid"><span class="hs-identifier hs-var">valid</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679383159"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-141"></span><span>      </span><span id="local-6989586621679383161"><span class="annot"><span class="annottext">ProductForm a a
</span><a href="#local-6989586621679383161"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#%3A%2A"><span class="hs-operator hs-type">:*</span></a></span><span> </span><span id="local-6989586621679383162"><span class="annot"><span class="annottext">ProductForm a a
</span><a href="#local-6989586621679383162"><span class="hs-identifier hs-var">b</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ProductForm a a -&gt; Statement
</span><a href="#local-6989586621679383145"><span class="hs-identifier hs-var">vld</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm a a
</span><a href="#local-6989586621679383161"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Statement -&gt; Statement -&gt; Statement
forall b. Boolean b =&gt; b -&gt; b -&gt; b
</span><a href="OAlg.Data.Boolean.Definition.html#%26%26"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm a a -&gt; Statement
</span><a href="#local-6989586621679383145"><span class="hs-identifier hs-var">vld</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm a a
</span><a href="#local-6989586621679383162"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-142"></span><span>    </span><span>
</span><span id="line-143"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679382452"><span id="local-6989586621679382453"><span class="hs-special">(</span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#Oriented"><span class="hs-identifier hs-type">Oriented</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382452"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Number"><span class="hs-identifier hs-type">Number</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382453"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Definition.html#Entity"><span class="hs-identifier hs-type">Entity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#ProductForm"><span class="hs-identifier hs-type">ProductForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382453"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382452"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-144"></span><span>
</span><span id="line-145"></span><span id="local-6989586621679382454"><span class="annot"><a href="OAlg.Entity.Product.Definition.html#pf"><span class="hs-identifier hs-type">pf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#ProductForm"><span class="hs-identifier hs-type">ProductForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382454"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#Orientation"><span class="hs-identifier hs-type">Orientation</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-146"></span><span id="pf"><span class="annot"><span class="annottext">pf :: forall r. Int -&gt; Char -&gt; ProductForm r (Orientation Char)
</span><a href="OAlg.Entity.Product.Definition.html#pf"><span class="hs-identifier hs-var hs-var">pf</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span id="local-6989586621679383194"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679383194"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point (Orientation Char) -&gt; ProductForm r (Orientation Char)
forall r a. Point a -&gt; ProductForm r a
</span><a href="OAlg.Entity.Product.Definition.html#One"><span class="hs-identifier hs-var">One</span></a></span><span> </span><span class="annot"><span class="annottext">Char
Point (Orientation Char)
</span><a href="#local-6989586621679383194"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-147"></span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#pf"><span class="hs-identifier hs-var">pf</span></a></span><span> </span><span id="local-6989586621679383195"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679383195"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679383196"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679383196"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Orientation Char -&gt; ProductForm r (Orientation Char)
forall r a. a -&gt; ProductForm r a
</span><a href="OAlg.Entity.Product.Definition.html#P"><span class="hs-identifier hs-var">P</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679383196"><span class="hs-identifier hs-var">c</span></a></span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Orientation Char
forall p. p -&gt; p -&gt; Orientation p
</span><a href="OAlg.Structure.Oriented.Definition.html#%3A%3E"><span class="hs-operator hs-var">:&gt;</span></a></span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679383196"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ProductForm r (Orientation Char)
-&gt; ProductForm r (Orientation Char)
-&gt; ProductForm r (Orientation Char)
forall r a. ProductForm r a -&gt; ProductForm r a -&gt; ProductForm r a
</span><a href="OAlg.Entity.Product.Definition.html#%3A%2A"><span class="hs-operator hs-var">:*</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Char -&gt; ProductForm r (Orientation Char)
forall r. Int -&gt; Char -&gt; ProductForm r (Orientation Char)
</span><a href="OAlg.Entity.Product.Definition.html#pf"><span class="hs-identifier hs-var">pf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679383195"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Abelian a =&gt; a -&gt; a -&gt; a
</span><a href="OAlg.Structure.Additive.Definition.html#-"><span class="hs-glyph hs-var">-</span></a></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679383196"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-148"></span><span>
</span><span id="line-149"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-150"></span><span class="hs-comment">-- ProductForm - Oriented -</span><span>
</span><span id="line-151"></span><span>
</span><span id="line-152"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679382443"><span id="local-6989586621679382444"><span id="local-6989586621679383208"><span id="local-6989586621679383211"><span class="hs-special">(</span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#Oriented"><span class="hs-identifier hs-type">Oriented</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382443"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Number"><span class="hs-identifier hs-type">Number</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382444"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#Oriented"><span class="hs-identifier hs-type">Oriented</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#ProductForm"><span class="hs-identifier hs-type">ProductForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382444"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382443"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-153"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Point"><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#Point"><span class="hs-identifier hs-var">Point</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#ProductForm"><span class="hs-identifier hs-type">ProductForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382444"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382443"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382443"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-154"></span><span>  </span><span id="local-6989586621679383255"><span class="annot"><span class="annottext">orientation :: ProductForm r a -&gt; Orientation (Point (ProductForm r a))
</span><a href="OAlg.Structure.Oriented.Definition.html#orientation"><span class="hs-identifier hs-var hs-var hs-var hs-var">orientation</span></a></span></span><span> </span><span id="local-6989586621679383256"><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679383256"><span class="hs-identifier hs-var">pf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679383256"><span class="hs-identifier hs-var">pf</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-155"></span><span>    </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#One"><span class="hs-identifier hs-type">One</span></a></span><span> </span><span id="local-6989586621679383257"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679383257"><span class="hs-identifier hs-var">p</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Point (Orientation (Point a)) -&gt; Orientation (Point a)
forall c. Multiplicative c =&gt; Point c -&gt; c
</span><a href="OAlg.Structure.Multiplicative.Definition.html#one"><span class="hs-identifier hs-var">one</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
Point (Orientation (Point a))
</span><a href="#local-6989586621679383257"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-156"></span><span>    </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span id="local-6989586621679383259"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679383259"><span class="hs-identifier hs-var">a</span></a></span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; Orientation (Point a)
forall q. Oriented q =&gt; q -&gt; Orientation (Point q)
</span><a href="OAlg.Structure.Oriented.Definition.html#orientation"><span class="hs-identifier hs-var">orientation</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679383259"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-157"></span><span>    </span><span id="local-6989586621679383260"><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679383260"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#%3A%5E"><span class="hs-operator hs-type">:^</span></a></span><span> </span><span id="local-6989586621679383261"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679383261"><span class="hs-identifier hs-var">r</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ProductForm r a -&gt; Orientation (Point (ProductForm r a))
forall q. Oriented q =&gt; q -&gt; Orientation (Point q)
</span><a href="OAlg.Structure.Oriented.Definition.html#orientation"><span class="hs-identifier hs-var">orientation</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679383260"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Orientation (Point a) -&gt; r -&gt; Orientation (Point a)
</span><a href="#local-6989586621679383262"><span class="hs-operator hs-var">^</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679383261"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679383262"><span class="annot"><span class="annottext">^ :: Orientation (Point a) -&gt; r -&gt; Orientation (Point a)
</span><a href="#local-6989586621679383262"><span class="hs-operator hs-var hs-var">(^)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Orientation (Point a) -&gt; r -&gt; Orientation (Point a)
forall r.
Number r =&gt;
Orientation (Point a) -&gt; r -&gt; Orientation (Point a)
forall f r. (Real f, Number r) =&gt; f -&gt; r -&gt; f
</span><a href="OAlg.Structure.Exponential.html#power"><span class="hs-identifier hs-var">power</span></a></span><span>
</span><span id="line-158"></span><span>    </span><span id="local-6989586621679383364"><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679383364"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#%3A%2A"><span class="hs-operator hs-type">:*</span></a></span><span> </span><span id="local-6989586621679383365"><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679383365"><span class="hs-identifier hs-var">g</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ProductForm r a -&gt; Orientation (Point (ProductForm r a))
forall q. Oriented q =&gt; q -&gt; Orientation (Point q)
</span><a href="OAlg.Structure.Oriented.Definition.html#orientation"><span class="hs-identifier hs-var">orientation</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679383364"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Orientation (Point a)
-&gt; Orientation (Point a) -&gt; Orientation (Point a)
forall c. Multiplicative c =&gt; c -&gt; c -&gt; c
</span><a href="OAlg.Structure.Multiplicative.Definition.html#%2A"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r a -&gt; Orientation (Point (ProductForm r a))
forall q. Oriented q =&gt; q -&gt; Orientation (Point q)
</span><a href="OAlg.Structure.Oriented.Definition.html#orientation"><span class="hs-identifier hs-var">orientation</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679383365"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-159"></span><span>
</span><span id="line-160"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-161"></span><span class="hs-comment">-- ProductForm - Foldable -</span><span>
</span><span id="line-162"></span><span>
</span><span id="line-163"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679383368"><span id="local-6989586621679383375"><span id="local-6989586621679383380"><span id="local-6989586621679383383"><span id="local-6989586621679383386"><span id="local-6989586621679383389"><span id="local-6989586621679383392"><span id="local-6989586621679383395"><span id="local-6989586621679383398"><span id="local-6989586621679383401"><span id="local-6989586621679383404"><span id="local-6989586621679383407"><span id="local-6989586621679383412"><span id="local-6989586621679383417"><span id="local-6989586621679383422"><span id="local-6989586621679383427"><span class="annot"><span class="hs-identifier hs-type">Foldable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#ProductForm"><span class="hs-identifier hs-type">ProductForm</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-164"></span><span>  </span><span id="local-6989586621679383451"><span class="annot"><span class="annottext">foldMap :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; ProductForm N a -&gt; m
</span><a href="#local-6989586621679383451"><span class="hs-identifier hs-var hs-var hs-var hs-var">foldMap</span></a></span></span><span> </span><span class="annot"><span class="annottext">a -&gt; m
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#One"><span class="hs-identifier hs-type">One</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-165"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span id="local-6989586621679383453"><span class="annot"><span class="annottext">a -&gt; m
</span><a href="#local-6989586621679383453"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span id="local-6989586621679383454"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679383454"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; m
</span><a href="#local-6989586621679383453"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679383454"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-166"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; m
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProductForm N a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#%3A%5E"><span class="hs-operator hs-type">:^</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-167"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span id="local-6989586621679383455"><span class="annot"><span class="annottext">a -&gt; m
</span><a href="#local-6989586621679383455"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679383456"><span class="annot"><span class="annottext">ProductForm N a
</span><a href="#local-6989586621679383456"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#%3A%5E"><span class="hs-operator hs-type">:^</span></a></span><span> </span><span id="local-6989586621679383457"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679383457"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; m) -&gt; ProductForm N a -&gt; m
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; ProductForm N a -&gt; m
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; m
</span><a href="#local-6989586621679383455"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm N a
</span><a href="#local-6989586621679383456"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">m -&gt; m -&gt; m
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; m) -&gt; ProductForm N a -&gt; m
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; ProductForm N a -&gt; m
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; m
</span><a href="#local-6989586621679383455"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProductForm N a
</span><a href="#local-6989586621679383456"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm N a -&gt; N -&gt; ProductForm N a
forall r a. ProductForm r a -&gt; r -&gt; ProductForm r a
</span><a href="OAlg.Entity.Product.Definition.html#%3A%5E"><span class="hs-operator hs-var">:^</span></a></span><span> </span><span class="annot"><span class="annottext">N -&gt; N
forall a. Enum a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">pred</span></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679383457"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-168"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span id="local-6989586621679383459"><span class="annot"><span class="annottext">a -&gt; m
</span><a href="#local-6989586621679383459"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679383460"><span class="annot"><span class="annottext">ProductForm N a
</span><a href="#local-6989586621679383460"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#%3A%2A"><span class="hs-operator hs-type">:*</span></a></span><span> </span><span id="local-6989586621679383461"><span class="annot"><span class="annottext">ProductForm N a
</span><a href="#local-6989586621679383461"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; m) -&gt; ProductForm N a -&gt; m
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; ProductForm N a -&gt; m
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; m
</span><a href="#local-6989586621679383459"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm N a
</span><a href="#local-6989586621679383460"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">m -&gt; m -&gt; m
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; m) -&gt; ProductForm N a -&gt; m
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; ProductForm N a -&gt; m
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; m
</span><a href="#local-6989586621679383459"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm N a
</span><a href="#local-6989586621679383461"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-169"></span><span>
</span><span id="line-170"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-171"></span><span class="hs-comment">-- ProductForm - Canonical -</span><span>
</span><span id="line-172"></span><span>
</span><span id="line-173"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679382512"><span id="local-6989586621679382513"><span class="annot"><a href="OAlg.Data.Canonical.html#Embeddable"><span class="hs-identifier hs-type">Embeddable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382512"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#ProductForm"><span class="hs-identifier hs-type">ProductForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382513"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382512"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-174"></span><span>  </span><span id="local-6989586621679383468"><span class="annot"><span class="annottext">inj :: Path a -&gt; ProductForm r a
</span><a href="OAlg.Data.Canonical.html#inj"><span class="hs-identifier hs-var hs-var hs-var hs-var">inj</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span id="local-6989586621679383469"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679383469"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679383470"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679383470"><span class="hs-identifier hs-var">fs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ProductForm r a -&gt; ProductForm r a -&gt; ProductForm r a)
-&gt; ProductForm r a -&gt; [ProductForm r a] -&gt; ProductForm r a
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="annot"><span class="annottext">ProductForm r a -&gt; ProductForm r a -&gt; ProductForm r a
forall r a. ProductForm r a -&gt; ProductForm r a -&gt; ProductForm r a
</span><a href="OAlg.Entity.Product.Definition.html#%3A%2A"><span class="hs-operator hs-var">(:*)</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point a -&gt; ProductForm r a
forall r a. Point a -&gt; ProductForm r a
</span><a href="OAlg.Entity.Product.Definition.html#One"><span class="hs-identifier hs-var">One</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679383469"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([ProductForm r a] -&gt; ProductForm r a)
-&gt; [ProductForm r a] -&gt; ProductForm r a
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><a href="OAlg.Category.Applicative.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; ProductForm r a) -&gt; [a] -&gt; [ProductForm r a]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; ProductForm r a
forall r a. a -&gt; ProductForm r a
</span><a href="OAlg.Entity.Product.Definition.html#P"><span class="hs-identifier hs-var">P</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679383470"><span class="hs-identifier hs-var">fs</span></a></span><span>
</span><span id="line-175"></span><span>
</span><span id="line-176"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679382521"><span id="local-6989586621679382522"><span class="annot"><a href="OAlg.Data.Canonical.html#Embeddable"><span class="hs-identifier hs-type">Embeddable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382521"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#ProductForm"><span class="hs-identifier hs-type">ProductForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382522"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382521"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-177"></span><span>  </span><span id="local-6989586621679383475"><span class="annot"><span class="annottext">inj :: a -&gt; ProductForm r a
</span><a href="OAlg.Data.Canonical.html#inj"><span class="hs-identifier hs-var hs-var hs-var hs-var">inj</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; ProductForm r a
forall r a. a -&gt; ProductForm r a
</span><a href="OAlg.Entity.Product.Definition.html#P"><span class="hs-identifier hs-var">P</span></a></span><span>
</span><span id="line-178"></span><span>  </span><span>
</span><span id="line-179"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679382527"><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#Oriented"><span class="hs-identifier hs-type">Oriented</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382527"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.Canonical.html#Projectible"><span class="hs-identifier hs-type">Projectible</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382527"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#ProductForm"><span class="hs-identifier hs-type">ProductForm</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382527"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-180"></span><span>  </span><span id="local-6989586621679383484"><span class="annot"><span class="annottext">prj :: ProductForm N a -&gt; Path a
</span><a href="OAlg.Data.Canonical.html#prj"><span class="hs-identifier hs-var hs-var hs-var hs-var">prj</span></a></span></span><span> </span><span id="local-6989586621679383485"><span class="annot"><span class="annottext">ProductForm N a
</span><a href="#local-6989586621679383485"><span class="hs-identifier hs-var">pf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point a -&gt; [a] -&gt; Path a
forall q. Point q -&gt; [q] -&gt; Path q
</span><a href="OAlg.Structure.Oriented.Definition.html#Path"><span class="hs-identifier hs-var">Path</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProductForm N a -&gt; Point (ProductForm N a)
forall q. Oriented q =&gt; q -&gt; Point q
</span><a href="OAlg.Structure.Oriented.Definition.html#start"><span class="hs-identifier hs-var">start</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm N a
</span><a href="#local-6989586621679383485"><span class="hs-identifier hs-var">pf</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProductForm N a -&gt; [a]
forall a. ProductForm N a -&gt; [a]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">toList</span></span><span> </span><span class="annot"><span class="annottext">ProductForm N a
</span><a href="#local-6989586621679383485"><span class="hs-identifier hs-var">pf</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-181"></span><span>
</span><span id="line-182"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679382531"><span id="local-6989586621679382532"><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Integral"><span class="hs-identifier hs-type">Integral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382531"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.Canonical.html#Embeddable"><span class="hs-identifier hs-type">Embeddable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#ProductForm"><span class="hs-identifier hs-type">ProductForm</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382532"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#ProductForm"><span class="hs-identifier hs-type">ProductForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382531"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382532"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-183"></span><span>  </span><span id="local-6989586621679383501"><span class="annot"><span class="annottext">inj :: ProductForm N a -&gt; ProductForm r a
</span><a href="OAlg.Data.Canonical.html#inj"><span class="hs-identifier hs-var hs-var hs-var hs-var">inj</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#One"><span class="hs-identifier hs-type">One</span></a></span><span> </span><span id="local-6989586621679383502"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679383502"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point a -&gt; ProductForm r a
forall r a. Point a -&gt; ProductForm r a
</span><a href="OAlg.Entity.Product.Definition.html#One"><span class="hs-identifier hs-var">One</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679383502"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-184"></span><span>  </span><span class="annot"><a href="OAlg.Data.Canonical.html#inj"><span class="hs-identifier hs-var">inj</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span id="local-6989586621679383503"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679383503"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; ProductForm r a
forall r a. a -&gt; ProductForm r a
</span><a href="OAlg.Entity.Product.Definition.html#P"><span class="hs-identifier hs-var">P</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679383503"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-185"></span><span>  </span><span class="annot"><a href="OAlg.Data.Canonical.html#inj"><span class="hs-identifier hs-var">inj</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679383504"><span class="annot"><span class="annottext">ProductForm N a
</span><a href="#local-6989586621679383504"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#%3A%5E"><span class="hs-operator hs-type">:^</span></a></span><span> </span><span id="local-6989586621679383505"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679383505"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProductForm N a -&gt; ProductForm r a
forall a b. Embeddable a b =&gt; a -&gt; b
</span><a href="OAlg.Data.Canonical.html#inj"><span class="hs-identifier hs-var">inj</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm N a
</span><a href="#local-6989586621679383504"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r a -&gt; r -&gt; ProductForm r a
forall r a. ProductForm r a -&gt; r -&gt; ProductForm r a
</span><a href="OAlg.Entity.Product.Definition.html#%3A%5E"><span class="hs-operator hs-var">:^</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">N -&gt; r -&gt; r
forall a. Additive a =&gt; N -&gt; a -&gt; a
</span><a href="OAlg.Structure.Additive.Definition.html#ntimes"><span class="hs-identifier hs-var">ntimes</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679383505"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">r
forall r. Semiring r =&gt; r
</span><a href="OAlg.Structure.Ring.Definition.html#rOne"><span class="hs-identifier hs-var">rOne</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-186"></span><span>  </span><span class="annot"><a href="OAlg.Data.Canonical.html#inj"><span class="hs-identifier hs-var">inj</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679383508"><span class="annot"><span class="annottext">ProductForm N a
</span><a href="#local-6989586621679383508"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#%3A%2A"><span class="hs-operator hs-type">:*</span></a></span><span> </span><span id="local-6989586621679383509"><span class="annot"><span class="annottext">ProductForm N a
</span><a href="#local-6989586621679383509"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProductForm N a -&gt; ProductForm r a
forall a b. Embeddable a b =&gt; a -&gt; b
</span><a href="OAlg.Data.Canonical.html#inj"><span class="hs-identifier hs-var">inj</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm N a
</span><a href="#local-6989586621679383508"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r a -&gt; ProductForm r a -&gt; ProductForm r a
forall r a. ProductForm r a -&gt; ProductForm r a -&gt; ProductForm r a
</span><a href="OAlg.Entity.Product.Definition.html#%3A%2A"><span class="hs-operator hs-var">:*</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm N a -&gt; ProductForm r a
forall a b. Embeddable a b =&gt; a -&gt; b
</span><a href="OAlg.Data.Canonical.html#inj"><span class="hs-identifier hs-var">inj</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm N a
</span><a href="#local-6989586621679383509"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-187"></span><span>
</span><span id="line-188"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679382538"><span id="local-6989586621679382539"><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Integral"><span class="hs-identifier hs-type">Integral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382538"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.Canonical.html#Projectible"><span class="hs-identifier hs-type">Projectible</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#ProductForm"><span class="hs-identifier hs-type">ProductForm</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382539"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#ProductForm"><span class="hs-identifier hs-type">ProductForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382538"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382539"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-189"></span><span>  </span><span id="local-6989586621679383520"><span class="annot"><span class="annottext">prj :: ProductForm r a -&gt; ProductForm N a
</span><a href="OAlg.Data.Canonical.html#prj"><span class="hs-identifier hs-var hs-var hs-var hs-var">prj</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#One"><span class="hs-identifier hs-type">One</span></a></span><span> </span><span id="local-6989586621679383521"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679383521"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point a -&gt; ProductForm N a
forall r a. Point a -&gt; ProductForm r a
</span><a href="OAlg.Entity.Product.Definition.html#One"><span class="hs-identifier hs-var">One</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679383521"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-190"></span><span>  </span><span class="annot"><a href="OAlg.Data.Canonical.html#prj"><span class="hs-identifier hs-var">prj</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span id="local-6989586621679383522"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679383522"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; ProductForm N a
forall r a. a -&gt; ProductForm r a
</span><a href="OAlg.Entity.Product.Definition.html#P"><span class="hs-identifier hs-var">P</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679383522"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-191"></span><span>  </span><span class="annot"><a href="OAlg.Data.Canonical.html#prj"><span class="hs-identifier hs-var">prj</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679383523"><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679383523"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#%3A%5E"><span class="hs-operator hs-type">:^</span></a></span><span> </span><span id="local-6989586621679383524"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679383524"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProductForm r a -&gt; ProductForm N a
forall a b. Projectible a b =&gt; b -&gt; a
</span><a href="OAlg.Data.Canonical.html#prj"><span class="hs-identifier hs-var">prj</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679383523"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm N a -&gt; N -&gt; ProductForm N a
forall r a. ProductForm r a -&gt; r -&gt; ProductForm r a
</span><a href="OAlg.Entity.Product.Definition.html#%3A%5E"><span class="hs-operator hs-var">:^</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679383525"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679383525"><span class="annot"><span class="annottext">n :: N
</span><a href="#local-6989586621679383525"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Z -&gt; N
forall a b. Projectible a b =&gt; b -&gt; a
</span><a href="OAlg.Data.Canonical.html#prj"><span class="hs-identifier hs-var">prj</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r -&gt; Z
forall r. Number r =&gt; r -&gt; Z
</span><a href="OAlg.Structure.Number.Definition.html#zFloor"><span class="hs-identifier hs-var">zFloor</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679383524"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-192"></span><span>  </span><span class="annot"><a href="OAlg.Data.Canonical.html#prj"><span class="hs-identifier hs-var">prj</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679383527"><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679383527"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#%3A%2A"><span class="hs-operator hs-type">:*</span></a></span><span> </span><span id="local-6989586621679383528"><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679383528"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProductForm r a -&gt; ProductForm N a
forall a b. Projectible a b =&gt; b -&gt; a
</span><a href="OAlg.Data.Canonical.html#prj"><span class="hs-identifier hs-var">prj</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679383527"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm N a -&gt; ProductForm N a -&gt; ProductForm N a
forall r a. ProductForm r a -&gt; ProductForm r a -&gt; ProductForm r a
</span><a href="OAlg.Entity.Product.Definition.html#%3A%2A"><span class="hs-operator hs-var">:*</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r a -&gt; ProductForm N a
forall a b. Projectible a b =&gt; b -&gt; a
</span><a href="OAlg.Data.Canonical.html#prj"><span class="hs-identifier hs-var">prj</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679383528"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-193"></span><span>  </span><span>
</span><span id="line-194"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-195"></span><span class="hs-comment">-- prfopl -</span><span>
</span><span id="line-196"></span><span>
</span><span id="line-197"></span><span class="annot"><span class="hs-comment">-- | applicative operation from the left.</span></span><span>
</span><span id="line-198"></span><span id="local-6989586621679382542"><span id="local-6989586621679382543"><span class="annot"><a href="OAlg.Entity.Product.Definition.html#prfopl"><span class="hs-identifier hs-type">prfopl</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679382542"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679382543"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679382543"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#ProductForm"><span class="hs-identifier hs-type">ProductForm</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382542"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679382543"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679382543"><span class="hs-identifier hs-type">x</span></a></span></span></span><span>
</span><span id="line-199"></span><span id="prfopl"><span class="annot"><span class="annottext">prfopl :: forall t x. (t -&gt; x -&gt; x) -&gt; ProductForm N t -&gt; x -&gt; x
</span><a href="OAlg.Entity.Product.Definition.html#prfopl"><span class="hs-identifier hs-var hs-var">prfopl</span></a></span></span><span> </span><span id="local-6989586621679383532"><span class="annot"><span class="annottext">t -&gt; x -&gt; x
</span><a href="#local-6989586621679383532"><span class="hs-operator hs-var">(*&gt;)</span></a></span></span><span> </span><span id="local-6989586621679383533"><span class="annot"><span class="annottext">ProductForm N t
</span><a href="#local-6989586621679383533"><span class="hs-identifier hs-var">pf</span></a></span></span><span> </span><span id="local-6989586621679383534"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679383534"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ProductForm N t
</span><a href="#local-6989586621679383533"><span class="hs-identifier hs-var">pf</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-200"></span><span>  </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#One"><span class="hs-identifier hs-type">One</span></a></span><span> </span><span class="annot"><span class="annottext">Point t
</span><span class="hs-identifier">_</span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679383534"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-201"></span><span>  </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span id="local-6989586621679383535"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679383535"><span class="hs-identifier hs-var">t</span></a></span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679383535"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">t -&gt; x -&gt; x
</span><a href="#local-6989586621679383532"><span class="hs-operator hs-var">*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679383534"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-202"></span><span>  </span><span class="annot"><span class="annottext">ProductForm N t
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#%3A%5E"><span class="hs-operator hs-type">:^</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679383534"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-203"></span><span>  </span><span id="local-6989586621679383536"><span class="annot"><span class="annottext">ProductForm N t
</span><a href="#local-6989586621679383536"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#%3A%5E"><span class="hs-operator hs-type">:^</span></a></span><span> </span><span id="local-6989586621679383537"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679383537"><span class="hs-identifier hs-var">n</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(t -&gt; x -&gt; x) -&gt; ProductForm N t -&gt; x -&gt; x
forall t x. (t -&gt; x -&gt; x) -&gt; ProductForm N t -&gt; x -&gt; x
</span><a href="OAlg.Entity.Product.Definition.html#prfopl"><span class="hs-identifier hs-var">prfopl</span></a></span><span> </span><span class="annot"><span class="annottext">t -&gt; x -&gt; x
</span><a href="#local-6989586621679383532"><span class="hs-operator hs-var">(*&gt;)</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProductForm N t
</span><a href="#local-6989586621679383536"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm N t -&gt; N -&gt; ProductForm N t
forall r a. ProductForm r a -&gt; r -&gt; ProductForm r a
</span><a href="OAlg.Entity.Product.Definition.html#%3A%5E"><span class="hs-operator hs-var">:^</span></a></span><span> </span><span class="annot"><span class="annottext">N -&gt; N
forall a. Enum a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">pred</span></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679383537"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(t -&gt; x -&gt; x) -&gt; ProductForm N t -&gt; x -&gt; x
forall t x. (t -&gt; x -&gt; x) -&gt; ProductForm N t -&gt; x -&gt; x
</span><a href="OAlg.Entity.Product.Definition.html#prfopl"><span class="hs-identifier hs-var">prfopl</span></a></span><span> </span><span class="annot"><span class="annottext">t -&gt; x -&gt; x
</span><a href="#local-6989586621679383532"><span class="hs-operator hs-var">(*&gt;)</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm N t
</span><a href="#local-6989586621679383536"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679383534"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-204"></span><span>  </span><span id="local-6989586621679383538"><span class="annot"><span class="annottext">ProductForm N t
</span><a href="#local-6989586621679383538"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#%3A%2A"><span class="hs-operator hs-type">:*</span></a></span><span> </span><span id="local-6989586621679383539"><span class="annot"><span class="annottext">ProductForm N t
</span><a href="#local-6989586621679383539"><span class="hs-identifier hs-var">b</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(t -&gt; x -&gt; x) -&gt; ProductForm N t -&gt; x -&gt; x
forall t x. (t -&gt; x -&gt; x) -&gt; ProductForm N t -&gt; x -&gt; x
</span><a href="OAlg.Entity.Product.Definition.html#prfopl"><span class="hs-identifier hs-var">prfopl</span></a></span><span> </span><span class="annot"><span class="annottext">t -&gt; x -&gt; x
</span><a href="#local-6989586621679383532"><span class="hs-operator hs-var">(*&gt;)</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm N t
</span><a href="#local-6989586621679383538"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(t -&gt; x -&gt; x) -&gt; ProductForm N t -&gt; x -&gt; x
forall t x. (t -&gt; x -&gt; x) -&gt; ProductForm N t -&gt; x -&gt; x
</span><a href="OAlg.Entity.Product.Definition.html#prfopl"><span class="hs-identifier hs-var">prfopl</span></a></span><span> </span><span class="annot"><span class="annottext">t -&gt; x -&gt; x
</span><a href="#local-6989586621679383532"><span class="hs-operator hs-var">(*&gt;)</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm N t
</span><a href="#local-6989586621679383539"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679383534"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-205"></span><span>
</span><span id="line-206"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-207"></span><span class="hs-comment">-- prfopl' -</span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span><span class="hs-comment">-- | partially strict version of 'prfopl', i.e. every @n@-th application will be</span><span>
</span><span id="line-210"></span><span class="hs-comment">-- reduced to head normal form.</span><span>
</span><span id="line-211"></span><span class="hs-comment">--</span><span>
</span><span id="line-212"></span><span class="hs-comment">-- Let @x' = 'prfopl'' n op p x@.</span><span>
</span><span id="line-213"></span><span class="hs-comment">--</span><span>
</span><span id="line-214"></span><span class="hs-comment">-- __Pre__ @0 '&lt;' n@.</span><span>
</span><span id="line-215"></span><span class="hs-comment">--</span><span>
</span><span id="line-216"></span><span class="hs-comment">-- __Post__ @x' '==' 'prfopl' op p x@.</span><span>
</span><span id="line-217"></span><span id="local-6989586621679382546"><span id="local-6989586621679382547"><span class="annot"><a href="OAlg.Entity.Product.Definition.html#prfopl%27"><span class="hs-identifier hs-type">prfopl'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679382546"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679382547"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679382547"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#ProductForm"><span class="hs-identifier hs-type">ProductForm</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382546"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679382547"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679382547"><span class="hs-identifier hs-type">x</span></a></span></span></span><span>
</span><span id="line-218"></span><span id="prfopl%27"><span class="annot"><span class="annottext">prfopl' :: forall t x. N -&gt; (t -&gt; x -&gt; x) -&gt; ProductForm N t -&gt; x -&gt; x
</span><a href="OAlg.Entity.Product.Definition.html#prfopl%27"><span class="hs-identifier hs-var hs-var">prfopl'</span></a></span></span><span> </span><span id="local-6989586621679383550"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679383550"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679383551"><span class="annot"><span class="annottext">t -&gt; x -&gt; x
</span><a href="#local-6989586621679383551"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621679383552"><span class="annot"><span class="annottext">ProductForm N t
</span><a href="#local-6989586621679383552"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679383553"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679383553"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(x, N) -&gt; x
forall a b. (a, b) -&gt; a
</span><a href="OAlg.Category.Definition.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">((x, N) -&gt; x) -&gt; (x, N) -&gt; x
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><a href="OAlg.Category.Applicative.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(t -&gt; (x, N) -&gt; (x, N)) -&gt; ProductForm N t -&gt; (x, N) -&gt; (x, N)
forall t x. (t -&gt; x -&gt; x) -&gt; ProductForm N t -&gt; x -&gt; x
</span><a href="OAlg.Entity.Product.Definition.html#prfopl"><span class="hs-identifier hs-var">prfopl</span></a></span><span> </span><span class="annot"><span class="annottext">t -&gt; (x, N) -&gt; (x, N)
</span><a href="#local-6989586621679383555"><span class="hs-identifier hs-var">op'</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm N t
</span><a href="#local-6989586621679383552"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679383553"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-219"></span><span>  </span><span id="local-6989586621679383555"><span class="annot"><span class="annottext">op' :: t -&gt; (x, N) -&gt; (x, N)
</span><a href="#local-6989586621679383555"><span class="hs-identifier hs-var hs-var">op'</span></a></span></span><span> </span><span id="local-6989586621679383556"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679383556"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679383557"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679383557"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679383558"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679383558"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679383558"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; N
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><a href="OAlg.Structure.Number.Definition.html#mod"><span class="hs-operator hs-var">`mod`</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679383550"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span>
</span><span id="line-220"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679383560"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">x -&gt; (x, N) -&gt; (x, N)
forall a b. a -&gt; b -&gt; b
</span><span class="hs-operator hs-var">`seq`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679383560"><span class="hs-identifier hs-var">x'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679383560"><span class="hs-identifier hs-var">x'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679383558"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">N -&gt; N -&gt; N
forall a. Additive a =&gt; a -&gt; a -&gt; a
</span><a href="OAlg.Structure.Additive.Definition.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span class="annot"><span class="annottext">N
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679383560"><span class="annot"><span class="annottext">x' :: x
</span><a href="#local-6989586621679383560"><span class="hs-identifier hs-var hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679383556"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">t -&gt; x -&gt; x
</span><a href="#local-6989586621679383551"><span class="hs-operator hs-var">`op`</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679383557"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-221"></span><span>
</span><span id="line-222"></span><span>
</span><span id="line-223"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-224"></span><span class="hs-comment">-- prfopr -</span><span>
</span><span id="line-225"></span><span>
</span><span id="line-226"></span><span class="annot"><span class="hs-comment">-- | applicative operation from the right.</span></span><span>
</span><span id="line-227"></span><span id="local-6989586621679383562"><span id="local-6989586621679383563"><span class="annot"><a href="OAlg.Entity.Product.Definition.html#prfopr"><span class="hs-identifier hs-type">prfopr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679383562"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679383563"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679383562"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679383562"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#ProductForm"><span class="hs-identifier hs-type">ProductForm</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679383563"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679383562"><span class="hs-identifier hs-type">x</span></a></span></span></span><span>
</span><span id="line-228"></span><span id="prfopr"><span class="annot"><span class="annottext">prfopr :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; ProductForm N a -&gt; b
</span><a href="OAlg.Entity.Product.Definition.html#prfopr"><span class="hs-identifier hs-var hs-var">prfopr</span></a></span></span><span> </span><span id="local-6989586621679383567"><span class="annot"><span class="annottext">x -&gt; t -&gt; x
</span><a href="#local-6989586621679383567"><span class="hs-operator hs-var">(&lt;*)</span></a></span></span><span> </span><span id="local-6989586621679383568"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679383568"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679383569"><span class="annot"><span class="annottext">ProductForm N t
</span><a href="#local-6989586621679383569"><span class="hs-identifier hs-var">pf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ProductForm N t
</span><a href="#local-6989586621679383569"><span class="hs-identifier hs-var">pf</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-229"></span><span>  </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#One"><span class="hs-identifier hs-type">One</span></a></span><span> </span><span class="annot"><span class="annottext">Point t
</span><span class="hs-identifier">_</span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679383568"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-230"></span><span>  </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span id="local-6989586621679383570"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679383570"><span class="hs-identifier hs-var">t</span></a></span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679383568"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">x -&gt; t -&gt; x
</span><a href="#local-6989586621679383567"><span class="hs-operator hs-var">&lt;*</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679383570"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-231"></span><span>  </span><span class="annot"><span class="annottext">ProductForm N t
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#%3A%5E"><span class="hs-operator hs-type">:^</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679383568"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-232"></span><span>  </span><span id="local-6989586621679383571"><span class="annot"><span class="annottext">ProductForm N t
</span><a href="#local-6989586621679383571"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#%3A%5E"><span class="hs-operator hs-type">:^</span></a></span><span> </span><span id="local-6989586621679383572"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679383572"><span class="hs-identifier hs-var">n</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(x -&gt; t -&gt; x) -&gt; x -&gt; ProductForm N t -&gt; x
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; ProductForm N a -&gt; b
</span><a href="OAlg.Entity.Product.Definition.html#prfopr"><span class="hs-identifier hs-var">prfopr</span></a></span><span> </span><span class="annot"><span class="annottext">x -&gt; t -&gt; x
</span><a href="#local-6989586621679383567"><span class="hs-operator hs-var">(&lt;*)</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(x -&gt; t -&gt; x) -&gt; x -&gt; ProductForm N t -&gt; x
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; ProductForm N a -&gt; b
</span><a href="OAlg.Entity.Product.Definition.html#prfopr"><span class="hs-identifier hs-var">prfopr</span></a></span><span> </span><span class="annot"><span class="annottext">x -&gt; t -&gt; x
</span><a href="#local-6989586621679383567"><span class="hs-operator hs-var">(&lt;*)</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679383568"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm N t
</span><a href="#local-6989586621679383571"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProductForm N t
</span><a href="#local-6989586621679383571"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm N t -&gt; N -&gt; ProductForm N t
forall r a. ProductForm r a -&gt; r -&gt; ProductForm r a
</span><a href="OAlg.Entity.Product.Definition.html#%3A%5E"><span class="hs-operator hs-var">:^</span></a></span><span> </span><span class="annot"><span class="annottext">N -&gt; N
forall a. Enum a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">pred</span></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679383572"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-233"></span><span>  </span><span id="local-6989586621679383573"><span class="annot"><span class="annottext">ProductForm N t
</span><a href="#local-6989586621679383573"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#%3A%2A"><span class="hs-operator hs-type">:*</span></a></span><span> </span><span id="local-6989586621679383574"><span class="annot"><span class="annottext">ProductForm N t
</span><a href="#local-6989586621679383574"><span class="hs-identifier hs-var">b</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(x -&gt; t -&gt; x) -&gt; x -&gt; ProductForm N t -&gt; x
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; ProductForm N a -&gt; b
</span><a href="OAlg.Entity.Product.Definition.html#prfopr"><span class="hs-identifier hs-var">prfopr</span></a></span><span> </span><span class="annot"><span class="annottext">x -&gt; t -&gt; x
</span><a href="#local-6989586621679383567"><span class="hs-operator hs-var">(&lt;*)</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(x -&gt; t -&gt; x) -&gt; x -&gt; ProductForm N t -&gt; x
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; ProductForm N a -&gt; b
</span><a href="OAlg.Entity.Product.Definition.html#prfopr"><span class="hs-identifier hs-var">prfopr</span></a></span><span> </span><span class="annot"><span class="annottext">x -&gt; t -&gt; x
</span><a href="#local-6989586621679383567"><span class="hs-operator hs-var">(&lt;*)</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679383568"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm N t
</span><a href="#local-6989586621679383573"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ProductForm N t
</span><a href="#local-6989586621679383574"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-234"></span><span>  </span><span>
</span><span id="line-235"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-236"></span><span class="hs-comment">-- prfopr' -</span><span>
</span><span id="line-237"></span><span>
</span><span id="line-238"></span><span class="hs-comment">-- | partially strict version of 'prfopr', i.e. every @n@-th application will be</span><span>
</span><span id="line-239"></span><span class="hs-comment">-- reduced to head normal form.</span><span>
</span><span id="line-240"></span><span class="hs-comment">--</span><span>
</span><span id="line-241"></span><span class="hs-comment">-- Let @x' = 'prfopr'' n op x p@.</span><span>
</span><span id="line-242"></span><span class="hs-comment">--</span><span>
</span><span id="line-243"></span><span class="hs-comment">-- __Pre__ @0 '&lt;' n@.</span><span>
</span><span id="line-244"></span><span class="hs-comment">--</span><span>
</span><span id="line-245"></span><span class="hs-comment">-- __Post__ @x' '==' 'prfopr' op x p@.</span><span>
</span><span id="line-246"></span><span id="local-6989586621679382555"><span id="local-6989586621679382556"><span class="annot"><a href="OAlg.Entity.Product.Definition.html#prfopr%27"><span class="hs-identifier hs-type">prfopr'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679382555"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679382556"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679382555"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679382555"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#ProductForm"><span class="hs-identifier hs-type">ProductForm</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382556"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679382555"><span class="hs-identifier hs-type">x</span></a></span></span></span><span>
</span><span id="line-247"></span><span id="prfopr%27"><span class="annot"><span class="annottext">prfopr' :: forall x t. N -&gt; (x -&gt; t -&gt; x) -&gt; x -&gt; ProductForm N t -&gt; x
</span><a href="OAlg.Entity.Product.Definition.html#prfopr%27"><span class="hs-identifier hs-var hs-var">prfopr'</span></a></span></span><span> </span><span id="local-6989586621679383583"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679383583"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679383584"><span class="annot"><span class="annottext">x -&gt; t -&gt; x
</span><a href="#local-6989586621679383584"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621679383585"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679383585"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679383586"><span class="annot"><span class="annottext">ProductForm N t
</span><a href="#local-6989586621679383586"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(x, N) -&gt; x
forall a b. (a, b) -&gt; a
</span><a href="OAlg.Category.Definition.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">((x, N) -&gt; x) -&gt; (x, N) -&gt; x
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><a href="OAlg.Category.Applicative.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">((x, N) -&gt; t -&gt; (x, N)) -&gt; (x, N) -&gt; ProductForm N t -&gt; (x, N)
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; ProductForm N a -&gt; b
</span><a href="OAlg.Entity.Product.Definition.html#prfopr"><span class="hs-identifier hs-var">prfopr</span></a></span><span> </span><span class="annot"><span class="annottext">(x, N) -&gt; t -&gt; (x, N)
</span><a href="#local-6989586621679383587"><span class="hs-identifier hs-var">op'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679383585"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ProductForm N t
</span><a href="#local-6989586621679383586"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-248"></span><span>  </span><span id="local-6989586621679383587"><span class="annot"><span class="annottext">op' :: (x, N) -&gt; t -&gt; (x, N)
</span><a href="#local-6989586621679383587"><span class="hs-identifier hs-var hs-var">op'</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679383588"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679383588"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679383589"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679383589"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679383590"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679383590"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679383589"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; N
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><a href="OAlg.Structure.Number.Definition.html#mod"><span class="hs-operator hs-var">`mod`</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679383583"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span>
</span><span id="line-249"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679383591"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">x -&gt; (x, N) -&gt; (x, N)
forall a b. a -&gt; b -&gt; b
</span><span class="hs-operator hs-var">`seq`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679383591"><span class="hs-identifier hs-var">x'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679383591"><span class="hs-identifier hs-var">x'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679383589"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">N -&gt; N -&gt; N
forall a. Additive a =&gt; a -&gt; a -&gt; a
</span><a href="OAlg.Structure.Additive.Definition.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span class="annot"><span class="annottext">N
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679383591"><span class="annot"><span class="annottext">x' :: x
</span><a href="#local-6989586621679383591"><span class="hs-identifier hs-var hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679383588"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">x -&gt; t -&gt; x
</span><a href="#local-6989586621679383584"><span class="hs-operator hs-var">`op`</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679383590"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-250"></span><span>
</span><span id="line-251"></span><span>
</span><span id="line-252"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-253"></span><span class="hs-comment">-- prfLength -</span><span>
</span><span id="line-254"></span><span>
</span><span id="line-255"></span><span class="annot"><span class="hs-comment">-- | length.</span></span><span>
</span><span id="line-256"></span><span id="local-6989586621679382559"><span id="local-6989586621679382560"><span class="annot"><a href="OAlg.Entity.Product.Definition.html#prfLength"><span class="hs-identifier hs-type">prfLength</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Number"><span class="hs-identifier hs-type">Number</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382559"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#ProductForm"><span class="hs-identifier hs-type">ProductForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382559"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382560"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span></span></span><span>
</span><span id="line-257"></span><span id="prfLength"><span class="annot"><span class="annottext">prfLength :: forall r a. Number r =&gt; ProductForm r a -&gt; N
</span><a href="OAlg.Entity.Product.Definition.html#prfLength"><span class="hs-identifier hs-var hs-var">prfLength</span></a></span></span><span> </span><span id="local-6989586621679383603"><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679383603"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679383603"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-258"></span><span>  </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#One"><span class="hs-identifier hs-type">One</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span>
</span><span id="line-259"></span><span>  </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">1</span></span><span>
</span><span id="line-260"></span><span>  </span><span id="local-6989586621679383604"><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679383604"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#%3A%5E"><span class="hs-operator hs-type">:^</span></a></span><span> </span><span id="local-6989586621679383605"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679383605"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ProductForm r a -&gt; N
forall r a. Number r =&gt; ProductForm r a -&gt; N
</span><a href="OAlg.Entity.Product.Definition.html#prfLength"><span class="hs-identifier hs-var">prfLength</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679383604"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; N
forall c. Multiplicative c =&gt; c -&gt; c -&gt; c
</span><a href="OAlg.Structure.Multiplicative.Definition.html#%2A"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; N
forall {r} {b}. (Projectible b Z, Number r) =&gt; r -&gt; b
</span><a href="#local-6989586621679383606"><span class="hs-identifier hs-var">nFloor</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679383605"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-261"></span><span>  </span><span id="local-6989586621679383607"><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679383607"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#%3A%2A"><span class="hs-operator hs-type">:*</span></a></span><span> </span><span id="local-6989586621679383608"><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679383608"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ProductForm r a -&gt; N
forall r a. Number r =&gt; ProductForm r a -&gt; N
</span><a href="OAlg.Entity.Product.Definition.html#prfLength"><span class="hs-identifier hs-var">prfLength</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679383607"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; N
forall a. Additive a =&gt; a -&gt; a -&gt; a
</span><a href="OAlg.Structure.Additive.Definition.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r a -&gt; N
forall r a. Number r =&gt; ProductForm r a -&gt; N
</span><a href="OAlg.Entity.Product.Definition.html#prfLength"><span class="hs-identifier hs-var">prfLength</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679383608"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-262"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679383606"><span class="annot"><span class="annottext">nFloor :: r -&gt; b
</span><a href="#local-6989586621679383606"><span class="hs-identifier hs-var hs-var">nFloor</span></a></span></span><span> </span><span id="local-6989586621679383719"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679383719"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Z -&gt; b
forall a b. Projectible a b =&gt; b -&gt; a
</span><a href="OAlg.Data.Canonical.html#prj"><span class="hs-identifier hs-var">prj</span></a></span><span> </span><span class="annot"><span class="annottext">(Z -&gt; b) -&gt; Z -&gt; b
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><a href="OAlg.Category.Applicative.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Z, r) -&gt; Z
forall a b. (a, b) -&gt; a
</span><a href="OAlg.Category.Definition.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">((Z, r) -&gt; Z) -&gt; (Z, r) -&gt; Z
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><a href="OAlg.Category.Applicative.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; (Z, r)
forall r. Number r =&gt; r -&gt; (Z, r)
</span><a href="OAlg.Structure.Number.Definition.html#zFloorFraction"><span class="hs-identifier hs-var">zFloorFraction</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679383719"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-263"></span><span>
</span><span id="line-264"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679382568"><span class="annot"><a href="OAlg.Data.Number.html#LengthN"><span class="hs-identifier hs-type">LengthN</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#ProductForm"><span class="hs-identifier hs-type">ProductForm</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382568"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-265"></span><span>  </span><span id="local-6989586621679383725"><span class="annot"><span class="annottext">lengthN :: ProductForm N a -&gt; N
</span><a href="#local-6989586621679383725"><span class="hs-identifier hs-var hs-var hs-var hs-var">lengthN</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProductForm N a -&gt; N
forall r a. Number r =&gt; ProductForm r a -&gt; N
</span><a href="OAlg.Entity.Product.Definition.html#prfLength"><span class="hs-identifier hs-var">prfLength</span></a></span><span>
</span><span id="line-266"></span><span>  </span><span>
</span><span id="line-267"></span><span class="hs-comment">----------------------------------------</span><span>
</span><span id="line-268"></span><span class="hs-comment">-- prfDepth -</span><span>
</span><span id="line-269"></span><span>
</span><span id="line-270"></span><span class="annot"><span class="hs-comment">-- | depth.</span></span><span>
</span><span id="line-271"></span><span id="local-6989586621679382569"><span id="local-6989586621679382570"><span class="annot"><a href="OAlg.Entity.Product.Definition.html#prfDepth"><span class="hs-identifier hs-type">prfDepth</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#ProductForm"><span class="hs-identifier hs-type">ProductForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382569"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382570"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span></span></span><span>
</span><span id="line-272"></span><span id="prfDepth"><span class="annot"><span class="annottext">prfDepth :: forall r a. ProductForm r a -&gt; N
</span><a href="OAlg.Entity.Product.Definition.html#prfDepth"><span class="hs-identifier hs-var hs-var">prfDepth</span></a></span></span><span> </span><span id="local-6989586621679383734"><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679383734"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679383734"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-273"></span><span>  </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#One"><span class="hs-identifier hs-type">One</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span>
</span><span id="line-274"></span><span>  </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">1</span></span><span>
</span><span id="line-275"></span><span>  </span><span id="local-6989586621679383735"><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679383735"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#%3A%5E"><span class="hs-operator hs-type">:^</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ProductForm r a -&gt; N
forall r a. ProductForm r a -&gt; N
</span><a href="OAlg.Entity.Product.Definition.html#prfDepth"><span class="hs-identifier hs-var">prfDepth</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679383735"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; N
forall a. Additive a =&gt; a -&gt; a -&gt; a
</span><a href="OAlg.Structure.Additive.Definition.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">1</span></span><span>
</span><span id="line-276"></span><span>  </span><span id="local-6989586621679383736"><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679383736"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#%3A%2A"><span class="hs-operator hs-type">:*</span></a></span><span> </span><span id="local-6989586621679383737"><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679383737"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; N
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProductForm r a -&gt; N
forall r a. ProductForm r a -&gt; N
</span><a href="OAlg.Entity.Product.Definition.html#prfDepth"><span class="hs-identifier hs-var">prfDepth</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679383736"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProductForm r a -&gt; N
forall r a. ProductForm r a -&gt; N
</span><a href="OAlg.Entity.Product.Definition.html#prfDepth"><span class="hs-identifier hs-var">prfDepth</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679383737"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; N
forall a. Additive a =&gt; a -&gt; a -&gt; a
</span><a href="OAlg.Structure.Additive.Definition.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">1</span></span><span>
</span><span id="line-277"></span><span>
</span><span id="line-278"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-279"></span><span class="hs-comment">-- Word -</span><span>
</span><span id="line-280"></span><span>
</span><span id="line-281"></span><span class="annot"><span class="hs-comment">-- | list of symbols in @__a__@ together with an exponent in @__r__@.</span></span><span>
</span><span id="line-282"></span><span class="hs-keyword">newtype</span><span> </span><span id="Word"><span class="annot"><a href="OAlg.Entity.Product.Definition.html#Word"><span class="hs-identifier hs-var">Word</span></a></span></span><span> </span><span id="local-6989586621679382605"><span class="annot"><a href="#local-6989586621679382605"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span id="local-6989586621679382604"><span class="annot"><a href="#local-6989586621679382604"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Word"><span class="annot"><a href="OAlg.Entity.Product.Definition.html#Word"><span class="hs-identifier hs-var">Word</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679382604"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679382605"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679383743"><span id="local-6989586621679383749"><span id="local-6989586621679383753"><span class="annot"><span class="annottext">Int -&gt; Word r a -&gt; ShowS
[Word r a] -&gt; ShowS
Word r a -&gt; String
(Int -&gt; Word r a -&gt; ShowS)
-&gt; (Word r a -&gt; String) -&gt; ([Word r a] -&gt; ShowS) -&gt; Show (Word r a)
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall r a. (Show a, Show r) =&gt; Int -&gt; Word r a -&gt; ShowS
forall r a. (Show a, Show r) =&gt; [Word r a] -&gt; ShowS
forall r a. (Show a, Show r) =&gt; Word r a -&gt; String
$cshowsPrec :: forall r a. (Show a, Show r) =&gt; Int -&gt; Word r a -&gt; ShowS
showsPrec :: Int -&gt; Word r a -&gt; ShowS
$cshow :: forall r a. (Show a, Show r) =&gt; Word r a -&gt; String
show :: Word r a -&gt; String
$cshowList :: forall r a. (Show a, Show r) =&gt; [Word r a] -&gt; ShowS
showList :: [Word r a] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679383759"><span id="local-6989586621679383765"><span class="annot"><span class="annottext">Word r a -&gt; Word r a -&gt; Bool
(Word r a -&gt; Word r a -&gt; Bool)
-&gt; (Word r a -&gt; Word r a -&gt; Bool) -&gt; Eq (Word r a)
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall r a. (Eq a, Eq r) =&gt; Word r a -&gt; Word r a -&gt; Bool
$c== :: forall r a. (Eq a, Eq r) =&gt; Word r a -&gt; Word r a -&gt; Bool
== :: Word r a -&gt; Word r a -&gt; Bool
$c/= :: forall r a. (Eq a, Eq r) =&gt; Word r a -&gt; Word r a -&gt; Bool
/= :: Word r a -&gt; Word r a -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679383774"><span class="annot"><span class="annottext">Word r a -&gt; Statement
(Word r a -&gt; Statement) -&gt; Validable (Word r a)
forall a. (a -&gt; Statement) -&gt; Validable a
forall r a. (Validable a, Validable r) =&gt; Word r a -&gt; Statement
$cvalid :: forall r a. (Validable a, Validable r) =&gt; Word r a -&gt; Statement
valid :: Word r a -&gt; Statement
</span><a href="OAlg.Data.Validable.html#Validable"><span class="hs-identifier hs-var hs-var hs-var hs-var">Validable</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-283"></span><span>
</span><span id="line-284"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-285"></span><span class="hs-comment">-- fromWord -</span><span>
</span><span id="line-286"></span><span>
</span><span id="line-287"></span><span class="annot"><span class="hs-comment">-- | the underlying list of @a@'s with their exponent.</span></span><span>
</span><span id="line-288"></span><span id="local-6989586621679382595"><span id="local-6989586621679382596"><span class="annot"><a href="OAlg.Entity.Product.Definition.html#fromWord"><span class="hs-identifier hs-type">fromWord</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#Word"><span class="hs-identifier hs-type">Word</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382595"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382596"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679382596"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679382595"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span></span><span>
</span><span id="line-289"></span><span id="fromWord"><span class="annot"><span class="annottext">fromWord :: forall r a. Word r a -&gt; [(a, r)]
</span><a href="OAlg.Entity.Product.Definition.html#fromWord"><span class="hs-identifier hs-var hs-var">fromWord</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#Word"><span class="hs-identifier hs-type">Word</span></a></span><span> </span><span id="local-6989586621679383781"><span class="annot"><span class="annottext">[(a, r)]
</span><a href="#local-6989586621679383781"><span class="hs-identifier hs-var">ars</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(a, r)]
</span><a href="#local-6989586621679383781"><span class="hs-identifier hs-var">ars</span></a></span><span>
</span><span id="line-290"></span><span>
</span><span id="line-291"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-292"></span><span class="hs-comment">-- wrdAggr -</span><span>
</span><span id="line-293"></span><span>
</span><span id="line-294"></span><span class="annot"><span class="hs-comment">-- | aggregating words.</span></span><span>
</span><span id="line-295"></span><span id="local-6989586621679382599"><span id="local-6989586621679382600"><span class="annot"><a href="OAlg.Entity.Product.Definition.html#wrdAggr"><span class="hs-identifier hs-type">wrdAggr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679382599"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Ring.Definition.html#Semiring"><span class="hs-identifier hs-type">Semiring</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382600"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#Word"><span class="hs-identifier hs-type">Word</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382600"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382599"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#Word"><span class="hs-identifier hs-type">Word</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382600"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382599"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-296"></span><span id="wrdAggr"><span class="annot"><span class="annottext">wrdAggr :: forall a r. (Eq a, Semiring r) =&gt; Word r a -&gt; Word r a
</span><a href="OAlg.Entity.Product.Definition.html#wrdAggr"><span class="hs-identifier hs-var hs-var">wrdAggr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(a, r)] -&gt; Word r a
forall r a. [(a, r)] -&gt; Word r a
</span><a href="OAlg.Entity.Product.Definition.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="annot"><span class="annottext">([(a, r)] -&gt; Word r a)
-&gt; (Word r a -&gt; [(a, r)]) -&gt; Word r a -&gt; Word r a
forall y z x. (y -&gt; z) -&gt; (x -&gt; y) -&gt; x -&gt; z
forall (c :: * -&gt; * -&gt; *) y z x.
Category c =&gt;
c y z -&gt; c x y -&gt; c x z
</span><a href="OAlg.Category.Definition.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">([(a, r)] -&gt; (a, r)) -&gt; [[(a, r)]] -&gt; [(a, r)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">[(a, r)] -&gt; (a, r)
forall {b} {a}. (Distributive b, Total b) =&gt; [(a, b)] -&gt; (a, b)
</span><a href="#local-6989586621679383795"><span class="hs-identifier hs-var">aggr</span></a></span><span> </span><span class="annot"><span class="annottext">([[(a, r)]] -&gt; [(a, r)])
-&gt; (Word r a -&gt; [[(a, r)]]) -&gt; Word r a -&gt; [(a, r)]
forall y z x. (y -&gt; z) -&gt; (x -&gt; y) -&gt; x -&gt; z
forall (c :: * -&gt; * -&gt; *) y z x.
Category c =&gt;
c y z -&gt; c x y -&gt; c x z
</span><a href="OAlg.Category.Definition.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">((a, r) -&gt; (a, r) -&gt; Bool) -&gt; [(a, r)] -&gt; [[(a, r)]]
forall a. (a -&gt; a -&gt; Bool) -&gt; [a] -&gt; [[a]]
</span><span class="hs-identifier hs-var">groupBy</span></span><span> </span><span class="annot"><span class="annottext">(a, r) -&gt; (a, r) -&gt; Bool
forall {a} {b} {b}. Eq a =&gt; (a, b) -&gt; (a, b) -&gt; Bool
</span><a href="#local-6989586621679383796"><span class="hs-operator hs-var">(&lt;=&gt;)</span></a></span><span> </span><span class="annot"><span class="annottext">([(a, r)] -&gt; [[(a, r)]])
-&gt; (Word r a -&gt; [(a, r)]) -&gt; Word r a -&gt; [[(a, r)]]
forall y z x. (y -&gt; z) -&gt; (x -&gt; y) -&gt; x -&gt; z
forall (c :: * -&gt; * -&gt; *) y z x.
Category c =&gt;
c y z -&gt; c x y -&gt; c x z
</span><a href="OAlg.Category.Definition.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Word r a -&gt; [(a, r)]
forall r a. Word r a -&gt; [(a, r)]
</span><a href="OAlg.Entity.Product.Definition.html#fromWord"><span class="hs-identifier hs-var">fromWord</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-297"></span><span>  </span><span id="local-6989586621679383799"><span class="annot"><span class="annottext">(a, b)
</span><a href="#local-6989586621679383799"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679383796"><span class="annot"><span class="annottext">&lt;=&gt; :: (a, b) -&gt; (a, b) -&gt; Bool
</span><a href="#local-6989586621679383796"><span class="hs-operator hs-var hs-var">&lt;=&gt;</span></a></span></span><span> </span><span id="local-6989586621679383800"><span class="annot"><span class="annottext">(a, b)
</span><a href="#local-6989586621679383800"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a, b) -&gt; a
forall a b. (a, b) -&gt; a
</span><a href="OAlg.Category.Definition.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">(a, b)
</span><a href="#local-6989586621679383799"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">(a, b) -&gt; a
forall a b. (a, b) -&gt; a
</span><a href="OAlg.Category.Definition.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">(a, b)
</span><a href="#local-6989586621679383800"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-298"></span><span>  </span><span id="local-6989586621679383795"><span class="annot"><span class="annottext">aggr :: [(a, b)] -&gt; (a, b)
</span><a href="#local-6989586621679383795"><span class="hs-identifier hs-var hs-var">aggr</span></a></span></span><span> </span><span id="local-6989586621679383898"><span class="annot"><span class="annottext">as :: [(a, b)]
</span><a href="#local-6989586621679383898"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679383899"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679383899"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[(a, b)]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679383899"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">(b -&gt; b -&gt; b) -&gt; b -&gt; [b] -&gt; b
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span> </span><span class="annot"><span class="annottext">b -&gt; b -&gt; b
forall a. Additive a =&gt; a -&gt; a -&gt; a
</span><a href="OAlg.Structure.Additive.Definition.html#%2B"><span class="hs-operator hs-var">(+)</span></a></span><span> </span><span class="annot"><span class="annottext">b
forall r. Semiring r =&gt; r
</span><a href="OAlg.Structure.Ring.Definition.html#rZero"><span class="hs-identifier hs-var">rZero</span></a></span><span> </span><span class="annot"><span class="annottext">([b] -&gt; b) -&gt; [b] -&gt; b
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><a href="OAlg.Category.Applicative.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">((a, b) -&gt; b) -&gt; [(a, b)] -&gt; [b]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(a, b) -&gt; b
forall a b. (a, b) -&gt; b
</span><a href="OAlg.Category.Definition.html#snd"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621679383898"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-299"></span><span>
</span><span id="line-300"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-301"></span><span class="hs-comment">-- nFactorize -</span><span>
</span><span id="line-302"></span><span>
</span><span id="line-303"></span><span class="hs-comment">-- | factorization of a natural number to powers of primes.</span><span>
</span><span id="line-304"></span><span class="hs-comment">--   For @0@ there will be thrown 'Undefined'.</span><span>
</span><span id="line-305"></span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#nFactorize"><span class="hs-identifier hs-type">nFactorize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#Word"><span class="hs-identifier hs-type">Word</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span>
</span><span id="line-306"></span><span id="nFactorize"><span class="annot"><span class="annottext">nFactorize :: N -&gt; Word N N
</span><a href="OAlg.Entity.Product.Definition.html#nFactorize"><span class="hs-identifier hs-var hs-var">nFactorize</span></a></span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AlgebraicException -&gt; Word N N
forall a e. Exception e =&gt; e -&gt; a
</span><span class="hs-identifier hs-var">throw</span></span><span> </span><span class="annot"><span class="annottext">(AlgebraicException -&gt; Word N N) -&gt; AlgebraicException -&gt; Word N N
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><a href="OAlg.Category.Applicative.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; AlgebraicException
</span><a href="OAlg.Control.Exception.html#Undefined"><span class="hs-identifier hs-var">Undefined</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;nFactorize 0&quot;</span></span><span>
</span><span id="line-307"></span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#nFactorize"><span class="hs-identifier hs-var">nFactorize</span></a></span><span> </span><span id="local-6989586621679383905"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679383905"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word N N -&gt; Word N N
forall a r. (Eq a, Semiring r) =&gt; Word r a -&gt; Word r a
</span><a href="OAlg.Entity.Product.Definition.html#wrdAggr"><span class="hs-identifier hs-var">wrdAggr</span></a></span><span> </span><span class="annot"><span class="annottext">(Word N N -&gt; Word N N) -&gt; Word N N -&gt; Word N N
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><a href="OAlg.Category.Applicative.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[(N, N)] -&gt; Word N N
forall r a. [(a, r)] -&gt; Word r a
</span><a href="OAlg.Entity.Product.Definition.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="annot"><span class="annottext">([(N, N)] -&gt; Word N N) -&gt; [(N, N)] -&gt; Word N N
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><a href="OAlg.Category.Applicative.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[N] -&gt; N -&gt; [(N, N)]
forall {t} {b}. (Integral t, Num t, Num b) =&gt; [t] -&gt; t -&gt; [(t, b)]
</span><a href="#local-6989586621679383906"><span class="hs-identifier hs-var">fct</span></a></span><span> </span><span class="annot"><span class="annottext">[N]
</span><a href="OAlg.Structure.Number.Definition.html#primes"><span class="hs-identifier hs-var">primes</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679383905"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-308"></span><span>  </span><span id="local-6989586621679383906"><span class="annot"><span class="annottext">fct :: [t] -&gt; t -&gt; [(t, b)]
</span><a href="#local-6989586621679383906"><span class="hs-identifier hs-var hs-var">fct</span></a></span></span><span> </span><span class="annot"><span class="annottext">[t]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-number">1</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-309"></span><span>  </span><span class="annot"><a href="#local-6989586621679383906"><span class="hs-identifier hs-var">fct</span></a></span><span> </span><span id="local-6989586621679384023"><span class="annot"><span class="annottext">prms :: [t]
</span><a href="#local-6989586621679384023"><span class="hs-identifier hs-var">prms</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679384024"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679384024"><span class="hs-identifier hs-var">p</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679384025"><span class="annot"><span class="annottext">[t]
</span><a href="#local-6989586621679384025"><span class="hs-identifier hs-var">prms'</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679384026"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679384026"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679384026"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">t -&gt; t -&gt; t
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><a href="OAlg.Structure.Number.Definition.html#mod"><span class="hs-operator hs-var">`mod`</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679384024"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">t -&gt; t -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-number">0</span></span><span>
</span><span id="line-310"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679384024"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="annot"><span class="annottext">(t, b) -&gt; [(t, b)] -&gt; [(t, b)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[t] -&gt; t -&gt; [(t, b)]
</span><a href="#local-6989586621679383906"><span class="hs-identifier hs-var">fct</span></a></span><span> </span><span class="annot"><span class="annottext">[t]
</span><a href="#local-6989586621679384023"><span class="hs-identifier hs-var">prms</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679384026"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">t -&gt; t -&gt; t
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><a href="OAlg.Structure.Number.Definition.html#div"><span class="hs-operator hs-var">`div`</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679384024"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-311"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[t] -&gt; t -&gt; [(t, b)]
</span><a href="#local-6989586621679383906"><span class="hs-identifier hs-var">fct</span></a></span><span> </span><span class="annot"><span class="annottext">[t]
</span><a href="#local-6989586621679384025"><span class="hs-identifier hs-var">prms'</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679384026"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-312"></span><span>
</span><span id="line-313"></span><span class="hs-comment">-- | factorization of a natural number to powers of primes smaller then the given bound.</span><span>
</span><span id="line-314"></span><span class="hs-comment">--   For @0@ there will be thrown 'Undefined'.</span><span>
</span><span id="line-315"></span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#nFactorize%27"><span class="hs-identifier hs-type">nFactorize'</span></a></span><span> </span><span>
</span><span id="line-316"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ bound for the primes</span></span><span>
</span><span id="line-317"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ a natural number</span></span><span>
</span><span id="line-318"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#Word"><span class="hs-identifier hs-type">Word</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span>
</span><span id="line-319"></span><span id="nFactorize%27"><span class="annot"><span class="annottext">nFactorize' :: N -&gt; N -&gt; Word N N
</span><a href="OAlg.Entity.Product.Definition.html#nFactorize%27"><span class="hs-identifier hs-var hs-var">nFactorize'</span></a></span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AlgebraicException -&gt; Word N N
forall a e. Exception e =&gt; e -&gt; a
</span><span class="hs-identifier hs-var">throw</span></span><span> </span><span class="annot"><span class="annottext">(AlgebraicException -&gt; Word N N) -&gt; AlgebraicException -&gt; Word N N
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><a href="OAlg.Category.Applicative.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; AlgebraicException
</span><a href="OAlg.Control.Exception.html#Undefined"><span class="hs-identifier hs-var">Undefined</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;nFactorize 0&quot;</span></span><span>
</span><span id="line-320"></span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#nFactorize%27"><span class="hs-identifier hs-var">nFactorize'</span></a></span><span> </span><span id="local-6989586621679384028"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679384028"><span class="hs-identifier hs-var">pMax</span></a></span></span><span> </span><span id="local-6989586621679384029"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679384029"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word N N -&gt; Word N N
forall a r. (Eq a, Semiring r) =&gt; Word r a -&gt; Word r a
</span><a href="OAlg.Entity.Product.Definition.html#wrdAggr"><span class="hs-identifier hs-var">wrdAggr</span></a></span><span> </span><span class="annot"><span class="annottext">(Word N N -&gt; Word N N) -&gt; Word N N -&gt; Word N N
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><a href="OAlg.Category.Applicative.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[(N, N)] -&gt; Word N N
forall r a. [(a, r)] -&gt; Word r a
</span><a href="OAlg.Entity.Product.Definition.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="annot"><span class="annottext">([(N, N)] -&gt; Word N N) -&gt; [(N, N)] -&gt; Word N N
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><a href="OAlg.Category.Applicative.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[N] -&gt; N -&gt; [(N, N)]
</span><a href="#local-6989586621679384030"><span class="hs-identifier hs-var">fct</span></a></span><span> </span><span class="annot"><span class="annottext">[N]
</span><a href="OAlg.Structure.Number.Definition.html#primes"><span class="hs-identifier hs-var">primes</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679384029"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-321"></span><span>  </span><span id="local-6989586621679384030"><span class="annot"><span class="annottext">fct :: [N] -&gt; N -&gt; [(N, N)]
</span><a href="#local-6989586621679384030"><span class="hs-identifier hs-var hs-var">fct</span></a></span></span><span> </span><span class="annot"><span class="annottext">[N]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-322"></span><span>  </span><span class="annot"><a href="#local-6989586621679384030"><span class="hs-identifier hs-var">fct</span></a></span><span> </span><span id="local-6989586621679384031"><span class="annot"><span class="annottext">ps :: [N]
</span><a href="#local-6989586621679384031"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679384032"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679384032"><span class="hs-identifier hs-var">p</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679384033"><span class="annot"><span class="annottext">[N]
</span><a href="#local-6989586621679384033"><span class="hs-identifier hs-var">ps'</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679384034"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679384034"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679384028"><span class="hs-identifier hs-var">pMax</span></a></span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span>  </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679384032"><span class="hs-identifier hs-var">p</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-323"></span><span>                   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679384034"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; N
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><a href="OAlg.Structure.Number.Definition.html#mod"><span class="hs-operator hs-var">`mod`</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679384032"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679384032"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">N
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="annot"><span class="annottext">(N, N) -&gt; [(N, N)] -&gt; [(N, N)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[N] -&gt; N -&gt; [(N, N)]
</span><a href="#local-6989586621679384030"><span class="hs-identifier hs-var">fct</span></a></span><span> </span><span class="annot"><span class="annottext">[N]
</span><a href="#local-6989586621679384031"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679384034"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">N -&gt; N -&gt; N
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><a href="OAlg.Structure.Number.Definition.html#div"><span class="hs-operator hs-var">`div`</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679384032"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-324"></span><span>                   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[N] -&gt; N -&gt; [(N, N)]
</span><a href="#local-6989586621679384030"><span class="hs-identifier hs-var">fct</span></a></span><span> </span><span class="annot"><span class="annottext">[N]
</span><a href="#local-6989586621679384033"><span class="hs-identifier hs-var">ps'</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679384034"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-325"></span><span>                   </span><span>
</span><span id="line-326"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-327"></span><span class="hs-comment">-- prfInverse -</span><span>
</span><span id="line-328"></span><span>
</span><span id="line-329"></span><span class="hs-comment">-- | formal inverse</span><span>
</span><span id="line-330"></span><span class="hs-comment">--</span><span>
</span><span id="line-331"></span><span class="hs-comment">--  Let @p@ in @'ProductForm' r a@ then:</span><span>
</span><span id="line-332"></span><span class="hs-comment">--</span><span>
</span><span id="line-333"></span><span class="hs-comment">--   __Pre__ If @p@ contains a factor @'P' a@ then @'minusOne' '/=' 'Nothing'@.</span><span>
</span><span id="line-334"></span><span class="hs-comment">--</span><span>
</span><span id="line-335"></span><span class="hs-comment">--   __Post__ the formal inverse.</span><span>
</span><span id="line-336"></span><span id="local-6989586621679382623"><span id="local-6989586621679382624"><span class="annot"><a href="OAlg.Entity.Product.Definition.html#prfInverse"><span class="hs-identifier hs-type">prfInverse</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Number"><span class="hs-identifier hs-type">Number</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382623"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#ProductForm"><span class="hs-identifier hs-type">ProductForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382623"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382624"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#ProductForm"><span class="hs-identifier hs-type">ProductForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382623"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382624"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-337"></span><span id="prfInverse"><span class="annot"><span class="annottext">prfInverse :: forall r a. Number r =&gt; ProductForm r a -&gt; ProductForm r a
</span><a href="OAlg.Entity.Product.Definition.html#prfInverse"><span class="hs-identifier hs-var hs-var">prfInverse</span></a></span></span><span> </span><span id="local-6989586621679384050"><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679384050"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679384050"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-338"></span><span>  </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#One"><span class="hs-identifier hs-type">One</span></a></span><span> </span><span id="local-6989586621679384051"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679384051"><span class="hs-identifier hs-var">p</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Point a -&gt; ProductForm r a
forall r a. Point a -&gt; ProductForm r a
</span><a href="OAlg.Entity.Product.Definition.html#One"><span class="hs-identifier hs-var">One</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679384051"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-339"></span><span>  </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span id="local-6989586621679384052"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679384052"><span class="hs-identifier hs-var">a</span></a></span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe r
forall r. Number r =&gt; Maybe r
</span><a href="OAlg.Structure.Number.Definition.html#minusOne"><span class="hs-identifier hs-var">minusOne</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-340"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679384053"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679384053"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; ProductForm r a
forall r a. a -&gt; ProductForm r a
</span><a href="OAlg.Entity.Product.Definition.html#P"><span class="hs-identifier hs-var">P</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679384052"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r a -&gt; r -&gt; ProductForm r a
forall r a. ProductForm r a -&gt; r -&gt; ProductForm r a
</span><a href="OAlg.Entity.Product.Definition.html#%3A%5E"><span class="hs-operator hs-var">:^</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679384053"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-341"></span><span>    </span><span class="annot"><span class="annottext">Maybe r
</span><span class="hs-identifier">_</span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ArithmeticException -&gt; ProductForm r a
forall a e. Exception e =&gt; e -&gt; a
</span><span class="hs-identifier hs-var">throw</span></span><span> </span><span class="annot"><span class="annottext">ArithmeticException
</span><a href="OAlg.Structure.Exception.html#NoMinusOne"><span class="hs-identifier hs-var">NoMinusOne</span></a></span><span>
</span><span id="line-342"></span><span>  </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span id="local-6989586621679384055"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679384055"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#%3A%5E"><span class="hs-operator hs-type">:^</span></a></span><span> </span><span id="local-6989586621679384056"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679384056"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe r
forall r. Number r =&gt; Maybe r
</span><a href="OAlg.Structure.Number.Definition.html#minusOne"><span class="hs-identifier hs-var">minusOne</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-343"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679384057"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679384057"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; ProductForm r a
forall r a. a -&gt; ProductForm r a
</span><a href="OAlg.Entity.Product.Definition.html#P"><span class="hs-identifier hs-var">P</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679384055"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r a -&gt; r -&gt; ProductForm r a
forall r a. ProductForm r a -&gt; r -&gt; ProductForm r a
</span><a href="OAlg.Entity.Product.Definition.html#%3A%5E"><span class="hs-operator hs-var">:^</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679384057"><span class="hs-identifier hs-var">e</span></a></span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall c. Multiplicative c =&gt; c -&gt; c -&gt; c
</span><a href="OAlg.Structure.Multiplicative.Definition.html#%2A"><span class="hs-operator hs-var">*</span></a></span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679384056"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-344"></span><span>    </span><span class="annot"><span class="annottext">Maybe r
</span><span class="hs-identifier">_</span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ArithmeticException -&gt; ProductForm r a
forall a e. Exception e =&gt; e -&gt; a
</span><span class="hs-identifier hs-var">throw</span></span><span> </span><span class="annot"><span class="annottext">ArithmeticException
</span><a href="OAlg.Structure.Exception.html#NoMinusOne"><span class="hs-identifier hs-var">NoMinusOne</span></a></span><span>
</span><span id="line-345"></span><span>  </span><span id="local-6989586621679384058"><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679384058"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#%3A%5E"><span class="hs-operator hs-type">:^</span></a></span><span> </span><span id="local-6989586621679384059"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679384059"><span class="hs-identifier hs-var">z</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ProductForm r a -&gt; ProductForm r a
forall r a. Number r =&gt; ProductForm r a -&gt; ProductForm r a
</span><a href="OAlg.Entity.Product.Definition.html#prfInverse"><span class="hs-identifier hs-var">prfInverse</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679384058"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r a -&gt; r -&gt; ProductForm r a
forall r a. ProductForm r a -&gt; r -&gt; ProductForm r a
</span><a href="OAlg.Entity.Product.Definition.html#%3A%5E"><span class="hs-operator hs-var">:^</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679384059"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-346"></span><span>  </span><span id="local-6989586621679384060"><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679384060"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#%3A%2A"><span class="hs-operator hs-type">:*</span></a></span><span> </span><span id="local-6989586621679384061"><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679384061"><span class="hs-identifier hs-var">b</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ProductForm r a -&gt; ProductForm r a
forall r a. Number r =&gt; ProductForm r a -&gt; ProductForm r a
</span><a href="OAlg.Entity.Product.Definition.html#prfInverse"><span class="hs-identifier hs-var">prfInverse</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679384061"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r a -&gt; ProductForm r a -&gt; ProductForm r a
forall r a. ProductForm r a -&gt; ProductForm r a -&gt; ProductForm r a
</span><a href="OAlg.Entity.Product.Definition.html#%3A%2A"><span class="hs-operator hs-var">:*</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r a -&gt; ProductForm r a
forall r a. Number r =&gt; ProductForm r a -&gt; ProductForm r a
</span><a href="OAlg.Entity.Product.Definition.html#prfInverse"><span class="hs-identifier hs-var">prfInverse</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679384060"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-347"></span><span>
</span><span id="line-348"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-349"></span><span class="hs-comment">-- prfFromOp -</span><span>
</span><span id="line-350"></span><span>
</span><span id="line-351"></span><span class="annot"><span class="hs-comment">-- | from 'Op' symbols.</span></span><span>
</span><span id="line-352"></span><span id="local-6989586621679382628"><span id="local-6989586621679382629"><span class="annot"><a href="OAlg.Entity.Product.Definition.html#prfFromOp"><span class="hs-identifier hs-type">prfFromOp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#ProductForm"><span class="hs-identifier hs-type">ProductForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382628"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Data.Opposite.html#Op"><span class="hs-identifier hs-type">Op</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382629"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#ProductForm"><span class="hs-identifier hs-type">ProductForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382628"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382629"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-353"></span><span id="prfFromOp"><span class="annot"><span class="annottext">prfFromOp :: forall r a. ProductForm r (Op a) -&gt; ProductForm r a
</span><a href="OAlg.Entity.Product.Definition.html#prfFromOp"><span class="hs-identifier hs-var hs-var">prfFromOp</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#One"><span class="hs-identifier hs-type">One</span></a></span><span> </span><span id="local-6989586621679384063"><span class="annot"><span class="annottext">Point (Op a)
</span><a href="#local-6989586621679384063"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point a -&gt; ProductForm r a
forall r a. Point a -&gt; ProductForm r a
</span><a href="OAlg.Entity.Product.Definition.html#One"><span class="hs-identifier hs-var">One</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
Point (Op a)
</span><a href="#local-6989586621679384063"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-354"></span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#prfFromOp"><span class="hs-identifier hs-var">prfFromOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Data.Opposite.html#Op"><span class="hs-identifier hs-type">Op</span></a></span><span> </span><span id="local-6989586621679384064"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679384064"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; ProductForm r a
forall r a. a -&gt; ProductForm r a
</span><a href="OAlg.Entity.Product.Definition.html#P"><span class="hs-identifier hs-var">P</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679384064"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-355"></span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#prfFromOp"><span class="hs-identifier hs-var">prfFromOp</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679384065"><span class="annot"><span class="annottext">ProductForm r (Op a)
</span><a href="#local-6989586621679384065"><span class="hs-identifier hs-var">fo</span></a></span></span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#%3A%5E"><span class="hs-operator hs-type">:^</span></a></span><span> </span><span id="local-6989586621679384066"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679384066"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProductForm r (Op a) -&gt; ProductForm r a
forall r a. ProductForm r (Op a) -&gt; ProductForm r a
</span><a href="OAlg.Entity.Product.Definition.html#prfFromOp"><span class="hs-identifier hs-var">prfFromOp</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r (Op a)
</span><a href="#local-6989586621679384065"><span class="hs-identifier hs-var">fo</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r a -&gt; r -&gt; ProductForm r a
forall r a. ProductForm r a -&gt; r -&gt; ProductForm r a
</span><a href="OAlg.Entity.Product.Definition.html#%3A%5E"><span class="hs-operator hs-var">:^</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679384066"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-356"></span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#prfFromOp"><span class="hs-identifier hs-var">prfFromOp</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679384067"><span class="annot"><span class="annottext">ProductForm r (Op a)
</span><a href="#local-6989586621679384067"><span class="hs-identifier hs-var">fo</span></a></span></span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#%3A%2A"><span class="hs-operator hs-type">:*</span></a></span><span> </span><span id="local-6989586621679384068"><span class="annot"><span class="annottext">ProductForm r (Op a)
</span><a href="#local-6989586621679384068"><span class="hs-identifier hs-var">fg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProductForm r (Op a) -&gt; ProductForm r a
forall r a. ProductForm r (Op a) -&gt; ProductForm r a
</span><a href="OAlg.Entity.Product.Definition.html#prfFromOp"><span class="hs-identifier hs-var">prfFromOp</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r (Op a)
</span><a href="#local-6989586621679384068"><span class="hs-identifier hs-var">fg</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r a -&gt; ProductForm r a -&gt; ProductForm r a
forall r a. ProductForm r a -&gt; ProductForm r a -&gt; ProductForm r a
</span><a href="OAlg.Entity.Product.Definition.html#%3A%2A"><span class="hs-operator hs-var">:*</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r (Op a) -&gt; ProductForm r a
forall r a. ProductForm r (Op a) -&gt; ProductForm r a
</span><a href="OAlg.Entity.Product.Definition.html#prfFromOp"><span class="hs-identifier hs-var">prfFromOp</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r (Op a)
</span><a href="#local-6989586621679384067"><span class="hs-identifier hs-var">fo</span></a></span><span>
</span><span id="line-357"></span><span>
</span><span id="line-358"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-359"></span><span class="hs-comment">-- prpToOp -</span><span>
</span><span id="line-360"></span><span>
</span><span id="line-361"></span><span class="annot"><span class="hs-comment">-- | to 'Op' symbols.</span></span><span>
</span><span id="line-362"></span><span id="local-6989586621679382633"><span id="local-6989586621679382634"><span class="annot"><a href="OAlg.Entity.Product.Definition.html#prfToOp"><span class="hs-identifier hs-type">prfToOp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#ProductForm"><span class="hs-identifier hs-type">ProductForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382633"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382634"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#ProductForm"><span class="hs-identifier hs-type">ProductForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382633"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Data.Opposite.html#Op"><span class="hs-identifier hs-type">Op</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382634"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-363"></span><span id="prfToOp"><span class="annot"><span class="annottext">prfToOp :: forall r a. ProductForm r a -&gt; ProductForm r (Op a)
</span><a href="OAlg.Entity.Product.Definition.html#prfToOp"><span class="hs-identifier hs-var hs-var">prfToOp</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#One"><span class="hs-identifier hs-type">One</span></a></span><span> </span><span id="local-6989586621679384070"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679384070"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point (Op a) -&gt; ProductForm r (Op a)
forall r a. Point a -&gt; ProductForm r a
</span><a href="OAlg.Entity.Product.Definition.html#One"><span class="hs-identifier hs-var">One</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
Point (Op a)
</span><a href="#local-6989586621679384070"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-364"></span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#prfToOp"><span class="hs-identifier hs-var">prfToOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span id="local-6989586621679384071"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679384071"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Op a -&gt; ProductForm r (Op a)
forall r a. a -&gt; ProductForm r a
</span><a href="OAlg.Entity.Product.Definition.html#P"><span class="hs-identifier hs-var">P</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Op a
forall x. x -&gt; Op x
</span><a href="OAlg.Data.Opposite.html#Op"><span class="hs-identifier hs-var">Op</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679384071"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-365"></span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#prfToOp"><span class="hs-identifier hs-var">prfToOp</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679384072"><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679384072"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#%3A%5E"><span class="hs-operator hs-type">:^</span></a></span><span> </span><span id="local-6989586621679384073"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679384073"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProductForm r a -&gt; ProductForm r (Op a)
forall r a. ProductForm r a -&gt; ProductForm r (Op a)
</span><a href="OAlg.Entity.Product.Definition.html#prfToOp"><span class="hs-identifier hs-var">prfToOp</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679384072"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r (Op a) -&gt; r -&gt; ProductForm r (Op a)
forall r a. ProductForm r a -&gt; r -&gt; ProductForm r a
</span><a href="OAlg.Entity.Product.Definition.html#%3A%5E"><span class="hs-operator hs-var">:^</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679384073"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-366"></span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#prfToOp"><span class="hs-identifier hs-var">prfToOp</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679384074"><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679384074"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#%3A%2A"><span class="hs-operator hs-type">:*</span></a></span><span> </span><span id="local-6989586621679384075"><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679384075"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProductForm r a -&gt; ProductForm r (Op a)
forall r a. ProductForm r a -&gt; ProductForm r (Op a)
</span><a href="OAlg.Entity.Product.Definition.html#prfToOp"><span class="hs-identifier hs-var">prfToOp</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679384075"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r (Op a)
-&gt; ProductForm r (Op a) -&gt; ProductForm r (Op a)
forall r a. ProductForm r a -&gt; ProductForm r a -&gt; ProductForm r a
</span><a href="OAlg.Entity.Product.Definition.html#%3A%2A"><span class="hs-operator hs-var">:*</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r a -&gt; ProductForm r (Op a)
forall r a. ProductForm r a -&gt; ProductForm r (Op a)
</span><a href="OAlg.Entity.Product.Definition.html#prfToOp"><span class="hs-identifier hs-var">prfToOp</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679384074"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-367"></span><span>
</span><span id="line-368"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-369"></span><span class="hs-comment">-- prfwrd -</span><span>
</span><span id="line-370"></span><span>
</span><span id="line-371"></span><span class="annot"><span class="hs-comment">-- | transforming a 'ProductForm' to its corresponding 'Word'.</span></span><span>
</span><span id="line-372"></span><span id="local-6989586621679382638"><span id="local-6989586621679382639"><span class="annot"><a href="OAlg.Entity.Product.Definition.html#prfwrd"><span class="hs-identifier hs-type">prfwrd</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Integral"><span class="hs-identifier hs-type">Integral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382638"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#ProductForm"><span class="hs-identifier hs-type">ProductForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382638"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382639"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#Word"><span class="hs-identifier hs-type">Word</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382638"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382639"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-373"></span><span id="prfwrd"><span class="annot"><span class="annottext">prfwrd :: forall r a. Integral r =&gt; ProductForm r a -&gt; Word r a
</span><a href="OAlg.Entity.Product.Definition.html#prfwrd"><span class="hs-identifier hs-var hs-var">prfwrd</span></a></span></span><span> </span><span id="local-6989586621679384079"><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679384079"><span class="hs-identifier hs-var">pf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(a, r)] -&gt; Word r a
forall r a. [(a, r)] -&gt; Word r a
</span><a href="OAlg.Entity.Product.Definition.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProductForm r a -&gt; [(a, r)]
forall {r} {a}. Number r =&gt; ProductForm r a -&gt; [(a, r)]
</span><a href="#local-6989586621679384080"><span class="hs-identifier hs-var">tow</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679384079"><span class="hs-identifier hs-var">pf</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-374"></span><span>  </span><span id="local-6989586621679384080"><span class="annot"><span class="annottext">tow :: ProductForm r a -&gt; [(a, r)]
</span><a href="#local-6989586621679384080"><span class="hs-identifier hs-var hs-var">tow</span></a></span></span><span> </span><span id="local-6989586621679384262"><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679384262"><span class="hs-identifier hs-var">pf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679384262"><span class="hs-identifier hs-var">pf</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-375"></span><span>    </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#One"><span class="hs-identifier hs-type">One</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><span class="hs-identifier">_</span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-376"></span><span>    </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span id="local-6989586621679384263"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679384263"><span class="hs-identifier hs-var">a</span></a></span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679384263"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">r
forall r. Semiring r =&gt; r
</span><a href="OAlg.Structure.Ring.Definition.html#rOne"><span class="hs-identifier hs-var">rOne</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-377"></span><span>    </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span id="local-6989586621679384264"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679384264"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#%3A%5E"><span class="hs-operator hs-type">:^</span></a></span><span> </span><span id="local-6989586621679384265"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679384265"><span class="hs-identifier hs-var">z</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679384264"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679384265"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-378"></span><span>    </span><span id="local-6989586621679384266"><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679384266"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#%3A%5E"><span class="hs-operator hs-type">:^</span></a></span><span> </span><span id="local-6989586621679384267"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679384267"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#%3A%5E"><span class="hs-operator hs-type">:^</span></a></span><span> </span><span id="local-6989586621679384268"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679384268"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ProductForm r a -&gt; [(a, r)]
</span><a href="#local-6989586621679384080"><span class="hs-identifier hs-var">tow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679384266"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r a -&gt; r -&gt; ProductForm r a
forall r a. ProductForm r a -&gt; r -&gt; ProductForm r a
</span><a href="OAlg.Entity.Product.Definition.html#%3A%5E"><span class="hs-operator hs-var">:^</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679384267"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall c. Multiplicative c =&gt; c -&gt; c -&gt; c
</span><a href="OAlg.Structure.Multiplicative.Definition.html#%2A"><span class="hs-operator hs-var">*</span></a></span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679384268"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-379"></span><span>    </span><span id="local-6989586621679384269"><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679384269"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#%3A%5E"><span class="hs-operator hs-type">:^</span></a></span><span> </span><span id="local-6989586621679384270"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679384270"><span class="hs-identifier hs-var">z</span></a></span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[[(a, r)]] -&gt; [(a, r)]
forall (m :: * -&gt; *) a. Monad m =&gt; m (m a) -&gt; m a
</span><span class="hs-identifier hs-var">join</span></span><span> </span><span class="annot"><span class="annottext">([[(a, r)]] -&gt; [(a, r)]) -&gt; [[(a, r)]] -&gt; [(a, r)]
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><a href="OAlg.Category.Applicative.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">N -&gt; [[(a, r)]] -&gt; [[(a, r)]]
forall a. N -&gt; [a] -&gt; [a]
</span><a href="OAlg.Data.Number.html#takeN"><span class="hs-identifier hs-var">takeN</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679384272"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">([[(a, r)]] -&gt; [[(a, r)]]) -&gt; [[(a, r)]] -&gt; [[(a, r)]]
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><a href="OAlg.Category.Applicative.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[(a, r)] -&gt; [[(a, r)]]
forall a. a -&gt; [a]
</span><span class="hs-identifier hs-var">repeat</span></span><span> </span><span class="annot"><span class="annottext">([(a, r)] -&gt; [[(a, r)]]) -&gt; [(a, r)] -&gt; [[(a, r)]]
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><a href="OAlg.Category.Applicative.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r a -&gt; [(a, r)]
</span><a href="#local-6989586621679384080"><span class="hs-identifier hs-var">tow</span></a></span><span> </span><span class="annot"><span class="annottext">(ProductForm r a -&gt; [(a, r)]) -&gt; ProductForm r a -&gt; [(a, r)]
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><a href="OAlg.Category.Applicative.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679384270"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">r
forall r. Semiring r =&gt; r
</span><a href="OAlg.Structure.Ring.Definition.html#rZero"><span class="hs-identifier hs-var">rZero</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">ProductForm r a -&gt; ProductForm r a
forall r a. Number r =&gt; ProductForm r a -&gt; ProductForm r a
</span><a href="OAlg.Entity.Product.Definition.html#prfInverse"><span class="hs-identifier hs-var">prfInverse</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679384269"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679384269"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-380"></span><span>      </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679384272"><span class="annot"><span class="annottext">n :: N
</span><a href="#local-6989586621679384272"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Z -&gt; N
forall a b. Projectible a b =&gt; b -&gt; a
</span><a href="OAlg.Data.Canonical.html#prj"><span class="hs-identifier hs-var">prj</span></a></span><span> </span><span class="annot"><span class="annottext">(Z -&gt; N) -&gt; Z -&gt; N
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><a href="OAlg.Category.Applicative.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Z, r) -&gt; Z
forall a b. (a, b) -&gt; a
</span><a href="OAlg.Category.Definition.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">((Z, r) -&gt; Z) -&gt; (Z, r) -&gt; Z
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><a href="OAlg.Category.Applicative.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; (Z, r)
forall r. Number r =&gt; r -&gt; (Z, r)
</span><a href="OAlg.Structure.Number.Definition.html#zFloorFraction"><span class="hs-identifier hs-var">zFloorFraction</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679384270"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-381"></span><span>    </span><span id="local-6989586621679384273"><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679384273"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#%3A%2A"><span class="hs-operator hs-type">:*</span></a></span><span> </span><span id="local-6989586621679384274"><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679384274"><span class="hs-identifier hs-var">b</span></a></span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ProductForm r a -&gt; [(a, r)]
</span><a href="#local-6989586621679384080"><span class="hs-identifier hs-var">tow</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679384273"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">[(a, r)] -&gt; [(a, r)] -&gt; [(a, r)]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ProductForm r a -&gt; [(a, r)]
</span><a href="#local-6989586621679384080"><span class="hs-identifier hs-var">tow</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679384274"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-382"></span><span>
</span><span id="line-383"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-384"></span><span class="hs-comment">-- wrdprf -</span><span>
</span><span id="line-385"></span><span>
</span><span id="line-386"></span><span class="hs-comment">-- | transforming a 'Word' to it corresponding 'ProductForm'.</span><span>
</span><span id="line-387"></span><span class="hs-comment">--</span><span>
</span><span id="line-388"></span><span class="hs-comment">-- __Note__ the 'Point' is needed for empty 'Word's.</span><span>
</span><span id="line-389"></span><span id="local-6989586621679382649"><span id="local-6989586621679382650"><span class="annot"><a href="OAlg.Entity.Product.Definition.html#wrdprf"><span class="hs-identifier hs-type">wrdprf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.Structure.Ring.Definition.html#Semiring"><span class="hs-identifier hs-type">Semiring</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382649"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382650"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#Word"><span class="hs-identifier hs-type">Word</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382649"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382650"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#ProductForm"><span class="hs-identifier hs-type">ProductForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382649"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382650"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-390"></span><span id="wrdprf"><span class="annot"><span class="annottext">wrdprf :: forall r a. Semiring r =&gt; Point a -&gt; Word r a -&gt; ProductForm r a
</span><a href="OAlg.Entity.Product.Definition.html#wrdprf"><span class="hs-identifier hs-var hs-var">wrdprf</span></a></span></span><span> </span><span id="local-6989586621679384280"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679384280"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#Word"><span class="hs-identifier hs-type">Word</span></a></span><span> </span><span id="local-6989586621679384281"><span class="annot"><span class="annottext">[(a, r)]
</span><a href="#local-6989586621679384281"><span class="hs-identifier hs-var">ws</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point a -&gt; [(a, r)] -&gt; ProductForm r a
forall {r} {a}.
(Distributive r, Total r) =&gt;
Point a -&gt; [(a, r)] -&gt; ProductForm r a
</span><a href="#local-6989586621679384282"><span class="hs-identifier hs-var">prf</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679384280"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">[(a, r)]
</span><a href="#local-6989586621679384281"><span class="hs-identifier hs-var">ws</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-391"></span><span>  </span><span id="local-6989586621679384282"><span class="annot"><span class="annottext">prf :: Point a -&gt; [(a, r)] -&gt; ProductForm r a
</span><a href="#local-6989586621679384282"><span class="hs-identifier hs-var hs-var">prf</span></a></span></span><span> </span><span id="local-6989586621679384367"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679384367"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679384368"><span class="annot"><span class="annottext">[(a, r)]
</span><a href="#local-6989586621679384368"><span class="hs-identifier hs-var">ws</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[(a, r)]
</span><a href="#local-6989586621679384368"><span class="hs-identifier hs-var">ws</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span>
</span><span id="line-392"></span><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Point a -&gt; ProductForm r a
forall r a. Point a -&gt; ProductForm r a
</span><a href="OAlg.Entity.Product.Definition.html#One"><span class="hs-identifier hs-var">One</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679384367"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-393"></span><span>    </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621679384369"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679384369"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679384370"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679384370"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679384370"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">r
forall r. Semiring r =&gt; r
</span><a href="OAlg.Structure.Ring.Definition.html#rOne"><span class="hs-identifier hs-var">rOne</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">a -&gt; ProductForm r a
forall r a. a -&gt; ProductForm r a
</span><a href="OAlg.Entity.Product.Definition.html#P"><span class="hs-identifier hs-var">P</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679384369"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; ProductForm r a
forall r a. a -&gt; ProductForm r a
</span><a href="OAlg.Entity.Product.Definition.html#P"><span class="hs-identifier hs-var">P</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679384369"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r a -&gt; r -&gt; ProductForm r a
forall r a. ProductForm r a -&gt; r -&gt; ProductForm r a
</span><a href="OAlg.Entity.Product.Definition.html#%3A%5E"><span class="hs-operator hs-var">:^</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679384370"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-394"></span><span>    </span><span id="local-6989586621679384371"><span class="annot"><span class="annottext">(a, r)
</span><a href="#local-6989586621679384371"><span class="hs-identifier hs-var">w</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679384372"><span class="annot"><span class="annottext">[(a, r)]
</span><a href="#local-6989586621679384372"><span class="hs-identifier hs-var">ws</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Point a -&gt; [(a, r)] -&gt; ProductForm r a
</span><a href="#local-6989586621679384282"><span class="hs-identifier hs-var">prf</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679384367"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">(a, r)
</span><a href="#local-6989586621679384371"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">ProductForm r a -&gt; ProductForm r a -&gt; ProductForm r a
forall r a. ProductForm r a -&gt; ProductForm r a -&gt; ProductForm r a
</span><a href="OAlg.Entity.Product.Definition.html#%3A%2A"><span class="hs-operator hs-var">:*</span></a></span><span> </span><span class="annot"><span class="annottext">Point a -&gt; [(a, r)] -&gt; ProductForm r a
</span><a href="#local-6989586621679384282"><span class="hs-identifier hs-var">prf</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679384367"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">[(a, r)]
</span><a href="#local-6989586621679384372"><span class="hs-identifier hs-var">ws</span></a></span><span>
</span><span id="line-395"></span><span>
</span><span id="line-396"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-397"></span><span class="hs-comment">-- wrdPrfGroup -</span><span>
</span><span id="line-398"></span><span>
</span><span id="line-399"></span><span class="hs-comment">-- | reducing a 'Word' by adding the exponents of consecutive equal symbols and</span><span>
</span><span id="line-400"></span><span class="hs-comment">-- eliminating symbols with zero exponents.</span><span>
</span><span id="line-401"></span><span id="local-6989586621679382655"><span id="local-6989586621679382656"><span class="annot"><a href="OAlg.Entity.Product.Definition.html#wrdPrfGroup"><span class="hs-identifier hs-type">wrdPrfGroup</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679382655"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Ring.Definition.html#Semiring"><span class="hs-identifier hs-type">Semiring</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382656"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#Word"><span class="hs-identifier hs-type">Word</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382656"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382655"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.Reducible.html#Rdc"><span class="hs-identifier hs-type">Rdc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#Word"><span class="hs-identifier hs-type">Word</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382656"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382655"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-402"></span><span id="wrdPrfGroup"><span class="annot"><span class="annottext">wrdPrfGroup :: forall a r. (Eq a, Semiring r) =&gt; Word r a -&gt; Rdc (Word r a)
</span><a href="OAlg.Entity.Product.Definition.html#wrdPrfGroup"><span class="hs-identifier hs-var hs-var">wrdPrfGroup</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#Word"><span class="hs-identifier hs-type">Word</span></a></span><span> </span><span id="local-6989586621679384384"><span class="annot"><span class="annottext">[(a, r)]
</span><a href="#local-6989586621679384384"><span class="hs-identifier hs-var">ws</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(a, r)] -&gt; Action RdcState [(a, r)]
forall {b} {a}.
(Distributive b, Total b, Eq a) =&gt;
[(a, b)] -&gt; Action RdcState [(a, b)]
</span><a href="#local-6989586621679384385"><span class="hs-identifier hs-var">rdcw</span></a></span><span> </span><span class="annot"><span class="annottext">[(a, r)]
</span><a href="#local-6989586621679384384"><span class="hs-identifier hs-var">ws</span></a></span><span> </span><span class="annot"><span class="annottext">Action RdcState [(a, r)]
-&gt; ([(a, r)] -&gt; Action RdcState (Word r a))
-&gt; Action RdcState (Word r a)
forall a b.
Action RdcState a -&gt; (a -&gt; Action RdcState b) -&gt; Action RdcState b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Word r a -&gt; Action RdcState (Word r a)
forall a. a -&gt; Action RdcState a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Word r a -&gt; Action RdcState (Word r a))
-&gt; ([(a, r)] -&gt; Word r a) -&gt; [(a, r)] -&gt; Action RdcState (Word r a)
forall y z x. (y -&gt; z) -&gt; (x -&gt; y) -&gt; x -&gt; z
forall (c :: * -&gt; * -&gt; *) y z x.
Category c =&gt;
c y z -&gt; c x y -&gt; c x z
</span><a href="OAlg.Category.Definition.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">[(a, r)] -&gt; Word r a
forall r a. [(a, r)] -&gt; Word r a
</span><a href="OAlg.Entity.Product.Definition.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-403"></span><span>  </span><span id="local-6989586621679384385"><span class="annot"><span class="annottext">rdcw :: [(a, b)] -&gt; Action RdcState [(a, b)]
</span><a href="#local-6989586621679384385"><span class="hs-identifier hs-var hs-var">rdcw</span></a></span></span><span> </span><span id="local-6989586621679384490"><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621679384490"><span class="hs-identifier hs-var">ws</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621679384490"><span class="hs-identifier hs-var">ws</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-404"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679384491"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679384491"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679384492"><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621679384492"><span class="hs-identifier hs-var">ws</span></a></span></span><span>       </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679384491"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; b -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">b
forall r. Semiring r =&gt; r
</span><a href="OAlg.Structure.Ring.Definition.html#rZero"><span class="hs-identifier hs-var">rZero</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[(a, b)] -&gt; Action RdcState [(a, b)]
forall a. a -&gt; Action RdcState a
</span><a href="OAlg.Data.Reducible.html#reducesTo"><span class="hs-identifier hs-var">reducesTo</span></a></span><span> </span><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621679384492"><span class="hs-identifier hs-var">ws</span></a></span><span> </span><span class="annot"><span class="annottext">Action RdcState [(a, b)]
-&gt; ([(a, b)] -&gt; Action RdcState [(a, b)])
-&gt; Action RdcState [(a, b)]
forall a b.
Action RdcState a -&gt; (a -&gt; Action RdcState b) -&gt; Action RdcState b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">[(a, b)] -&gt; Action RdcState [(a, b)]
</span><a href="#local-6989586621679384385"><span class="hs-identifier hs-var">rdcw</span></a></span><span> </span><span>
</span><span id="line-405"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679384494"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679384494"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679384495"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679384495"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="hs-special">(</span><span id="local-6989586621679384496"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679384496"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679384497"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679384497"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679384498"><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621679384498"><span class="hs-identifier hs-var">ws</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679384494"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679384496"><span class="hs-identifier hs-var">b</span></a></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[(a, b)] -&gt; Action RdcState [(a, b)]
forall a. a -&gt; Action RdcState a
</span><a href="OAlg.Data.Reducible.html#reducesTo"><span class="hs-identifier hs-var">reducesTo</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679384494"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679384495"><span class="hs-identifier hs-var">r</span></a></span><span class="annot"><span class="annottext">b -&gt; b -&gt; b
forall a. Additive a =&gt; a -&gt; a -&gt; a
</span><a href="OAlg.Structure.Additive.Definition.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679384497"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">(a, b) -&gt; [(a, b)] -&gt; [(a, b)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621679384498"><span class="hs-identifier hs-var">ws</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Action RdcState [(a, b)]
-&gt; ([(a, b)] -&gt; Action RdcState [(a, b)])
-&gt; Action RdcState [(a, b)]
forall a b.
Action RdcState a -&gt; (a -&gt; Action RdcState b) -&gt; Action RdcState b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">[(a, b)] -&gt; Action RdcState [(a, b)]
</span><a href="#local-6989586621679384385"><span class="hs-identifier hs-var">rdcw</span></a></span><span>
</span><span id="line-406"></span><span>    </span><span id="local-6989586621679384499"><span class="annot"><span class="annottext">(a, b)
</span><a href="#local-6989586621679384499"><span class="hs-identifier hs-var">ar</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679384500"><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621679384500"><span class="hs-identifier hs-var">ws</span></a></span></span><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[(a, b)] -&gt; Action RdcState [(a, b)]
</span><a href="#local-6989586621679384385"><span class="hs-identifier hs-var">rdcw</span></a></span><span> </span><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621679384500"><span class="hs-identifier hs-var">ws</span></a></span><span> </span><span class="annot"><span class="annottext">Action RdcState [(a, b)]
-&gt; ([(a, b)] -&gt; Action RdcState [(a, b)])
-&gt; Action RdcState [(a, b)]
forall a b.
Action RdcState a -&gt; (a -&gt; Action RdcState b) -&gt; Action RdcState b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">[(a, b)] -&gt; Action RdcState [(a, b)]
forall a. a -&gt; Action RdcState a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">([(a, b)] -&gt; Action RdcState [(a, b)])
-&gt; ([(a, b)] -&gt; [(a, b)]) -&gt; [(a, b)] -&gt; Action RdcState [(a, b)]
forall y z x. (y -&gt; z) -&gt; (x -&gt; y) -&gt; x -&gt; z
forall (c :: * -&gt; * -&gt; *) y z x.
Category c =&gt;
c y z -&gt; c x y -&gt; c x z
</span><a href="OAlg.Category.Definition.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a, b)
</span><a href="#local-6989586621679384499"><span class="hs-identifier hs-var">ar</span></a></span><span class="annot"><span class="annottext">(a, b) -&gt; [(a, b)] -&gt; [(a, b)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span>
</span><span id="line-407"></span><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[(a, b)] -&gt; Action RdcState [(a, b)]
forall a. a -&gt; Action RdcState a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621679384490"><span class="hs-identifier hs-var">ws</span></a></span><span>         </span><span>
</span><span id="line-408"></span><span>  </span><span>
</span><span id="line-409"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-410"></span><span class="hs-comment">-- prfReduceWith -</span><span>
</span><span id="line-411"></span><span>
</span><span id="line-412"></span><span class="hs-comment">-- | reduces a product form by the given reduction rules for words until no more</span><span>
</span><span id="line-413"></span><span class="hs-comment">--   reductions are applicable.</span><span>
</span><span id="line-414"></span><span id="local-6989586621679382669"><span id="local-6989586621679382670"><span class="annot"><a href="OAlg.Entity.Product.Definition.html#prfReduceWith"><span class="hs-identifier hs-type">prfReduceWith</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#Oriented"><span class="hs-identifier hs-type">Oriented</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382669"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Integral"><span class="hs-identifier hs-type">Integral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382670"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-415"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#Word"><span class="hs-identifier hs-type">Word</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382670"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382669"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.Reducible.html#Rdc"><span class="hs-identifier hs-type">Rdc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#Word"><span class="hs-identifier hs-type">Word</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382670"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382669"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#ProductForm"><span class="hs-identifier hs-type">ProductForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382670"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382669"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#ProductForm"><span class="hs-identifier hs-type">ProductForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382670"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382669"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-416"></span><span id="prfReduceWith"><span class="annot"><span class="annottext">prfReduceWith :: forall a r.
(Oriented a, Integral r) =&gt;
(Word r a -&gt; Rdc (Word r a)) -&gt; ProductForm r a -&gt; ProductForm r a
</span><a href="OAlg.Entity.Product.Definition.html#prfReduceWith"><span class="hs-identifier hs-var hs-var">prfReduceWith</span></a></span></span><span> </span><span id="local-6989586621679384514"><span class="annot"><span class="annottext">Word r a -&gt; Rdc (Word r a)
</span><a href="#local-6989586621679384514"><span class="hs-identifier hs-var">rel</span></a></span></span><span> </span><span id="local-6989586621679384515"><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679384515"><span class="hs-identifier hs-var">pf</span></a></span></span><span>
</span><span id="line-417"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point a -&gt; Word r a -&gt; ProductForm r a
forall r a. Semiring r =&gt; Point a -&gt; Word r a -&gt; ProductForm r a
</span><a href="OAlg.Entity.Product.Definition.html#wrdprf"><span class="hs-identifier hs-var">wrdprf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProductForm r a -&gt; Point (ProductForm r a)
forall q. Oriented q =&gt; q -&gt; Point q
</span><a href="OAlg.Structure.Oriented.Definition.html#end"><span class="hs-identifier hs-var">end</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679384515"><span class="hs-identifier hs-var">pf</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-418"></span><span>  </span><span class="annot"><span class="annottext">(Word r a -&gt; ProductForm r a) -&gt; Word r a -&gt; ProductForm r a
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><a href="OAlg.Category.Applicative.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Word r a -&gt; Rdc (Word r a)) -&gt; Word r a -&gt; Word r a
forall x. (x -&gt; Rdc x) -&gt; x -&gt; x
</span><a href="OAlg.Data.Reducible.html#reduceWith"><span class="hs-identifier hs-var">reduceWith</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word r a -&gt; Rdc (Word r a)
forall a r. (Eq a, Semiring r) =&gt; Word r a -&gt; Rdc (Word r a)
</span><a href="OAlg.Entity.Product.Definition.html#wrdPrfGroup"><span class="hs-identifier hs-var">wrdPrfGroup</span></a></span><span> </span><span class="annot"><span class="annottext">(Word r a -&gt; Rdc (Word r a))
-&gt; (Word r a -&gt; Rdc (Word r a)) -&gt; Word r a -&gt; Rdc (Word r a)
forall x. (x -&gt; Rdc x) -&gt; (x -&gt; Rdc x) -&gt; x -&gt; Rdc x
</span><a href="OAlg.Data.Reducible.html#%3E%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Word r a -&gt; Rdc (Word r a)
</span><a href="#local-6989586621679384514"><span class="hs-identifier hs-var">rel</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-419"></span><span>  </span><span class="annot"><span class="annottext">(Word r a -&gt; Word r a) -&gt; Word r a -&gt; Word r a
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><a href="OAlg.Category.Applicative.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r a -&gt; Word r a
forall r a. Integral r =&gt; ProductForm r a -&gt; Word r a
</span><a href="OAlg.Entity.Product.Definition.html#prfwrd"><span class="hs-identifier hs-var">prfwrd</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679384515"><span class="hs-identifier hs-var">pf</span></a></span><span>
</span><span id="line-420"></span><span>
</span><span id="line-421"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-422"></span><span class="hs-comment">-- prfFactors -</span><span>
</span><span id="line-423"></span><span>
</span><span id="line-424"></span><span class="annot"><span class="hs-comment">-- | list of elementary factors.</span></span><span>
</span><span id="line-425"></span><span id="local-6989586621679384519"><span class="annot"><a href="OAlg.Entity.Product.Definition.html#prfFactors"><span class="hs-identifier hs-type">prfFactors</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#ProductForm"><span class="hs-identifier hs-type">ProductForm</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679384519"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679384519"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-426"></span><span id="prfFactors"><span class="annot"><span class="annottext">prfFactors :: forall a. ProductForm N a -&gt; [a]
</span><a href="OAlg.Entity.Product.Definition.html#prfFactors"><span class="hs-identifier hs-var hs-var">prfFactors</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProductForm N a -&gt; [a]
forall a. ProductForm N a -&gt; [a]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">toList</span></span><span>
</span><span id="line-427"></span><span>
</span><span id="line-428"></span><span class="annot"><span class="hs-comment">-- | gets the @n@-the symbol.</span></span><span>
</span><span id="line-429"></span><span id="local-6989586621679382676"><span class="annot"><a href="OAlg.Entity.Product.Definition.html#prfLookup"><span class="hs-identifier hs-type">prfLookup</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#ProductForm"><span class="hs-identifier hs-type">ProductForm</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382676"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679382676"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-430"></span><span id="prfLookup"><span class="annot"><span class="annottext">prfLookup :: forall a. ProductForm N a -&gt; N -&gt; Maybe a
</span><a href="OAlg.Entity.Product.Definition.html#prfLookup"><span class="hs-identifier hs-var hs-var">prfLookup</span></a></span></span><span> </span><span id="local-6989586621679384527"><span class="annot"><span class="annottext">ProductForm N a
</span><a href="#local-6989586621679384527"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">N -&gt; [(a, N)] -&gt; N -&gt; Maybe a
forall {t} {a}.
(Additive t, Ord t) =&gt;
t -&gt; [(a, t)] -&gt; t -&gt; Maybe a
</span><a href="#local-6989586621679384528"><span class="hs-identifier hs-var">lookup</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word N a -&gt; [(a, N)]
forall r a. Word r a -&gt; [(a, r)]
</span><a href="OAlg.Entity.Product.Definition.html#fromWord"><span class="hs-identifier hs-var">fromWord</span></a></span><span> </span><span class="annot"><span class="annottext">(Word N a -&gt; [(a, N)]) -&gt; Word N a -&gt; [(a, N)]
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><a href="OAlg.Category.Applicative.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm N a -&gt; Word N a
forall r a. Integral r =&gt; ProductForm r a -&gt; Word r a
</span><a href="OAlg.Entity.Product.Definition.html#prfwrd"><span class="hs-identifier hs-var">prfwrd</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm N a
</span><a href="#local-6989586621679384527"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-431"></span><span>  </span><span id="local-6989586621679384528"><span class="annot"><span class="annottext">lookup :: t -&gt; [(a, t)] -&gt; t -&gt; Maybe a
</span><a href="#local-6989586621679384528"><span class="hs-identifier hs-var hs-var">lookup</span></a></span></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-identifier">_</span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-432"></span><span>  </span><span class="annot"><a href="#local-6989586621679384528"><span class="hs-identifier hs-var">lookup</span></a></span><span> </span><span id="local-6989586621679384558"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679384558"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679384559"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679384559"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679384560"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679384560"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679384561"><span class="annot"><span class="annottext">[(a, t)]
</span><a href="#local-6989586621679384561"><span class="hs-identifier hs-var">ws</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679384562"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679384562"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679384562"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">t -&gt; t -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679384563"><span class="hs-identifier hs-var">l'</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679384559"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">t -&gt; [(a, t)] -&gt; t -&gt; Maybe a
</span><a href="#local-6989586621679384528"><span class="hs-identifier hs-var">lookup</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679384563"><span class="hs-identifier hs-var">l'</span></a></span><span> </span><span class="annot"><span class="annottext">[(a, t)]
</span><a href="#local-6989586621679384561"><span class="hs-identifier hs-var">ws</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679384562"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679384563"><span class="annot"><span class="annottext">l' :: t
</span><a href="#local-6989586621679384563"><span class="hs-identifier hs-var hs-var">l'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679384558"><span class="hs-identifier hs-var">l</span></a></span><span class="annot"><span class="annottext">t -&gt; t -&gt; t
forall a. Additive a =&gt; a -&gt; a -&gt; a
</span><a href="OAlg.Structure.Additive.Definition.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679384560"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span>
</span><span id="line-433"></span><span>  </span><span>
</span><span id="line-434"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679382688"><span id="local-6989586621679384569"><span class="annot"><a href="OAlg.Entity.Sequence.Definition.html#Sequence"><span class="hs-identifier hs-type">Sequence</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#ProductForm"><span class="hs-identifier hs-type">ProductForm</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382688"><span class="hs-identifier hs-type">x</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-435"></span><span>  </span><span id="local-6989586621679384577"><span class="annot"><span class="annottext">list :: forall (p :: * -&gt; *). p N -&gt; ProductForm N x -&gt; [(x, N)]
</span><a href="#local-6989586621679384577"><span class="hs-identifier hs-var hs-var hs-var hs-var">list</span></a></span></span><span> </span><span class="annot"><span class="annottext">p N
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679384579"><span class="annot"><span class="annottext">ProductForm N x
</span><a href="#local-6989586621679384579"><span class="hs-identifier hs-var">pf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProductForm N x -&gt; [x]
forall a. ProductForm N a -&gt; [a]
</span><a href="OAlg.Entity.Product.Definition.html#prfFactors"><span class="hs-identifier hs-var">prfFactors</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm N x
</span><a href="#local-6989586621679384579"><span class="hs-identifier hs-var">pf</span></a></span><span> </span><span class="annot"><span class="annottext">[x] -&gt; [N] -&gt; [(x, N)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-operator hs-var">`zip`</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">N
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="hs-special">]</span><span>
</span><span id="line-436"></span><span>  </span><span id="local-6989586621679384580"><span class="annot"><span class="annottext">?? :: ProductForm N x -&gt; N -&gt; Maybe x
</span><a href="#local-6989586621679384580"><span class="hs-operator hs-var hs-var hs-var hs-var">(??)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProductForm N x -&gt; N -&gt; Maybe x
forall a. ProductForm N a -&gt; N -&gt; Maybe a
</span><a href="OAlg.Entity.Product.Definition.html#prfLookup"><span class="hs-identifier hs-var">prfLookup</span></a></span><span>
</span><span id="line-437"></span><span>  </span><span>
</span><span id="line-438"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-439"></span><span class="hs-comment">-- prfReduce -</span><span>
</span><span id="line-440"></span><span>
</span><span id="line-441"></span><span class="annot"><span class="hs-comment">-- | reducing a 'ProductForm'  according to @'prfReduceWith' 'return'@.</span></span><span>
</span><span id="line-442"></span><span id="local-6989586621679382692"><span id="local-6989586621679382693"><span class="annot"><a href="OAlg.Entity.Product.Definition.html#prfReduce"><span class="hs-identifier hs-type">prfReduce</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#Oriented"><span class="hs-identifier hs-type">Oriented</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382692"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Integral"><span class="hs-identifier hs-type">Integral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382693"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#ProductForm"><span class="hs-identifier hs-type">ProductForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382693"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382692"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#ProductForm"><span class="hs-identifier hs-type">ProductForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382693"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382692"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-443"></span><span id="prfReduce"><span class="annot"><span class="annottext">prfReduce :: forall a r.
(Oriented a, Integral r) =&gt;
ProductForm r a -&gt; ProductForm r a
</span><a href="OAlg.Entity.Product.Definition.html#prfReduce"><span class="hs-identifier hs-var hs-var">prfReduce</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Word r a -&gt; Rdc (Word r a)) -&gt; ProductForm r a -&gt; ProductForm r a
forall a r.
(Oriented a, Integral r) =&gt;
(Word r a -&gt; Rdc (Word r a)) -&gt; ProductForm r a -&gt; ProductForm r a
</span><a href="OAlg.Entity.Product.Definition.html#prfReduceWith"><span class="hs-identifier hs-var">prfReduceWith</span></a></span><span> </span><span class="annot"><span class="annottext">Word r a -&gt; Rdc (Word r a)
forall a. a -&gt; Action RdcState a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span>
</span><span id="line-444"></span><span>
</span><span id="line-445"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679382700"><span id="local-6989586621679382701"><span class="hs-special">(</span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#Oriented"><span class="hs-identifier hs-type">Oriented</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382700"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Integral"><span class="hs-identifier hs-type">Integral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382701"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.Reducible.html#Reducible"><span class="hs-identifier hs-type">Reducible</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#ProductForm"><span class="hs-identifier hs-type">ProductForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382701"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382700"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-446"></span><span>  </span><span id="local-6989586621679384594"><span class="annot"><span class="annottext">reduce :: ProductForm r a -&gt; ProductForm r a
</span><a href="#local-6989586621679384594"><span class="hs-identifier hs-var hs-var hs-var hs-var">reduce</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProductForm r a -&gt; ProductForm r a
forall a r.
(Oriented a, Integral r) =&gt;
ProductForm r a -&gt; ProductForm r a
</span><a href="OAlg.Entity.Product.Definition.html#prfReduce"><span class="hs-identifier hs-var">prfReduce</span></a></span><span>
</span><span id="line-447"></span><span>
</span><span id="line-448"></span><span>
</span><span id="line-449"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-450"></span><span class="hs-comment">-- Product -</span><span>
</span><span id="line-451"></span><span>
</span><span id="line-452"></span><span class="hs-comment">-- | free product over 'Oriented' symbols in @__a__@ with exponents in a 'Integral' @__r__@.</span><span>
</span><span id="line-453"></span><span class="hs-comment">--</span><span>
</span><span id="line-454"></span><span class="hs-comment">-- __Definition__ A 'Product' @p@ is 'valid' if and only if its underlying</span><span>
</span><span id="line-455"></span><span class="hs-comment">-- 'ProductForm' @pf@ is 'valid' and @pf@ is reduced, i.e. @pf == 'reduce' pf@.</span><span>
</span><span id="line-456"></span><span class="hs-keyword">newtype</span><span> </span><span id="Product"><span class="annot"><a href="OAlg.Entity.Product.Definition.html#Product"><span class="hs-identifier hs-var">Product</span></a></span></span><span> </span><span id="local-6989586621679382767"><span class="annot"><a href="#local-6989586621679382767"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span id="local-6989586621679382768"><span class="annot"><a href="#local-6989586621679382768"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Product"><span class="annot"><a href="OAlg.Entity.Product.Definition.html#Product"><span class="hs-identifier hs-var">Product</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#ProductForm"><span class="hs-identifier hs-type">ProductForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382767"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382768"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679384599"><span id="local-6989586621679384603"><span id="local-6989586621679384607"><span class="annot"><span class="annottext">Int -&gt; Product r a -&gt; ShowS
[Product r a] -&gt; ShowS
Product r a -&gt; String
(Int -&gt; Product r a -&gt; ShowS)
-&gt; (Product r a -&gt; String)
-&gt; ([Product r a] -&gt; ShowS)
-&gt; Show (Product r a)
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall r a. (Oriented a, Entity r) =&gt; Int -&gt; Product r a -&gt; ShowS
forall r a. (Oriented a, Entity r) =&gt; [Product r a] -&gt; ShowS
forall r a. (Oriented a, Entity r) =&gt; Product r a -&gt; String
$cshowsPrec :: forall r a. (Oriented a, Entity r) =&gt; Int -&gt; Product r a -&gt; ShowS
showsPrec :: Int -&gt; Product r a -&gt; ShowS
$cshow :: forall r a. (Oriented a, Entity r) =&gt; Product r a -&gt; String
show :: Product r a -&gt; String
$cshowList :: forall r a. (Oriented a, Entity r) =&gt; [Product r a] -&gt; ShowS
showList :: [Product r a] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679384612"><span id="local-6989586621679384616"><span class="annot"><span class="annottext">Product r a -&gt; Product r a -&gt; Bool
(Product r a -&gt; Product r a -&gt; Bool)
-&gt; (Product r a -&gt; Product r a -&gt; Bool) -&gt; Eq (Product r a)
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall r a.
(Oriented a, Entity r) =&gt;
Product r a -&gt; Product r a -&gt; Bool
$c== :: forall r a.
(Oriented a, Entity r) =&gt;
Product r a -&gt; Product r a -&gt; Bool
== :: Product r a -&gt; Product r a -&gt; Bool
$c/= :: forall r a.
(Oriented a, Entity r) =&gt;
Product r a -&gt; Product r a -&gt; Bool
/= :: Product r a -&gt; Product r a -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679384628"><span id="local-6989586621679384632"><span id="local-6989586621679384636"><span id="local-6989586621679384640"><span id="local-6989586621679384644"><span id="local-6989586621679384648"><span id="local-6989586621679384652"><span class="annot"><span class="annottext">Eq (Product r a)
Eq (Product r a)
-&gt; (Product r a -&gt; Product r a -&gt; Ordering)
-&gt; (Product r a -&gt; Product r a -&gt; Bool)
-&gt; (Product r a -&gt; Product r a -&gt; Bool)
-&gt; (Product r a -&gt; Product r a -&gt; Bool)
-&gt; (Product r a -&gt; Product r a -&gt; Bool)
-&gt; (Product r a -&gt; Product r a -&gt; Product r a)
-&gt; (Product r a -&gt; Product r a -&gt; Product r a)
-&gt; Ord (Product r a)
Product r a -&gt; Product r a -&gt; Bool
Product r a -&gt; Product r a -&gt; Ordering
Product r a -&gt; Product r a -&gt; Product r a
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall {r} {a}.
(Oriented a, OrdPoint a, Ord a, Ord r, Entity r) =&gt;
Eq (Product r a)
forall r a.
(Oriented a, OrdPoint a, Ord a, Ord r, Entity r) =&gt;
Product r a -&gt; Product r a -&gt; Bool
forall r a.
(Oriented a, OrdPoint a, Ord a, Ord r, Entity r) =&gt;
Product r a -&gt; Product r a -&gt; Ordering
forall r a.
(Oriented a, OrdPoint a, Ord a, Ord r, Entity r) =&gt;
Product r a -&gt; Product r a -&gt; Product r a
$ccompare :: forall r a.
(Oriented a, OrdPoint a, Ord a, Ord r, Entity r) =&gt;
Product r a -&gt; Product r a -&gt; Ordering
compare :: Product r a -&gt; Product r a -&gt; Ordering
$c&lt; :: forall r a.
(Oriented a, OrdPoint a, Ord a, Ord r, Entity r) =&gt;
Product r a -&gt; Product r a -&gt; Bool
&lt; :: Product r a -&gt; Product r a -&gt; Bool
$c&lt;= :: forall r a.
(Oriented a, OrdPoint a, Ord a, Ord r, Entity r) =&gt;
Product r a -&gt; Product r a -&gt; Bool
&lt;= :: Product r a -&gt; Product r a -&gt; Bool
$c&gt; :: forall r a.
(Oriented a, OrdPoint a, Ord a, Ord r, Entity r) =&gt;
Product r a -&gt; Product r a -&gt; Bool
&gt; :: Product r a -&gt; Product r a -&gt; Bool
$c&gt;= :: forall r a.
(Oriented a, OrdPoint a, Ord a, Ord r, Entity r) =&gt;
Product r a -&gt; Product r a -&gt; Bool
&gt;= :: Product r a -&gt; Product r a -&gt; Bool
$cmax :: forall r a.
(Oriented a, OrdPoint a, Ord a, Ord r, Entity r) =&gt;
Product r a -&gt; Product r a -&gt; Product r a
max :: Product r a -&gt; Product r a -&gt; Product r a
$cmin :: forall r a.
(Oriented a, OrdPoint a, Ord a, Ord r, Entity r) =&gt;
Product r a -&gt; Product r a -&gt; Product r a
min :: Product r a -&gt; Product r a -&gt; Product r a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-457"></span><span>
</span><span id="line-458"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679382717"><span id="local-6989586621679382718"><span class="hs-special">(</span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#Oriented"><span class="hs-identifier hs-type">Oriented</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382717"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Integral"><span class="hs-identifier hs-type">Integral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382718"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.Validable.html#Validable"><span class="hs-identifier hs-type">Validable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#Product"><span class="hs-identifier hs-type">Product</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382718"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382717"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-459"></span><span>  </span><span id="local-6989586621679384670"><span class="annot"><span class="annottext">valid :: Product r a -&gt; Statement
</span><a href="OAlg.Data.Validable.html#valid"><span class="hs-identifier hs-var hs-var hs-var hs-var">valid</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#Product"><span class="hs-identifier hs-type">Product</span></a></span><span> </span><span id="local-6989586621679384671"><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679384671"><span class="hs-identifier hs-var">pf</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Statement] -&gt; Statement
</span><a href="OAlg.Data.Statement.Definition.html#And"><span class="hs-identifier hs-var">And</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ProductForm r a -&gt; Statement
forall a. Validable a =&gt; a -&gt; Statement
</span><a href="OAlg.Data.Validable.html#valid"><span class="hs-identifier hs-var">valid</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679384671"><span class="hs-identifier hs-var">pf</span></a></span><span>
</span><span id="line-460"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Label
</span><a href="OAlg.Data.Statement.Definition.html#Label"><span class="hs-identifier hs-var">Label</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;reduced&quot;</span></span><span>
</span><span id="line-461"></span><span>                             </span><span class="annot"><span class="annottext">Label -&gt; Statement -&gt; Statement
</span><a href="OAlg.Data.Statement.Definition.html#%3A%3C%3D%3E%3A"><span class="hs-operator hs-var">:&lt;=&gt;:</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProductForm r a -&gt; ProductForm r a
forall e. Reducible e =&gt; e -&gt; e
</span><a href="OAlg.Data.Reducible.html#reduce"><span class="hs-identifier hs-var">reduce</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679384671"><span class="hs-identifier hs-var">pf</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r a -&gt; ProductForm r a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679384671"><span class="hs-identifier hs-var">pf</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Message -&gt; Statement
</span><a href="OAlg.Data.Statement.Definition.html#%3A%3F%3E"><span class="hs-operator hs-var">:?&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[Parameter] -&gt; Message
</span><a href="OAlg.Data.Statement.Definition.html#Params"><span class="hs-identifier hs-var">Params</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;pf&quot;</span></span><span class="annot"><span class="annottext">String -&gt; String -&gt; Parameter
</span><a href="OAlg.Data.Statement.Definition.html#%3A%3D"><span class="hs-operator hs-var">:=</span></a></span><span class="annot"><span class="annottext">ProductForm r a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679384671"><span class="hs-identifier hs-var">pf</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-462"></span><span>                           </span><span class="hs-special">]</span><span>
</span><span id="line-463"></span><span>
</span><span id="line-464"></span><span id="local-6989586621679384679"><span id="local-6989586621679384687"><span id="local-6989586621679384695"><span id="local-6989586621679384701"><span id="local-6989586621679384705"><span id="local-6989586621679384709"><span id="local-6989586621679384713"><span id="local-6989586621679384717"><span id="local-6989586621679384721"><span id="local-6989586621679384725"><span id="local-6989586621679384729"><span id="local-6989586621679384733"><span id="local-6989586621679384739"><span id="local-6989586621679384747"><span id="local-6989586621679384755"><span id="local-6989586621679384763"><span id="local-6989586621679384771"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Foldable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#Product"><span class="hs-identifier hs-type">Product</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-465"></span><span id="local-6989586621679382753"><span id="local-6989586621679384778"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#LengthN"><span class="hs-identifier hs-type">LengthN</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#Product"><span class="hs-identifier hs-type">Product</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382753"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-466"></span><span>
</span><span id="line-467"></span><span class="hs-comment">---------------------------------------</span><span>
</span><span id="line-468"></span><span class="hs-comment">-- Product - Constructable -</span><span>
</span><span id="line-469"></span><span>
</span><span id="line-470"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679382759"><span id="local-6989586621679382760"><span class="annot"><a href="OAlg.Data.Constructable.html#Exposable"><span class="hs-identifier hs-type">Exposable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#Product"><span class="hs-identifier hs-type">Product</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382759"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382760"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-471"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Form"><span class="annot"><a href="OAlg.Data.Constructable.html#Form"><span class="hs-identifier hs-var">Form</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#Product"><span class="hs-identifier hs-type">Product</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382759"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382760"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#ProductForm"><span class="hs-identifier hs-type">ProductForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382759"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382760"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-472"></span><span>  </span><span id="local-6989586621679384785"><span class="annot"><span class="annottext">form :: Product r a -&gt; Form (Product r a)
</span><a href="#local-6989586621679384785"><span class="hs-identifier hs-var hs-var hs-var hs-var">form</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#Product"><span class="hs-identifier hs-type">Product</span></a></span><span> </span><span id="local-6989586621679384787"><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679384787"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Form (Product r a)
ProductForm r a
</span><a href="#local-6989586621679384787"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-473"></span><span>
</span><span id="line-474"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679382765"><span id="local-6989586621679382766"><span class="hs-special">(</span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#Oriented"><span class="hs-identifier hs-type">Oriented</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382765"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Integral"><span class="hs-identifier hs-type">Integral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382766"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.Constructable.html#Constructable"><span class="hs-identifier hs-type">Constructable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#Product"><span class="hs-identifier hs-type">Product</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382766"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382765"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-475"></span><span>  </span><span id="local-6989586621679384797"><span class="annot"><span class="annottext">make :: Form (Product r a) -&gt; Product r a
</span><a href="#local-6989586621679384797"><span class="hs-identifier hs-var hs-var hs-var hs-var">make</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProductForm r a -&gt; Product r a
forall r a. ProductForm r a -&gt; Product r a
</span><a href="OAlg.Entity.Product.Definition.html#Product"><span class="hs-identifier hs-var">Product</span></a></span><span> </span><span class="annot"><span class="annottext">(ProductForm r a -&gt; Product r a)
-&gt; (ProductForm r a -&gt; ProductForm r a)
-&gt; ProductForm r a
-&gt; Product r a
forall y z x. (y -&gt; z) -&gt; (x -&gt; y) -&gt; x -&gt; z
forall (c :: * -&gt; * -&gt; *) y z x.
Category c =&gt;
c y z -&gt; c x y -&gt; c x z
</span><a href="OAlg.Category.Definition.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r a -&gt; ProductForm r a
forall e. Reducible e =&gt; e -&gt; e
</span><a href="OAlg.Data.Reducible.html#reduce"><span class="hs-identifier hs-var">reduce</span></a></span><span>
</span><span id="line-476"></span><span>
</span><span id="line-477"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-478"></span><span class="hs-comment">-- Product - Sequence -</span><span>
</span><span id="line-479"></span><span>
</span><span id="line-480"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679382770"><span id="local-6989586621679384804"><span class="annot"><a href="OAlg.Entity.Sequence.Definition.html#Sequence"><span class="hs-identifier hs-type">Sequence</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#Product"><span class="hs-identifier hs-type">Product</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382770"><span class="hs-identifier hs-type">a</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-481"></span><span>  </span><span id="local-6989586621679384811"><span class="annot"><span class="annottext">list :: forall (p :: * -&gt; *). p N -&gt; Product N a -&gt; [(a, N)]
</span><a href="OAlg.Entity.Sequence.Definition.html#list"><span class="hs-identifier hs-var hs-var hs-var hs-var">list</span></a></span></span><span> </span><span id="local-6989586621679384812"><span class="annot"><span class="annottext">p N
</span><a href="#local-6989586621679384812"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Form (Product N a) -&gt; [(a, N)]) -&gt; Product N a -&gt; [(a, N)]
forall x y. Exposable x =&gt; (Form x -&gt; y) -&gt; x -&gt; y
</span><a href="OAlg.Data.Constructable.html#restrict"><span class="hs-identifier hs-var">restrict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">p N -&gt; ProductForm N a -&gt; [(a, N)]
forall (p :: * -&gt; *). p N -&gt; ProductForm N a -&gt; [(a, N)]
forall (s :: * -&gt; *) i x (p :: * -&gt; *).
Sequence s i x =&gt;
p i -&gt; s x -&gt; [(x, i)]
</span><a href="OAlg.Entity.Sequence.Definition.html#list"><span class="hs-identifier hs-var">list</span></a></span><span> </span><span class="annot"><span class="annottext">p N
</span><a href="#local-6989586621679384812"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-482"></span><span>  </span><span id="local-6989586621679384816"><span class="annot"><span class="annottext">?? :: Product N a -&gt; N -&gt; Maybe a
</span><a href="OAlg.Entity.Sequence.Definition.html#%3F%3F"><span class="hs-operator hs-var hs-var hs-var hs-var">(??)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Form (Product N a) -&gt; N -&gt; Maybe a) -&gt; Product N a -&gt; N -&gt; Maybe a
forall x y. Exposable x =&gt; (Form x -&gt; y) -&gt; x -&gt; y
</span><a href="OAlg.Data.Constructable.html#restrict"><span class="hs-identifier hs-var">restrict</span></a></span><span> </span><span class="annot"><span class="annottext">Form (Product N a) -&gt; N -&gt; Maybe a
ProductForm N a -&gt; N -&gt; Maybe a
forall (s :: * -&gt; *) i x. Sequence s i x =&gt; s x -&gt; i -&gt; Maybe x
</span><a href="OAlg.Entity.Sequence.Definition.html#%3F%3F"><span class="hs-operator hs-var">(??)</span></a></span><span>
</span><span id="line-483"></span><span>  </span><span>
</span><span id="line-484"></span><span class="hs-comment">----------------------------------------</span><span>
</span><span id="line-485"></span><span class="hs-comment">-- Product - Canonical -</span><span>
</span><span id="line-486"></span><span>
</span><span id="line-487"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679382776"><span id="local-6989586621679382777"><span class="hs-special">(</span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#Oriented"><span class="hs-identifier hs-type">Oriented</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382776"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Integral"><span class="hs-identifier hs-type">Integral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382777"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.Canonical.html#Embeddable"><span class="hs-identifier hs-type">Embeddable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382776"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#Product"><span class="hs-identifier hs-type">Product</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382777"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382776"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-488"></span><span>  </span><span id="local-6989586621679384824"><span class="annot"><span class="annottext">inj :: a -&gt; Product r a
</span><a href="OAlg.Data.Canonical.html#inj"><span class="hs-identifier hs-var hs-var hs-var hs-var">inj</span></a></span></span><span> </span><span id="local-6989586621679384825"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679384825"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Form (Product r a) -&gt; Product r a
ProductForm r a -&gt; Product r a
forall x. Constructable x =&gt; Form x -&gt; x
</span><a href="OAlg.Data.Constructable.html#make"><span class="hs-identifier hs-var">make</span></a></span><span> </span><span class="annot"><span class="annottext">(ProductForm r a -&gt; Product r a) -&gt; ProductForm r a -&gt; Product r a
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><a href="OAlg.Category.Applicative.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; ProductForm r a
forall a b. Embeddable a b =&gt; a -&gt; b
</span><a href="OAlg.Data.Canonical.html#inj"><span class="hs-identifier hs-var">inj</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679384825"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-489"></span><span>
</span><span id="line-490"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679382780"><span id="local-6989586621679382781"><span class="hs-special">(</span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#Oriented"><span class="hs-identifier hs-type">Oriented</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382780"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Integral"><span class="hs-identifier hs-type">Integral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382781"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.Canonical.html#Embeddable"><span class="hs-identifier hs-type">Embeddable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382780"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#Product"><span class="hs-identifier hs-type">Product</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382781"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382780"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-491"></span><span>  </span><span id="local-6989586621679384833"><span class="annot"><span class="annottext">inj :: Path a -&gt; Product r a
</span><a href="OAlg.Data.Canonical.html#inj"><span class="hs-identifier hs-var hs-var hs-var hs-var">inj</span></a></span></span><span> </span><span id="local-6989586621679384834"><span class="annot"><span class="annottext">Path a
</span><a href="#local-6989586621679384834"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Form (Product r a) -&gt; Product r a
ProductForm r a -&gt; Product r a
forall x. Constructable x =&gt; Form x -&gt; x
</span><a href="OAlg.Data.Constructable.html#make"><span class="hs-identifier hs-var">make</span></a></span><span> </span><span class="annot"><span class="annottext">(ProductForm r a -&gt; Product r a) -&gt; ProductForm r a -&gt; Product r a
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><a href="OAlg.Category.Applicative.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Path a -&gt; ProductForm r a
forall a b. Embeddable a b =&gt; a -&gt; b
</span><a href="OAlg.Data.Canonical.html#inj"><span class="hs-identifier hs-var">inj</span></a></span><span> </span><span class="annot"><span class="annottext">Path a
</span><a href="#local-6989586621679384834"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-492"></span><span>
</span><span id="line-493"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679382783"><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#Oriented"><span class="hs-identifier hs-type">Oriented</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382783"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.Canonical.html#Projectible"><span class="hs-identifier hs-type">Projectible</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382783"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#Product"><span class="hs-identifier hs-type">Product</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382783"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-494"></span><span>  </span><span id="local-6989586621679384840"><span class="annot"><span class="annottext">prj :: Product N a -&gt; Path a
</span><a href="OAlg.Data.Canonical.html#prj"><span class="hs-identifier hs-var hs-var hs-var hs-var">prj</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Form (Product N a) -&gt; Path a) -&gt; Product N a -&gt; Path a
forall x y. Exposable x =&gt; (Form x -&gt; y) -&gt; x -&gt; y
</span><a href="OAlg.Data.Constructable.html#restrict"><span class="hs-identifier hs-var">restrict</span></a></span><span> </span><span class="annot"><span class="annottext">Form (Product N a) -&gt; Path a
ProductForm N a -&gt; Path a
forall a b. Projectible a b =&gt; b -&gt; a
</span><a href="OAlg.Data.Canonical.html#prj"><span class="hs-identifier hs-var">prj</span></a></span><span>
</span><span id="line-495"></span><span>  </span><span>
</span><span id="line-496"></span><span class="hs-comment">----------------------------------------</span><span>
</span><span id="line-497"></span><span class="hs-comment">-- Product - Structure -</span><span>
</span><span id="line-498"></span><span>
</span><span id="line-499"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679382786"><span id="local-6989586621679382787"><span class="hs-special">(</span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#Oriented"><span class="hs-identifier hs-type">Oriented</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382786"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Integral"><span class="hs-identifier hs-type">Integral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382787"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Definition.html#Entity"><span class="hs-identifier hs-type">Entity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#Product"><span class="hs-identifier hs-type">Product</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382787"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382786"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-500"></span><span>
</span><span id="line-501"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679382790"><span id="local-6989586621679382791"><span id="local-6989586621679384872"><span id="local-6989586621679384876"><span class="hs-special">(</span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#Oriented"><span class="hs-identifier hs-type">Oriented</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382790"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Integral"><span class="hs-identifier hs-type">Integral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382791"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#Oriented"><span class="hs-identifier hs-type">Oriented</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#Product"><span class="hs-identifier hs-type">Product</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382791"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382790"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-502"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Point"><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#Point"><span class="hs-identifier hs-var">Point</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#Product"><span class="hs-identifier hs-type">Product</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382791"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382790"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382790"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-503"></span><span>  </span><span id="local-6989586621679384881"><span class="annot"><span class="annottext">orientation :: Product r a -&gt; Orientation (Point (Product r a))
</span><a href="OAlg.Structure.Oriented.Definition.html#orientation"><span class="hs-identifier hs-var hs-var hs-var hs-var">orientation</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Form (Product r a) -&gt; Orientation (Point a))
-&gt; Product r a -&gt; Orientation (Point a)
forall x y. Exposable x =&gt; (Form x -&gt; y) -&gt; x -&gt; y
</span><a href="OAlg.Data.Constructable.html#restrict"><span class="hs-identifier hs-var">restrict</span></a></span><span> </span><span class="annot"><span class="annottext">Form (Product r a) -&gt; Orientation (Point a)
ProductForm r a -&gt; Orientation (Point (ProductForm r a))
forall q. Oriented q =&gt; q -&gt; Orientation (Point q)
</span><a href="OAlg.Structure.Oriented.Definition.html#orientation"><span class="hs-identifier hs-var">orientation</span></a></span><span>
</span><span id="line-504"></span><span>
</span><span id="line-505"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679382794"><span id="local-6989586621679382795"><span class="hs-special">(</span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#Oriented"><span class="hs-identifier hs-type">Oriented</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382794"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Integral"><span class="hs-identifier hs-type">Integral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382795"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Structure.Multiplicative.Definition.html#Multiplicative"><span class="hs-identifier hs-type">Multiplicative</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#Product"><span class="hs-identifier hs-type">Product</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382795"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382794"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-506"></span><span>  </span><span id="local-6989586621679384898"><span class="annot"><span class="annottext">one :: Point (Product r a) -&gt; Product r a
</span><a href="OAlg.Structure.Multiplicative.Definition.html#one"><span class="hs-identifier hs-var hs-var hs-var hs-var">one</span></a></span></span><span> </span><span id="local-6989586621679384899"><span class="annot"><span class="annottext">Point (Product r a)
</span><a href="#local-6989586621679384899"><span class="hs-identifier hs-var">p</span></a></span></span><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Form (Product r a) -&gt; Product r a
forall x. Constructable x =&gt; Form x -&gt; x
</span><a href="OAlg.Data.Constructable.html#make"><span class="hs-identifier hs-var">make</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point a -&gt; ProductForm r a
forall r a. Point a -&gt; ProductForm r a
</span><a href="OAlg.Entity.Product.Definition.html#One"><span class="hs-identifier hs-var">One</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
Point (Product r a)
</span><a href="#local-6989586621679384899"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-507"></span><span>  </span><span>
</span><span id="line-508"></span><span>  </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#Product"><span class="hs-identifier hs-type">Product</span></a></span><span> </span><span id="local-6989586621679384905"><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679384905"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679384906"><span class="annot"><span class="annottext">* :: Product r a -&gt; Product r a -&gt; Product r a
</span><a href="OAlg.Structure.Multiplicative.Definition.html#%2A"><span class="hs-operator hs-var hs-var hs-var hs-var">*</span></a></span></span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#Product"><span class="hs-identifier hs-type">Product</span></a></span><span> </span><span id="local-6989586621679384907"><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679384907"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ProductForm r a -&gt; Point (ProductForm r a)
forall q. Oriented q =&gt; q -&gt; Point q
</span><a href="OAlg.Structure.Oriented.Definition.html#start"><span class="hs-identifier hs-var">start</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679384905"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">ProductForm r a -&gt; Point (ProductForm r a)
forall q. Oriented q =&gt; q -&gt; Point q
</span><a href="OAlg.Structure.Oriented.Definition.html#end"><span class="hs-identifier hs-var">end</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679384907"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Form (Product r a) -&gt; Product r a
forall x. Constructable x =&gt; Form x -&gt; x
</span><a href="OAlg.Data.Constructable.html#make"><span class="hs-identifier hs-var">make</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679384905"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r a -&gt; ProductForm r a -&gt; ProductForm r a
forall r a. ProductForm r a -&gt; ProductForm r a -&gt; ProductForm r a
</span><a href="OAlg.Entity.Product.Definition.html#%3A%2A"><span class="hs-operator hs-var">:*</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679384907"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-509"></span><span>                        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ArithmeticException -&gt; Product r a
forall a e. Exception e =&gt; e -&gt; a
</span><span class="hs-identifier hs-var">throw</span></span><span> </span><span class="annot"><span class="annottext">ArithmeticException
</span><a href="OAlg.Structure.Exception.html#NotMultiplicable"><span class="hs-identifier hs-var">NotMultiplicable</span></a></span><span>
</span><span id="line-510"></span><span>
</span><span id="line-511"></span><span>  </span><span id="local-6989586621679384913"><span class="annot"><span class="annottext">npower :: Product r a -&gt; N -&gt; Product r a
</span><a href="#local-6989586621679384913"><span class="hs-identifier hs-var hs-var hs-var hs-var">npower</span></a></span></span><span> </span><span id="local-6989586621679384915"><span class="annot"><span class="annottext">Product r a
</span><a href="#local-6989586621679384915"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679384916"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679384916"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Product r a
</span><a href="#local-6989586621679384915"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Product r a -&gt; Exponent (Product r a) -&gt; Product r a
forall f. Exponential f =&gt; f -&gt; Exponent f -&gt; f
</span><a href="OAlg.Structure.Exponential.html#%5E"><span class="hs-operator hs-var">^</span></a></span><span> </span><span class="annot"><span class="annottext">r
Exponent (Product r a)
</span><a href="#local-6989586621679384918"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679384918"><span class="annot"><span class="annottext">r :: r
</span><a href="#local-6989586621679384918"><span class="hs-identifier hs-var hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">N -&gt; r -&gt; r
forall a. Additive a =&gt; N -&gt; a -&gt; a
</span><a href="OAlg.Structure.Additive.Definition.html#ntimes"><span class="hs-identifier hs-var">ntimes</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679384916"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">r
forall r. Semiring r =&gt; r
</span><a href="OAlg.Structure.Ring.Definition.html#rOne"><span class="hs-identifier hs-var">rOne</span></a></span><span>
</span><span id="line-512"></span><span>
</span><span id="line-513"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679382807"><span id="local-6989586621679382808"><span id="local-6989586621679384927"><span id="local-6989586621679384931"><span class="hs-special">(</span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#Oriented"><span class="hs-identifier hs-type">Oriented</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382807"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Integral"><span class="hs-identifier hs-type">Integral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382808"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Ring.Definition.html#Ring"><span class="hs-identifier hs-type">Ring</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382808"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Structure.Multiplicative.Definition.html#Invertible"><span class="hs-identifier hs-type">Invertible</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#Product"><span class="hs-identifier hs-type">Product</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382808"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382807"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-514"></span><span>  </span><span id="local-6989586621679384940"><span class="annot"><span class="annottext">tryToInvert :: Product r a -&gt; Solver (Product r a)
</span><a href="#local-6989586621679384940"><span class="hs-identifier hs-var hs-var hs-var hs-var">tryToInvert</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Product r a -&gt; Solver (Product r a)
forall a. a -&gt; Solver a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Product r a -&gt; Solver (Product r a))
-&gt; (Product r a -&gt; Product r a)
-&gt; Product r a
-&gt; Solver (Product r a)
forall y z x. (y -&gt; z) -&gt; (x -&gt; y) -&gt; x -&gt; z
forall (c :: * -&gt; * -&gt; *) y z x.
Category c =&gt;
c y z -&gt; c x y -&gt; c x z
</span><a href="OAlg.Category.Definition.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Product r a -&gt; Product r a
forall c. Invertible c =&gt; c -&gt; c
</span><a href="OAlg.Structure.Multiplicative.Definition.html#invert"><span class="hs-identifier hs-var">invert</span></a></span><span> </span><span>
</span><span id="line-515"></span><span>  </span><span id="local-6989586621679384946"><span class="annot"><span class="annottext">invert :: Product r a -&gt; Product r a
</span><a href="OAlg.Structure.Multiplicative.Definition.html#invert"><span class="hs-identifier hs-var hs-var hs-var hs-var">invert</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#Product"><span class="hs-identifier hs-type">Product</span></a></span><span> </span><span id="local-6989586621679384947"><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679384947"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Form (Product r a) -&gt; Product r a
forall x. Constructable x =&gt; Form x -&gt; x
</span><a href="OAlg.Data.Constructable.html#make"><span class="hs-identifier hs-var">make</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679384947"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r a -&gt; r -&gt; ProductForm r a
forall r a. ProductForm r a -&gt; r -&gt; ProductForm r a
</span><a href="OAlg.Entity.Product.Definition.html#%3A%5E"><span class="hs-operator hs-var">:^</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r
forall a. Abelian a =&gt; a -&gt; a
</span><a href="OAlg.Structure.Additive.Definition.html#negate"><span class="hs-identifier hs-var">negate</span></a></span><span> </span><span class="annot"><span class="annottext">r
forall r. Semiring r =&gt; r
</span><a href="OAlg.Structure.Ring.Definition.html#rOne"><span class="hs-identifier hs-var">rOne</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-516"></span><span>
</span><span id="line-517"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679382813"><span id="local-6989586621679382814"><span class="hs-special">(</span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#Oriented"><span class="hs-identifier hs-type">Oriented</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382813"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Integral"><span class="hs-identifier hs-type">Integral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382814"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Ring.Definition.html#Ring"><span class="hs-identifier hs-type">Ring</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382814"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Structure.Multiplicative.Definition.html#Cayleyan"><span class="hs-identifier hs-type">Cayleyan</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#Product"><span class="hs-identifier hs-type">Product</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382814"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382813"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-518"></span><span>
</span><span id="line-519"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679382797"><span id="local-6989586621679382798"><span class="hs-special">(</span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#Oriented"><span class="hs-identifier hs-type">Oriented</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382797"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Integral"><span class="hs-identifier hs-type">Integral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382798"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Structure.Exponential.html#Exponential"><span class="hs-identifier hs-type">Exponential</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#Product"><span class="hs-identifier hs-type">Product</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382798"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382797"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-520"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Exponent"><span class="annot"><a href="OAlg.Structure.Exponential.html#Exponent"><span class="hs-identifier hs-var">Exponent</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#Product"><span class="hs-identifier hs-type">Product</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382798"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382797"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679382798"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-521"></span><span>  </span><span id="local-6989586621679384980"><span class="annot"><span class="annottext">p :: Product r a
</span><a href="#local-6989586621679384980"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#Product"><span class="hs-identifier hs-type">Product</span></a></span><span> </span><span id="local-6989586621679384981"><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679384981"><span class="hs-identifier hs-var">pf</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679384982"><span class="annot"><span class="annottext">^ :: Product r a -&gt; Exponent (Product r a) -&gt; Product r a
</span><a href="OAlg.Structure.Exponential.html#%5E"><span class="hs-operator hs-var hs-var hs-var hs-var">^</span></a></span></span><span> </span><span id="local-6989586621679384983"><span class="annot"><span class="annottext">Exponent (Product r a)
</span><a href="#local-6989586621679384983"><span class="hs-identifier hs-var">r</span></a></span></span><span>
</span><span id="line-522"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
forall b. Boolean b =&gt; b -&gt; b
</span><a href="OAlg.Data.Boolean.Definition.html#not"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r -&gt; r
forall r. Number r =&gt; r -&gt; r
</span><a href="OAlg.Structure.Number.Definition.html#abs"><span class="hs-identifier hs-var">abs</span></a></span><span> </span><span class="annot"><span class="annottext">r
Exponent (Product r a)
</span><a href="#local-6989586621679384983"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">r
forall r. Semiring r =&gt; r
</span><a href="OAlg.Structure.Ring.Definition.html#rOne"><span class="hs-identifier hs-var">rOne</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
forall b. Boolean b =&gt; b -&gt; b -&gt; b
</span><a href="OAlg.Data.Boolean.Definition.html#%7C%7C"><span class="hs-operator hs-var">||</span></a></span><span> </span><span class="annot"><span class="annottext">Product r a -&gt; Bool
forall q. Oriented q =&gt; q -&gt; Bool
</span><a href="OAlg.Structure.Oriented.Definition.html#isEndo"><span class="hs-identifier hs-var">isEndo</span></a></span><span> </span><span class="annot"><span class="annottext">Product r a
</span><a href="#local-6989586621679384980"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ArithmeticException -&gt; Product r a
forall a e. Exception e =&gt; e -&gt; a
</span><span class="hs-identifier hs-var">throw</span></span><span> </span><span class="annot"><span class="annottext">ArithmeticException
</span><a href="OAlg.Structure.Exception.html#NotExponential"><span class="hs-identifier hs-var">NotExponential</span></a></span><span>
</span><span id="line-523"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>                       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Form (Product r a) -&gt; Product r a
forall x. Constructable x =&gt; Form x -&gt; x
</span><a href="OAlg.Data.Constructable.html#make"><span class="hs-identifier hs-var">make</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679384981"><span class="hs-identifier hs-var">pf</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r a -&gt; r -&gt; ProductForm r a
forall r a. ProductForm r a -&gt; r -&gt; ProductForm r a
</span><a href="OAlg.Entity.Product.Definition.html#%3A%5E"><span class="hs-operator hs-var">:^</span></a></span><span> </span><span class="annot"><span class="annottext">r
Exponent (Product r a)
</span><a href="#local-6989586621679384983"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-524"></span><span>
</span><span id="line-525"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-526"></span><span class="hs-comment">-- prFactors -</span><span>
</span><span id="line-527"></span><span>
</span><span id="line-528"></span><span class="annot"><span class="hs-comment">-- | the list of primary factors.</span></span><span>
</span><span id="line-529"></span><span id="local-6989586621679384989"><span class="annot"><a href="OAlg.Entity.Product.Definition.html#prFactors"><span class="hs-identifier hs-type">prFactors</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#Product"><span class="hs-identifier hs-type">Product</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679384989"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679384989"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-530"></span><span id="prFactors"><span class="annot"><span class="annottext">prFactors :: forall a. Product N a -&gt; [a]
</span><a href="OAlg.Entity.Product.Definition.html#prFactors"><span class="hs-identifier hs-var hs-var">prFactors</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Product N a -&gt; [a]
forall a. Product N a -&gt; [a]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">toList</span></span><span>
</span><span id="line-531"></span><span>
</span><span id="line-532"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-533"></span><span class="hs-comment">-- prLength -</span><span>
</span><span id="line-534"></span><span>
</span><span id="line-535"></span><span class="annot"><span class="hs-comment">-- | number of primary factors where where all simple factors are expanded according to there exponent.</span></span><span>
</span><span id="line-536"></span><span id="local-6989586621679384991"><span class="annot"><a href="OAlg.Entity.Product.Definition.html#prLength"><span class="hs-identifier hs-type">prLength</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#Product"><span class="hs-identifier hs-type">Product</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679384991"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span></span><span>
</span><span id="line-537"></span><span id="prLength"><span class="annot"><span class="annottext">prLength :: forall a. Product N a -&gt; N
</span><a href="OAlg.Entity.Product.Definition.html#prLength"><span class="hs-identifier hs-var hs-var">prLength</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Form (Product N a) -&gt; N) -&gt; Product N a -&gt; N
forall x y. Exposable x =&gt; (Form x -&gt; y) -&gt; x -&gt; y
</span><a href="OAlg.Data.Constructable.html#restrict"><span class="hs-identifier hs-var">restrict</span></a></span><span> </span><span class="annot"><span class="annottext">Form (Product N a) -&gt; N
ProductForm N a -&gt; N
forall r a. Number r =&gt; ProductForm r a -&gt; N
</span><a href="OAlg.Entity.Product.Definition.html#prfLength"><span class="hs-identifier hs-var">prfLength</span></a></span><span>
</span><span id="line-538"></span><span>
</span><span id="line-539"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-540"></span><span class="hs-comment">-- prwrd -</span><span>
</span><span id="line-541"></span><span>
</span><span id="line-542"></span><span class="annot"><span class="hs-comment">-- | restriction of 'prfwrd'.</span></span><span>
</span><span id="line-543"></span><span id="local-6989586621679382820"><span id="local-6989586621679382821"><span class="annot"><a href="OAlg.Entity.Product.Definition.html#prwrd"><span class="hs-identifier hs-type">prwrd</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Integral"><span class="hs-identifier hs-type">Integral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382820"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#Oriented"><span class="hs-identifier hs-type">Oriented</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382821"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#Product"><span class="hs-identifier hs-type">Product</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382820"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382821"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#Word"><span class="hs-identifier hs-type">Word</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382820"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382821"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-544"></span><span id="prwrd"><span class="annot"><span class="annottext">prwrd :: forall r a. (Integral r, Oriented a) =&gt; Product r a -&gt; Word r a
</span><a href="OAlg.Entity.Product.Definition.html#prwrd"><span class="hs-identifier hs-var hs-var">prwrd</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#Product"><span class="hs-identifier hs-type">Product</span></a></span><span> </span><span id="local-6989586621679385003"><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679385003"><span class="hs-identifier hs-var">pf</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(a, r)] -&gt; Word r a
forall r a. [(a, r)] -&gt; Word r a
</span><a href="OAlg.Entity.Product.Definition.html#Word"><span class="hs-identifier hs-var">Word</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProductForm r a -&gt; [(a, r)]
forall {b} {a}.
(Distributive b, Total b, Oriented a) =&gt;
ProductForm b a -&gt; [(a, b)]
</span><a href="#local-6989586621679385004"><span class="hs-identifier hs-var">prfwrd</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679385003"><span class="hs-identifier hs-var">pf</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-545"></span><span>  </span><span class="hs-comment">-- we use here the property that pf is reduced.</span><span>
</span><span id="line-546"></span><span>  </span><span id="local-6989586621679385004"><span class="annot"><span class="annottext">prfwrd :: ProductForm b a -&gt; [(a, b)]
</span><a href="#local-6989586621679385004"><span class="hs-identifier hs-var hs-var">prfwrd</span></a></span></span><span> </span><span id="local-6989586621679385121"><span class="annot"><span class="annottext">ProductForm b a
</span><a href="#local-6989586621679385121"><span class="hs-identifier hs-var">pf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ProductForm b a
</span><a href="#local-6989586621679385121"><span class="hs-identifier hs-var">pf</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-547"></span><span>    </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#One"><span class="hs-identifier hs-type">One</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><span class="hs-identifier">_</span></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-548"></span><span>    </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span id="local-6989586621679385122"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679385122"><span class="hs-identifier hs-var">a</span></a></span></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679385122"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
forall r. Semiring r =&gt; r
</span><a href="OAlg.Structure.Ring.Definition.html#rOne"><span class="hs-identifier hs-var">rOne</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-549"></span><span>    </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span id="local-6989586621679385123"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679385123"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#%3A%5E"><span class="hs-operator hs-type">:^</span></a></span><span> </span><span id="local-6989586621679385124"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679385124"><span class="hs-identifier hs-var">r</span></a></span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679385123"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679385124"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-550"></span><span>    </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span id="local-6989586621679385125"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679385125"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#%3A%2A"><span class="hs-operator hs-type">:*</span></a></span><span> </span><span id="local-6989586621679385126"><span class="annot"><span class="annottext">ProductForm b a
</span><a href="#local-6989586621679385126"><span class="hs-identifier hs-var">pf</span></a></span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679385125"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
forall r. Semiring r =&gt; r
</span><a href="OAlg.Structure.Ring.Definition.html#rOne"><span class="hs-identifier hs-var">rOne</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">(a, b) -&gt; [(a, b)] -&gt; [(a, b)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">ProductForm b a -&gt; [(a, b)]
</span><a href="#local-6989586621679385004"><span class="hs-identifier hs-var">prfwrd</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm b a
</span><a href="#local-6989586621679385126"><span class="hs-identifier hs-var">pf</span></a></span><span>
</span><span id="line-551"></span><span>    </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span id="local-6989586621679385127"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679385127"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#%3A%5E"><span class="hs-operator hs-type">:^</span></a></span><span> </span><span id="local-6989586621679385128"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679385128"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#%3A%2A"><span class="hs-operator hs-type">:*</span></a></span><span> </span><span id="local-6989586621679385129"><span class="annot"><span class="annottext">ProductForm b a
</span><a href="#local-6989586621679385129"><span class="hs-identifier hs-var">pf</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679385127"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679385128"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">(a, b) -&gt; [(a, b)] -&gt; [(a, b)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">ProductForm b a -&gt; [(a, b)]
</span><a href="#local-6989586621679385004"><span class="hs-identifier hs-var">prfwrd</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm b a
</span><a href="#local-6989586621679385129"><span class="hs-identifier hs-var">pf</span></a></span><span>
</span><span id="line-552"></span><span>    </span><span id="local-6989586621679385130"><span class="annot"><span class="annottext">ProductForm b a
</span><a href="#local-6989586621679385130"><span class="hs-identifier hs-var">pf</span></a></span></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AlgebraicException -&gt; [(a, b)]
forall a e. Exception e =&gt; e -&gt; a
</span><span class="hs-identifier hs-var">throw</span></span><span> </span><span class="annot"><span class="annottext">(AlgebraicException -&gt; [(a, b)]) -&gt; AlgebraicException -&gt; [(a, b)]
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><a href="OAlg.Category.Applicative.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; AlgebraicException
</span><a href="OAlg.Control.Exception.html#InvalidData"><span class="hs-identifier hs-var">InvalidData</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; AlgebraicException) -&gt; String -&gt; AlgebraicException
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><a href="OAlg.Category.Applicative.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm b a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">(ProductForm b a -&gt; String) -&gt; ProductForm b a -&gt; String
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><a href="OAlg.Category.Applicative.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm b a
</span><a href="#local-6989586621679385130"><span class="hs-identifier hs-var">pf</span></a></span><span>
</span><span id="line-553"></span><span>
</span><span id="line-554"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-555"></span><span class="hs-comment">-- prFactor -</span><span>
</span><span id="line-556"></span><span>
</span><span id="line-557"></span><span class="hs-comment">-- | the @n@-th primary factor where all simple factors are expanded according to there</span><span>
</span><span id="line-558"></span><span class="hs-comment">--   exponent. </span><span>
</span><span id="line-559"></span><span id="local-6989586621679382826"><span class="annot"><a href="OAlg.Entity.Product.Definition.html#prFactor"><span class="hs-identifier hs-type">prFactor</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#Product"><span class="hs-identifier hs-type">Product</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382826"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679382826"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-560"></span><span id="prFactor"><span class="annot"><span class="annottext">prFactor :: forall a. Product N a -&gt; N -&gt; a
</span><a href="OAlg.Entity.Product.Definition.html#prFactor"><span class="hs-identifier hs-var hs-var">prFactor</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Product N a -&gt; N -&gt; a
forall (s :: * -&gt; *) i x. Sequence s i x =&gt; s x -&gt; i -&gt; x
</span><a href="OAlg.Entity.Sequence.Definition.html#%3F"><span class="hs-operator hs-var">(?)</span></a></span><span>
</span><span id="line-561"></span><span>
</span><span id="line-562"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-563"></span><span class="hs-comment">-- prd -</span><span>
</span><span id="line-564"></span><span>
</span><span id="line-565"></span><span class="annot"><span class="hs-comment">-- | evaluates the /product/ according to the given exponential and multiplication.</span></span><span>
</span><span id="line-566"></span><span id="local-6989586621679382831"><span id="local-6989586621679382832"><span id="local-6989586621679382833"><span id="local-6989586621679382834"><span id="local-6989586621679382835"><span class="annot"><a href="OAlg.Entity.Product.Definition.html#prd"><span class="hs-identifier hs-type">prd</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Structure.Multiplicative.Definition.html#Multiplicative"><span class="hs-identifier hs-type">Multiplicative</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382831"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#Oriented"><span class="hs-identifier hs-type">Oriented</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382832"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679382833"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382832"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679382834"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382831"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Number"><span class="hs-identifier hs-type">Number</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382835"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-567"></span><span>   </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679382831"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679382835"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679382831"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679382833"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679382834"><span class="hs-identifier hs-type">q</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679382832"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679382831"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#ProductForm"><span class="hs-identifier hs-type">ProductForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382835"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382832"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679382831"><span class="hs-identifier hs-type">x</span></a></span></span></span></span></span></span><span>
</span><span id="line-568"></span><span id="prd"><span class="annot"><span class="annottext">prd :: forall x a p q r.
(Multiplicative x, Oriented a, p ~ Point a, q ~ Point x,
 Number r) =&gt;
(x -&gt; r -&gt; x) -&gt; (p -&gt; q) -&gt; (a -&gt; x) -&gt; ProductForm r a -&gt; x
</span><a href="OAlg.Entity.Product.Definition.html#prd"><span class="hs-identifier hs-var hs-var">prd</span></a></span></span><span> </span><span id="local-6989586621679385163"><span class="annot"><span class="annottext">x -&gt; r -&gt; x
</span><a href="#local-6989586621679385163"><span class="hs-operator hs-var">(^)</span></a></span></span><span> </span><span id="local-6989586621679385164"><span class="annot"><span class="annottext">p -&gt; q
</span><a href="#local-6989586621679385164"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span id="local-6989586621679385165"><span class="annot"><span class="annottext">a -&gt; x
</span><a href="#local-6989586621679385165"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679385166"><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679385166"><span class="hs-identifier hs-var">pf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679385166"><span class="hs-identifier hs-var">pf</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-569"></span><span>  </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#One"><span class="hs-identifier hs-type">One</span></a></span><span> </span><span id="local-6989586621679385167"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679385167"><span class="hs-identifier hs-var">p</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Point x -&gt; x
forall c. Multiplicative c =&gt; Point c -&gt; c
</span><a href="OAlg.Structure.Multiplicative.Definition.html#one"><span class="hs-identifier hs-var">one</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">p -&gt; q
</span><a href="#local-6989586621679385164"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">p
Point a
</span><a href="#local-6989586621679385167"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-570"></span><span>  </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span id="local-6989586621679385168"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679385168"><span class="hs-identifier hs-var">a</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; x
</span><a href="#local-6989586621679385165"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679385168"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-571"></span><span>  </span><span id="local-6989586621679385169"><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679385169"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#%3A%5E"><span class="hs-operator hs-type">:^</span></a></span><span> </span><span id="local-6989586621679385170"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679385170"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(x -&gt; r -&gt; x) -&gt; (p -&gt; q) -&gt; (a -&gt; x) -&gt; ProductForm r a -&gt; x
forall x a p q r.
(Multiplicative x, Oriented a, p ~ Point a, q ~ Point x,
 Number r) =&gt;
(x -&gt; r -&gt; x) -&gt; (p -&gt; q) -&gt; (a -&gt; x) -&gt; ProductForm r a -&gt; x
</span><a href="OAlg.Entity.Product.Definition.html#prd"><span class="hs-identifier hs-var">prd</span></a></span><span> </span><span class="annot"><span class="annottext">x -&gt; r -&gt; x
</span><a href="#local-6989586621679385163"><span class="hs-operator hs-var">(^)</span></a></span><span> </span><span class="annot"><span class="annottext">p -&gt; q
</span><a href="#local-6989586621679385164"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; x
</span><a href="#local-6989586621679385165"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679385169"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">x -&gt; r -&gt; x
</span><a href="#local-6989586621679385163"><span class="hs-operator hs-var">^</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679385170"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-572"></span><span>  </span><span id="local-6989586621679385171"><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679385171"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#%3A%2A"><span class="hs-operator hs-type">:*</span></a></span><span> </span><span id="local-6989586621679385172"><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679385172"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(x -&gt; r -&gt; x) -&gt; (p -&gt; q) -&gt; (a -&gt; x) -&gt; ProductForm r a -&gt; x
forall x a p q r.
(Multiplicative x, Oriented a, p ~ Point a, q ~ Point x,
 Number r) =&gt;
(x -&gt; r -&gt; x) -&gt; (p -&gt; q) -&gt; (a -&gt; x) -&gt; ProductForm r a -&gt; x
</span><a href="OAlg.Entity.Product.Definition.html#prd"><span class="hs-identifier hs-var">prd</span></a></span><span> </span><span class="annot"><span class="annottext">x -&gt; r -&gt; x
</span><a href="#local-6989586621679385163"><span class="hs-operator hs-var">(^)</span></a></span><span> </span><span class="annot"><span class="annottext">p -&gt; q
</span><a href="#local-6989586621679385164"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; x
</span><a href="#local-6989586621679385165"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679385171"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">x -&gt; x -&gt; x
forall c. Multiplicative c =&gt; c -&gt; c -&gt; c
</span><a href="OAlg.Structure.Multiplicative.Definition.html#%2A"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">(x -&gt; r -&gt; x) -&gt; (p -&gt; q) -&gt; (a -&gt; x) -&gt; ProductForm r a -&gt; x
forall x a p q r.
(Multiplicative x, Oriented a, p ~ Point a, q ~ Point x,
 Number r) =&gt;
(x -&gt; r -&gt; x) -&gt; (p -&gt; q) -&gt; (a -&gt; x) -&gt; ProductForm r a -&gt; x
</span><a href="OAlg.Entity.Product.Definition.html#prd"><span class="hs-identifier hs-var">prd</span></a></span><span> </span><span class="annot"><span class="annottext">x -&gt; r -&gt; x
</span><a href="#local-6989586621679385163"><span class="hs-operator hs-var">(^)</span></a></span><span> </span><span class="annot"><span class="annottext">p -&gt; q
</span><a href="#local-6989586621679385164"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; x
</span><a href="#local-6989586621679385165"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r a
</span><a href="#local-6989586621679385172"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-573"></span><span>
</span><span id="line-574"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-575"></span><span class="hs-comment">-- prdMapTotal -</span><span>
</span><span id="line-576"></span><span>
</span><span id="line-577"></span><span class="annot"><span class="hs-comment">-- | mapping a product.</span></span><span>
</span><span id="line-578"></span><span id="local-6989586621679382841"><span id="local-6989586621679382842"><span id="local-6989586621679382843"><span class="annot"><a href="OAlg.Entity.Product.Definition.html#prdMapTotal"><span class="hs-identifier hs-type">prdMapTotal</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Data.Singleton.html#Singleton"><span class="hs-identifier hs-type">Singleton</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382841"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#Oriented"><span class="hs-identifier hs-type">Oriented</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382841"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Number.Definition.html#Integral"><span class="hs-identifier hs-type">Integral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382842"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-579"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679382843"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679382841"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#Product"><span class="hs-identifier hs-type">Product</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382842"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382843"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#Product"><span class="hs-identifier hs-type">Product</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382842"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382841"><span class="hs-identifier hs-type">y</span></a></span></span></span></span><span>
</span><span id="line-580"></span><span id="prdMapTotal"><span class="annot"><span class="annottext">prdMapTotal :: forall y r x.
(Singleton (Point y), Oriented y, Integral r) =&gt;
(x -&gt; y) -&gt; Product r x -&gt; Product r y
</span><a href="OAlg.Entity.Product.Definition.html#prdMapTotal"><span class="hs-identifier hs-var hs-var">prdMapTotal</span></a></span></span><span> </span><span id="local-6989586621679385179"><span class="annot"><span class="annottext">x -&gt; y
</span><a href="#local-6989586621679385179"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#Product"><span class="hs-identifier hs-type">Product</span></a></span><span> </span><span id="local-6989586621679385180"><span class="annot"><span class="annottext">ProductForm r x
</span><a href="#local-6989586621679385180"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Form (Product r y) -&gt; Product r y
ProductForm r y -&gt; Product r y
forall x. Constructable x =&gt; Form x -&gt; x
</span><a href="OAlg.Data.Constructable.html#make"><span class="hs-identifier hs-var">make</span></a></span><span> </span><span class="annot"><span class="annottext">(ProductForm r y -&gt; Product r y) -&gt; ProductForm r y -&gt; Product r y
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><a href="OAlg.Category.Applicative.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r x -&gt; ProductForm r y
</span><a href="#local-6989586621679385181"><span class="hs-identifier hs-var">f'</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r x
</span><a href="#local-6989586621679385180"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-581"></span><span>  </span><span id="local-6989586621679385181"><span class="annot"><span class="annottext">f' :: ProductForm r x -&gt; ProductForm r y
</span><a href="#local-6989586621679385181"><span class="hs-identifier hs-var hs-var">f'</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#One"><span class="hs-identifier hs-type">One</span></a></span><span> </span><span class="annot"><span class="annottext">Point x
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point y -&gt; ProductForm r y
forall r a. Point a -&gt; ProductForm r a
</span><a href="OAlg.Entity.Product.Definition.html#One"><span class="hs-identifier hs-var">One</span></a></span><span> </span><span class="annot"><span class="annottext">Point y
forall s. Singleton s =&gt; s
</span><a href="OAlg.Data.Singleton.html#unit"><span class="hs-keyword hs-var">unit</span></a></span><span>
</span><span id="line-582"></span><span>  </span><span class="annot"><a href="#local-6989586621679385181"><span class="hs-identifier hs-var">f'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span id="local-6989586621679385183"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679385183"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">y -&gt; ProductForm r y
forall r a. a -&gt; ProductForm r a
</span><a href="OAlg.Entity.Product.Definition.html#P"><span class="hs-identifier hs-var">P</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">x -&gt; y
</span><a href="#local-6989586621679385179"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679385183"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-583"></span><span>  </span><span class="annot"><a href="#local-6989586621679385181"><span class="hs-identifier hs-var">f'</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679385184"><span class="annot"><span class="annottext">ProductForm r x
</span><a href="#local-6989586621679385184"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#%3A%5E"><span class="hs-operator hs-type">:^</span></a></span><span> </span><span id="local-6989586621679385185"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679385185"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProductForm r x -&gt; ProductForm r y
</span><a href="#local-6989586621679385181"><span class="hs-identifier hs-var">f'</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r x
</span><a href="#local-6989586621679385184"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r y -&gt; r -&gt; ProductForm r y
forall r a. ProductForm r a -&gt; r -&gt; ProductForm r a
</span><a href="OAlg.Entity.Product.Definition.html#%3A%5E"><span class="hs-operator hs-var">:^</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679385185"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-584"></span><span>  </span><span class="annot"><a href="#local-6989586621679385181"><span class="hs-identifier hs-var">f'</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679385186"><span class="annot"><span class="annottext">ProductForm r x
</span><a href="#local-6989586621679385186"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#%3A%2A"><span class="hs-operator hs-type">:*</span></a></span><span> </span><span id="local-6989586621679385187"><span class="annot"><span class="annottext">ProductForm r x
</span><a href="#local-6989586621679385187"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProductForm r x -&gt; ProductForm r y
</span><a href="#local-6989586621679385181"><span class="hs-identifier hs-var">f'</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r x
</span><a href="#local-6989586621679385186"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r y -&gt; ProductForm r y -&gt; ProductForm r y
forall r a. ProductForm r a -&gt; ProductForm r a -&gt; ProductForm r a
</span><a href="OAlg.Entity.Product.Definition.html#%3A%2A"><span class="hs-operator hs-var">:*</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r x -&gt; ProductForm r y
</span><a href="#local-6989586621679385181"><span class="hs-identifier hs-var">f'</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r x
</span><a href="#local-6989586621679385187"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-585"></span><span>  </span><span>
</span><span id="line-586"></span><span>
</span><span id="line-587"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-588"></span><span class="hs-comment">-- prfMapTotal -</span><span>
</span><span id="line-589"></span><span>
</span><span id="line-590"></span><span class="annot"><span class="hs-comment">-- | mapping a product form</span></span><span>
</span><span id="line-591"></span><span id="local-6989586621679382848"><span id="local-6989586621679382849"><span id="local-6989586621679382850"><span class="annot"><a href="OAlg.Entity.Product.Definition.html#prfMapTotal"><span class="hs-identifier hs-type">prfMapTotal</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.Data.Singleton.html#Singleton"><span class="hs-identifier hs-type">Singleton</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382848"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-592"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679382849"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#ProductForm"><span class="hs-identifier hs-type">ProductForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382850"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382848"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#ProductForm"><span class="hs-identifier hs-type">ProductForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382850"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382849"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#ProductForm"><span class="hs-identifier hs-type">ProductForm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382850"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382848"><span class="hs-identifier hs-type">y</span></a></span></span></span></span><span>
</span><span id="line-593"></span><span id="prfMapTotal"><span class="annot"><span class="annottext">prfMapTotal :: forall y x r.
Singleton (Point y) =&gt;
(x -&gt; ProductForm r y) -&gt; ProductForm r x -&gt; ProductForm r y
</span><a href="OAlg.Entity.Product.Definition.html#prfMapTotal"><span class="hs-identifier hs-var hs-var">prfMapTotal</span></a></span></span><span> </span><span id="local-6989586621679385193"><span class="annot"><span class="annottext">x -&gt; ProductForm r y
</span><a href="#local-6989586621679385193"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679385194"><span class="annot"><span class="annottext">ProductForm r x
</span><a href="#local-6989586621679385194"><span class="hs-identifier hs-var">pf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ProductForm r x
</span><a href="#local-6989586621679385194"><span class="hs-identifier hs-var">pf</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-594"></span><span>  </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#One"><span class="hs-identifier hs-type">One</span></a></span><span> </span><span class="annot"><span class="annottext">Point x
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Point y -&gt; ProductForm r y
forall r a. Point a -&gt; ProductForm r a
</span><a href="OAlg.Entity.Product.Definition.html#One"><span class="hs-identifier hs-var">One</span></a></span><span> </span><span class="annot"><span class="annottext">Point y
forall s. Singleton s =&gt; s
</span><a href="OAlg.Data.Singleton.html#unit"><span class="hs-keyword hs-var">unit</span></a></span><span>
</span><span id="line-595"></span><span>  </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span id="local-6989586621679385195"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679385195"><span class="hs-identifier hs-var">x</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">x -&gt; ProductForm r y
</span><a href="#local-6989586621679385193"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679385195"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-596"></span><span>  </span><span id="local-6989586621679385196"><span class="annot"><span class="annottext">ProductForm r x
</span><a href="#local-6989586621679385196"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#%3A%5E"><span class="hs-operator hs-type">:^</span></a></span><span> </span><span id="local-6989586621679385197"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679385197"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(x -&gt; ProductForm r y) -&gt; ProductForm r x -&gt; ProductForm r y
forall y x r.
Singleton (Point y) =&gt;
(x -&gt; ProductForm r y) -&gt; ProductForm r x -&gt; ProductForm r y
</span><a href="OAlg.Entity.Product.Definition.html#prfMapTotal"><span class="hs-identifier hs-var">prfMapTotal</span></a></span><span> </span><span class="annot"><span class="annottext">x -&gt; ProductForm r y
</span><a href="#local-6989586621679385193"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r x
</span><a href="#local-6989586621679385196"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r y -&gt; r -&gt; ProductForm r y
forall r a. ProductForm r a -&gt; r -&gt; ProductForm r a
</span><a href="OAlg.Entity.Product.Definition.html#%3A%5E"><span class="hs-operator hs-var">:^</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679385197"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-597"></span><span>  </span><span id="local-6989586621679385198"><span class="annot"><span class="annottext">ProductForm r x
</span><a href="#local-6989586621679385198"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#%3A%2A"><span class="hs-operator hs-type">:*</span></a></span><span> </span><span id="local-6989586621679385199"><span class="annot"><span class="annottext">ProductForm r x
</span><a href="#local-6989586621679385199"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(x -&gt; ProductForm r y) -&gt; ProductForm r x -&gt; ProductForm r y
forall y x r.
Singleton (Point y) =&gt;
(x -&gt; ProductForm r y) -&gt; ProductForm r x -&gt; ProductForm r y
</span><a href="OAlg.Entity.Product.Definition.html#prfMapTotal"><span class="hs-identifier hs-var">prfMapTotal</span></a></span><span> </span><span class="annot"><span class="annottext">x -&gt; ProductForm r y
</span><a href="#local-6989586621679385193"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r x
</span><a href="#local-6989586621679385198"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r y -&gt; ProductForm r y -&gt; ProductForm r y
forall r a. ProductForm r a -&gt; ProductForm r a -&gt; ProductForm r a
</span><a href="OAlg.Entity.Product.Definition.html#%3A%2A"><span class="hs-operator hs-var">:*</span></a></span><span> </span><span class="annot"><span class="annottext">(x -&gt; ProductForm r y) -&gt; ProductForm r x -&gt; ProductForm r y
forall y x r.
Singleton (Point y) =&gt;
(x -&gt; ProductForm r y) -&gt; ProductForm r x -&gt; ProductForm r y
</span><a href="OAlg.Entity.Product.Definition.html#prfMapTotal"><span class="hs-identifier hs-var">prfMapTotal</span></a></span><span> </span><span class="annot"><span class="annottext">x -&gt; ProductForm r y
</span><a href="#local-6989586621679385193"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r x
</span><a href="#local-6989586621679385199"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-598"></span><span>
</span><span id="line-599"></span><span class="hs-comment">----------------------------------------</span><span>
</span><span id="line-600"></span><span class="hs-comment">-- nProductForm -</span><span>
</span><span id="line-601"></span><span>
</span><span id="line-602"></span><span>
</span><span id="line-603"></span><span id="local-6989586621679382855"><span id="local-6989586621679382857"><span id="local-6989586621679382858"><span class="annot"><a href="OAlg.Entity.Product.Definition.html#nProductFormOrt"><span class="hs-identifier hs-type">nProductFormOrt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Hom.Definition.html#Hom"><span class="hs-identifier hs-type">Hom</span></a></span><span> </span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#Ort"><span class="hs-identifier hs-type">Ort</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382855"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Multiplicative.Definition.html#Multiplicative"><span class="hs-identifier hs-type">Multiplicative</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382857"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-604"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Structure.Definition.html#Struct"><span class="hs-identifier hs-type">Struct</span></a></span><span> </span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#Ort"><span class="hs-identifier hs-type">Ort</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382858"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679382855"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382858"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382857"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#ProductForm"><span class="hs-identifier hs-type">ProductForm</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382858"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679382857"><span class="hs-identifier hs-type">x</span></a></span></span></span></span><span>
</span><span id="line-605"></span><span class="hs-comment">-- nProductFormOrt Struct f = prd npower (pmap f) (f$)</span><span>
</span><span id="line-606"></span><span id="nProductFormOrt"><span class="annot"><span class="annottext">nProductFormOrt :: forall (h :: * -&gt; * -&gt; *) x a.
(Hom Ort h, Multiplicative x) =&gt;
Struct Ort a -&gt; h a x -&gt; ProductForm N a -&gt; x
</span><a href="OAlg.Entity.Product.Definition.html#nProductFormOrt"><span class="hs-identifier hs-var hs-var">nProductFormOrt</span></a></span></span><span> </span><span class="annot"><span class="annottext">Struct Ort a
</span><a href="OAlg.Structure.Definition.html#Struct"><span class="hs-identifier hs-var">Struct</span></a></span><span> </span><span id="local-6989586621679385208"><span class="annot"><span class="annottext">h a x
</span><a href="#local-6989586621679385208"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">h a x -&gt; ProductForm N a -&gt; x
forall {c} {h :: * -&gt; * -&gt; *} {a}.
(Multiplicative c, HomOriented h) =&gt;
h a c -&gt; ProductForm N a -&gt; c
</span><a href="#local-6989586621679385209"><span class="hs-identifier hs-var">prd</span></a></span><span> </span><span class="annot"><span class="annottext">h a x
</span><a href="#local-6989586621679385208"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-607"></span><span>  </span><span id="local-6989586621679385209"><span class="annot"><span class="annottext">prd :: h a c -&gt; ProductForm N a -&gt; c
</span><a href="#local-6989586621679385209"><span class="hs-identifier hs-var hs-var">prd</span></a></span></span><span> </span><span id="local-6989586621679385279"><span class="annot"><span class="annottext">h a c
</span><a href="#local-6989586621679385279"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621679385280"><span class="annot"><span class="annottext">ProductForm N a
</span><a href="#local-6989586621679385280"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ProductForm N a
</span><a href="#local-6989586621679385280"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-608"></span><span>    </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#One"><span class="hs-identifier hs-type">One</span></a></span><span> </span><span id="local-6989586621679385281"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679385281"><span class="hs-identifier hs-var">p</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Point c -&gt; c
forall c. Multiplicative c =&gt; Point c -&gt; c
</span><a href="OAlg.Structure.Multiplicative.Definition.html#one"><span class="hs-identifier hs-var">one</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">h a c -&gt; Point a -&gt; Point c
forall a b. h a b -&gt; Point a -&gt; Point b
forall (h :: * -&gt; * -&gt; *) a b.
HomOriented h =&gt;
h a b -&gt; Point a -&gt; Point b
</span><a href="OAlg.Hom.Oriented.Definition.html#pmap"><span class="hs-identifier hs-var">pmap</span></a></span><span> </span><span class="annot"><span class="annottext">h a c
</span><a href="#local-6989586621679385279"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679385281"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-609"></span><span>    </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span id="local-6989586621679385283"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679385283"><span class="hs-identifier hs-var">a</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">h a c -&gt; a -&gt; c
forall a b. h a b -&gt; a -&gt; b
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><a href="OAlg.Category.Applicative.html#amap"><span class="hs-identifier hs-var">amap</span></a></span><span> </span><span class="annot"><span class="annottext">h a c
</span><a href="#local-6989586621679385279"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679385283"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-610"></span><span>    </span><span id="local-6989586621679385285"><span class="annot"><span class="annottext">ProductForm N a
</span><a href="#local-6989586621679385285"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#%3A%5E"><span class="hs-operator hs-type">:^</span></a></span><span> </span><span id="local-6989586621679385286"><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679385286"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">h a c -&gt; ProductForm N a -&gt; c
</span><a href="#local-6989586621679385209"><span class="hs-identifier hs-var">prd</span></a></span><span> </span><span class="annot"><span class="annottext">h a c
</span><a href="#local-6989586621679385279"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm N a
</span><a href="#local-6989586621679385285"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">c -&gt; N -&gt; c
forall c. Multiplicative c =&gt; c -&gt; N -&gt; c
</span><a href="OAlg.Structure.Multiplicative.Definition.html#npower"><span class="hs-operator hs-var">`npower`</span></a></span><span> </span><span class="annot"><span class="annottext">N
</span><a href="#local-6989586621679385286"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-611"></span><span>    </span><span id="local-6989586621679385287"><span class="annot"><span class="annottext">ProductForm N a
</span><a href="#local-6989586621679385287"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#%3A%2A"><span class="hs-operator hs-type">:*</span></a></span><span> </span><span id="local-6989586621679385288"><span class="annot"><span class="annottext">ProductForm N a
</span><a href="#local-6989586621679385288"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">h a c -&gt; ProductForm N a -&gt; c
</span><a href="#local-6989586621679385209"><span class="hs-identifier hs-var">prd</span></a></span><span> </span><span class="annot"><span class="annottext">h a c
</span><a href="#local-6989586621679385279"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm N a
</span><a href="#local-6989586621679385287"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">c -&gt; c -&gt; c
forall c. Multiplicative c =&gt; c -&gt; c -&gt; c
</span><a href="OAlg.Structure.Multiplicative.Definition.html#%2A"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">h a c -&gt; ProductForm N a -&gt; c
</span><a href="#local-6989586621679385209"><span class="hs-identifier hs-var">prd</span></a></span><span> </span><span class="annot"><span class="annottext">h a c
</span><a href="#local-6989586621679385279"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm N a
</span><a href="#local-6989586621679385288"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-612"></span><span>    </span><span>
</span><span id="line-613"></span><span class="hs-comment">-- | mapping a product form with exponents in t'N' into a 'Multiplicative' structure</span><span>
</span><span id="line-614"></span><span class="hs-comment">-- applying a homomorphism between 'Oriented' structures.</span><span>
</span><span id="line-615"></span><span id="local-6989586621679382889"><span id="local-6989586621679382890"><span id="local-6989586621679382891"><span class="annot"><a href="OAlg.Entity.Product.Definition.html#nProductForm"><span class="hs-identifier hs-type">nProductForm</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Hom.Definition.html#Hom"><span class="hs-identifier hs-type">Hom</span></a></span><span> </span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#Ort"><span class="hs-identifier hs-type">Ort</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382889"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Multiplicative.Definition.html#Multiplicative"><span class="hs-identifier hs-type">Multiplicative</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382890"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-616"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679382889"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382891"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382890"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#ProductForm"><span class="hs-identifier hs-type">ProductForm</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382891"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679382890"><span class="hs-identifier hs-type">x</span></a></span></span></span></span><span>
</span><span id="line-617"></span><span id="nProductForm"><span class="annot"><span class="annottext">nProductForm :: forall (h :: * -&gt; * -&gt; *) x a.
(Hom Ort h, Multiplicative x) =&gt;
h a x -&gt; ProductForm N a -&gt; x
</span><a href="OAlg.Entity.Product.Definition.html#nProductForm"><span class="hs-identifier hs-var hs-var">nProductForm</span></a></span></span><span> </span><span id="local-6989586621679385300"><span class="annot"><span class="annottext">h a x
</span><a href="#local-6989586621679385300"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Struct Ort a -&gt; h a x -&gt; ProductForm N a -&gt; x
forall (h :: * -&gt; * -&gt; *) x a.
(Hom Ort h, Multiplicative x) =&gt;
Struct Ort a -&gt; h a x -&gt; ProductForm N a -&gt; x
</span><a href="OAlg.Entity.Product.Definition.html#nProductFormOrt"><span class="hs-identifier hs-var">nProductFormOrt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Struct (ObjectClass h) a -&gt; Struct Ort a
forall x. Struct (ObjectClass h) x -&gt; Struct Ort x
forall s t x. Transformable s t =&gt; Struct s x -&gt; Struct t x
</span><a href="OAlg.Structure.Definition.html#tau"><span class="hs-identifier hs-var">tau</span></a></span><span> </span><span class="annot"><span class="annottext">(Struct (ObjectClass h) a -&gt; Struct Ort a)
-&gt; Struct (ObjectClass h) a -&gt; Struct Ort a
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><a href="OAlg.Category.Applicative.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">h a x -&gt; Struct (ObjectClass h) a
forall x y. h x y -&gt; Struct (ObjectClass h) x
forall (m :: * -&gt; * -&gt; *) x y.
Morphism m =&gt;
m x y -&gt; Struct (ObjectClass m) x
</span><a href="OAlg.Category.Definition.html#domain"><span class="hs-identifier hs-var">domain</span></a></span><span> </span><span class="annot"><span class="annottext">h a x
</span><a href="#local-6989586621679385300"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">h a x
</span><a href="#local-6989586621679385300"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-618"></span><span>
</span><span id="line-619"></span><span>
</span><span id="line-620"></span><span id="local-6989586621679382901"><span id="local-6989586621679382902"><span id="local-6989586621679382903"><span class="annot"><a href="OAlg.Entity.Product.Definition.html#nProductOrt"><span class="hs-identifier hs-type">nProductOrt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Hom.Definition.html#Hom"><span class="hs-identifier hs-type">Hom</span></a></span><span> </span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#Ort"><span class="hs-identifier hs-type">Ort</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382901"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Multiplicative.Definition.html#Multiplicative"><span class="hs-identifier hs-type">Multiplicative</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382902"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-621"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Structure.Definition.html#Struct"><span class="hs-identifier hs-type">Struct</span></a></span><span> </span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#Ort"><span class="hs-identifier hs-type">Ort</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382903"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679382901"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382903"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382902"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#Product"><span class="hs-identifier hs-type">Product</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382903"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679382902"><span class="hs-identifier hs-type">x</span></a></span></span></span></span><span>
</span><span id="line-622"></span><span id="nProductOrt"><span class="annot"><span class="annottext">nProductOrt :: forall (h :: * -&gt; * -&gt; *) x a.
(Hom Ort h, Multiplicative x) =&gt;
Struct Ort a -&gt; h a x -&gt; Product N a -&gt; x
</span><a href="OAlg.Entity.Product.Definition.html#nProductOrt"><span class="hs-identifier hs-var hs-var">nProductOrt</span></a></span></span><span> </span><span class="annot"><span class="annottext">Struct Ort a
</span><a href="OAlg.Structure.Definition.html#Struct"><span class="hs-identifier hs-var">Struct</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Form (Product N a) -&gt; x) -&gt; Product N a -&gt; x
(ProductForm N a -&gt; x) -&gt; Product N a -&gt; x
forall x y. Exposable x =&gt; (Form x -&gt; y) -&gt; x -&gt; y
</span><a href="OAlg.Data.Constructable.html#restrict"><span class="hs-identifier hs-var">restrict</span></a></span><span> </span><span class="annot"><span class="annottext">((ProductForm N a -&gt; x) -&gt; Product N a -&gt; x)
-&gt; (h a x -&gt; ProductForm N a -&gt; x) -&gt; h a x -&gt; Product N a -&gt; x
forall y z x. (y -&gt; z) -&gt; (x -&gt; y) -&gt; x -&gt; z
forall (c :: * -&gt; * -&gt; *) y z x.
Category c =&gt;
c y z -&gt; c x y -&gt; c x z
</span><a href="OAlg.Category.Definition.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">h a x -&gt; ProductForm N a -&gt; x
forall (h :: * -&gt; * -&gt; *) x a.
(Hom Ort h, Multiplicative x) =&gt;
h a x -&gt; ProductForm N a -&gt; x
</span><a href="OAlg.Entity.Product.Definition.html#nProductForm"><span class="hs-identifier hs-var">nProductForm</span></a></span><span>
</span><span id="line-623"></span><span>
</span><span id="line-624"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-625"></span><span class="hs-comment">-- nProduct -</span><span>
</span><span id="line-626"></span><span>
</span><span id="line-627"></span><span class="hs-comment">-- | mapping a product with exponents in t'N' into a 'Multiplicative' structure</span><span>
</span><span id="line-628"></span><span class="hs-comment">--   applying a homomorphism between 'Oriented' structures.</span><span>
</span><span id="line-629"></span><span id="local-6989586621679382907"><span id="local-6989586621679382908"><span id="local-6989586621679382909"><span class="annot"><a href="OAlg.Entity.Product.Definition.html#nProduct"><span class="hs-identifier hs-type">nProduct</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Hom.Definition.html#Hom"><span class="hs-identifier hs-type">Hom</span></a></span><span> </span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#Ort"><span class="hs-identifier hs-type">Ort</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382907"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Multiplicative.Definition.html#Multiplicative"><span class="hs-identifier hs-type">Multiplicative</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382908"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-630"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679382907"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382909"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382908"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#Product"><span class="hs-identifier hs-type">Product</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#N"><span class="hs-identifier hs-type">N</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382909"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679382908"><span class="hs-identifier hs-type">x</span></a></span></span></span></span><span>
</span><span id="line-631"></span><span id="nProduct"><span class="annot"><span class="annottext">nProduct :: forall (h :: * -&gt; * -&gt; *) x a.
(Hom Ort h, Multiplicative x) =&gt;
h a x -&gt; Product N a -&gt; x
</span><a href="OAlg.Entity.Product.Definition.html#nProduct"><span class="hs-identifier hs-var hs-var">nProduct</span></a></span></span><span> </span><span id="local-6989586621679385323"><span class="annot"><span class="annottext">h a x
</span><a href="#local-6989586621679385323"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Struct Ort a -&gt; h a x -&gt; Product N a -&gt; x
forall (h :: * -&gt; * -&gt; *) x a.
(Hom Ort h, Multiplicative x) =&gt;
Struct Ort a -&gt; h a x -&gt; Product N a -&gt; x
</span><a href="OAlg.Entity.Product.Definition.html#nProductOrt"><span class="hs-identifier hs-var">nProductOrt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Struct (ObjectClass h) a -&gt; Struct Ort a
forall x. Struct (ObjectClass h) x -&gt; Struct Ort x
forall s t x. Transformable s t =&gt; Struct s x -&gt; Struct t x
</span><a href="OAlg.Structure.Definition.html#tau"><span class="hs-identifier hs-var">tau</span></a></span><span> </span><span class="annot"><span class="annottext">(Struct (ObjectClass h) a -&gt; Struct Ort a)
-&gt; Struct (ObjectClass h) a -&gt; Struct Ort a
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><a href="OAlg.Category.Applicative.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">h a x -&gt; Struct (ObjectClass h) a
forall x y. h x y -&gt; Struct (ObjectClass h) x
forall (m :: * -&gt; * -&gt; *) x y.
Morphism m =&gt;
m x y -&gt; Struct (ObjectClass m) x
</span><a href="OAlg.Category.Definition.html#domain"><span class="hs-identifier hs-var">domain</span></a></span><span> </span><span class="annot"><span class="annottext">h a x
</span><a href="#local-6989586621679385323"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">h a x
</span><a href="#local-6989586621679385323"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span>
</span><span id="line-632"></span><span>
</span><span id="line-633"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-634"></span><span class="hs-comment">-- zProductForm -</span><span>
</span><span id="line-635"></span><span>
</span><span id="line-636"></span><span id="local-6989586621679382913"><span id="local-6989586621679382914"><span id="local-6989586621679382915"><span class="annot"><a href="OAlg.Entity.Product.Definition.html#zProductFormOrt"><span class="hs-identifier hs-type">zProductFormOrt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Hom.Definition.html#Hom"><span class="hs-identifier hs-type">Hom</span></a></span><span> </span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#Ort"><span class="hs-identifier hs-type">Ort</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382913"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Multiplicative.Definition.html#Cayleyan"><span class="hs-identifier hs-type">Cayleyan</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382914"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-637"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Structure.Definition.html#Struct"><span class="hs-identifier hs-type">Struct</span></a></span><span> </span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#Ort"><span class="hs-identifier hs-type">Ort</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382915"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679382913"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382915"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382914"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#ProductForm"><span class="hs-identifier hs-type">ProductForm</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#Z"><span class="hs-identifier hs-type">Z</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382915"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679382914"><span class="hs-identifier hs-type">x</span></a></span></span></span></span><span>
</span><span id="line-638"></span><span id="zProductFormOrt"><span class="annot"><span class="annottext">zProductFormOrt :: forall (h :: * -&gt; * -&gt; *) x a.
(Hom Ort h, Cayleyan x) =&gt;
Struct Ort a -&gt; h a x -&gt; ProductForm Z a -&gt; x
</span><a href="OAlg.Entity.Product.Definition.html#zProductFormOrt"><span class="hs-identifier hs-var hs-var">zProductFormOrt</span></a></span></span><span> </span><span class="annot"><span class="annottext">Struct Ort a
</span><a href="OAlg.Structure.Definition.html#Struct"><span class="hs-identifier hs-var">Struct</span></a></span><span> </span><span id="local-6989586621679385333"><span class="annot"><span class="annottext">h a x
</span><a href="#local-6989586621679385333"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">h a x -&gt; ProductForm Z a -&gt; x
forall {c} {h :: * -&gt; * -&gt; *} {a}.
(HomOriented h, Invertible c) =&gt;
h a c -&gt; ProductForm Z a -&gt; c
</span><a href="#local-6989586621679385334"><span class="hs-identifier hs-var">prd</span></a></span><span> </span><span class="annot"><span class="annottext">h a x
</span><a href="#local-6989586621679385333"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-639"></span><span>  </span><span id="local-6989586621679385334"><span class="annot"><span class="annottext">prd :: h a c -&gt; ProductForm Z a -&gt; c
</span><a href="#local-6989586621679385334"><span class="hs-identifier hs-var hs-var">prd</span></a></span></span><span> </span><span id="local-6989586621679385405"><span class="annot"><span class="annottext">h a c
</span><a href="#local-6989586621679385405"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621679385406"><span class="annot"><span class="annottext">ProductForm Z a
</span><a href="#local-6989586621679385406"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ProductForm Z a
</span><a href="#local-6989586621679385406"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-640"></span><span>    </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#One"><span class="hs-identifier hs-type">One</span></a></span><span> </span><span id="local-6989586621679385407"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679385407"><span class="hs-identifier hs-var">p</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Point c -&gt; c
forall c. Multiplicative c =&gt; Point c -&gt; c
</span><a href="OAlg.Structure.Multiplicative.Definition.html#one"><span class="hs-identifier hs-var">one</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">h a c -&gt; Point a -&gt; Point c
forall a b. h a b -&gt; Point a -&gt; Point b
forall (h :: * -&gt; * -&gt; *) a b.
HomOriented h =&gt;
h a b -&gt; Point a -&gt; Point b
</span><a href="OAlg.Hom.Oriented.Definition.html#pmap"><span class="hs-identifier hs-var">pmap</span></a></span><span> </span><span class="annot"><span class="annottext">h a c
</span><a href="#local-6989586621679385405"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679385407"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-641"></span><span>    </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span id="local-6989586621679385408"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679385408"><span class="hs-identifier hs-var">a</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">h a c -&gt; a -&gt; c
forall a b. h a b -&gt; a -&gt; b
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><a href="OAlg.Category.Applicative.html#amap"><span class="hs-identifier hs-var">amap</span></a></span><span> </span><span class="annot"><span class="annottext">h a c
</span><a href="#local-6989586621679385405"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679385408"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-642"></span><span>    </span><span id="local-6989586621679385409"><span class="annot"><span class="annottext">ProductForm Z a
</span><a href="#local-6989586621679385409"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#%3A%5E"><span class="hs-operator hs-type">:^</span></a></span><span> </span><span id="local-6989586621679385410"><span class="annot"><span class="annottext">Z
</span><a href="#local-6989586621679385410"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">h a c -&gt; ProductForm Z a -&gt; c
</span><a href="#local-6989586621679385334"><span class="hs-identifier hs-var">prd</span></a></span><span> </span><span class="annot"><span class="annottext">h a c
</span><a href="#local-6989586621679385405"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm Z a
</span><a href="#local-6989586621679385409"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">c -&gt; Z -&gt; c
forall c. Invertible c =&gt; c -&gt; Z -&gt; c
</span><a href="OAlg.Structure.Multiplicative.Definition.html#zpower"><span class="hs-operator hs-var">`zpower`</span></a></span><span> </span><span class="annot"><span class="annottext">Z
</span><a href="#local-6989586621679385410"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-643"></span><span>    </span><span id="local-6989586621679385412"><span class="annot"><span class="annottext">ProductForm Z a
</span><a href="#local-6989586621679385412"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#%3A%2A"><span class="hs-operator hs-type">:*</span></a></span><span> </span><span id="local-6989586621679385413"><span class="annot"><span class="annottext">ProductForm Z a
</span><a href="#local-6989586621679385413"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">h a c -&gt; ProductForm Z a -&gt; c
</span><a href="#local-6989586621679385334"><span class="hs-identifier hs-var">prd</span></a></span><span> </span><span class="annot"><span class="annottext">h a c
</span><a href="#local-6989586621679385405"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm Z a
</span><a href="#local-6989586621679385412"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">c -&gt; c -&gt; c
forall c. Multiplicative c =&gt; c -&gt; c -&gt; c
</span><a href="OAlg.Structure.Multiplicative.Definition.html#%2A"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">h a c -&gt; ProductForm Z a -&gt; c
</span><a href="#local-6989586621679385334"><span class="hs-identifier hs-var">prd</span></a></span><span> </span><span class="annot"><span class="annottext">h a c
</span><a href="#local-6989586621679385405"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm Z a
</span><a href="#local-6989586621679385413"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-644"></span><span>
</span><span id="line-645"></span><span>
</span><span id="line-646"></span><span class="hs-comment">-- | mapping a product form with exponents in 'Z' into a 'Cayleyan' structure</span><span>
</span><span id="line-647"></span><span class="hs-comment">-- applying a homomorphism between 'Oriented' structures.</span><span>
</span><span id="line-648"></span><span id="local-6989586621679382922"><span id="local-6989586621679382923"><span id="local-6989586621679382924"><span class="annot"><a href="OAlg.Entity.Product.Definition.html#zProductForm"><span class="hs-identifier hs-type">zProductForm</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Hom.Definition.html#Hom"><span class="hs-identifier hs-type">Hom</span></a></span><span> </span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#Ort"><span class="hs-identifier hs-type">Ort</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382922"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Multiplicative.Definition.html#Cayleyan"><span class="hs-identifier hs-type">Cayleyan</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382923"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-649"></span><span>                 </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679382922"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382924"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382923"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#ProductForm"><span class="hs-identifier hs-type">ProductForm</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#Z"><span class="hs-identifier hs-type">Z</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382924"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679382923"><span class="hs-identifier hs-type">x</span></a></span></span></span></span><span>
</span><span id="line-650"></span><span id="zProductForm"><span class="annot"><span class="annottext">zProductForm :: forall (h :: * -&gt; * -&gt; *) x a.
(Hom Ort h, Cayleyan x) =&gt;
h a x -&gt; ProductForm Z a -&gt; x
</span><a href="OAlg.Entity.Product.Definition.html#zProductForm"><span class="hs-identifier hs-var hs-var">zProductForm</span></a></span></span><span> </span><span id="local-6989586621679385425"><span class="annot"><span class="annottext">h a x
</span><a href="#local-6989586621679385425"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Struct Ort a -&gt; h a x -&gt; ProductForm Z a -&gt; x
forall (h :: * -&gt; * -&gt; *) x a.
(Hom Ort h, Cayleyan x) =&gt;
Struct Ort a -&gt; h a x -&gt; ProductForm Z a -&gt; x
</span><a href="OAlg.Entity.Product.Definition.html#zProductFormOrt"><span class="hs-identifier hs-var">zProductFormOrt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Struct (ObjectClass h) a -&gt; Struct Ort a
forall x. Struct (ObjectClass h) x -&gt; Struct Ort x
forall s t x. Transformable s t =&gt; Struct s x -&gt; Struct t x
</span><a href="OAlg.Structure.Definition.html#tau"><span class="hs-identifier hs-var">tau</span></a></span><span> </span><span class="annot"><span class="annottext">(Struct (ObjectClass h) a -&gt; Struct Ort a)
-&gt; Struct (ObjectClass h) a -&gt; Struct Ort a
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><a href="OAlg.Category.Applicative.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">h a x -&gt; Struct (ObjectClass h) a
forall x y. h x y -&gt; Struct (ObjectClass h) x
forall (m :: * -&gt; * -&gt; *) x y.
Morphism m =&gt;
m x y -&gt; Struct (ObjectClass m) x
</span><a href="OAlg.Category.Definition.html#domain"><span class="hs-identifier hs-var">domain</span></a></span><span> </span><span class="annot"><span class="annottext">h a x
</span><a href="#local-6989586621679385425"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">h a x
</span><a href="#local-6989586621679385425"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-651"></span><span>
</span><span id="line-652"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-653"></span><span class="hs-comment">-- zProduct -</span><span>
</span><span id="line-654"></span><span id="local-6989586621679382928"><span id="local-6989586621679382929"><span id="local-6989586621679382930"><span class="annot"><a href="OAlg.Entity.Product.Definition.html#zProductOrt"><span class="hs-identifier hs-type">zProductOrt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Hom.Definition.html#Hom"><span class="hs-identifier hs-type">Hom</span></a></span><span> </span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#Ort"><span class="hs-identifier hs-type">Ort</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382928"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Multiplicative.Definition.html#Cayleyan"><span class="hs-identifier hs-type">Cayleyan</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382929"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-655"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="OAlg.Structure.Definition.html#Struct"><span class="hs-identifier hs-type">Struct</span></a></span><span> </span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#Ort"><span class="hs-identifier hs-type">Ort</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382930"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679382928"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382930"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382929"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#Product"><span class="hs-identifier hs-type">Product</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#Z"><span class="hs-identifier hs-type">Z</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382930"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679382929"><span class="hs-identifier hs-type">x</span></a></span></span></span></span><span>
</span><span id="line-656"></span><span id="zProductOrt"><span class="annot"><span class="annottext">zProductOrt :: forall (h :: * -&gt; * -&gt; *) x a.
(Hom Ort h, Cayleyan x) =&gt;
Struct Ort a -&gt; h a x -&gt; Product Z a -&gt; x
</span><a href="OAlg.Entity.Product.Definition.html#zProductOrt"><span class="hs-identifier hs-var hs-var">zProductOrt</span></a></span></span><span> </span><span class="annot"><span class="annottext">Struct Ort a
</span><a href="OAlg.Structure.Definition.html#Struct"><span class="hs-identifier hs-var">Struct</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Form (Product Z a) -&gt; x) -&gt; Product Z a -&gt; x
(ProductForm Z a -&gt; x) -&gt; Product Z a -&gt; x
forall x y. Exposable x =&gt; (Form x -&gt; y) -&gt; x -&gt; y
</span><a href="OAlg.Data.Constructable.html#restrict"><span class="hs-identifier hs-var">restrict</span></a></span><span> </span><span class="annot"><span class="annottext">((ProductForm Z a -&gt; x) -&gt; Product Z a -&gt; x)
-&gt; (h a x -&gt; ProductForm Z a -&gt; x) -&gt; h a x -&gt; Product Z a -&gt; x
forall y z x. (y -&gt; z) -&gt; (x -&gt; y) -&gt; x -&gt; z
forall (c :: * -&gt; * -&gt; *) y z x.
Category c =&gt;
c y z -&gt; c x y -&gt; c x z
</span><a href="OAlg.Category.Definition.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">h a x -&gt; ProductForm Z a -&gt; x
forall (h :: * -&gt; * -&gt; *) x a.
(Hom Ort h, Cayleyan x) =&gt;
h a x -&gt; ProductForm Z a -&gt; x
</span><a href="OAlg.Entity.Product.Definition.html#zProductForm"><span class="hs-identifier hs-var">zProductForm</span></a></span><span>
</span><span id="line-657"></span><span>
</span><span id="line-658"></span><span class="hs-comment">-- | mapping a product with exponents in 'Z' into a 'Cayleyan' structure</span><span>
</span><span id="line-659"></span><span class="hs-comment">--   applying a homomorphism between 'Oriented' structures.</span><span>
</span><span id="line-660"></span><span id="local-6989586621679382934"><span id="local-6989586621679382935"><span id="local-6989586621679382936"><span class="annot"><a href="OAlg.Entity.Product.Definition.html#zProduct"><span class="hs-identifier hs-type">zProduct</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Hom.Definition.html#Hom"><span class="hs-identifier hs-type">Hom</span></a></span><span> </span><span class="annot"><a href="OAlg.Structure.Oriented.Definition.html#Ort"><span class="hs-identifier hs-type">Ort</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382934"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="OAlg.Structure.Multiplicative.Definition.html#Cayleyan"><span class="hs-identifier hs-type">Cayleyan</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382935"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-661"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679382934"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382936"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382935"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#Product"><span class="hs-identifier hs-type">Product</span></a></span><span> </span><span class="annot"><a href="OAlg.Data.Number.html#Z"><span class="hs-identifier hs-type">Z</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382936"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679382935"><span class="hs-identifier hs-type">x</span></a></span></span></span></span><span>
</span><span id="line-662"></span><span id="zProduct"><span class="annot"><span class="annottext">zProduct :: forall (h :: * -&gt; * -&gt; *) x a.
(Hom Ort h, Cayleyan x) =&gt;
h a x -&gt; Product Z a -&gt; x
</span><a href="OAlg.Entity.Product.Definition.html#zProduct"><span class="hs-identifier hs-var hs-var">zProduct</span></a></span></span><span> </span><span id="local-6989586621679385446"><span class="annot"><span class="annottext">h a x
</span><a href="#local-6989586621679385446"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Struct Ort a -&gt; h a x -&gt; Product Z a -&gt; x
forall (h :: * -&gt; * -&gt; *) x a.
(Hom Ort h, Cayleyan x) =&gt;
Struct Ort a -&gt; h a x -&gt; Product Z a -&gt; x
</span><a href="OAlg.Entity.Product.Definition.html#zProductOrt"><span class="hs-identifier hs-var">zProductOrt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Struct (ObjectClass h) a -&gt; Struct Ort a
forall x. Struct (ObjectClass h) x -&gt; Struct Ort x
forall s t x. Transformable s t =&gt; Struct s x -&gt; Struct t x
</span><a href="OAlg.Structure.Definition.html#tau"><span class="hs-identifier hs-var">tau</span></a></span><span> </span><span class="annot"><span class="annottext">(Struct (ObjectClass h) a -&gt; Struct Ort a)
-&gt; Struct (ObjectClass h) a -&gt; Struct Ort a
forall (h :: * -&gt; * -&gt; *) a b. Applicative h =&gt; h a b -&gt; a -&gt; b
</span><a href="OAlg.Category.Applicative.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">h a x -&gt; Struct (ObjectClass h) a
forall x y. h x y -&gt; Struct (ObjectClass h) x
forall (m :: * -&gt; * -&gt; *) x y.
Morphism m =&gt;
m x y -&gt; Struct (ObjectClass m) x
</span><a href="OAlg.Category.Definition.html#domain"><span class="hs-identifier hs-var">domain</span></a></span><span> </span><span class="annot"><span class="annottext">h a x
</span><a href="#local-6989586621679385446"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">h a x
</span><a href="#local-6989586621679385446"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-663"></span><span>
</span><span id="line-664"></span><span>
</span><span id="line-665"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-666"></span><span class="hs-comment">-- prFromOp -</span><span>
</span><span id="line-667"></span><span>
</span><span id="line-668"></span><span class="hs-comment">-- | from 'Op' symbols.</span><span>
</span><span id="line-669"></span><span class="hs-comment">--</span><span>
</span><span id="line-670"></span><span class="hs-comment">-- __Property__ For every 'Oriented' structure @__a__@ and 'Integral' @__r__@ the resulting</span><span>
</span><span id="line-671"></span><span class="hs-comment">-- map 'prFromOp' is a __contravariant__ homomorphisms between 'Multiplicative' structures.</span><span>
</span><span id="line-672"></span><span id="local-6989586621679382940"><span id="local-6989586621679382941"><span class="annot"><a href="OAlg.Entity.Product.Definition.html#prFromOp"><span class="hs-identifier hs-type">prFromOp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#Product"><span class="hs-identifier hs-type">Product</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382940"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Data.Opposite.html#Op"><span class="hs-identifier hs-type">Op</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382941"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#Product"><span class="hs-identifier hs-type">Product</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382940"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679382941"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-673"></span><span id="prFromOp"><span class="annot"><span class="annottext">prFromOp :: forall r a. Product r (Op a) -&gt; Product r a
</span><a href="OAlg.Entity.Product.Definition.html#prFromOp"><span class="hs-identifier hs-var hs-var">prFromOp</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="OAlg.Entity.Product.Definition.html#Product"><span class="hs-identifier hs-type">Product</span></a></span><span> </span><span id="local-6989586621679385447"><span class="annot"><span class="annottext">ProductForm r (Op a)
</span><a href="#local-6989586621679385447"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProductForm r a -&gt; Product r a
forall r a. ProductForm r a -&gt; Product r a
</span><a href="OAlg.Entity.Product.Definition.html#Product"><span class="hs-identifier hs-var">Product</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProductForm r (Op a) -&gt; ProductForm r a
forall r a. ProductForm r (Op a) -&gt; ProductForm r a
</span><a href="OAlg.Entity.Product.Definition.html#prfFromOp"><span class="hs-identifier hs-var">prfFromOp</span></a></span><span> </span><span class="annot"><span class="annottext">ProductForm r (Op a)
</span><a href="#local-6989586621679385447"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-674"></span><span>
</span><span id="line-675"></span></pre></body></html>